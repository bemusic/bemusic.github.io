(this.webpackJsonp=this.webpackJsonp||[]).push([[10],{142:function(module,__webpack_exports__,__webpack_require__){"use strict";var debug__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(157),debug__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(debug__WEBPACK_IMPORTED_MODULE_0__),_parser_pegjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(811),_parser_pegjs__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_parser_pegjs__WEBPACK_IMPORTED_MODULE_1__);const log=debug__WEBPACK_IMPORTED_MODULE_0___default()("scintillator:expression");function createFunction(code){let fn=eval("(function(get) { return "+code+" })");return fn.displayName="("+code+")",fn.constant=!!/^[-0-9.]+$/.test(code),fn}function Expression(t){log("parsing %s",t);let e=_parser_pegjs__WEBPACK_IMPORTED_MODULE_1___default.a.parse(t);log("parsed %s => %s",t,e);let n,r=createFunction(e);return n=r.constant?r:function(t){return r((function(e){return t[e]}))},n.constant=r.constant,n}__webpack_exports__.a=Expression},550:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return d}));var r=n(32),i=n.n(r),a=n(68),s=n.n(a),o=n(812),c=n.n(o);let l=t=>Object.assign({},t,{data:c()(t.data)});class h{constructor(t,e){this._timeKey=e||"t",this._properties=i()(t).map(t=>i.a.map(t.data,"name")).flatten().thru(t=>new Set(t)).value(),this._animations=i.a.map(t,l),this._events=i.a.uniq(i.a.map(t,"on"))}prop(t,e){return this._properties.has(t)?n=>{let r=this._getAnimation(n);return r.hasOwnProperty(t)?r[t]:e(n)}:e}_getAnimation(t){let e=i()(this._events).filter(e=>""===e||e in t).maxBy(e=>t[e]||0),n=t[this._timeKey]-(t[e]||0),r=this._animations.filter(t=>t.on===e).map(t=>t.data.values(n));return Object.assign({},...r)}static compile(t,e){let n=Array.from(e.children("animation")),r=i.a.map(n,t=>u(s()(t))),a=e.attr("t")||"t";return new h(r,a)}}function u(t){let e=i.a.map(Array.from(t.children("keyframe")),d),n={};for(let t of e){let e=+t.t,r=t.ease||"linear";if(isNaN(e))throw new Error('Expected keyframe to have "t" attribute');for(let i in t){if("t"===i||"ease"===i)continue;let a=+t[i];(n[i]||(n[i]={name:i,keyframes:[]})).keyframes.push({time:e,value:a,ease:r})}}return{on:t.attr("on")||"",data:i.a.values(n)}}function d(t){return i()(t.attributes).map(t=>[t.name.toLowerCase(),t.value]).fromPairs().value()}e.d=h},811:function(t,e,n){"use strict";function r(t,e,n,i){this.message=t,this.expected=e,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,r)}!function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(r,Error),r.buildMessage=function(t,e){var n={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var e,n="";for(e=0;e<t.parts.length;e++)n+=t.parts[e]instanceof Array?a(t.parts[e][0])+"-"+a(t.parts[e][1]):a(t.parts[e]);return"["+(t.inverted?"^":"")+n+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function a(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}return"Expected "+function(t){var e,r,i,a=new Array(t.length);for(e=0;e<t.length;e++)a[e]=(i=t[e],n[i.type](i));if(a.sort(),a.length>0){for(e=1,r=1;e<a.length;e++)a[e-1]!==a[e]&&(a[r]=a[e],r++);a.length=r}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(t)+" but "+function(t){return t?'"'+i(t)+'"':"end of input"}(e)+" found."},t.exports={SyntaxError:r,parse:function(t,e){e=void 0!==e?e:{};var n,i={},a={expr:Y},s=Y,o=K("||",!1),c=function(t,e){return function(t,e){return t+e.map(et).join("")}(t,e)},l=K("&&",!1),h=K("+",!1),u=K("-",!1),d=K("*",!1),f=K("/",!1),p=K("%",!1),_=K("(",!1),m=K(")",!1),g=K("!",!1),v=q("number"),w=/^[eE]/,x=W(["e","E"],!1,!1),y=/^[0-9]/,b=W([["0","9"]],!1,!1),A=K(".",!1),E=K("0",!1),C=/^[1-9]/,k=W([["1","9"]],!1,!1),D=/^[a-zA-Z]/,j=W([["a","z"],["A","Z"]],!1,!1),M=/^[a-zA-Z0-9_]/,L=W([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),O=q("whitespace"),T=/^[ \t\n\r]/,P=W([" ","\t","\n","\r"],!1,!1),S=0,R=0,N=[{line:1,column:1}],B=0,I=[],F=0;if("startRule"in e){if(!(e.startRule in a))throw new Error("Can't start parsing from rule \""+e.startRule+'".');s=a[e.startRule]}function U(){return t.substring(R,S)}function K(t,e){return{type:"literal",text:t,ignoreCase:e}}function W(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function q(t){return{type:"other",description:t}}function z(e){var n,r=N[e];if(r)return r;for(n=e-1;!N[n];)n--;for(r={line:(r=N[n]).line,column:r.column};n<e;)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return N[e]=r,r}function X(t,e){var n=z(t),r=z(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function Z(t){S<B||(S>B&&(B=S,I=[]),I.push(t))}function J(t,e,n){return new r(r.buildMessage(t,e),t,e,n)}function Y(){return $()}function $(){var e,n,r,a,s,l,h,u;if(e=S,(n=G())!==i){for(r=[],a=S,(s=tt())!==i?("||"===t.substr(S,2)?(l="||",S+=2):(l=i,0===F&&Z(o)),l!==i&&(h=tt())!==i&&(u=G())!==i?a=s=[s,l,h,u]:(S=a,a=i)):(S=a,a=i);a!==i;)r.push(a),a=S,(s=tt())!==i?("||"===t.substr(S,2)?(l="||",S+=2):(l=i,0===F&&Z(o)),l!==i&&(h=tt())!==i&&(u=G())!==i?a=s=[s,l,h,u]:(S=a,a=i)):(S=a,a=i);r!==i?(R=e,e=n=c(n,r)):(S=e,e=i)}else S=e,e=i;return e}function G(){var e,n,r,a,s,o,h,u;if(e=S,(n=H())!==i){for(r=[],a=S,(s=tt())!==i?("&&"===t.substr(S,2)?(o="&&",S+=2):(o=i,0===F&&Z(l)),o!==i&&(h=tt())!==i&&(u=H())!==i?a=s=[s,o,h,u]:(S=a,a=i)):(S=a,a=i);a!==i;)r.push(a),a=S,(s=tt())!==i?("&&"===t.substr(S,2)?(o="&&",S+=2):(o=i,0===F&&Z(l)),o!==i&&(h=tt())!==i&&(u=H())!==i?a=s=[s,o,h,u]:(S=a,a=i)):(S=a,a=i);r!==i?(R=e,e=n=c(n,r)):(S=e,e=i)}else S=e,e=i;return e}function H(){var e,n,r,a,s,o,l,d;if(e=S,(n=Q())!==i){for(r=[],a=S,(s=tt())!==i?(43===t.charCodeAt(S)?(o="+",S++):(o=i,0===F&&Z(h)),o===i&&(45===t.charCodeAt(S)?(o="-",S++):(o=i,0===F&&Z(u))),o!==i&&(l=tt())!==i&&(d=Q())!==i?a=s=[s,o,l,d]:(S=a,a=i)):(S=a,a=i);a!==i;)r.push(a),a=S,(s=tt())!==i?(43===t.charCodeAt(S)?(o="+",S++):(o=i,0===F&&Z(h)),o===i&&(45===t.charCodeAt(S)?(o="-",S++):(o=i,0===F&&Z(u))),o!==i&&(l=tt())!==i&&(d=Q())!==i?a=s=[s,o,l,d]:(S=a,a=i)):(S=a,a=i);r!==i?(R=e,e=n=c(n,r)):(S=e,e=i)}else S=e,e=i;return e}function Q(){var e,n,r,a,s,o,l,h;if(e=S,(n=V())!==i){for(r=[],a=S,(s=tt())!==i?(42===t.charCodeAt(S)?(o="*",S++):(o=i,0===F&&Z(d)),o===i&&(47===t.charCodeAt(S)?(o="/",S++):(o=i,0===F&&Z(f)),o===i&&(37===t.charCodeAt(S)?(o="%",S++):(o=i,0===F&&Z(p)))),o!==i&&(l=tt())!==i&&(h=V())!==i?a=s=[s,o,l,h]:(S=a,a=i)):(S=a,a=i);a!==i;)r.push(a),a=S,(s=tt())!==i?(42===t.charCodeAt(S)?(o="*",S++):(o=i,0===F&&Z(d)),o===i&&(47===t.charCodeAt(S)?(o="/",S++):(o=i,0===F&&Z(f)),o===i&&(37===t.charCodeAt(S)?(o="%",S++):(o=i,0===F&&Z(p)))),o!==i&&(l=tt())!==i&&(h=V())!==i?a=s=[s,o,l,h]:(S=a,a=i)):(S=a,a=i);r!==i?(R=e,e=n=c(n,r)):(S=e,e=i)}else S=e,e=i;return e}function V(){var e,n,r,a,s;return e=S,40===t.charCodeAt(S)?(n="(",S++):(n=i,0===F&&Z(_)),n!==i&&(r=tt())!==i&&(a=$())!==i&&tt()!==i?(41===t.charCodeAt(S)?(s=")",S++):(s=i,0===F&&Z(m)),s!==i?(R=e,e=n="("+a+")"):(S=e,e=i)):(S=e,e=i),e===i&&(e=S,33===t.charCodeAt(S)?(n="!",S++):(n=i,0===F&&Z(g)),n!==i&&(r=V())!==i?(R=e,e=n="!"+r):(S=e,e=i),e===i&&(e=function(){var e,n,r,a;F++,e=S,45===t.charCodeAt(S)?(n="-",S++):(n=i,0===F&&Z(u));n===i&&(n=null);n!==i&&function(){var e,n,r,a;48===t.charCodeAt(S)?(e="0",S++):(e=i,0===F&&Z(E));if(e===i)if(e=S,C.test(t.charAt(S))?(n=t.charAt(S),S++):(n=i,0===F&&Z(k)),n!==i){for(r=[],y.test(t.charAt(S))?(a=t.charAt(S),S++):(a=i,0===F&&Z(b));a!==i;)r.push(a),y.test(t.charAt(S))?(a=t.charAt(S),S++):(a=i,0===F&&Z(b));r!==i?e=n=[n,r]:(S=e,e=i)}else S=e,e=i;return e}()!==i?((r=function(){var e,n,r,a;e=S,46===t.charCodeAt(S)?(n=".",S++):(n=i,0===F&&Z(A));if(n!==i){if(r=[],y.test(t.charAt(S))?(a=t.charAt(S),S++):(a=i,0===F&&Z(b)),a!==i)for(;a!==i;)r.push(a),y.test(t.charAt(S))?(a=t.charAt(S),S++):(a=i,0===F&&Z(b));else r=i;r!==i?e=n=[n,r]:(S=e,e=i)}else S=e,e=i;return e}())===i&&(r=null),r!==i?((a=function(){var e,n,r,a,s;e=S,w.test(t.charAt(S))?(n=t.charAt(S),S++):(n=i,0===F&&Z(x));if(n!==i)if(45===t.charCodeAt(S)?(r="-",S++):(r=i,0===F&&Z(u)),r===i&&(43===t.charCodeAt(S)?(r="+",S++):(r=i,0===F&&Z(h))),r===i&&(r=null),r!==i){if(a=[],y.test(t.charAt(S))?(s=t.charAt(S),S++):(s=i,0===F&&Z(b)),s!==i)for(;s!==i;)a.push(s),y.test(t.charAt(S))?(s=t.charAt(S),S++):(s=i,0===F&&Z(b));else a=i;a!==i?e=n=[n,r,a]:(S=e,e=i)}else S=e,e=i;else S=e,e=i;return e}())===i&&(a=null),a!==i?(R=e,n=U(),e=n):(S=e,e=i)):(S=e,e=i)):(S=e,e=i);F--,e===i&&(n=i,0===F&&Z(v));return e}())===i&&(e=function(){var e,n,r,a;e=S,n=[],D.test(t.charAt(S))?(r=t.charAt(S),S++):(r=i,0===F&&Z(j));if(r!==i)for(;r!==i;)n.push(r),D.test(t.charAt(S))?(r=t.charAt(S),S++):(r=i,0===F&&Z(j));else n=i;if(n!==i){for(r=[],M.test(t.charAt(S))?(a=t.charAt(S),S++):(a=i,0===F&&Z(L));a!==i;)r.push(a),M.test(t.charAt(S))?(a=t.charAt(S),S++):(a=i,0===F&&Z(L));r!==i?(R=e,n="get("+JSON.stringify(U())+")",e=n):(S=e,e=i)}else S=e,e=i;return e}())),e}function tt(){var e,n;for(F++,e=[],T.test(t.charAt(S))?(n=t.charAt(S),S++):(n=i,0===F&&Z(P));n!==i;)e.push(n),T.test(t.charAt(S))?(n=t.charAt(S),S++):(n=i,0===F&&Z(P));return F--,e===i&&(n=i,0===F&&Z(O)),e}function et(t){return" "+t[1]+" "+t[3]}if((n=s())!==i&&S===t.length)return n;throw n!==i&&S<t.length&&Z({type:"end"}),J(I,B<t.length?t.charAt(B):null,B<t.length?X(B,B+1):X(B,B))}}},879:function(t,e,n){"use strict";n.r(e),n.d(e,"load",(function(){return I})),n.d(e,"Context",(function(){return a})),n.d(e,"getSkinUrl",(function(){return F}));var r=n(50);function i(t,e){return r.utils.canUseNewCanvasBlendModes=()=>!0,new r.CanvasRenderer(t,e,{transparent:!0})}class a{constructor(t,{touchEventTarget:e}={}){this.refs={},this._skin=t,this._touchEventTarget=e,this._instance=t.instantiate(this),this._renderer=i(t.width,t.height),this.stage=this._instance.object,this.view=this._renderer.view,this.skinData=t.data,this._setupInteractivity()}render(t){this._instance.push(t),this._renderer.render(this.stage)}destroy(){this._instance.destroy(),this._instance=null,this._teardownInteractivity()}get input(){return this._input.get()}ref(t,e){(this.refs[t]||(this.refs[t]=new Set)).add(e)}unref(t,e){let n=this.refs[t];n&&n.delete(e)}_setupInteractivity(){let t=null,e=[],n=e=>{t=e},r=e=>{t=t&&e},i=()=>{t=null},a=t=>{e=[].slice.call(t.touches)};const s=this._touchEventTarget||this.view;let o=this._skin.width,c=this._skin.height;function l(t,e,n){return{x:(e.clientX-n.left)/n.width*o,y:(e.clientY-n.top)/n.height*c,id:t}}s.addEventListener("mousedown",n,!1),s.addEventListener("mousemove",r,!1),s.addEventListener("mouseup",i,!1),s.addEventListener("touchstart",a,!1),s.addEventListener("touchmove",a,!1),s.addEventListener("touchend",a,!1),this._teardownInteractivity=()=>{s.removeEventListener("mousedown",n,!1),s.removeEventListener("mousemove",r,!1),s.removeEventListener("mouseup",i,!1),s.removeEventListener("touchstart",a,!1),s.removeEventListener("touchmove",a,!1),s.removeEventListener("touchend",a,!1)},this._input={get:()=>{let n=[],r=this.view.getBoundingClientRect();t&&n.push(l("mouse",t,r));for(let t=0;t<e.length;t++){let i=e[t];n.push(l("touch"+i.identifier,i,r))}return n}}}}var s=n(68),o=n.n(s),c=n(157),l=n.n(c),h=n(103),u=n.n(h),d=n(75);var f=class{static compile(t,e){let n=new this;return n.compile(t,e),n}},p=n(166);var _=class{constructor(t){if(this._context=t.context,this._object=t.object,this._children=t.children,this._bindings=[],this._concerns=[],this.onData=new p.a(t.onData),this.onDestroy=new p.a(t.onDestroy),t.bindings)for(let e of t.bindings)this.bind(...e);if(t.concerns)for(let e of t.concerns)this._concerns.push(e.instantiate(this._context,this));if(t.children)for(let e of t.children)this._concerns.push(e.instantiate(this._context,this._object));t.onCreate&&new p.a(t.onCreate).call(),t.parent&&this.attachTo(t.parent)}bind(...t){let e=function(t){let e;return function(n){e!==n&&(e=n,t(n))}}(t.pop());1===t.length&&t[0].constant?e(t[0]()):this._bindings.push(n=>{for(var r=0;r<t.length;r++)n=t[r](n);e(n)})}attachTo(t){this._parent=t,this._parent.addChild(this._object)}detach(){this._parent&&(this._parent.removeChild(this._object),this._parent=null)}push(t){var e;for(e=0;e<this._bindings.length;e++)this._bindings[e](t);for(e=0;e<this._concerns.length;e++)this._concerns[e].push(t);this.onData.call(t)}destroy(){this.detach();for(var t=0;t<this._concerns.length;t++)this._concerns[t].destroy();this.onDestroy.call(),this._concerns=null,this._bindings=null,this._parent=null,this._object=null}get object(){return this._object}get parent(){return this._parent}},m=n(142),g=n(550);let v=[{name:"x",default:"0",apply:(t,e)=>t.x=e},{name:"y",default:"0",apply:(t,e)=>t.y=e},{name:"scale-x",default:"1",apply:(t,e)=>t.scale.x=e},{name:"scale-y",default:"1",apply:(t,e)=>t.scale.y=e},{name:"alpha",default:"1",apply:(t,e)=>t.alpha=e},{name:"width",apply:(t,e)=>t.width=e},{name:"height",apply:(t,e)=>t.height=e},{name:"visible",apply:(t,e)=>t.visible=e}];var w=class extends f{compile(t,e){this._animation=g.d.compile(t,e),this._bindings=[];for(let t of v){let n=e.attr(t.name)||t.default;if(!n)continue;let r=new m.a(n),i=this._animation.prop(t.name,r);this._bindings.push({getter:i,apply:t.apply})}this.blendMode=function(t){if("normal"===t)return r.BLEND_MODES.NORMAL;if("screen"===t)return r.BLEND_MODES.SCREEN;throw new Error("Invalid blend mode: "+t)}(e.attr("blend")||"normal"),this.ref=e.attr("ref")||null}instantiate(t,e){var n=e.object,r=[],i=null;n.blendMode=this.blendMode;for(var a=0;a<this._bindings.length;a++){var s=this._bindings[a];r.push([s.getter,s.apply.bind(null,n)])}return this.ref&&(t.ref(this.ref,n),i=()=>t.unref(this.ref,n)),new _({bindings:r,onDestroy:i})}};function x(t){let e=t.match(/^(\d+)x(\d+)\+(\d+)\+(\d+)$/);return e?new r.Rectangle(+e[3],+e[4],+e[1],+e[2]):null}class y{constructor(t){this._frame=t}instantiate(t,e){let n=new r.Graphics;return n.beginFill(),n.drawShape(this._frame),n.endFill(),e.object.mask=n,new _({context:t,object:n,parent:e.object})}}var b=class extends f{compile(t,e){this.children=t.compileChildren(e),this.display=w.compile(t,e);let n=x(e.attr("mask")||"");n&&(this.mask=new y(n))}instantiate(t,e){let n=new r.Container,i=[this.display];return this.mask&&i.push(this.mask),new _({context:t,object:n,parent:e,concerns:i,children:this.children})}};var A=class extends f{compile(t,e){let n=t.compileChildren(e);if(1!==n.length)throw new Error("Expected exactly 1 children, "+n.length+" found");this.child=n[0],this.key=new m.a(e.attr("key")),this.value=String(e.attr("value"))}instantiate(t,e){let n=new r.Container,i=this.key,a=this.value,s=this.child,o=null;return new _({context:t,parent:e,object:n,onData:e=>{String(i(e))===a?(null===o&&(o=s.instantiate(t,n)),o.push(e)):null!==o&&(o.destroy(),o=null)}})}};function E(t,e,n){return{instantiate(r,i){let a=new Map,s=[];return function(){for(var t,a=0;a<n;a++)(t=e.instantiate(r,i.object)).detach(),s.push(t)}(),new _({context:r,onData:e=>{!function(t){var e,n,r,i=new Set(a.keys());t||(t=[]);for(var c=0;c<t.length;c++)n=t[c],e=n.key,a.has(e)?r=a.get(e):(r=o(),a.set(e,r)),r.push(n),i.delete(e);for(e of i)(r=a.get(e)).detach(),a.delete(e),s.push(r)}(t(e))}});function o(){var t=s.pop();return t?t.attachTo(i.object):t=e.instantiate(r,i.object),t}}}}var C=class extends f{compile(t,e){if(this.children=t.compileChildren(e),1!==this.children.length)throw new Error("Expected exactly 1 children, "+this.children.length+" given");this.pool=+e.attr("pool")||1,this.key=new m.a(e.attr("key"))}instantiate(t,e){let n=new r.particles.ParticleContainer(void 0,{position:!0,alpha:!0}),i=new E(this.key,this.children[0],this.pool);return new _({context:t,parent:e,object:n,concerns:[i]})}};var k=class extends f{compile(t,e){this.children=t.compileChildren(e),this.width=+e.attr("width"),this.height=+e.attr("height"),this.data=e.data()}instantiate(t){let e=new r.Stage(591879);return new _({context:t,object:e,children:this.children})}};var D=class extends f{compile(t,e){this.url=t.resources.get(e.attr("image")),this.display=w.compile(t,e),this.frame=x(e.attr("frame")||""),this.anchorX=+e.attr("anchor-x")||0,this.anchorY=+e.attr("anchor-y")||0}instantiate(t,e){let n=new r.Sprite(this.getTexture());return n.anchor.x=this.anchorX,n.anchor.y=this.anchorY,new _({context:t,object:n,parent:e,concerns:[this.display]})}getTexture(){if(this._texture)return this._texture;let t=r.SCALE_MODES.NEAREST,e=r.BaseTexture.fromImage(this.url,void 0,t),n=new r.Texture(e,this.frame);return this._texture=n,n}};var j=class extends f{compile(t,e){this.font=e.attr("font"),this.text=e.attr("text"),this.data=new m.a(e.attr("data")||"0"),this.display=w.compile(t,e),this.ttf=!e.attr("font-src"),this.fill=e.attr("fill"),this.align="left"===e.attr("align")?0:"right"===e.attr("align")?1:.5}instantiate(t,e){let n;n=this.ttf?new r.Text(this.text,{font:this.font,fill:this.fill}):new r.extras.BitmapText(this.text,{font:this.font});let i=new r.Container;return i.addChild(n),new _({context:t,parent:e,object:i,concerns:[this.display],bindings:[[this.data,t=>{n.text=this.text.replace("%s",t),n.updateText(),n.x=n.width*-this.align}]]})}};const M=l()("scintillator:compiler");let L={skin:k,sprite:D,group:b,object:C,text:j,if:A};class O{constructor(t){Object.assign(this,t),this._defs=new Map}compile(t){let e=t[0].nodeName;M("compiling",t[0]);let n=O.getNodeClass(e);if(!n)throw new Error("Invalid node name: "+e);return n.compile(this,t)}compileChildren(t){let e=[];for(let n of Array.from(t.children())){let t=n.nodeName;if("defs"===t)this.compileDefs(o()(n));else if("use"===t)e.push(this.getDef(n.getAttribute("def")));else{O.getNodeClass(t)&&e.push(this.compile(o()(n)))}}return e}compileDefs(t){for(let e of Array.from(t.children())){let t=e.getAttribute("id");if(!t)throw new Error("A def should have an id: "+e.nodeName);this._defs.set(t,this.compile(o()(e)))}}getDef(t){let e=this._defs.get(t);if(!e)throw new Error("Cannot find def: "+t);return e}static getNodeClass(t){return L[t]}}var T=O,P=n(32),S=n.n(P);var R=class{constructor(){this._map={}}add(t,e){this._map[t]=e}get(t){if(!(t in this._map))throw new Error("Not registered: "+t);return this._map[t]}get urls(){return S.a.values(this._map)}},N=function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{c(r.next(t))}catch(t){a(t)}}function o(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}c((r=r.apply(t,e||[])).next())}))};const B=l()("scintillator:loader");function I(t,e){return N(this,void 0,void 0,(function*(){B("load XML from %s",t);let n=yield(i=t,Promise.resolve(o.a.ajax({url:i,dataType:"xml"})).then(t=>o()(t.documentElement)));var i;let a=new R,s=new Set;for(let t of Array.from(n.find("[image]")))s.add(o()(t).attr("image"));for(let t of Array.from(n.find("[font-src]")))s.add(o()(t).attr("font-src"));for(let e of s){let n=u.a.resolve(t,e);a.add(e,n)}return yield function(t,e){return B("loading resources"),new Promise((function(n){if(0===t.urls.length)return n();let i=new r.loaders.Loader;for(let e of t.urls)i.add(e,e);i.once("complete",(function(){B("resources finished loading"),n()})),e&&(e.formatter=d.c,i.once("complete",(function(){e.report(100,100)})),i.on("progress",(function(){e.report(i.progress,100)}))),i.load()}))}(a,e),B("compiling"),new T({resources:a}).compile(n)}))}function F({displayMode:t}={}){return"touch3d"===t?"/skins/default/skin_touch3d.xml":window.innerWidth<window.innerHeight?"/skins/default/skin_touch.xml":"/skins/default/skin_screen.xml"}}}]);
//# sourceMappingURL=gameEngine-023d608094d487cfce41.js.map