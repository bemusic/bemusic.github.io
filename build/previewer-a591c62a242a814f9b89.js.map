{"version":3,"sources":["file:///home/runner/work/bemuse/bemuse/bemuse/src/ui/Panel.jsx","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/util/match.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/bms/headers.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/bms/objects.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/time-signatures/index.js","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/BarDot.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/BarDot.scss?e2e6","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/BarDot.scss","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui-dialogs/index.scss?c7ed","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui-dialogs/index.scss","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui/Button.scss?cce1","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui/Button.scss","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui-dialogs/ComboBox.scss?1f38","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui-dialogs/ComboBox.scss","file:///home/runner/work/bemuse/bemuse/bemuse/src/audio-context/index.js","file:///home/runner/work/bemuse/bemuse/bemuse/src/sampling-master/index.js","file:///home/runner/work/bemuse/bemuse/bemuse/src/sampling-master/ogg.ts","file:///home/runner/work/bemuse/bemuse/packages/bemuse-notechart/lib/index.js","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/BemusePreviewer.scss?f16c","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/BemusePreviewer.scss","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/PreviewInfo.scss?f944","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/PreviewInfo.scss","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/PreviewCanvas.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/PreviewInfo.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/PreviewFileDropHandler.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/NotechartPreview.ts","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/PreviewLoader.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/PreviewState.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/PreviewKeyHandler.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/utils/useLatest.ts","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/BemusePreviewer.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/previewer/index.tsx","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/reader/index.web.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/reader/getReaderOptionsFromFilename.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/compiler/index.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/reader/types.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/speedcore/segment.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/notes/index.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/notes/note.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/notes/channels.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/timing/index.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/song-info/index.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/keysounds/index.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/positioning/index.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/spacing/index.js","file:///home/runner/work/bemuse/bemuse/packages/bemuse-notechart/lib/loader/BMSNotechartLoader.js","file:///home/runner/work/bemuse/bemuse/packages/bemuse-notechart/lib/types.js","file:///home/runner/work/bemuse/bemuse/packages/bmson/lib/legacy.js","file:///home/runner/work/bemuse/bemuse/packages/bmson/lib/utils.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/bms/chart.js","file:///home/runner/work/bemuse/bemuse/bemuse/src/utils/warp-element.ts","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui/Button.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui/VBox.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui-dialogs/ComboBox.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui-dialogs/index.tsx","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui/Panel.scss?c53d","file:///home/runner/work/bemuse/bemuse/bemuse/src/ui/Panel.scss","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/speedcore/index.js","file:///home/runner/work/bemuse/bemuse/packages/bemuse-notechart/lib/loader/index.js","file:///home/runner/work/bemuse/bemuse/packages/bemuse-notechart/lib/loader/BmsonNotechartLoader.js","file:///home/runner/work/bemuse/bemuse/packages/bmson/lib/index.js","file:///home/runner/work/bemuse/bemuse/packages/bmson/lib/types.js","file:///home/runner/work/bemuse/bemuse/bemuse/src/utils/read-blob.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/util/lodash.js","file:///home/runner/work/bemuse/bemuse/packages/bms/lib/index.js","file:///home/runner/work/bemuse/bemuse/bemuse/src/utils/main-element.js"],"names":["Panel","Component","render","className","this","props","title","children","propTypes","string","node","Object","defineProperty","exports","value","match","text","matched","when","pattern","callback","else","BMSHeaders","_data","_dataAll","prototype","each","i","get","name","toLowerCase","getAll","set","key","push","BMSObjects","_objects","add","object","channel","length","test","measure","fraction","all","slice","allSorted","list","sort","a","b","TimeSignatures","_values","getBeats","measureToBeat","sum","BarDot","width","height","viewBox","fill","d","describeArc","cx","cy","r","polarToCartesian","centerX","centerY","radius","angleInDegrees","angleInRadians","Math","PI","x","cos","y","sin","startAngle","endAngle","start","end","largeArcFlag","join","content","module","options","transform","undefined","locals","AudioContext","latencyHint","FADE_LENGTH","dummyAudioTag","document","createElement","needsVorbisDecoder","canPlayType","SoundGroup","constructor","samplingMaster","volume","_master","_gain","audioContext","createGain","gain","connect","destination","destroy","disconnect","Sample","audioBuffer","_buffer","play","delay","PlayInstance","duration","buffer","context","source","createBufferSource","onended","stop","group","_source","TEST_node","startTime","max","currentTime","startOffset","fadeIn","fadeOutAt","setValueAtTime","linearRampToValueAtTime","_startPlaying","_stoppedPlaying","onstop","bad","playbackRate","random","pow","unmuteAudio","ctx","osc","createOscillator","frequency","async","resume","resumeContext","catch","e","console","error","_audioContext","_samples","_groups","_instances","Set","_destination","unmute","_destroyed","sample","instance","decode","blobOrArrayBuffer","_coerceToArrayBuffer","then","arrayBuffer","_decodeAudio","blobOrArrayBufferOrAudioBuffer","numberOfChannels","Promise","resolve","Error","ArrayBuffer","as","reject","byteLength","view","Uint8Array","decodeAudioData","delete","decoderPromise","limit","decodeOGG","stbvorbis","ns","default","src","eval","buffers","sampleRate","totalLength","data","eof","decodedChunks","createBuffer","channels","Array","map","_","ch","ChannelDataWriter","getChannelData","chunk","forEach","audioSamples","channelIndex","write","doDecodeOGG","offset","__createBinding","create","o","m","k","k2","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","__exportStar","p","hasOwnProperty","call","__values","s","Symbol","iterator","next","done","TypeError","__importDefault","mod","Notechart","lodash_1","invariant_1","playerOptions","_this","bmsNotes","notes","timing","keysounds","songInfo","positioning","spacing","barLines","images","expertJudgmentWindow","_a","landmineNotes","_preTransform","_timing","_positioning","_spacing","_keysounds","_duration","_notes","_generatePlayableNotesFromBMS","_landmines","_autos","_generateAutoKeysoundEventsFromBMS","_barLines","_generateBarLineEvents","_generateKeysoundFiles","_infos","Map","note","_getNoteInfo","_songInfo","_images","eyecatch","background","info","beatToSeconds","beat","beatToPosition","position","secondsToBeat","seconds","secondsToPosition","bpmAtBeat","scrollSpeedAtBeat","speed","spacingAtBeat","factor","getKeyMode","scratch","e_1","usedColumns","_b","_c","column","e_1_1","return","chain","keys","e_4","bmsNotes_1","bmsNotes_1_1","e_4_1","getKeys","assign","columnsToShift_1","shiftNote","amount","index","indexOf","newIndex","newColumn","nextId","filter","spec","_generateEvent","id","keysound","keysoundStart","keysoundEnd","_updateDuration","endBeat","_generateLandminesFromBMS","event","time","e_2","e_3","autos","_d","array","array_1","array_1_1","event_","file","e_3_1","e_2_1","from","beats","combos","sprites","highlight","keymap","nextX","noteColumn","sprite","columns","split","c","endsWith","totalWidth","columnMapping","fromPairs","PreviewCanvas","notesImage","useImage","landmineImage","canvasRef","useRef","layout","viewport","notechartPreview","getViewport","previewState","hiSpeed","maxCombo","getMaxCombo","comboInfo","getComboInfo","current","getContext","fillStyle","fillRect","textAlign","font","barLine","visibleBarLines","round","fillText","measureNumber","visibleNotes","gameEvent","long","endY","spriteYOffset","active","drawImage","noteHeight","image","type","deltaTime","comboTime","opacity","comboCount","ref","style","imageRendering","setImage","useState","img","Image","onload","preview","measureInfo","getMeasureInfo","bpm","getCurrentBpm","scroll","getCurrentScroll","getCurrentSpeed","format","n","toFixed","formatTime","toString","padStart","keyHints","description","scope","colSpan","BarDots","measureEndBeat","measureSize","measureStartBeat","dotCount","dotSize","dots","filledDots","ceil","currentBeat","PreviewFileDropHandler","onDragOver","preventDefault","onDrop","items","dataTransfer","alert","item","kind","handleNullable","getAsFileSystemHandle","handle","requestPermission","mode","chartFiles","entries","filename","label","selectedChartFile","window","addEventListener","removeEventListener","createNullNotechartPreview","location","hostname","delegate","setTimeout","onFinish","measureToSeconds","getMeasureJumpTarget","_notechart","_filename","_samplingMaster","_soundGroup","_sortedGameNotes","sortBy","_sortedGameLandmines","landmines","_sortedSoundEvents","_comboPreviewer","_secondsToBeat","windowSize","insideView","gameNote","visibleNote","gameLandmine","delta","currentMeasure","currentMeasureStart","direction","closestBarLine","minBy","abs","target","_secondsToBeatCache","log","player","BemuseNotechartPreviewPlayer","_delegate","_cursor","_sampleMap","_startAudioTime","_startSongTime","_stopped","_playingSamples","frame","_advance","requestAnimationFrame","nextEvent","_choke","onTimeUpdate","playing","values","clear","_events","flatMap","identity","sortedLastIndex","PREVIEWER_FS_HANDLE_KEYVAL_KEY","getSamplingMaster","once","keysoundCache","keysoundCacheHandleId","loadPreview","loadOptions","message","directoryHandle","directory","handleId","permission","queryPermission","ensureReadable","chartHandles","fileHandle","chartHandle","find","chartFilename","notechartLoader","getFile","notechart","load","double","numLoadedSamples","samples","has","getFileHandle","replace","progress","concurrency","soundGroup","createNotechartPreview","previewStateReducer","state","action","nextState","loaded","speedUp","min","speedDown","pause","playPause","playFinish","home","updateTime","jumpToTime","jumpByMeasure","jumpBySeconds","rememberedMeasureNumber","PreviewKeyHandler","getLatestNotechartPreview","useLatest","onKeyDown","dispatch","prompt","isNaN","ctrlKey","metaKey","onReload","div","setNotechartPreview","loading","setLoading","reload","setLoadingDebounced","throttle","focus","String","finally","playerRef","t","usePreviewPlayer","savedPreviewInfo","getSavedPreviewInfo","choices","tabIndex","href","rel","selectedChartFilename","generate","setPreview","main","getReaderOptionsFromFilename","readAsync","read","chardet","args","_i","arguments","charset","forceEncoding","detect","reader","FileReader","result","onerror","readAsText","Blob","getReaderOptionsFromFilename_1","compile","match_1","chart_1","matchers","bms","if","endif","timeSignature","header","dtx","chart","BMSChart","rng","floor","matcher","randomStack","skipStack","headerSentences","channelSentences","controlSentences","skippedSentences","malformedSentences","warnings","line","trim","eachLine","lineNumber","flow","charAt","pop","skipped","timeSignatures","substr","objects","handleChannelSentence","headers","warn","Segment","data_structure_1","dx","__setModuleDefault","v","__importStar","Notes","note_1","ChannelMapping","Note","count","fromBMSChart","mapping","CHANNEL_MAPPING","IIDX_P1","BMSNoteBuilder","build","_chart","_mapping","_activeLN","_lastNote","_lnObj","_channelMapping","_handle","_handleNormalNote","toUpperCase","_handleLongNote","_normalizeChannel","_getBeat","_getColumn","maybe","IIDX_DP_LANDMINE","IIDX_P1_LANDMINE","IIDX_DP","D1","D2","D3","D4","D5","D8","D9","D6","E1","E2","E3","E4","E5","E8","E9","E6","Timing","speedcore_1","precedence","initialBPM","actions","segments","inclusive","stopBeats","_speedcore","Speedcore","_eventBeats","uniq","segmentAtX","getEventBeats","parseInt","SongInfo","artist","genre","subtitles","subartists","difficulty","level","extractSubtitle","Keysounds","_map","files","Positioning","previous","Spacing","unshift","BMS","__1","getJudgmentWindowFromBMS","rank","generateBarLinesFromBMS","__read","ar","__spreadArray","to","pack","l","concat","_slicesForNotesAndTiming","beatForLoc","timingInfoForBmson","barLinesForBmson","utils","bmson","lines","initBPM","bpmNotes","stopNotes","slicesForNotesAndTiming","beatForPulse","restart","notes_1","notes_1_1","lastAdded","soundTime","mustAdd","_e","obj","headers_1","objects_1","time_signatures_1","querySelector","onClick","padding","gap","display","flexDirection","inputItems","setInputItems","isOpen","getLabelProps","getMenuProps","getInputProps","getComboboxProps","highlightedIndex","getItemProps","setHighlightedIndex","initialHighlightedIndex","onInputValueChange","inputValue","results","go","onHighlightedIndexChange","onSelectedItemChange","selectedItem","stateChangeTypes","InputKeyDownEnter","ItemClick","onSelect","itemToString","hidden","showAlert","registerActiveModal","container","appendChild","popup","open","asChild","removeChild","unmountComponentAtNode","showQuickPick","activeModals","promise","isModalActive","size","segment_1","_segments","_reached","targetFn","segment","_segmentAt","X","segmentAtT","T","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","rejected","apply","__generator","body","f","g","sent","trys","ops","verb","op","NotechartLoader","BMSNotechartLoader","BmsonNotechartLoader","coerceToBuffer","bufferOrArrayBuffer","Buffer","isBuffer","arraybuffer","resource","loadBmson","loadBMS","readerOptions","compileResult","Reader","Compiler","getExpertJudgmentWindowForBmson","judgeRank","judge_rank","JSON","parse","songInfoForBmson","score","musicalScoreForBmson","stuff","eyecatch_image","back_image","keysForBmson","hasScratch","beatForPulseForBmson","legacy","version","init_bpm","bpm_events","stop_events","soundChannelsForBmson","sound_channels","soundChannel","bmsonInfo","chart_name","subtitle","getSubtitles","timingForBmson","nextKeysoundNumber","soundChannels","soundChannels_1","soundChannels_1_1","name_1","soundChannelNotes","sortedNotes","keysoundNumber","keysoundId","slices","sortedNotes_1","sortedNotes_1_1","getColumn","notesDataAndKeysoundsDataForBmsonAndTiming","legacy_1","resolution","soundChannels_2","soundChannels_2_1","e_5","e_6","hasKeys","hasSecondPlayer","hasDeluxeKeys","soundChannels_3","soundChannels_3_1","notes_2","notes_2_1","e_6_1","e_5_1","blob","readAsArrayBuffer","lodash_uniq_1","lodash_map_1","lodash_values_1","lodash_assign_1"],"mappings":"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","file":"build/previewer-a591c62a242a814f9b89.js","sourcesContent":["import './Panel.scss'\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport c from 'classnames'\n\nexport default class Panel extends React.Component {\n  static propTypes = {\n    className: PropTypes.string,\n    title: PropTypes.string,\n    children: PropTypes.node,\n  }\n\n  render() {\n    return (\n      <div className={c('Panel', this.props.className)}>\n        <div className='Paneltitle'>{this.props.title}</div>\n        <div className='Panelcontent'>{this.props.children}</div>\n      </div>\n    )\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.match = void 0;\nfunction match(text) {\n    var matched = false;\n    return {\n        when: function (pattern, callback) {\n            if (matched)\n                return this;\n            var match = text.match(pattern);\n            if (match) {\n                matched = true;\n                callback(match);\n            }\n            return this;\n        },\n        else: function (callback) {\n            if (matched)\n                return this;\n            callback();\n        },\n    };\n}\nexports.match = match;\n//# sourceMappingURL=match.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BMSHeaders = void 0;\n/**\n * A BMSHeader holds the header information in a BMS file, such as\n * `#TITLE`, `#ARTIST`, or `#BPM`.\n *\n * You get retrieve a header using the `get()` method:\n *\n * ```js\n * chart.headers.get('title')\n * ```\n *\n * For some header fields that may contain multiple values, such as `#SUBTITLE`,\n * you can get them all using `getAll()`:\n *\n * ```js\n * chart.headers.getAll()\n * ```\n */\nvar BMSHeaders = /** @class */ (function () {\n    function BMSHeaders() {\n        this._data = {};\n        this._dataAll = {};\n    }\n    /**\n     * Iterates through each header field using a callback function.\n     * @param callback will be called for each header field\n     */\n    BMSHeaders.prototype.each = function (callback) {\n        for (var i in this._data) {\n            callback(i, this._data[i]);\n        }\n    };\n    /**\n     * Retrieves the header fields latest value.\n     * @param name fields name\n     * @return the fields latest value\n     */\n    BMSHeaders.prototype.get = function (name) {\n        return this._data[name.toLowerCase()];\n    };\n    /**\n     * Retrieves the header fields values.\n     * This is useful when a header field is specified multiple times.\n     * @param name fields name\n     */\n    BMSHeaders.prototype.getAll = function (name) {\n        return this._dataAll[name.toLowerCase()];\n    };\n    /**\n     * Sets the header fields value.\n     * @param name fields name\n     * @param value fields value\n     */\n    BMSHeaders.prototype.set = function (name, value) {\n        var key = name.toLowerCase();\n        this._data[key] = value;\n        (this._dataAll[key] || (this._dataAll[key] = [])).push(value);\n    };\n    return BMSHeaders;\n}());\nexports.BMSHeaders = BMSHeaders;\n//# sourceMappingURL=headers.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BMSObjects = void 0;\n/**\n * BMSObjects holds a collection of objects inside a BMS notechart.\n */\nvar BMSObjects = /** @class */ (function () {\n    function BMSObjects() {\n        this._objects = [];\n    }\n    /**\n     * Adds a new object to this collection.\n     * If an object already exists on the same channel and position,\n     * the object is replaced (except for autokeysound tracks).\n     * @param object the object to add\n     */\n    BMSObjects.prototype.add = function (object) {\n        if (object.channel !== '01') {\n            for (var i = 0; i < this._objects.length; i++) {\n                var test = this._objects[i];\n                if (test.channel === object.channel &&\n                    test.measure === object.measure &&\n                    test.fraction === object.fraction) {\n                    this._objects[i] = object;\n                    return;\n                }\n            }\n        }\n        this._objects.push(object);\n    };\n    /**\n     * Returns an array of all objects.\n     */\n    BMSObjects.prototype.all = function () {\n        return this._objects.slice();\n    };\n    /**\n     * Returns a sorted array of all objects.\n     */\n    BMSObjects.prototype.allSorted = function () {\n        var list = this.all();\n        list.sort(function (a, b) {\n            return a.measure + a.fraction - (b.measure + b.fraction);\n        });\n        return list;\n    };\n    return BMSObjects;\n}());\nexports.BMSObjects = BMSObjects;\n//# sourceMappingURL=objects.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TimeSignatures = void 0;\n/**\n * A TimeSignatures is a collection of time signature values\n * index by measure number.\n *\n * The measure number starts from 0.\n * By default, each measure has a measure size of 1\n * (which represents the common 4/4 time signature)\n *\n * ## Example\n *\n * If you have a BMS like this:\n *\n * ```\n * #00102:0.75\n * #00103:1.25\n * ```\n *\n * Having parsed it using a {Compiler} into a {BMSChart},\n * you can access the {TimeSignatures} object:\n *\n * ```js\n * var timeSignatures = bmsChart.timeSignatures\n * ```\n *\n * Note that you can also use the constructor\n * to create a {TimeSignatures} from scratch.\n *\n * One of the most useful use case of this class\n * is to convert the measure and fraction into beat number.\n *\n * ```js\n * timeSignatures.measureToBeat(0, 0.000) // =>  0.0\n * timeSignatures.measureToBeat(0, 0.500) // =>  2.0\n * timeSignatures.measureToBeat(1, 0.000) // =>  4.0\n * timeSignatures.measureToBeat(1, 0.500) // =>  5.5\n * timeSignatures.measureToBeat(2, 0.000) // =>  7.0\n * timeSignatures.measureToBeat(2, 0.500) // =>  9.5\n * timeSignatures.measureToBeat(3, 0.000) // => 12.0\n * ```\n */\nvar TimeSignatures = /** @class */ (function () {\n    function TimeSignatures() {\n        this._values = {};\n    }\n    /**\n     * Sets the size of a specified measure.\n     * @param measure the measure number, starting from 0\n     * @param value the measure size.\n     *  For example, a size of 1.0 represents a common 4/4 time signature,\n     *  whereas a size of 0.75 represents the 3/4 or 6/8 time signature.\n     */\n    TimeSignatures.prototype.set = function (measure, value) {\n        this._values[measure] = value;\n    };\n    /**\n     * Retrieves the size of a specified measure.\n     * @param measure representing the measure number.\n     * @returns the size of the measure.\n     *  By default, a measure has a size of 1.\n     */\n    TimeSignatures.prototype.get = function (measure) {\n        return this._values[measure] || 1;\n    };\n    /**\n     * Retrieves the number of beats in a specified measure.\n     *\n     * Since one beat is equivalent to a quarter note in 4/4 time signature,\n     * this is equivalent to `(timeSignatures.get(measure) * 4)`.\n     * @param measure representing the measure number.\n     * @returns the size of the measure in beats.\n     */\n    TimeSignatures.prototype.getBeats = function (measure) {\n        return this.get(measure) * 4;\n    };\n    /**\n     * Converts a measure number and a fraction inside that measure\n     * into the beat number.\n     *\n     * @param measure the measure number.\n     * @param fraction the fraction of a measure,\n     * @returns the number of beats since measure 0.\n     */\n    TimeSignatures.prototype.measureToBeat = function (measure, fraction) {\n        var sum = 0;\n        for (var i = 0; i < measure; i++)\n            sum += this.getBeats(i);\n        return sum + this.getBeats(measure) * fraction;\n    };\n    return TimeSignatures;\n}());\nexports.TimeSignatures = TimeSignatures;\n//# sourceMappingURL=index.js.map","import './BarDot.scss'\nimport React from 'react'\n\nexport interface BarDot {\n  fraction: number\n  fill: string\n}\n\nexport const BarDot: FC<BarDot> = (props) => (\n  <svg width={32} height={32} viewBox='0 0 32 32' className='BarDot'>\n    {props.fraction > 0 ? (\n      props.fraction < 0.99 ? (\n        <path\n          fill={props.fill}\n          d={describeArc(16, 16, 16, 0, props.fraction * 360)}\n        />\n      ) : (\n        <circle cx={16} cy={16} r={16} fill={props.fill} />\n      )\n    ) : null}\n  </svg>\n)\n\n// Yoinked from StackOverflow: https://stackoverflow.com/a/18473154/559913\nfunction polarToCartesian(\n  centerX: number,\n  centerY: number,\n  radius: number,\n  angleInDegrees: number\n) {\n  const angleInRadians = ((angleInDegrees - 90) * Math.PI) / 180.0\n\n  return {\n    x: centerX + radius * Math.cos(angleInRadians),\n    y: centerY + radius * Math.sin(angleInRadians),\n  }\n}\n\n// Yoinked from StackOverflow: https://stackoverflow.com/a/18473154/559913\nfunction describeArc(\n  x: number,\n  y: number,\n  radius: number,\n  startAngle: number,\n  endAngle: number\n) {\n  const start = polarToCartesian(x, y, radius, endAngle)\n  const end = polarToCartesian(x, y, radius, startAngle)\n\n  const largeArcFlag = endAngle - startAngle <= 180 ? '0' : '1'\n\n  const d = [\n    'M',\n    start.x,\n    start.y,\n    'A',\n    radius,\n    radius,\n    0,\n    largeArcFlag,\n    0,\n    end.x,\n    end.y,\n    'L',\n    x,\n    y,\n  ].join(' ')\n\n  return d\n}\n","\nvar content = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./BarDot.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./BarDot.scss\", function() {\n\t\tvar newContent = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./BarDot.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".BarDot {\\n  width: 0.64em;\\n  height: 0.64em;\\n  vertical-align: middle;\\n  margin-right: 0.25em;\\n}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@charset \\\"UTF-8\\\";\\n.AlertDialogoverlay {\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  background: rgba(17, 17, 17, 0.5);\\n  overflow: hidden;\\n  z-index: 10000;\\n}\\n.AlertDialogcontent {\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  overflow: auto;\\n  -webkit-overflow-scrolling: touch;\\n  z-index: 10001;\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  justify-content: center;\\n}\\n.AlertDialogcontent > * {\\n  flex: none;\\n}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./Button.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./Button.scss\", function() {\n\t\tvar newContent = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./Button.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".Button {\\n  font: inherit;\\n  background: #252423 linear-gradient(to bottom, #454443, #151413);\\n  border: 1px solid #555453;\\n  padding: 0.5ex 1.3ex;\\n  color: #fff;\\n  border-radius: 4px;\\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);\\n}\\n.Button:hover {\\n  border-color: #656463;\\n}\\n.Button:focus {\\n  border-color: #8b8685;\\n  outline: 0;\\n}\\n.Button:active {\\n  background: #252423 linear-gradient(to top, #353433, #151413);\\n  border-color: #454443;\\n}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./ComboBox.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./ComboBox.scss\", function() {\n\t\tvar newContent = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./ComboBox.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@charset \\\"UTF-8\\\";\\n.ComboBox {\\n  width: 24em;\\n  max-width: 80vw;\\n}\\n.ComboBoxinput {\\n  font: inherit;\\n  background: #252423 linear-gradient(to bottom, #151413, #292827);\\n  border: 1px solid #555453;\\n  padding: 0.5ex 1.3ex;\\n  color: #fff;\\n  border-radius: 4px;\\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);\\n  width: 100%;\\n  box-sizing: border-box;\\n}\\n.ComboBoxinput:hover {\\n  border-color: #656463;\\n}\\n.ComboBoxinput:focus {\\n  border-color: #8b8685;\\n  outline: 0;\\n}\\n.ComboBoxinput:active {\\n  border-color: #454443;\\n}\\n.ComboBoxinput::selection {\\n  background: #8b8685;\\n  color: #8e8;\\n}\\n.ComboBoxmenu {\\n  list-style: none;\\n  margin: 0;\\n  padding: 0;\\n  overflow: auto;\\n  -webkit-overflow-scrolling: touch;\\n  height: 8em;\\n  margin-top: 0.5em;\\n  background: #252423;\\n  border: 1px solid #555453;\\n  border-radius: 4px;\\n}\\n.ComboBoxmenu > li[data-highlighted=true] {\\n  background-color: #8b8685;\\n  color: #fff;\\n}\\n.ComboBoxmenu > li {\\n  padding: 0.5ex 1.3ex;\\n}\", \"\"]);\n\n// exports\n","export default new AudioContext({\n  latencyHint: 'interactive',\n})\n","import defaultAudioContext from 'bemuse/audio-context'\nimport readBlob from 'bemuse/utils/read-blob'\nimport { decodeOGG } from './ogg'\n\nexport const FADE_LENGTH = 0.001\n\nconst dummyAudioTag = document.createElement('audio')\n// Checks whether an audio format is supported.\nexport function canPlay(type) {\n  // We have a Vorbis audio decoder!\n  if (type === 'audio/ogg; codecs=\"vorbis\"') return true\n  return dummyAudioTag.canPlayType(type) === 'probably'\n}\n\nconst needsVorbisDecoder = !dummyAudioTag.canPlayType(\n  'audio/ogg; codecs=\"vorbis\"'\n)\n\n// The sampling master is a wrapper class around Web Audio API\n// that takes care of:\n//\n// - Decoding audio from an ArrayBuffer or Blob (resulting in a \"Sample\").\n// - Playing the `Sample` and managing its lifecycle.\nexport class SamplingMaster {\n  constructor(audioContext) {\n    this._audioContext = audioContext || defaultAudioContext\n    this._samples = []\n    this._groups = []\n    this._instances = new Set()\n    this._destination = this._audioContext.destination\n  }\n\n  // Connects a dummy node to the audio, thereby unmuting the audio system on\n  // iOS devices (which keeps the audio muted until a user interacts with the\n  // page).\n  unmute() {\n    unmuteAudio(this._audioContext)\n  }\n\n  // The underlying AudioContext.\n  get audioContext() {\n    return this._audioContext\n  }\n\n  // The audio destination.\n  get destination() {\n    return this._destination\n  }\n\n  // The current time\n  // See: https://webaudio.github.io/web-audio-api/#dom-baseaudiocontext-currenttime\n  get currentTime() {\n    return this._audioContext.currentTime\n  }\n\n  // Destroys this SamplingMaster, make it unusable.\n  destroy() {\n    if (this._destroyed) return\n    this._destroyed = true\n    for (const sample of this._samples) sample.destroy()\n    for (const instance of this._instances) instance.destroy()\n    this._samples = null\n    this._instances = null\n  }\n\n  // Decodes the audio data from a Blob or an ArrayBuffer.\n  // Returns an AudioBuffer which can be re-used in other sampling masters.\n  decode(blobOrArrayBuffer) {\n    return this._coerceToArrayBuffer(blobOrArrayBuffer).then((arrayBuffer) =>\n      this._decodeAudio(arrayBuffer)\n    )\n  }\n\n  // Creates a `Sample` from a Blob or an ArrayBuffer or an AudioBuffer.\n  sample(blobOrArrayBufferOrAudioBuffer) {\n    const audioBufferPromise = (() => {\n      if (blobOrArrayBufferOrAudioBuffer.numberOfChannels) {\n        return Promise.resolve(blobOrArrayBufferOrAudioBuffer)\n      } else {\n        return this.decode(blobOrArrayBufferOrAudioBuffer)\n      }\n    })()\n    return audioBufferPromise.then((audioBuffer) => {\n      if (this._destroyed) throw new Error('SamplingMaster already destroyed!')\n      const sample = new Sample(this, audioBuffer)\n      this._samples.push(sample)\n      return sample\n    })\n  }\n\n  group(options) {\n    const group = new SoundGroup(this, options)\n    this._groups.push(group)\n    return group\n  }\n\n  _coerceToArrayBuffer(blobOrArrayBuffer) {\n    if (blobOrArrayBuffer instanceof ArrayBuffer) {\n      return Promise.resolve(blobOrArrayBuffer)\n    } else {\n      return readBlob(blobOrArrayBuffer).as('arraybuffer')\n    }\n  }\n\n  _decodeAudio(arrayBuffer) {\n    return new Promise((resolve, reject) => {\n      if (needsVorbisDecoder && arrayBuffer.byteLength > 4) {\n        const view = new Uint8Array(arrayBuffer, 0, 4)\n        if (\n          view[0] === 0x4f &&\n          view[1] === 0x67 &&\n          view[2] === 0x67 &&\n          view[3] === 0x53\n        ) {\n          return resolve(decodeOGG(this.audioContext, arrayBuffer))\n        }\n      }\n      this.audioContext.decodeAudioData(\n        arrayBuffer,\n        function decodeAudioDataSuccess(audioBuffer) {\n          resolve(audioBuffer)\n        },\n        function decodeAudioDataFailure(e) {\n          reject(new Error('Unable to decode audio: ' + e))\n        }\n      )\n    })\n  }\n\n  _startPlaying(instance) {\n    this._instances.add(instance)\n  }\n\n  _stoppedPlaying(instance) {\n    this._instances.delete(instance)\n  }\n}\n\n// Sound group\nexport class SoundGroup {\n  constructor(samplingMaster, { volume } = {}) {\n    this._master = samplingMaster\n    this._gain = this._master.audioContext.createGain()\n    if (volume != null) this._gain.gain.value = volume\n    this._gain.connect(this._master.destination)\n  }\n\n  get destination() {\n    return this._gain\n  }\n\n  destroy() {\n    this._gain.disconnect()\n    this._gain = null\n  }\n}\n\n// The Sample is created by and belongs to the `SamplingMaster`.\n//\n// You don't invoke this constructor directly; it is invoked by\n// `SamplingMaster#create`.\nexport class Sample {\n  constructor(samplingMaster, /** @type {AudioBuffer} */ audioBuffer) {\n    this._master = samplingMaster\n    this._buffer = audioBuffer\n  }\n\n  // Plays the sample and returns the new PlayInstance.\n  play(delay, options) {\n    return new PlayInstance(this._master, this._buffer, delay, options)\n  }\n\n  // Destroys this sample, thereby making it unusable.\n  destroy() {\n    this._master = null\n    this._buffer = null\n  }\n\n  get duration() {\n    return this._buffer.duration\n  }\n}\n\n// When a `Sample` is played, a PlayInstance is created.\n// A PlayInstance may not be reused; after the sound finishes playing,\n// you have to invoke `Sample#play` again.\n//\n// You don't invoke this constructor directly; it is invoked by `Sample#play`.\nexport class PlayInstance {\n  constructor(samplingMaster, buffer, delay, options = {}) {\n    delay = delay || 0\n    this._master = samplingMaster\n\n    // Connect all the stuff...\n    const context = samplingMaster.audioContext\n    const source = context.createBufferSource()\n    source.buffer = buffer\n    source.onended = () => this.stop()\n    const gain = context.createGain()\n    source.connect(gain)\n    const destination =\n      options.node ||\n      (options.group && options.group.destination) ||\n      samplingMaster.destination\n    gain.connect(destination)\n    this._source = source\n    this._gain = this.TEST_node = gain\n\n    // Start the sound.\n    const startTime = !delay ? 0 : Math.max(0, context.currentTime + delay)\n    const startOffset = options.start || 0\n    const fadeIn = startOffset > 0\n    let fadeOutAt = false\n    if (fadeIn) {\n      gain.gain.setValueAtTime(0, 0)\n    }\n    if (options.end !== undefined) {\n      const duration = Math.max(options.end - startOffset, 0)\n      source.start(startTime, startOffset, duration + FADE_LENGTH)\n      fadeOutAt = context.currentTime + delay + duration\n    } else {\n      source.start(startTime, startOffset)\n    }\n    if (fadeIn) {\n      gain.gain.setValueAtTime(0, context.currentTime + delay)\n      gain.gain.linearRampToValueAtTime(\n        1,\n        context.currentTime + delay + FADE_LENGTH\n      )\n    }\n    if (fadeOutAt !== false) {\n      gain.gain.setValueAtTime(1, fadeOutAt)\n      gain.gain.linearRampToValueAtTime(0, fadeOutAt + FADE_LENGTH)\n    }\n    this._master._startPlaying(this)\n  }\n\n  // Stops the sample and disconnects the underlying Web Audio nodes.\n  stop() {\n    if (!this._source) return\n    this._source.stop(0)\n    this._source.disconnect()\n    this._gain.disconnect()\n    this._source = null\n    this._gain = null\n    this._master._stoppedPlaying(this)\n    if (this.onstop) this.onstop()\n  }\n\n  // Makes this PlayInstance sound off-pitch, as a result of badly hitting\n  // a note.\n  bad() {\n    if (!this._source) return\n    this._source.playbackRate.value =\n      Math.random() < 0.5 ? Math.pow(2, 1 / 24) : Math.pow(2, -1 / 24)\n  }\n\n  // Destroys this PlayInstance.\n  destroy() {\n    this.stop()\n  }\n}\n\nexport default SamplingMaster\n\n/**\n * Enables Web Audio on iOS. By default, on iOS, audio is disabled.\n * This function must be called before audio will start working. It must be\n * called as a response to some user interaction (e.g. touchstart).\n *\n * Also, theres now Chrome autoplay policy taking effect.\n * https://developers.google.com/web/updates/2017/09/autoplay-policy-changes\n *\n * @param {AudioContext} ctx The AudioContext to be unmuted.\n */\nexport function unmuteAudio(ctx = defaultAudioContext) {\n  // Perform some strange magic to unmute the audio on iOS devices.\n  // This code doesnt make sense at all, you know.\n  const gain = ctx.createGain()\n  const osc = ctx.createOscillator()\n  osc.frequency.value = 440\n  osc.start(ctx.currentTime + 0.1)\n  osc.stop(ctx.currentTime + 0.1)\n  gain.connect(ctx.destination)\n  gain.disconnect()\n\n  resumeContext(ctx).catch((e) => {\n    console.error('[sampling-master] Cannot resume AudioContext', e)\n  })\n}\n\nasync function resumeContext(ctx) {\n  return ctx.resume()\n}\n","import throat from 'throat'\n\ntype OGGDecodeEvent = {\n  data?: Float32Array[]\n  sampleRate: number\n  error?: any\n  eof?: boolean\n}\n\ntype OGGDecoder = {\n  decode(arrayBuffer: ArrayBuffer, callback: (e: OGGDecodeEvent) => void): void\n}\n\nlet decoderPromise: Promise<OGGDecoder>\n\nconst limit = throat(1)\n\nfunction getDecoder() {\n  if (!decoderPromise) {\n    decoderPromise = import(\n      // @ts-ignore\n      /* webpackChunkName: 'stbvorbis' */ 'raw-loader!./vendor/stbvorbis/stbvorbis-e6da5fe-NDEBUG.js'\n    )\n      .then((ns) => ns.default)\n      .then((src) => {\n        // eslint-disable-next-line no-eval\n        return (0, eval)(src + ';stbvorbis')\n      })\n  }\n  return decoderPromise\n}\n\n/**\n * Decodes an OGG file using stbvorbis.js.\n */\nexport async function decodeOGG(\n  audioContext: AudioContext,\n  arrayBuffer: ArrayBuffer\n) {\n  const stbvorbis = await getDecoder()\n  return limit(() => doDecodeOGG(stbvorbis, audioContext, arrayBuffer))\n}\n\nfunction doDecodeOGG(\n  stbvorbis: OGGDecoder,\n  audioContext: AudioContext,\n  arrayBuffer: ArrayBuffer\n) {\n  return new Promise<AudioBuffer>((resolve, reject) => {\n    const buffers: Float32Array[][] = []\n    let totalLength = 0\n    let sampleRate: number\n    stbvorbis.decode(arrayBuffer, function (e) {\n      if (e.data) {\n        sampleRate = e.sampleRate\n        buffers.push(e.data)\n        totalLength += e.data[0].length\n      }\n      if (e.error) {\n        const error =\n          e.error instanceof Error ? e.error : `stbvorbis.js Error: ${e.error}`\n        reject(error)\n      }\n      if (e.eof) {\n        resolve(createBuffer(audioContext, buffers, totalLength, sampleRate))\n      }\n    })\n  })\n}\n\nasync function createBuffer(\n  audioContext: AudioContext,\n  decodedChunks: Float32Array[][],\n  length: number,\n  sampleRate: number\n) {\n  if (!length) throw new Error(`stbvorbis.js Error: No length`)\n  if (!sampleRate) throw new Error(`stbvorbis.js Error: No sample rate`)\n  const numberOfChannels = decodedChunks[0].length\n  const audioBuffer = audioContext.createBuffer(\n    numberOfChannels,\n    length,\n    sampleRate\n  )\n  const channels: ChannelDataWriter[] = Array(audioBuffer.numberOfChannels)\n    .fill(null)\n    .map((_, ch) => new ChannelDataWriter(audioBuffer.getChannelData(ch)))\n  for (const chunk of decodedChunks) {\n    chunk.forEach((audioSamples, channelIndex) => {\n      channels[channelIndex].write(audioSamples)\n    })\n  }\n  return audioBuffer\n}\n\nclass ChannelDataWriter {\n  private offset = 0\n  constructor(private data: Float32Array) {}\n  write(audioSamples: Float32Array) {\n    // iOS Safari does not support `buf.copyToChannel(a, ch, track[ch])`, so we had to copy audio data sample-by-sample.\n    const { offset, data } = this\n    for (let i = 0; i < audioSamples.length; i++) {\n      data[i + offset] = audioSamples[i]\n    }\n    this.offset += audioSamples.length\n  }\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Notechart = void 0;\nvar lodash_1 = __importDefault(require(\"lodash\"));\nvar invariant_1 = __importDefault(require(\"invariant\"));\n__exportStar(require(\"./types\"), exports);\n/**\n * A notechart holds every info about a single player's note chart that the\n * game will ever need.\n */\nvar Notechart = /** @class */ (function () {\n    function Notechart(data, playerOptions) {\n        if (playerOptions === void 0) { playerOptions = {}; }\n        var _this = this;\n        var bmsNotes = data.notes, timing = data.timing, keysounds = data.keysounds, songInfo = data.songInfo, positioning = data.positioning, spacing = data.spacing, barLines = data.barLines, images = data.images, expertJudgmentWindow = data.expertJudgmentWindow, _a = data.landmineNotes, landmineNotes = _a === void 0 ? [] : _a;\n        (0, invariant_1.default)(bmsNotes, 'Expected \"data.notes\"');\n        (0, invariant_1.default)(timing, 'Expected \"data.timing\"');\n        (0, invariant_1.default)(keysounds, 'Expected \"data.keysounds\"');\n        (0, invariant_1.default)(songInfo, 'Expected \"data.songInfo\"');\n        (0, invariant_1.default)(positioning, 'Expected \"data.positioning\"');\n        (0, invariant_1.default)(spacing, 'Expected \"data.spacing\"');\n        (0, invariant_1.default)(barLines, 'Expected \"data.barLines\"');\n        this.expertJudgmentWindow = expertJudgmentWindow;\n        bmsNotes = this._preTransform(bmsNotes, playerOptions);\n        this._timing = timing;\n        this._positioning = positioning;\n        this._spacing = spacing;\n        this._keysounds = keysounds;\n        this._duration = 0;\n        this._notes = this._generatePlayableNotesFromBMS(bmsNotes);\n        this._landmines = this._generatePlayableNotesFromBMS(landmineNotes);\n        this._autos = this._generateAutoKeysoundEventsFromBMS(bmsNotes);\n        this._barLines = this._generateBarLineEvents(barLines);\n        this._samples = this._generateKeysoundFiles(keysounds);\n        this._infos = new Map(this._notes.map(function (note) { return [note, _this._getNoteInfo(note)]; }));\n        this._songInfo = songInfo;\n        this._images = images;\n    }\n    Object.defineProperty(Notechart.prototype, \"notes\", {\n        /**\n         * An Array of note events.\n         */\n        get: function () {\n            return this._notes;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"landmines\", {\n        /**\n         * An Array of landmines events.\n         */\n        get: function () {\n            return this._landmines;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"autos\", {\n        /**\n         * An Array of auto-keysound events.\n         */\n        get: function () {\n            return this._autos;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"samples\", {\n        /**\n         * An Array of all the sample files to use.\n         */\n        get: function () {\n            return this._samples;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"keysounds\", {\n        /**\n         * An Object containing the mapping from keysound ID to keysound filename.\n         */\n        get: function () {\n            return this._keysounds.all();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"barLines\", {\n        /**\n         * An Object representing the bar line events.\n         */\n        get: function () {\n            return this._barLines;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"columns\", {\n        /**\n         * An Array of all column names in this notechart.\n         */\n        get: function () {\n            return ['SC', '1', '2', '3', '4', '5', '6', '7'];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"duration\", {\n        /**\n         * Notechart's duration (time of last event)\n         */\n        get: function () {\n            return this._duration;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"songInfo\", {\n        /**\n         * Notechart's song info\n         */\n        get: function () {\n            return this._songInfo;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"eyecatchImage\", {\n        /**\n         * Eyecatch image\n         */\n        get: function () {\n            return (this._images && this._images.eyecatch) || 'eyecatch_image.png';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"backgroundImage\", {\n        /**\n         * Background image\n         */\n        get: function () {\n            return (this._images && this._images.background) || 'back_image.png';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Returns the characteristic of the note as an Object.\n     */\n    Notechart.prototype.info = function (note) {\n        return this._infos.get(note);\n    };\n    /**\n     * Converts the beat number to in-song position (seconds)\n     */\n    Notechart.prototype.beatToSeconds = function (beat) {\n        return this._timing.beatToSeconds(beat);\n    };\n    /**\n     * Converts the beat number to in-game position.\n     */\n    Notechart.prototype.beatToPosition = function (beat) {\n        return this._positioning.position(beat);\n    };\n    /**\n     * Converts measure number to beat.\n     */\n    Notechart.prototype.measureToBeat = function (measure) {\n        return (this._barLines[measure] || this._barLines[this._barLines.length - 1]).beat;\n    };\n    /**\n     * Converts the in-song position to beat number.\n     */\n    Notechart.prototype.secondsToBeat = function (seconds) {\n        return this._timing.secondsToBeat(seconds);\n    };\n    /**\n     * Converts the in-song position to in-game position.\n     */\n    Notechart.prototype.secondsToPosition = function (seconds) {\n        return this.beatToPosition(this.secondsToBeat(seconds));\n    };\n    /**\n     * Finds BPM at the specified beat.\n     */\n    Notechart.prototype.bpmAtBeat = function (beat) {\n        return this._timing.bpmAtBeat(beat);\n    };\n    /**\n     * Finds the scrolling speed at the specified beat.\n     */\n    Notechart.prototype.scrollSpeedAtBeat = function (beat) {\n        return this._positioning.speed(beat);\n    };\n    /**\n     * Calculates the note spacing factor at the specified beat.\n     */\n    Notechart.prototype.spacingAtBeat = function (beat) {\n        return this._spacing.factor(beat);\n    };\n    /**\n     * Gets the keyMode from scratch\n     * @param scratch\n     * @returns {string}\n     */\n    Notechart.prototype.getKeyMode = function (scratch) {\n        var e_1, _a;\n        var usedColumns = {};\n        try {\n            for (var _b = __values(this.notes), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var note = _c.value;\n                usedColumns[note.column] = true;\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        if (scratch === 'off' && !usedColumns['1'] && !usedColumns['7'])\n            return '5K';\n        if (scratch === 'left' && !usedColumns['6'] && !usedColumns['7'])\n            return '5K';\n        if (scratch === 'right' && !usedColumns['1'] && !usedColumns['2'])\n            return '5K';\n        return '7K';\n    };\n    Notechart.prototype._preTransform = function (bmsNotes, playerOptions) {\n        var chain = lodash_1.default.chain(bmsNotes);\n        var keys = getKeys(bmsNotes);\n        if (playerOptions.scratch === 'off') {\n            chain = chain.map(function (note) {\n                if (note.column && note.column === 'SC') {\n                    return Object.assign({}, note, { column: null });\n                }\n                else {\n                    return note;\n                }\n            });\n        }\n        if (keys === '5K') {\n            var columnsToShift_1 = ['1', '2', '3', '4', '5', '6', '7'];\n            var shiftNote = function (amount) { return function (note) {\n                if (note.column) {\n                    var index = columnsToShift_1.indexOf(note.column);\n                    if (index > -1) {\n                        var newIndex = index + amount;\n                        (0, invariant_1.default)(newIndex < columnsToShift_1.length, 'Weird. Columns must not shift beyond available column');\n                        var newColumn = columnsToShift_1[newIndex];\n                        return Object.assign({}, note, { column: newColumn });\n                    }\n                }\n                return note;\n            }; };\n            if (playerOptions.scratch === 'off') {\n                chain = chain.map(shiftNote(1));\n            }\n            else if (playerOptions.scratch === 'right') {\n                chain = chain.map(shiftNote(2));\n            }\n        }\n        return chain.value();\n    };\n    Notechart.prototype._generatePlayableNotesFromBMS = function (bmsNotes) {\n        var _this = this;\n        var nextId = 1;\n        return bmsNotes\n            .filter(function (note) { return note.column; })\n            .map(function (note) {\n            var spec = _this._generateEvent(note.beat);\n            spec.id = nextId++;\n            spec.column = note.column;\n            spec.keysound = note.keysound;\n            spec.keysoundStart = note.keysoundStart;\n            spec.keysoundEnd = note.keysoundEnd;\n            _this._updateDuration(spec);\n            if (note.endBeat !== undefined) {\n                spec.end = _this._generateEvent(note.endBeat);\n                _this._updateDuration(spec.end);\n            }\n            else {\n                spec.end = undefined;\n            }\n            return spec;\n        });\n    };\n    Notechart.prototype._generateLandminesFromBMS = function (bmsNotes) {\n        var _this = this;\n        var nextId = 1;\n        return bmsNotes\n            .filter(function (note) { return note.column; })\n            .map(function (note) {\n            var spec = _this._generateEvent(note.beat);\n            spec.id = nextId++;\n            spec.column = note.column;\n            _this._updateDuration(spec);\n            return spec;\n        });\n    };\n    Notechart.prototype._updateDuration = function (event) {\n        if (event.time > this._duration)\n            this._duration = event.time;\n    };\n    Notechart.prototype._generateAutoKeysoundEventsFromBMS = function (bmsNotes) {\n        var _this = this;\n        return bmsNotes\n            .filter(function (note) { return !note.column; })\n            .map(function (note) {\n            var spec = _this._generateEvent(note.beat);\n            spec.keysound = note.keysound;\n            spec.keysoundStart = note.keysoundStart;\n            spec.keysoundEnd = note.keysoundEnd;\n            return spec;\n        });\n    };\n    Notechart.prototype._generateKeysoundFiles = function (keysounds) {\n        var e_2, _a, e_3, _b;\n        var set = new Set();\n        try {\n            for (var _c = __values([this.notes, this.autos]), _d = _c.next(); !_d.done; _d = _c.next()) {\n                var array = _d.value;\n                try {\n                    for (var array_1 = (e_3 = void 0, __values(array)), array_1_1 = array_1.next(); !array_1_1.done; array_1_1 = array_1.next()) {\n                        var event_ = array_1_1.value;\n                        var file = keysounds.get(event_.keysound);\n                        if (file)\n                            set.add(file);\n                    }\n                }\n                catch (e_3_1) { e_3 = { error: e_3_1 }; }\n                finally {\n                    try {\n                        if (array_1_1 && !array_1_1.done && (_b = array_1.return)) _b.call(array_1);\n                    }\n                    finally { if (e_3) throw e_3.error; }\n                }\n            }\n        }\n        catch (e_2_1) { e_2 = { error: e_2_1 }; }\n        finally {\n            try {\n                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n            }\n            finally { if (e_2) throw e_2.error; }\n        }\n        return Array.from(set);\n    };\n    Notechart.prototype._generateBarLineEvents = function (beats) {\n        var _this = this;\n        return beats.map(function (beat) { return _this._generateEvent(beat); });\n    };\n    Notechart.prototype._generateEvent = function (beat) {\n        return {\n            beat: beat,\n            time: this.beatToSeconds(beat),\n            position: this.beatToPosition(beat),\n        };\n    };\n    Notechart.prototype._getNoteInfo = function (note) {\n        return { combos: note.end ? 2 : 1 };\n    };\n    return Notechart;\n}());\nexports.Notechart = Notechart;\nexports.default = Notechart;\nfunction getKeys(bmsNotes) {\n    var e_4, _a;\n    try {\n        for (var bmsNotes_1 = __values(bmsNotes), bmsNotes_1_1 = bmsNotes_1.next(); !bmsNotes_1_1.done; bmsNotes_1_1 = bmsNotes_1.next()) {\n            var note = bmsNotes_1_1.value;\n            if (note.column === '6' || note.column === '7') {\n                return '7K';\n            }\n        }\n    }\n    catch (e_4_1) { e_4 = { error: e_4_1 }; }\n    finally {\n        try {\n            if (bmsNotes_1_1 && !bmsNotes_1_1.done && (_a = bmsNotes_1.return)) _a.call(bmsNotes_1);\n        }\n        finally { if (e_4) throw e_4.error; }\n    }\n    return '5K';\n}\n//# sourceMappingURL=index.js.map","\nvar content = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./BemusePreviewer.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./BemusePreviewer.scss\", function() {\n\t\tvar newContent = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./BemusePreviewer.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@charset \\\"UTF-8\\\";\\n.BemusePreviewer {\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  font-size: 18px;\\n}\\n.BemusePreviewerheader {\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  height: 50px;\\n  left: 0;\\n  background-color: #e34e7a;\\n  color: #fff;\\n  display: flex;\\n  align-items: center;\\n  padding: 0 1em;\\n}\\n.BemusePreviewerheader > h1 {\\n  margin: 0;\\n  font-size: 20px;\\n  font-weight: normal;\\n}\\n.BemusePreviewerheader > h1 strong {\\n  font-weight: 600;\\n}\\n.BemusePreviewerheader > h1 a {\\n  color: inherit;\\n  text-decoration: none;\\n}\\n.BemusePreviewermain {\\n  position: absolute;\\n  top: 50px;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  display: flex;\\n  align-items: flex-start;\\n}\\n.BemusePreviewerloading {\\n  position: absolute;\\n  top: 50px;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  background: rgba(0, 0, 0, 0.5333333333);\\n  color: #fff;\\n  text-align: left;\\n  padding: 2em;\\n}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./PreviewInfo.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./PreviewInfo.scss\", function() {\n\t\tvar newContent = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./PreviewInfo.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@charset \\\"UTF-8\\\";\\n.PreviewInfo {\\n  padding: 1em;\\n}\\n.PreviewInfo > h2 {\\n  margin: 0 0 0em;\\n}\\n.PreviewInfokeyHints {\\n  color: #8b8685;\\n  font-size: 12px;\\n  line-height: 2;\\n}\\n.PreviewInfokeyHints > kbd {\\n  font-family: inherit;\\n  padding: 0.1em 0.2em;\\n  background: #222;\\n  border: 1px solid #333;\\n  border-radius: 4px;\\n  box-shadow: 0 3px 0 #333;\\n  display: inline-block;\\n  line-height: 1;\\n}\\n.PreviewInfo td {\\n  text-align: right;\\n  font-family: Menlo, Consolas, monospace;\\n}\\n.PreviewInfo th {\\n  text-align: left;\\n}\", \"\"]);\n\n// exports\n","import _ from 'lodash'\nimport React, { useEffect, useMemo } from 'react'\nimport { NotechartPreview } from './NotechartPreview'\nimport { PreviewState } from './PreviewState'\n\nexport type PreviewColumn = {\n  x: number\n  width: number\n  column: string | null\n  sprite?: PreviewNoteSprite\n}\n\nexport type PreviewNoteSprite = {\n  x: number\n  width: number\n  highlight?: boolean\n}\n\nconst sprites = {\n  scratch: { x: 0, width: 61 },\n  white: { x: 62, width: 34, highlight: true },\n  blue: { x: 97, width: 26 },\n  green: { x: 159, width: 26 },\n}\n\nclass PreviewLayout {\n  columns: PreviewColumn[]\n  totalWidth: number\n  columnMapping: Record<string, PreviewColumn>\n  constructor(keymap: string) {\n    let nextX = 0\n    const column = (width: number, name: string | null): PreviewColumn => {\n      const x = nextX\n      nextX += width + 1\n      return { x, width, column: name }\n    }\n    const noteColumn = (\n      sprite: PreviewNoteSprite,\n      name: string\n    ): PreviewColumn => {\n      return { ...column(sprite.width, name), sprite }\n    }\n    this.columns = keymap.split(' ').map((c) => {\n      if (c === '-') return column(72, null)\n      if (c.endsWith('s')) return noteColumn(sprites.scratch, c.slice(0, -1))\n      if (c.endsWith('b')) return noteColumn(sprites.blue, c.slice(0, -1))\n      if (c.endsWith('g')) return noteColumn(sprites.green, c.slice(0, -1))\n      return noteColumn(sprites.white, c)\n    })\n    this.totalWidth = nextX\n    this.columnMapping = _.fromPairs(\n      this.columns.filter((c) => c.column != null).map((c) => [c.column, c])\n    )\n  }\n}\n\nexport interface PreviewCanvas {\n  previewState: PreviewState\n  notechartPreview: NotechartPreview\n}\n\nexport const PreviewCanvas: FC<PreviewCanvas> = (props) => {\n  const keymap = 'SCs 1 2b 3 4g 5 6b 7 - 8 9b 10 11g 12 13b 14 SC2s'\n  const notesImage = useImage('/skins/default/Note/DX/Note.png')\n  const landmineImage = useImage('/skins/default/Note/DX/Landmine.png')\n  const canvasRef = React.useRef<HTMLCanvasElement>(null)\n\n  const layout = useMemo(() => new PreviewLayout(keymap), [keymap])\n  const width = layout.totalWidth + 1\n  const height = 468\n\n  const viewport = useMemo(() => {\n    return props.notechartPreview.getViewport(\n      props.previewState.currentTime,\n      props.previewState.hiSpeed\n    )\n  }, [\n    props.notechartPreview,\n    props.previewState.currentTime,\n    props.previewState.hiSpeed,\n  ])\n\n  const maxCombo = props.notechartPreview.getMaxCombo()\n\n  const comboInfo = useMemo(() => {\n    return props.notechartPreview.getComboInfo(props.previewState.currentTime)\n  }, [props.notechartPreview, props.previewState.currentTime])\n\n  useEffect(() => {\n    const ctx = canvasRef.current?.getContext('2d')\n    if (!ctx) return\n\n    // background\n    ctx.fillStyle = '#000'\n    ctx.fillRect(0, 0, width, height)\n\n    // lines\n    for (const column of layout.columns) {\n      ctx.fillStyle = '#555'\n      ctx.fillRect(column.x, 0, 1, height)\n      if (column.sprite?.highlight) {\n        ctx.fillStyle = '#111'\n        ctx.fillRect(column.x + 1, 0, column.width, height)\n      }\n    }\n    ctx.fillStyle = '#555'\n    ctx.fillRect(layout.totalWidth, 0, 1, height)\n\n    ctx.textAlign = 'center'\n    ctx.font = 'bold 18px sans-serif'\n    for (const barLine of viewport.visibleBarLines) {\n      const y = Math.round(height - barLine.y * height)\n      ctx.fillRect(0, y - 1, layout.totalWidth, 1)\n      ctx.fillText('#' + barLine.measureNumber, layout.totalWidth / 2, y - 4)\n    }\n\n    if (notesImage && landmineImage) {\n      for (const note of viewport.visibleNotes) {\n        const column = layout.columnMapping[note.gameEvent.column]\n        if (column?.sprite) {\n          const y = Math.round(height - note.y * height)\n          if (note.long) {\n            const endY = Math.round(height - note.long.endY * height)\n            const spriteYOffset = note.long.active ? 100 : 0\n            ctx.drawImage(\n              notesImage,\n              column.sprite.x,\n              104 + spriteYOffset,\n              column.width,\n              8,\n              column.x + 1,\n              y - 8,\n              column.width,\n              8\n            )\n            ctx.drawImage(\n              notesImage,\n              column.sprite.x,\n              12 + spriteYOffset,\n              column.width,\n              8,\n              column.x + 1,\n              endY - 12,\n              column.width,\n              8\n            )\n            const noteHeight = y - endY - 4\n            if (noteHeight > 0) {\n              ctx.drawImage(\n                notesImage,\n                column.sprite.x,\n                22 + spriteYOffset,\n                column.width,\n                64,\n                column.x + 1,\n                endY - 4,\n                column.width,\n                noteHeight\n              )\n            }\n          } else {\n            const image = note.type === 'landmine' ? landmineImage : notesImage\n            ctx.drawImage(\n              image,\n              column.sprite.x,\n              0,\n              column.width,\n              12,\n              column.x + 1,\n              y - 12,\n              column.width,\n              12\n            )\n          }\n        }\n      }\n    }\n\n    if (comboInfo) {\n      const deltaTime = props.previewState.currentTime - comboInfo.comboTime\n      const opacity = Math.max(0, 1 - deltaTime)\n      if (opacity > 0) {\n        ctx.fillStyle = 'rgba(255, 255, 255, ' + opacity + ')'\n        ctx.font = 'bold 36px sans-serif'\n        ctx.textAlign = 'center'\n        ctx.fillText(\n          `${comboInfo.comboCount} / ${maxCombo}`,\n          layout.totalWidth / 2,\n          height - 64 - opacity ** 8 * 8\n        )\n      }\n    }\n  }, [\n    width,\n    height,\n    layout,\n    viewport,\n    notesImage,\n    maxCombo,\n    comboInfo,\n    props.previewState.currentTime,\n  ])\n\n  return (\n    <canvas\n      ref={canvasRef}\n      width={width}\n      height={height}\n      style={{\n        imageRendering: 'pixelated',\n      }}\n    />\n  )\n}\n\nfunction useImage(src: string) {\n  const [image, setImage] = React.useState<HTMLImageElement | null>(null)\n  useEffect(() => {\n    const img = new Image()\n    img.src = src\n    img.onload = () => setImage(img)\n    return () => {\n      img.onload = null\n    }\n  }, [src])\n  return image\n}\n","import './PreviewInfo.scss'\nimport React, { useMemo } from 'react'\nimport { MeasureInfo, NotechartPreview } from './NotechartPreview'\nimport { PreviewState } from './PreviewState'\nimport { BarDot } from './BarDot'\n\nexport interface PreviewInfo {\n  notechartPreview: NotechartPreview\n  previewState: PreviewState\n}\n\nexport const PreviewInfo: FC<PreviewInfo> = (props) => {\n  const preview = props.notechartPreview\n\n  const measureInfo = useMemo(() => {\n    return props.notechartPreview.getMeasureInfo(props.previewState.currentTime)\n  }, [props.notechartPreview, props.previewState.currentTime])\n  const bpm = useMemo(() => {\n    return props.notechartPreview.getCurrentBpm(props.previewState.currentTime)\n  }, [props.notechartPreview, props.previewState.currentTime])\n  const scroll = useMemo(() => {\n    return props.notechartPreview.getCurrentScroll(\n      props.previewState.currentTime\n    )\n  }, [props.notechartPreview, props.previewState.currentTime])\n  const speed = useMemo(() => {\n    return props.notechartPreview.getCurrentSpeed(\n      props.previewState.currentTime\n    )\n  }, [props.notechartPreview, props.previewState.currentTime])\n  const hiSpeed = props.previewState.hiSpeed\n  const format = (n: number) => n.toFixed(2)\n  const formatTime = (s: number) => {\n    return `${~~(s / 60)}:${(~~s % 60).toString().padStart(2, '0')}`\n  }\n\n  const keyHints = useMemo(\n    () => (\n      <p className='PreviewInfokeyHints'>\n        <kbd>Space</kbd> Play/Pause\n        <br />\n        <kbd>Up/Down/Left/Right/,/.</kbd> Seek\n        <br />\n        <kbd>G</kbd> Go To Measure\n        <br />\n        <kbd>1/2</kbd> Hi-Speed\n        <br />\n        <kbd>R</kbd> Reload Chart\n      </p>\n    ),\n    []\n  )\n\n  return (\n    <div className='PreviewInfo'>\n      <h2>{preview.name}</h2>\n      <p>{preview.description}</p>\n      <table>\n        <col width={80} />\n        <col width={120} />\n        <col width={80} />\n        <tbody>\n          <tr>\n            <th scope='row'>Time</th>\n            <td colSpan={2}>\n              {formatTime(props.previewState.currentTime)} /{' '}\n              {formatTime(props.notechartPreview.duration)}\n            </td>\n          </tr>\n          <tr>\n            <th scope='row'>Measure</th>\n            <td colSpan={2}>\n              <BarDots measureInfo={measureInfo} /> #{measureInfo.measureNumber}\n            </td>\n          </tr>\n          <tr>\n            <th scope='row'>#BPM</th>\n            <td />\n            <td>{format(bpm)}</td>\n          </tr>\n          <tr>\n            <th scope='row'>#SCROLL</th>\n            <td>{format(scroll)}x &rarr;</td>\n            <td>{format(bpm * scroll)}</td>\n          </tr>\n          <tr>\n            <th scope='row'>#SPEED</th>\n            <td>{format(speed)}x &rarr;</td>\n            <td>{format(bpm * scroll * speed)}</td>\n          </tr>\n          <tr>\n            <th scope='row'>HI-SPEED</th>\n            <td>{format(hiSpeed)}x &rarr;</td>\n            <td>{format(bpm * scroll * speed * hiSpeed)}</td>\n          </tr>\n        </tbody>\n      </table>\n      {keyHints}\n    </div>\n  )\n}\n\ninterface BarDots {\n  measureInfo: MeasureInfo\n}\n\nconst BarDots: FC<BarDots> = (props) => {\n  const { measureInfo } = props\n  if (!measureInfo.measureEndBeat) return null\n  const measureSize = measureInfo.measureEndBeat - measureInfo.measureStartBeat\n  if (!measureSize) return null\n  let dotCount = measureSize\n  let dotSize = 1\n  while (dotCount >= 8) {\n    dotSize *= 2\n    dotCount /= 2\n  }\n  while (dotCount <= 2) {\n    dotSize /= 2\n    dotCount *= 2\n  }\n  const dots: ReactNode[] = []\n  let filledDots = Math.ceil(\n    (measureInfo.currentBeat - measureInfo.measureStartBeat) / dotSize\n  )\n  while (dotCount > 0) {\n    dots.push(\n      <BarDot\n        key={dots.length}\n        fraction={dotCount > 1 ? 1 : dotCount}\n        fill={filledDots > 0 ? '#e34e7a' : '#333'}\n      />\n    )\n    dotCount--\n    filledDots--\n  }\n  return <>{dots}</>\n}\n","import { showQuickPick } from 'bemuse/ui-dialogs'\nimport { useEffect } from 'react'\n\nexport interface PreviewFileDropHandler {\n  onDrop: (\n    handle: FileSystemDirectoryHandle,\n    selectedChartFilename: string\n  ) => void\n}\n\nexport const PreviewFileDropHandler: FC<PreviewFileDropHandler> = (props) => {\n  useEffect(() => {\n    const onDragOver = (e: DragEvent) => {\n      e.preventDefault()\n    }\n    const onDrop = async (e: DragEvent) => {\n      e.preventDefault()\n      const items = e.dataTransfer!.items\n      if (items.length !== 1) {\n        alert('Please drop only one folder.')\n        return\n      }\n      const item = items[0]\n      if (item.kind !== 'file') {\n        alert('Please drop only a folder here.')\n        return\n      }\n      if (!('getAsFileSystemHandle' in item)) {\n        alert('Unsupported browser (sorry).')\n        return\n      }\n      const handleNullable = await item.getAsFileSystemHandle()\n      if (!handleNullable || handleNullable.kind !== 'directory') {\n        alert('Please drop folder, not a file here.')\n        return\n      }\n      const handle = handleNullable as FileSystemDirectoryHandle\n      await handle.requestPermission({ mode: 'read' })\n      const chartFiles: { filename: string; label: string }[] = []\n      for await (const [name] of handle.entries()) {\n        if (/\\.(bms|bme|bml|bmson)$/i.test(name)) {\n          chartFiles.push({ filename: name, label: name })\n        }\n      }\n      if (chartFiles.length === 0) {\n        alert('No BMS/bmson files found in folder.')\n        return\n      }\n\n      const selectedChartFile = await showQuickPick(chartFiles, {\n        title: 'Select a chart file',\n      })\n      props.onDrop(handle, selectedChartFile.filename)\n    }\n    window.addEventListener('dragover', onDragOver)\n    window.addEventListener('drop', onDrop)\n    return () => {\n      window.removeEventListener('dragover', onDragOver)\n      window.removeEventListener('drop', onDrop)\n    }\n  }, [props.onDrop])\n  return null\n}\n","import Notechart, {\n  GameLandmine,\n  GameNote,\n  SoundedEvent,\n} from 'bemuse-notechart'\nimport SamplingMaster, {\n  PlayInstance,\n  Sample,\n  SoundGroup,\n} from 'bemuse/sampling-master'\nimport _ from 'lodash'\n\nexport interface NotechartPreview {\n  /**\n   * Songs length in seconds.\n   */\n  duration: number\n\n  name: string\n  description: string\n\n  getViewport(currentTime: number, hiSpeed: number): PreviewViewport\n  getMeasureInfo(currentTime: number): MeasureInfo\n  getCurrentBpm(currentTime: number): number\n  getCurrentScroll(currentTime: number): number\n  getCurrentSpeed(currentTime: number): number\n  play(delegate: NotechartPreviewPlayerDelegate): NotechartPreviewPlayer\n  measureToSeconds(measure: number): number\n  getMeasureJumpTarget(currentTime: number, direction: number): number\n  getComboInfo(currentTime: number): ComboInfo | null\n  getMaxCombo(): number\n}\n\nexport interface PreviewViewport {\n  visibleNotes: VisibleNote[]\n  visibleBarLines: VisibleBarLine[]\n}\n\nexport interface MeasureInfo {\n  currentBeat: number\n  measureNumber: number\n  measureStartBeat: number\n  measureEndBeat?: number\n}\n\nexport interface ComboInfo {\n  comboTime: number\n  comboCount: number\n}\n\nexport interface NotechartPreviewPlayer {\n  stop(): void\n}\n\nexport interface NotechartPreviewPlayerDelegate {\n  startTime: number\n\n  onFinish(): void\n  onTimeUpdate(currentTime: number): void\n}\n\nexport type VisibleNote = {\n  y: number\n  long?: { endY: number; active: boolean }\n  gameEvent: GameNote | GameLandmine\n  type: 'note' | 'landmine'\n}\n\nexport type VisibleBarLine = {\n  y: number\n  measureNumber: number\n}\n\nexport function createNullNotechartPreview(): NotechartPreview {\n  const warning =\n    location.hostname !== 'bemuse.ninja'\n      ? ' [NOTE: Do not bookmark this URL because it is a preview and this URL will stop working in the future.]'\n      : ''\n  return {\n    duration: 0.99,\n    name: 'No BMS/bmson loaded',\n    description:\n      'Drop a folder with BMS/bmson files into this window to preview it.' +\n      warning,\n    getViewport: () => ({\n      visibleBarLines: [],\n      visibleNotes: [],\n    }),\n    getMeasureInfo: () => ({\n      currentBeat: 0,\n      measureNumber: 0,\n      measureStartBeat: 0,\n    }),\n    getCurrentBpm: () => 0,\n    getCurrentScroll: () => 0,\n    getCurrentSpeed: () => 0,\n    play: (delegate) => {\n      setTimeout(() => {\n        delegate.onFinish()\n      })\n      return { stop: () => {} }\n    },\n    measureToSeconds: () => 0,\n    getMeasureJumpTarget: () => 0,\n    getComboInfo: () => null,\n    getMaxCombo: () => 0,\n  }\n}\n\nexport type PreviewSoundSample = {\n  filename: string\n  sample: Sample | null\n}\n\nexport function createNotechartPreview(\n  notechart: Notechart,\n  filename: string,\n  samplingMaster: SamplingMaster,\n  soundGroup: SoundGroup,\n  samples: PreviewSoundSample[]\n): NotechartPreview {\n  return new BemuseNotechartPreview(\n    notechart,\n    filename,\n    samplingMaster,\n    soundGroup,\n    samples\n  )\n}\n\nclass BemuseNotechartPreview implements NotechartPreview {\n  private _sortedGameNotes: GameNote[]\n  private _sortedSoundEvents: SoundedEvent[]\n  private _secondsToBeatCache?: { seconds: number; beat: number }\n  private _comboPreviewer: ComboPreviewer\n  private _sortedGameLandmines: GameNote[]\n\n  constructor(\n    private _notechart: Notechart,\n    private _filename: string,\n    private _samplingMaster: SamplingMaster,\n    private _soundGroup: SoundGroup,\n    private _samples: PreviewSoundSample[]\n  ) {\n    this._sortedGameNotes = _.sortBy(this._notechart.notes, (e) => e.position)\n    this._sortedGameLandmines = _.sortBy(\n      this._notechart.landmines,\n      (e) => e.position\n    )\n    this._sortedSoundEvents = _.sortBy(\n      [...this._notechart.notes, ...this._notechart.autos],\n      (e) => e.time\n    )\n    this._comboPreviewer = new ComboPreviewer(this._notechart.notes)\n  }\n\n  get duration() {\n    return this._notechart.duration\n  }\n\n  get name() {\n    return this._filename\n  }\n\n  get description() {\n    return this._notechart.songInfo.title\n  }\n\n  getViewport(currentTime: number, hiSpeed: number): PreviewViewport {\n    const beat = this._secondsToBeat(currentTime)\n    const position = this._notechart.beatToPosition(beat)\n    const speed = this._notechart.spacingAtBeat(beat)\n    const windowSize = 4 / speed / hiSpeed\n    const visibleNotes: VisibleNote[] = []\n    const insideView = (gameNote: GameNote) => {\n      if (gameNote.end) {\n        if (currentTime > gameNote.end.time) return false\n        if (gameNote.position > position + windowSize * 1.5) return false\n        if (gameNote.end.position < position - windowSize * 0.5) return false\n        return true\n      } else {\n        if (currentTime > gameNote.time) return false\n        if (gameNote.position > position + windowSize * 1.5) return false\n        if (gameNote.position < position - windowSize * 0.5) return false\n        return true\n      }\n    }\n    for (const gameNote of this._sortedGameNotes) {\n      if (!insideView(gameNote)) continue\n      const delta = gameNote.position - position\n      const y = delta / windowSize\n      const visibleNote: VisibleNote = {\n        gameEvent: gameNote,\n        y,\n        type: 'note',\n      }\n      if (gameNote.end) {\n        const endDelta = gameNote.end.position - position\n        const endY = endDelta / windowSize\n        const active =\n          currentTime >= gameNote.time && currentTime < gameNote.end.time\n        visibleNote.long = { endY, active }\n      }\n      visibleNotes.push(visibleNote)\n    }\n    for (const gameLandmine of this._sortedGameLandmines) {\n      if (!insideView(gameLandmine)) continue\n      const delta = gameLandmine.position - position\n      const y = delta / windowSize\n      const visibleNote: VisibleNote = {\n        gameEvent: gameLandmine,\n        y,\n        type: 'landmine',\n      }\n      visibleNotes.push(visibleNote)\n    }\n    const visibleBarLines: VisibleBarLine[] = []\n    for (const [i, barLine] of this._notechart.barLines.entries()) {\n      if (barLine.position > position + windowSize * 1.5) continue\n      if (barLine.position < position - windowSize * 0.5) continue\n      const delta = barLine.position - position\n      visibleBarLines.push({ y: delta / windowSize, measureNumber: i })\n    }\n    return { visibleNotes, visibleBarLines }\n  }\n\n  getMeasureInfo(currentTime: number): MeasureInfo {\n    const beat = this._secondsToBeat(currentTime)\n    let currentMeasure = 0\n    let currentMeasureStart = 0\n    for (const [i, barLine] of this._notechart.barLines.entries()) {\n      if (beat < barLine.beat) {\n        break\n      }\n      currentMeasure = i\n      currentMeasureStart = barLine.beat\n    }\n    return {\n      currentBeat: beat,\n      measureNumber: currentMeasure,\n      measureStartBeat: currentMeasureStart,\n      measureEndBeat: this._notechart.barLines[currentMeasure + 1]?.beat,\n    }\n  }\n\n  getCurrentBpm(currentTime: number): number {\n    return this._notechart.bpmAtBeat(this._secondsToBeat(currentTime))\n  }\n\n  getCurrentScroll(currentTime: number): number {\n    return this._notechart.scrollSpeedAtBeat(this._secondsToBeat(currentTime))\n  }\n\n  getCurrentSpeed(currentTime: number): number {\n    return this._notechart.spacingAtBeat(this._secondsToBeat(currentTime))\n  }\n\n  measureToSeconds(measure: number): number {\n    const beat = this._notechart.measureToBeat(measure)\n    return this._notechart.beatToSeconds(beat)\n  }\n\n  getMeasureJumpTarget(currentTime: number, direction: number): number {\n    const beat = this._secondsToBeat(currentTime)\n    const closestBarLine = _.minBy(this._notechart.barLines, (b) =>\n      Math.abs(b.beat - beat)\n    )\n    if (!closestBarLine) {\n      return currentTime\n    }\n    const index = this._notechart.barLines.indexOf(closestBarLine)\n    const target = this._notechart.barLines[index + direction]\n    if (!target) {\n      return currentTime\n    }\n    return target.time\n  }\n\n  getComboInfo(currentTime: number): ComboInfo | null {\n    return this._comboPreviewer.getComboInfo(currentTime)\n  }\n\n  getMaxCombo(): number {\n    return this._comboPreviewer.getMaxCombo()\n  }\n\n  private _secondsToBeat(currentTime: number) {\n    if (\n      !this._secondsToBeatCache ||\n      this._secondsToBeatCache.seconds !== currentTime\n    ) {\n      this._secondsToBeatCache = {\n        seconds: currentTime,\n        beat: this._notechart.secondsToBeat(currentTime),\n      }\n    }\n    return this._secondsToBeatCache.beat\n  }\n\n  play(delegate: NotechartPreviewPlayerDelegate) {\n    this._samplingMaster.unmute()\n    console.log(this._sortedSoundEvents)\n    console.log(this._notechart.keysounds)\n    const player = new BemuseNotechartPreviewPlayer(\n      this._samplingMaster,\n      this._soundGroup,\n      this._sortedSoundEvents,\n      this._notechart.keysounds,\n      this._samples,\n      delegate\n    )\n    player.play()\n    return player\n  }\n}\n\nclass BemuseNotechartPreviewPlayer implements NotechartPreviewPlayer {\n  private _cursor = 0\n  private _sampleMap = new Map<string, Sample>()\n  private _startAudioTime = 0\n  private _startSongTime = 0\n  private _stopped = false\n  private _playingSamples = new Map<string, PlayInstance>()\n\n  constructor(\n    private _samplingMaster: SamplingMaster,\n    private _soundGroup: SoundGroup,\n    private _sortedSoundEvents: SoundedEvent[],\n    private _keysounds: Record<string, string>,\n    _samples: PreviewSoundSample[],\n    private _delegate: NotechartPreviewPlayerDelegate\n  ) {\n    for (const { filename, sample } of _samples) {\n      if (sample) {\n        this._sampleMap.set(filename, sample)\n      }\n    }\n  }\n\n  play() {\n    this._startAudioTime = this._samplingMaster.currentTime\n    this._startSongTime = this._delegate.startTime\n    const frame = () => {\n      if (this._stopped) return\n      this._advance()\n      requestAnimationFrame(frame)\n    }\n    requestAnimationFrame(frame)\n  }\n\n  private _advance() {\n    const currentTime =\n      this._samplingMaster.currentTime -\n      this._startAudioTime +\n      this._startSongTime\n    for (; this._cursor < this._sortedSoundEvents.length; this._cursor++) {\n      const nextEvent = this._sortedSoundEvents[this._cursor]\n      if (nextEvent.time > currentTime + 0.1) {\n        break\n      }\n\n      if (nextEvent.keysoundStart) {\n        // bmsons \"continue\" notes do not trigger a new sound\n        continue\n      }\n\n      const keysound = nextEvent.keysound\n      const filename = this._keysounds[keysound.toLowerCase()]\n      if (!filename) {\n        continue\n      }\n\n      const sample = this._sampleMap.get(filename)\n      if (!sample) {\n        continue\n      }\n\n      let delay = 0\n      let offset = 0\n      if (nextEvent.time > currentTime) {\n        delay = nextEvent.time - currentTime\n      } else if (nextEvent.time < currentTime) {\n        offset = currentTime - nextEvent.time\n      }\n\n      if (offset >= sample.duration) {\n        continue\n      }\n      this._choke(keysound, delay)\n      const instance = sample.play(delay, {\n        start: offset,\n        group: this._soundGroup,\n      })\n      this._playingSamples.set(keysound, instance)\n    }\n    this._delegate.onTimeUpdate(currentTime)\n  }\n\n  private _choke(keysound: string, delay: number) {\n    const playing = this._playingSamples.get(keysound)\n    if (!playing) {\n      return\n    }\n    // TODO: Use Web Audio API instead\n    setTimeout(() => {\n      playing.stop()\n    }, delay * 1000)\n  }\n\n  stop() {\n    this._stopped = true\n    for (const playing of this._playingSamples.values()) {\n      playing.destroy()\n    }\n    this._playingSamples.clear()\n  }\n}\n\nclass ComboPreviewer {\n  private _events: number[]\n\n  constructor(notes: GameNote[]) {\n    this._events = _.sortBy(\n      _.flatMap(notes, (note) => {\n        if (note.end) {\n          return [note.time, note.end.time]\n        } else {\n          return [note.time]\n        }\n      }),\n      _.identity\n    )\n  }\n\n  getComboInfo(time: number): ComboInfo | null {\n    const index = _.sortedLastIndex(this._events, time)\n    if (index === 0) {\n      return null\n    }\n    const prev = this._events[index - 1]\n    return {\n      comboCount: index,\n      comboTime: prev,\n    }\n  }\n\n  getMaxCombo(): number {\n    return this._events.length\n  }\n}\n","import _ from 'lodash'\nimport NotechartLoader from 'bemuse-notechart/lib/loader'\nimport ObjectID from 'bson-objectid'\nimport pMap from 'p-map'\nimport SamplingMaster, { Sample } from 'bemuse/sampling-master'\nimport { get, set } from 'idb-keyval'\nimport { showAlert } from 'bemuse/ui-dialogs'\n\nimport { createNotechartPreview } from './NotechartPreview'\n\nconst PREVIEWER_FS_HANDLE_KEYVAL_KEY = 'previewer-fs-handle'\nconst getSamplingMaster = _.once(() => {\n  const samplingMaster = new SamplingMaster()\n  // http://qiita.com/dtinth/items/1200681c517a3fb26357\n  const DEFAULT_REPLAYGAIN = -12.2 // dB\n\n  const volume = Math.pow(10, (DEFAULT_REPLAYGAIN + 4) / 20)\n  const group = samplingMaster.group({ volume })\n  return {\n    samplingMaster,\n    group,\n  }\n})\n\nconst keysoundCache = new Map<string, Sample>()\nlet keysoundCacheHandleId = ''\n\nexport async function getSavedPreviewInfo() {\n  const data = await get(PREVIEWER_FS_HANDLE_KEYVAL_KEY)\n  const chartFilename = data?.chartFilename\n  return chartFilename ? { chartFilename } : null\n}\n\ntype LoadPreviewOptions = {\n  log: (message: string) => void\n}\n\nexport async function loadPreview(loadOptions: LoadPreviewOptions) {\n  const log =\n    loadOptions.log ||\n    ((message: string) => console.log(`[PreviewLoader] ${message}`))\n\n  log('Loading directory handle from IndexedDB')\n  const data = await get(PREVIEWER_FS_HANDLE_KEYVAL_KEY)\n  const directoryHandle: FileSystemDirectoryHandle = data.directory\n  const handleId = data.handleId\n\n  log('Obtaining permission to read directory')\n  await ensureReadable(directoryHandle)\n\n  log('Scanning charts')\n  const chartHandles: { name: string; handle: FileSystemFileHandle }[] = []\n  for await (const [name, fileHandle] of directoryHandle) {\n    if (fileHandle.kind === 'file' && /\\.(bms|bme|bml|bmson)$/i.test(name)) {\n      chartHandles.push({ name, handle: fileHandle })\n    }\n  }\n  console.log(directoryHandle)\n\n  const chartHandle =\n    chartHandles.find((c) => c.name === data.chartFilename) || chartHandles[0]\n  if (!chartHandle) {\n    throw new Error('No chart found.')\n  }\n\n  log('Loading chart ' + chartHandle.name)\n  const notechartLoader = new NotechartLoader()\n  const arrayBuffer = await (await chartHandle.handle.getFile()).arrayBuffer()\n  const notechart = await notechartLoader.load(\n    arrayBuffer,\n    { name: chartHandle.name },\n    { scratch: 'left', double: true }\n  )\n\n  log('Loading samples')\n  const { samplingMaster, group } = getSamplingMaster()\n  let numLoadedSamples = 0\n  if (keysoundCacheHandleId !== handleId) {\n    keysoundCache.clear()\n    keysoundCacheHandleId = handleId\n  }\n  const samples = await pMap(\n    notechart.samples,\n    async (filename) => {\n      if (keysoundCache.has(filename)) {\n        const sample = keysoundCache.get(filename) || null\n        return { filename, sample }\n      }\n      const load = async (name: string) => {\n        const fileHandle = await directoryHandle.getFileHandle(name)\n        const file = await fileHandle.getFile()\n        return file.arrayBuffer()\n      }\n      try {\n        const arrayBuffer = await load(\n          filename.replace(/\\.\\w+$/, '.ogg')\n        ).catch(() => load(filename))\n        const sample = await samplingMaster.sample(arrayBuffer)\n        const progress = `${++numLoadedSamples}/${notechart.samples.length}`\n        log(`Loaded ${filename} [${progress}]: ${sample.duration}s`)\n        keysoundCache.set(filename, sample)\n        return { filename, sample }\n      } catch (error) {\n        console.error(error)\n        log(`Failed to load ${filename}: ${error}`)\n        return { filename, sample: null }\n      }\n    },\n    { concurrency: 64 }\n  )\n  console.log(samples)\n\n  log('Loading preview')\n  const preview = createNotechartPreview(\n    notechart,\n    chartHandle.name,\n    samplingMaster,\n    group,\n    samples\n  )\n  console.log(preview)\n\n  return preview\n}\n\nasync function ensureReadable(directoryHandle: FileSystemDirectoryHandle) {\n  let permission = await directoryHandle.queryPermission({ mode: 'read' })\n  try {\n    if (permission === 'prompt') {\n      permission = await directoryHandle.requestPermission({ mode: 'read' })\n    }\n  } catch (error) {\n    await showAlert(\n      'File system access required',\n      'Please allow access to the filesystem.'\n    )\n    permission = await directoryHandle.requestPermission({ mode: 'read' })\n  }\n  if (permission !== 'granted') {\n    throw new Error('Permission denied.')\n  }\n}\n\nexport async function setPreview(\n  handle: FileSystemDirectoryHandle,\n  selectedChartFilename: string\n) {\n  await set(PREVIEWER_FS_HANDLE_KEYVAL_KEY, {\n    directory: handle,\n    chartFilename: selectedChartFilename,\n    handleId: ObjectID.generate(),\n  })\n}\n","import { NotechartPreview } from './NotechartPreview'\n\nexport type PreviewState = {\n  currentTime: number\n  hiSpeed: number\n  playing: boolean\n}\n\nexport type PreviewAction = {\n  loaded?: boolean\n  speedUp?: boolean\n  speedDown?: boolean\n  play?: boolean\n  pause?: boolean\n  playPause?: boolean\n  home?: boolean\n  playFinish?: boolean\n  updateTime?: { time: number }\n  jumpToTime?: { time: number }\n  jumpByMeasure?: { preview: NotechartPreview; direction: number }\n  jumpBySeconds?: { direction: number }\n}\n\nexport function previewStateReducer(\n  state: PreviewState,\n  action: PreviewAction\n) {\n  let nextState = state\n  if (action.loaded) {\n    nextState = {\n      ...state,\n      playing: false,\n    }\n  }\n  if (action.speedUp) {\n    nextState = {\n      ...state,\n      hiSpeed: +Math.min(state.hiSpeed + 0.25, 99).toFixed(2),\n    }\n  }\n  if (action.speedDown) {\n    nextState = {\n      ...state,\n      hiSpeed: +Math.max(state.hiSpeed - 0.25, 0.25).toFixed(2),\n    }\n  }\n  if (action.play) {\n    nextState = {\n      ...state,\n      playing: true,\n    }\n  }\n  if (action.pause) {\n    nextState = {\n      ...state,\n      playing: false,\n    }\n  }\n  if (action.playPause) {\n    nextState = {\n      ...state,\n      playing: !state.playing,\n    }\n  }\n  if (action.playFinish) {\n    nextState = {\n      ...state,\n      playing: false,\n    }\n  }\n  if (action.home) {\n    nextState = {\n      ...state,\n      playing: false,\n      currentTime: 0,\n    }\n  }\n  if (action.updateTime) {\n    nextState = {\n      ...state,\n      currentTime: action.updateTime.time,\n    }\n  }\n  if (action.jumpToTime) {\n    nextState = {\n      ...state,\n      currentTime: action.jumpToTime.time,\n      playing: false,\n    }\n  }\n  if (action.jumpByMeasure) {\n    nextState = {\n      ...state,\n      currentTime: action.jumpByMeasure.preview.getMeasureJumpTarget(\n        state.currentTime,\n        action.jumpByMeasure.direction\n      ),\n      playing: false,\n    }\n  }\n  if (action.jumpBySeconds) {\n    nextState = {\n      ...state,\n      currentTime: Math.max(\n        0,\n        state.currentTime + action.jumpBySeconds.direction\n      ),\n      playing: false,\n    }\n  }\n  return nextState\n}\n","import { isModalActive } from 'bemuse/ui-dialogs'\nimport { useLatest } from 'bemuse/utils/useLatest'\nimport { useEffect } from 'react'\nimport { NotechartPreview } from './NotechartPreview'\nimport { PreviewAction } from './PreviewState'\n\nlet rememberedMeasureNumber: number | null = null\n\nexport interface PreviewKeyHandler {\n  notechartPreview: NotechartPreview\n  dispatch: React.Dispatch<PreviewAction>\n  onReload: () => void\n}\n\nexport const PreviewKeyHandler: FC<PreviewKeyHandler> = (props) => {\n  const getLatestNotechartPreview = useLatest(props.notechartPreview)\n  useEffect(() => {\n    const onKeyDown = (e: KeyboardEvent) => {\n      if (isModalActive()) return\n      console.log(e.key)\n      if (e.key === '2') {\n        props.dispatch({ speedUp: true })\n        e.preventDefault()\n      }\n      if (e.key === '1') {\n        props.dispatch({ speedDown: true })\n        e.preventDefault()\n      }\n      if (e.key === ' ') {\n        props.dispatch({ playPause: true })\n        e.preventDefault()\n      }\n      if (e.key === 'Home') {\n        props.dispatch({ home: true })\n        e.preventDefault()\n      }\n      if (e.key === 'g') {\n        props.dispatch({ pause: true })\n        const measure = +(\n          prompt(\n            'Measure number',\n            rememberedMeasureNumber ? `${rememberedMeasureNumber}` : ''\n          ) || ''\n        )\n        if (!isNaN(measure)) {\n          rememberedMeasureNumber = measure\n          props.dispatch({\n            jumpToTime: {\n              time: getLatestNotechartPreview().measureToSeconds(measure),\n            },\n          })\n        }\n        e.preventDefault()\n      }\n      if (e.key === 'r' && !e.ctrlKey && !e.metaKey) {\n        props.onReload()\n        e.preventDefault()\n      }\n      if (e.key === 'ArrowDown') {\n        props.dispatch({\n          jumpByMeasure: {\n            direction: -1,\n            preview: getLatestNotechartPreview(),\n          },\n        })\n        e.preventDefault()\n      }\n      if (e.key === 'ArrowUp') {\n        props.dispatch({\n          jumpByMeasure: {\n            direction: 1,\n            preview: getLatestNotechartPreview(),\n          },\n        })\n        e.preventDefault()\n      }\n      if (e.key === 'ArrowLeft') {\n        props.dispatch({\n          jumpBySeconds: { direction: -5 },\n        })\n        e.preventDefault()\n      }\n      if (e.key === 'ArrowRight') {\n        props.dispatch({\n          jumpBySeconds: { direction: 5 },\n        })\n        e.preventDefault()\n      }\n      if (e.key === ',') {\n        props.dispatch({\n          jumpBySeconds: { direction: -1 / 10 },\n        })\n        e.preventDefault()\n      }\n      if (e.key === '.') {\n        props.dispatch({\n          jumpBySeconds: { direction: 1 / 10 },\n        })\n        e.preventDefault()\n      }\n    }\n    window.addEventListener('keydown', onKeyDown)\n    return () => {\n      window.removeEventListener('keydown', onKeyDown)\n    }\n  }, [props.dispatch])\n  return null\n}\n","import { useCallback, useEffect, useRef } from 'react'\n\nexport function useLatest<T>(value: T): () => T {\n  const ref = useRef(value)\n  useEffect(() => {\n    ref.current = value\n  }, [value])\n  return useCallback(() => ref.current, [])\n}\n","import './BemusePreviewer.scss'\nimport React, { useEffect, useReducer, useRef, useState } from 'react'\nimport { PreviewCanvas } from './PreviewCanvas'\nimport { PreviewInfo } from './PreviewInfo'\nimport { PreviewFileDropHandler } from './PreviewFileDropHandler'\nimport { getSavedPreviewInfo, loadPreview, setPreview } from './PreviewLoader'\nimport {\n  createNullNotechartPreview,\n  NotechartPreview,\n  NotechartPreviewPlayer,\n} from './NotechartPreview'\nimport {\n  PreviewAction,\n  PreviewState,\n  previewStateReducer,\n} from './PreviewState'\nimport { PreviewKeyHandler } from './PreviewKeyHandler'\nimport { showAlert, showQuickPick } from 'bemuse/ui-dialogs'\nimport _ from 'lodash'\n\nexport const BemusePreviewer = () => {\n  const div = useRef<HTMLDivElement>(null)\n  const [previewState, dispatch] = useReducer(previewStateReducer, {\n    currentTime: 0,\n    hiSpeed: 1,\n    playing: false,\n  })\n\n  const [notechartPreview, setNotechartPreview] = useState(\n    createNullNotechartPreview\n  )\n\n  const [loading, setLoading] = useState<null | string>(null)\n\n  const reload = () => {\n    setLoading('Loading...')\n    const setLoadingDebounced = _.throttle(setLoading, 100)\n    loadPreview({\n      log: (message) => {\n        setLoadingDebounced((x) => (x != null ? message : x))\n      },\n    })\n      .then((preview) => {\n        setNotechartPreview(preview)\n        dispatch({ loaded: true })\n        if (div.current) {\n          div.current.focus()\n        }\n      })\n      .catch((error) => {\n        console.error(error)\n        showAlert('Error loading preview', String(error))\n      })\n      .finally(() => setLoadingDebounced(null))\n  }\n\n  usePreviewPlayer(previewState, dispatch, notechartPreview)\n\n  useEffect(() => {\n    ;(async () => {\n      const savedPreviewInfo = await getSavedPreviewInfo()\n      if (savedPreviewInfo) {\n        const choices: { label: string; action: () => void }[] = [\n          {\n            label: `Load ${savedPreviewInfo.chartFilename}`,\n            action: () => {\n              reload()\n            },\n          },\n          {\n            label: 'Do not load',\n            action: () => {},\n          },\n        ]\n        const chosenChoice = await showQuickPick(choices, {\n          title: 'Load a recent song?',\n        })\n        chosenChoice.action()\n      }\n    })()\n  }, [])\n\n  const onDrop = async (\n    handle: FileSystemDirectoryHandle,\n    selectedChartFilename: string\n  ) => {\n    await setPreview(handle, selectedChartFilename)\n    reload()\n  }\n\n  const onReload = () => {\n    reload()\n  }\n\n  return (\n    <div className='BemusePreviewer' tabIndex={0} ref={div}>\n      <div className='BemusePreviewerheader'>\n        <h1>\n          <a\n            href='https://bemuse.ninja/project/docs/previewer.html'\n            target='_blank'\n            rel='noreferrer'\n          >\n            <strong>Bemuse</strong>s BMS/bmson previewer\n          </a>\n        </h1>\n      </div>\n      <div className='BemusePreviewermain'>\n        <PreviewCanvas\n          notechartPreview={notechartPreview}\n          previewState={previewState}\n        />\n        <PreviewInfo\n          notechartPreview={notechartPreview}\n          previewState={previewState}\n        />\n        <PreviewFileDropHandler onDrop={onDrop} />\n        <PreviewKeyHandler\n          notechartPreview={notechartPreview}\n          dispatch={dispatch}\n          onReload={onReload}\n        />\n      </div>\n      {loading != null ? (\n        <div className='BemusePreviewerloading'>{loading}</div>\n      ) : null}\n    </div>\n  )\n}\n\nfunction usePreviewPlayer(\n  state: PreviewState,\n  dispatch: React.Dispatch<PreviewAction>,\n  notechartPreview: NotechartPreview\n) {\n  const playerRef = useRef<NotechartPreviewPlayer | null>(null)\n\n  useEffect(() => {\n    if (state.playing && playerRef.current === null) {\n      playerRef.current = notechartPreview.play({\n        startTime: state.currentTime,\n        onFinish: () => {\n          dispatch({ playFinish: true })\n        },\n        onTimeUpdate: (t) => {\n          dispatch({ updateTime: { time: t } })\n        },\n      })\n    } else if (!state.playing && playerRef.current !== null) {\n      playerRef.current.stop()\n      playerRef.current = null\n    }\n  }, [state])\n}\n","import React from 'react'\nimport _ from 'lodash'\nimport MAIN from 'bemuse/utils/main-element'\nimport ReactDOM from 'react-dom'\nimport { BemusePreviewer } from './BemusePreviewer'\n\nexport function main() {\n  ReactDOM.render(<BemusePreviewer />, MAIN)\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getReaderOptionsFromFilename = exports.readAsync = exports.read = void 0;\nvar chardet = require(\"bemuse-chardet/bemuse-chardet\");\nfunction read(buffer) {\n    throw new Error('Synchronous read unsupported in browser!');\n}\nexports.read = read;\nfunction readAsync() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var buffer = args[0];\n    var options = args[1];\n    var charset = (options && options.forceEncoding) || chardet.detect(buffer);\n    return new Promise(function (resolve, reject) {\n        var reader = new FileReader();\n        reader.onload = function () {\n            resolve(reader.result);\n        };\n        reader.onerror = function () {\n            reject(new Error('cannot read it'));\n        };\n        reader.readAsText(new Blob([buffer]), charset);\n    });\n}\nexports.readAsync = readAsync;\nvar getReaderOptionsFromFilename_1 = require(\"./getReaderOptionsFromFilename\");\nObject.defineProperty(exports, \"getReaderOptionsFromFilename\", { enumerable: true, get: function () { return getReaderOptionsFromFilename_1.getReaderOptionsFromFilename; } });\n//# sourceMappingURL=index.web.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getReaderOptionsFromFilename = void 0;\n/**\n * Given the filename, returns the reader options.\n * @param {string} filename\n */\nfunction getReaderOptionsFromFilename(filename) {\n    var forceEncoding;\n    if (filename.match(/\\.sjis\\.\\w+$/i)) {\n        forceEncoding = 'Shift-JIS';\n    }\n    if (filename.match(/\\.euc_kr\\.\\w+$/i)) {\n        forceEncoding = 'EUC-KR';\n    }\n    if (filename.match(/\\.utf8\\.\\w+$/i)) {\n        forceEncoding = 'UTF-8';\n    }\n    return { forceEncoding: forceEncoding };\n}\nexports.getReaderOptionsFromFilename = getReaderOptionsFromFilename;\n//# sourceMappingURL=getReaderOptionsFromFilename.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.compile = void 0;\n// Public: A module that takes a string representing the BMS notechart,\n// parses it, and compiles into a {BMSChart}.\n/* module */\nvar match_1 = require(\"../util/match\");\nvar chart_1 = require(\"../bms/chart\");\nvar matchers = {\n    bms: {\n        random: /^#RANDOM\\s+(\\d+)$/i,\n        if: /^#IF\\s+(\\d+)$/i,\n        endif: /^#ENDIF$/i,\n        timeSignature: /^#(\\d\\d\\d)02:(\\S*)$/,\n        channel: /^#(?:EXT\\s+#)?(\\d\\d\\d)(\\S\\S):(\\S*)$/,\n        header: /^#(\\w+)(?:\\s+(\\S.*))?$/,\n    },\n    dtx: {\n        random: /^#RANDOM\\s+(\\d+)$/i,\n        if: /^#IF\\s+(\\d+)$/i,\n        endif: /^#ENDIF$/i,\n        timeSignature: /^#(\\d\\d\\d)02:\\s*(\\S*)$/,\n        channel: /^#(?:EXT\\s+#)?(\\d\\d\\d)(\\S\\S):\\s*(\\S*)$/,\n        header: /^#(\\w+):(?:\\s+(\\S.*))?$/,\n    },\n};\n/**\n * Reads the string representing the BMS notechart, parses it,\n * and compiles into a {BMSChart}.\n * @param text the BMS notechart\n * @param options additional parser options\n */\nfunction compile(text, options) {\n    options = options || {};\n    var chart = new chart_1.BMSChart();\n    var rng = options.rng ||\n        function (max) {\n            return 1 + Math.floor(Math.random() * max);\n        };\n    var matcher = (options.format && matchers[options.format]) || matchers.bms;\n    var randomStack = [];\n    var skipStack = [false];\n    var result = {\n        headerSentences: 0,\n        channelSentences: 0,\n        controlSentences: 0,\n        skippedSentences: 0,\n        malformedSentences: 0,\n        /**\n         * The resulting chart\n         */\n        chart: chart,\n        /**\n         * Warnings found during compilation\n         */\n        warnings: [],\n    };\n    eachLine(text, function (text, lineNumber) {\n        var flow = true;\n        if (text.charAt(0) !== '#')\n            return;\n        (0, match_1.match)(text)\n            .when(matcher.random, function (m) {\n            result.controlSentences += 1;\n            randomStack.push(rng(+m[1]));\n        })\n            .when(matcher.if, function (m) {\n            result.controlSentences += 1;\n            skipStack.push(randomStack[randomStack.length - 1] !== +m[1]);\n        })\n            .when(matcher.endif, function (m) {\n            result.controlSentences += 1;\n            skipStack.pop();\n        })\n            .else(function () {\n            flow = false;\n        });\n        if (flow)\n            return;\n        var skipped = skipStack[skipStack.length - 1];\n        (0, match_1.match)(text)\n            .when(matcher.timeSignature, function (m) {\n            result.channelSentences += 1;\n            if (!skipped)\n                chart.timeSignatures.set(+m[1], +m[2]);\n        })\n            .when(matcher.channel, function (m) {\n            result.channelSentences += 1;\n            if (!skipped)\n                handleChannelSentence(+m[1], m[2], m[3], lineNumber);\n        })\n            .when(matcher.header, function (m) {\n            result.headerSentences += 1;\n            if (!skipped)\n                chart.headers.set(m[1], m[2]);\n        })\n            .else(function () {\n            warn(lineNumber, 'Invalid command');\n        });\n    });\n    return result;\n    function handleChannelSentence(measure, channel, string, lineNumber) {\n        var items = Math.floor(string.length / 2);\n        if (items === 0)\n            return;\n        for (var i = 0; i < items; i++) {\n            var value = string.substr(i * 2, 2);\n            var fraction = i / items;\n            if (value === '00')\n                continue;\n            chart.objects.add({\n                measure: measure,\n                fraction: fraction,\n                value: value,\n                channel: channel,\n                lineNumber: lineNumber,\n            });\n        }\n    }\n    function warn(lineNumber, message) {\n        result.warnings.push({\n            lineNumber: lineNumber,\n            message: message,\n        });\n    }\n}\nexports.compile = compile;\nfunction eachLine(text, callback) {\n    text\n        .split(/\\r\\n|\\r|\\n/)\n        .map(function (line) {\n        return line.trim();\n    })\n        .forEach(function (line, index) {\n        callback(line, index + 1);\n    });\n}\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=types.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Segment = void 0;\nvar data_structure_1 = __importDefault(require(\"data-structure\"));\nexports.Segment = (0, data_structure_1.default)({\n    t: 'number',\n    x: 'number',\n    dx: 'number',\n});\n//# sourceMappingURL=segment.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Notes = void 0;\nvar note_1 = require(\"./note\");\nvar invariant_1 = __importDefault(require(\"invariant\"));\nvar ChannelMapping = __importStar(require(\"./channels\"));\nvar chart_1 = require(\"../bms/chart\");\n/**\n * A Notes holds the {Note} objects in the game.\n * A note object may or may not be playable.\n *\n * ## Example\n *\n * If you have a BMS like this:\n *\n * ```\n * #00111:AA\n * ```\n *\n * Having parsed it using a {Compiler} into a {BMSChart},\n * you can create a {Notes} using `fromBMSChart()`:\n *\n * ```js\n * var notes = Notes.fromBMSChart(bmsChart)\n * ```\n *\n * Then you can get all notes using `.all()` method\n *\n * ```js\n * notes.all()\n * ```\n */\nvar Notes = /** @class */ (function () {\n    /**\n     * @param {BMSNote[]} notes An array of Note objects\n     */\n    function Notes(notes) {\n        notes.forEach(note_1.Note);\n        this._notes = notes;\n    }\n    /**\n     * Returns the number of notes in this object,\n     * counting both playable and non-playable notes.\n     */\n    Notes.prototype.count = function () {\n        return this._notes.length;\n    };\n    /**\n     * Returns an Array of all notes.\n     */\n    Notes.prototype.all = function () {\n        return this._notes.slice();\n    };\n    /**\n     * Creates a Notes object from a BMSChart.\n     * @param chart the chart to process\n     * @param options options\n     */\n    Notes.fromBMSChart = function (chart, options) {\n        void chart_1.BMSChart;\n        options = options || {};\n        var mapping = options.mapping || Notes.CHANNEL_MAPPING.IIDX_P1;\n        var builder = new BMSNoteBuilder(chart, { mapping: mapping });\n        return builder.build();\n    };\n    Notes.CHANNEL_MAPPING = ChannelMapping;\n    return Notes;\n}());\nexports.Notes = Notes;\nvar BMSNoteBuilder = /** @class */ (function () {\n    function BMSNoteBuilder(chart, options) {\n        this._chart = chart;\n        (0, invariant_1.default)(options.mapping, 'Expected options.mapping');\n        (0, invariant_1.default)(typeof options.mapping === 'object', 'options.mapping must be object');\n        this._mapping = options.mapping;\n        this._notes = [];\n        this._activeLN = {};\n        this._lastNote = {};\n        this._lnObj = (this._chart.headers.get('lnobj') || '').toLowerCase();\n        this._channelMapping = this._mapping;\n        this._objects = this._chart.objects.allSorted();\n    }\n    BMSNoteBuilder.prototype.build = function () {\n        var _this = this;\n        this._objects.forEach(function (object) {\n            _this._handle(object);\n        });\n        return new Notes(this._notes);\n    };\n    BMSNoteBuilder.prototype._handle = function (object) {\n        if (object.channel === '01') {\n            this._handleNormalNote(object);\n        }\n        else {\n            switch (object.channel.charAt(0).toUpperCase()) {\n                case '1':\n                case '2':\n                case 'D':\n                case 'E':\n                    this._handleNormalNote(object);\n                    break;\n                case '5':\n                case '6':\n                    this._handleLongNote(object);\n                    break;\n            }\n        }\n    };\n    BMSNoteBuilder.prototype._handleNormalNote = function (object) {\n        var channel = this._normalizeChannel(object.channel);\n        var beat = this._getBeat(object);\n        if (object.value.toLowerCase() === this._lnObj) {\n            if (this._lastNote[channel]) {\n                this._lastNote[channel].endBeat = beat;\n            }\n        }\n        else {\n            var note = {\n                beat: beat,\n                endBeat: undefined,\n                keysound: object.value,\n                column: this._getColumn(channel),\n            };\n            this._lastNote[channel] = note;\n            this._notes.push(note);\n        }\n    };\n    BMSNoteBuilder.prototype._handleLongNote = function (object) {\n        var channel = this._normalizeChannel(object.channel);\n        var beat = this._getBeat(object);\n        if (this._activeLN[channel]) {\n            var note = this._activeLN[channel];\n            note.endBeat = beat;\n            this._notes.push(note);\n            delete this._activeLN[channel];\n        }\n        else {\n            this._activeLN[channel] = {\n                beat: beat,\n                keysound: object.value,\n                column: this._getColumn(channel),\n            };\n        }\n    };\n    BMSNoteBuilder.prototype._getBeat = function (object) {\n        return this._chart.measureToBeat(object.measure, object.fraction);\n    };\n    BMSNoteBuilder.prototype._getColumn = function (channel) {\n        return this._channelMapping[channel];\n    };\n    BMSNoteBuilder.prototype._normalizeChannel = function (channel) {\n        return channel.replace(/^5/, '1').replace(/^6/, '2');\n    };\n    return BMSNoteBuilder;\n}());\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Note = void 0;\nvar data_structure_1 = __importDefault(require(\"data-structure\"));\nexports.Note = (0, data_structure_1.default)({\n    beat: 'number',\n    endBeat: data_structure_1.default.maybe('number'),\n    column: data_structure_1.default.maybe('string'),\n    keysound: 'string',\n});\n//# sourceMappingURL=note.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IIDX_DP_LANDMINE = exports.IIDX_P1_LANDMINE = exports.IIDX_DP = exports.IIDX_P1 = void 0;\nexports.IIDX_P1 = {\n    '11': '1',\n    '12': '2',\n    '13': '3',\n    '14': '4',\n    '15': '5',\n    '18': '6',\n    '19': '7',\n    '16': 'SC',\n};\nexports.IIDX_DP = {\n    '11': '1',\n    '12': '2',\n    '13': '3',\n    '14': '4',\n    '15': '5',\n    '18': '6',\n    '19': '7',\n    '16': 'SC',\n    '21': '8',\n    '22': '9',\n    '23': '10',\n    '24': '11',\n    '25': '12',\n    '28': '13',\n    '29': '14',\n    '26': 'SC2',\n};\nexports.IIDX_P1_LANDMINE = {\n    D1: '1',\n    D2: '2',\n    D3: '3',\n    D4: '4',\n    D5: '5',\n    D8: '6',\n    D9: '7',\n    D6: 'SC',\n};\nexports.IIDX_DP_LANDMINE = {\n    D1: '1',\n    D2: '2',\n    D3: '3',\n    D4: '4',\n    D5: '5',\n    D8: '6',\n    D9: '7',\n    D6: 'SC',\n    E1: '8',\n    E2: '9',\n    E3: '10',\n    E4: '11',\n    E5: '12',\n    E8: '13',\n    E9: '14',\n    E6: 'SC2',\n};\n//# sourceMappingURL=channels.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Timing = void 0;\nvar speedcore_1 = require(\"../speedcore\");\nvar lodash_1 = require(\"../util/lodash\");\nvar chart_1 = require(\"../bms/chart\");\nvar precedence = { bpm: 1, stop: 2 };\n/**\n * A Timing represents the timing information of a musical score.\n * A Timing object provides facilities to synchronize between\n * metric time (seconds) and musical time (beats).\n *\n * A Timing are created from a series of actions:\n *\n * - BPM changes.\n * - STOP action.\n */\nvar Timing = /** @class */ (function () {\n    /**\n     * Constructs a Timing with an initial BPM and specified actions.\n     *\n     * Generally, you would use `Timing.fromBMSChart` to create an instance\n     * from a BMSChart, but the constructor may also be used in other situations\n     * unrelated to the BMS file format. (e.g. bmson package)\n     */\n    function Timing(initialBPM, actions) {\n        var state = { bpm: initialBPM, beat: 0, seconds: 0 };\n        var segments = [];\n        segments.push({\n            t: 0,\n            x: 0,\n            dx: state.bpm / 60,\n            bpm: state.bpm,\n            inclusive: true,\n        });\n        actions = actions.slice();\n        actions.sort(function (a, b) {\n            return a.beat - b.beat || precedence[a.type] - precedence[b.type];\n        });\n        actions.forEach(function (action) {\n            var beat = action.beat;\n            var seconds = state.seconds + ((beat - state.beat) * 60) / state.bpm;\n            switch (action.type) {\n                case 'bpm':\n                    state.bpm = action.bpm;\n                    segments.push({\n                        t: seconds,\n                        x: beat,\n                        dx: state.bpm / 60,\n                        bpm: state.bpm,\n                        inclusive: true,\n                    });\n                    break;\n                case 'stop':\n                    segments.push({\n                        t: seconds,\n                        x: beat,\n                        dx: 0,\n                        bpm: state.bpm,\n                        inclusive: true,\n                    });\n                    seconds += ((action.stopBeats || 0) * 60) / state.bpm;\n                    segments.push({\n                        t: seconds,\n                        x: beat,\n                        dx: state.bpm / 60,\n                        bpm: state.bpm,\n                        inclusive: false,\n                    });\n                    break;\n                default:\n                    throw new Error('Unrecognized segment object!');\n            }\n            state.beat = beat;\n            state.seconds = seconds;\n        });\n        this._speedcore = new speedcore_1.Speedcore(segments);\n        this._eventBeats = (0, lodash_1.uniq)((0, lodash_1.map)(actions, function (action) { return action.beat; }));\n    }\n    /**\n     * Convert the given beat into seconds.\n     * @param {number} beat\n     */\n    Timing.prototype.beatToSeconds = function (beat) {\n        return this._speedcore.t(beat);\n    };\n    /**\n     * Convert the given second into beats.\n     * @param {number} seconds\n     */\n    Timing.prototype.secondsToBeat = function (seconds) {\n        return this._speedcore.x(seconds);\n    };\n    /**\n     * Returns the BPM at the specified beat.\n     * @param {number} beat\n     */\n    Timing.prototype.bpmAtBeat = function (beat) {\n        return this._speedcore.segmentAtX(beat).bpm;\n    };\n    /**\n     * Returns an array representing the beats where there are events.\n     */\n    Timing.prototype.getEventBeats = function () {\n        return this._eventBeats;\n    };\n    /**\n     * Creates a Timing instance from a BMSChart.\n     * @param {BMSChart} chart\n     */\n    Timing.fromBMSChart = function (chart) {\n        void chart_1.BMSChart;\n        var actions = [];\n        chart.objects.all().forEach(function (object) {\n            var bpm;\n            var beat = chart.measureToBeat(object.measure, object.fraction);\n            if (object.channel === '03') {\n                bpm = parseInt(object.value, 16);\n                actions.push({ type: 'bpm', beat: beat, bpm: bpm });\n            }\n            else if (object.channel === '08') {\n                bpm = +chart.headers.get('bpm' + object.value);\n                if (!isNaN(bpm))\n                    actions.push({ type: 'bpm', beat: beat, bpm: bpm });\n            }\n            else if (object.channel === '09') {\n                var stopBeats = +chart.headers.get('stop' + object.value) / 48;\n                actions.push({ type: 'stop', beat: beat, stopBeats: stopBeats });\n            }\n        });\n        return new Timing(+chart.headers.get('bpm') || 60, actions);\n    };\n    return Timing;\n}());\nexports.Timing = Timing;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SongInfo = void 0;\nvar match_1 = require(\"../util/match\");\nvar lodash_1 = require(\"../util/lodash\");\nvar chart_1 = require(\"../bms/chart\");\n/**\n * A SongInfo represents the song info, such as title, artist, genre.\n *\n * ## Example\n *\n * If you have a BMS like this:\n *\n * ```\n * #TITLE Exargon [HYPER]\n * ```\n *\n * Having parsed it using a {Compiler} into a {BMSChart},\n * you can create a {SongInfo} using `fromBMSChart()`:\n *\n * ```js\n * var info = SongInfo.fromBMSChart(bmsChart)\n * ```\n *\n * Then you can query the song information by accessing its properties.\n *\n * ```js\n * info.title     // => 'Exargon'\n * info.subtitles // => ['HYPER']\n * ```\n */\nvar SongInfo = /** @class */ (function () {\n    /**\n     * Constructs a SongInfo with given data\n     * @param info the properties to set on this new instance\n     */\n    function SongInfo(info) {\n        /** the song title */\n        this.title = 'NO TITLE';\n        /** the song artist */\n        this.artist = 'NO ARTIST';\n        /** the song genre */\n        this.genre = 'NO GENRE';\n        /**\n         * the song's subtitles, one line per element.\n         * The subtitle may be used to represent the difficulty name,\n         * such as NORMAL, HYPER, ANOTHER.\n         * @type {string[]}\n         */\n        this.subtitles = [];\n        /**\n         * the song's other artists, one artist per element.\n         * @type {string[]}\n         */\n        this.subartists = [];\n        /**\n         * the difficulty.\n         * Meaning of the number is same as BMS's [`#DIFFICULTY`](http:*hitkey.nekokan.dyndns.info/cmds.htm#DIFFICULTY) header.\n         *\n         * | difficulty | meaning  |\n         * | ----------:|:--------:|\n         * |          1 | BEGINNER |\n         * |          2 | NORMAL   |\n         * |          3 | HYPER    |\n         * |          4 | ANOTHER  |\n         * |          5 | INSANE   |\n         */\n        this.difficulty = 0;\n        /**\n         * the level of the song.\n         * When converted from a BMS chart, this is the value of `#PLAYLEVEL` header.\n         */\n        this.level = 0;\n        if (info)\n            (0, lodash_1.assign)(this, info);\n    }\n    /**\n     * Constructs a new {SongInfo} object from a {BMSChart}.\n     * @param chart A {BMSChart} to construct a {SongInfo} from\n     */\n    SongInfo.fromBMSChart = function (chart) {\n        void chart_1.BMSChart;\n        var info = {};\n        var title = chart.headers.get('title');\n        var artist = chart.headers.get('artist');\n        var genre = chart.headers.get('genre');\n        var difficulty = +chart.headers.get('difficulty') || 0;\n        var level = +chart.headers.get('playlevel') || 0;\n        var subtitles = chart.headers.getAll('subtitle');\n        var subartists = chart.headers.getAll('subartist');\n        if (typeof title === 'string' && !subtitles) {\n            var extractSubtitle = function (m) {\n                title = m[1];\n                subtitles = [m[2]];\n            };\n            (0, match_1.match)(title)\n                .when(/^(.*\\S)\\s*-(.+?)-$/, extractSubtitle)\n                .when(/^(.*\\S)\\s*(.+?)$/, extractSubtitle)\n                .when(/^(.*\\S)\\s*\\((.+?)\\)$/, extractSubtitle)\n                .when(/^(.*\\S)\\s*\\[(.+?)\\]$/, extractSubtitle)\n                .when(/^(.*\\S)\\s*<(.+?)>$/, extractSubtitle);\n        }\n        if (title)\n            info.title = title;\n        if (artist)\n            info.artist = artist;\n        if (genre)\n            info.genre = genre;\n        if (subtitles)\n            info.subtitles = subtitles;\n        if (subartists)\n            info.subartists = subartists;\n        if (difficulty)\n            info.difficulty = difficulty;\n        if (level)\n            info.level = level;\n        return new SongInfo(info);\n    };\n    return SongInfo;\n}());\nexports.SongInfo = SongInfo;\n//# sourceMappingURL=index.js.map","\"use strict\";\n// Public: A module that exposes {Keysounds}\n/* module */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Keysounds = void 0;\nvar lodash_1 = require(\"../util/lodash\");\nvar chart_1 = require(\"../bms/chart\");\n/**\n * A simple mapping between keysounds ID and the file name.\n * ## Example\n *\n * If you have a BMS like this:\n *\n * ```\n * #WAVAA cat.wav\n * ```\n *\n * Having parsed it using a {Compiler} into a {BMSChart},\n * you can create a {Keysounds} using `fromBMSChart()`:\n *\n * ```js\n * var keysounds = Keysounds.fromBMSChart(bmsChart)\n * ```\n *\n * Then you can retrieve the filename using `.get()`:\n *\n * ```js\n * keysounds.get('aa') // => 'cat.wav'\n * ```\n */\nvar Keysounds = /** @class */ (function () {\n    function Keysounds(map) {\n        this._map = map;\n    }\n    /**\n     * Returns the keysound file at the specified ID.\n     * @param id the two-character keysound ID\n     * @returns the sound filename\n     */\n    Keysounds.prototype.get = function (id) {\n        return this._map[id.toLowerCase()];\n    };\n    /**\n     * Returns an array of unique filenames in this Keysounds object.\n     * @returns filenames array\n     */\n    Keysounds.prototype.files = function () {\n        return (0, lodash_1.uniq)((0, lodash_1.values)(this._map));\n    };\n    /**\n     * Returns a mapping from keysound ID to keysound filename.\n     *\n     * **Warning:** This method returns the internal data structure used\n     * in this Keysounds object. Do not mutate!\n     */\n    Keysounds.prototype.all = function () {\n        return this._map;\n    };\n    /**\n     * Constructs a new {Keysounds} object from a {BMSChart}.\n     * @param chart\n     */\n    Keysounds.fromBMSChart = function (chart) {\n        void chart_1.BMSChart;\n        var map = {};\n        chart.headers.each(function (name, value) {\n            var match = name.match(/^wav(\\S\\S)$/i);\n            if (!match)\n                return;\n            map[match[1].toLowerCase()] = value;\n        });\n        return new Keysounds(map);\n    };\n    return Keysounds;\n}());\nexports.Keysounds = Keysounds;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Positioning = void 0;\nvar speedcore_1 = require(\"../speedcore\");\nvar chart_1 = require(\"../bms/chart\");\n/**\n * A Positioning represents the relation between song beats and\n * display position, and provides a way to convert between them.\n *\n * In some rhythm games, the amount of scrolling per beat may be different.\n * StepManias `#SCROLL` segments is an example.\n */\nvar Positioning = /** @class */ (function () {\n    /**\n     * Constructs a Positioning from the given `segments`.\n     * @param segments\n     */\n    function Positioning(segments) {\n        this._speedcore = new speedcore_1.Speedcore(segments);\n    }\n    /**\n     * Returns the scrolling speed at specified beat.\n     * @param beat the beat number\n     */\n    Positioning.prototype.speed = function (beat) {\n        return this._speedcore.dx(beat);\n    };\n    /**\n     * Returns the total elapsed scrolling amount at specified beat.\n     * @param beat the beat number\n     */\n    Positioning.prototype.position = function (beat) {\n        return this._speedcore.x(beat);\n    };\n    /**\n     * Creates a {Positioning} object from the {BMSChart}.\n     * @param {BMSChart} chart A {BMSChart} to construct a {Positioning} from\n     */\n    Positioning.fromBMSChart = function (chart) {\n        void chart_1.BMSChart;\n        var segments = [];\n        var x = 0;\n        segments.push({\n            t: 0,\n            x: x,\n            dx: 1,\n            inclusive: true,\n        });\n        chart.objects.allSorted().forEach(function (object) {\n            if (object.channel === 'SC') {\n                var beat = chart.measureToBeat(object.measure, object.fraction);\n                var dx = +chart.headers.get('scroll' + object.value);\n                if (isNaN(dx))\n                    return;\n                var previous = segments[segments.length - 1];\n                x += (beat - previous.t) * previous.dx;\n                if (beat === 0 && segments.length === 1) {\n                    segments[0].dx = dx;\n                }\n                else {\n                    segments.push({\n                        t: beat,\n                        x: x,\n                        dx: dx,\n                        inclusive: true,\n                    });\n                }\n            }\n        });\n        return new Positioning(segments);\n    };\n    return Positioning;\n}());\nexports.Positioning = Positioning;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Spacing = void 0;\nvar speedcore_1 = require(\"../speedcore\");\nvar chart_1 = require(\"../bms/chart\");\n/**\n * Public: A Spacing represents the relation between song beats and\n * notes spacing.\n *\n * In some rhythm games, such as Pump It Up!,\n * the speed (note spacing factor) may be adjusted by the notechart.\n * StepManias `#SPEED` segments is an example.\n */\nvar Spacing = /** @class */ (function () {\n    /**\n     * Constructs a Spacing from the given `segments`.\n     */\n    function Spacing(segments) {\n        if (segments.length > 0) {\n            this._speedcore = new speedcore_1.Speedcore(segments);\n        }\n    }\n    /**\n     * Returns the note spacing factor at the specified beat.\n     * @param beat the beat\n     */\n    Spacing.prototype.factor = function (beat) {\n        if (this._speedcore) {\n            return this._speedcore.x(beat);\n        }\n        else {\n            return 1;\n        }\n    };\n    /**\n     * Creates a {Spacing} object from the {BMSChart}.\n     *\n     * ## `#SPEED` and `#xxxSP`\n     *\n     * Speed is defined as keyframes. These keyframes will be linearly interpolated.\n     *\n     * ```\n     * #SPEED01 1.0\n     * #SPEED02 2.0\n     *\n     * #001SP:01010202\n     * ```\n     *\n     * In this example, the note spacing factor will gradually change\n     * from 1.0x at beat 1 to 2.0x at beat 2.\n     *\n     * Returns a {Spacing} object\n     *\n     * @param {BMSChart} chart the chart\n     */\n    Spacing.fromBMSChart = function (chart) {\n        void chart_1.BMSChart;\n        var segments = [];\n        chart.objects.allSorted().forEach(function (object) {\n            if (object.channel === 'SP') {\n                var beat = chart.measureToBeat(object.measure, object.fraction);\n                var factor = +chart.headers.get('speed' + object.value);\n                if (isNaN(factor))\n                    return;\n                if (segments.length > 0) {\n                    var previous = segments[segments.length - 1];\n                    previous.dx = (factor - previous.x) / (beat - previous.t);\n                }\n                segments.push({\n                    t: beat,\n                    x: factor,\n                    dx: 0,\n                    inclusive: true,\n                });\n            }\n        });\n        if (segments.length > 0) {\n            segments.unshift({\n                t: 0,\n                x: segments[0].x,\n                dx: 0,\n                inclusive: true,\n            });\n        }\n        return new Spacing(segments);\n    };\n    return Spacing;\n}());\nexports.Spacing = Spacing;\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fromBMSChart = void 0;\nvar BMS = __importStar(require(\"bms\"));\nvar lodash_1 = __importDefault(require(\"lodash\"));\nvar __1 = __importDefault(require(\"../\"));\n// Returns a new Notechart from a BMSChart.\nfunction fromBMSChart(bms, playerOptions) {\n    var notes = BMS.Notes.fromBMSChart(bms, {\n        mapping: playerOptions.double\n            ? BMS.Notes.CHANNEL_MAPPING.IIDX_DP\n            : BMS.Notes.CHANNEL_MAPPING.IIDX_P1,\n    }).all();\n    var landmineNotes = BMS.Notes.fromBMSChart(bms, {\n        mapping: playerOptions.double\n            ? BMS.Notes.CHANNEL_MAPPING.IIDX_DP_LANDMINE\n            : BMS.Notes.CHANNEL_MAPPING.IIDX_P1_LANDMINE,\n    }).all();\n    var timing = BMS.Timing.fromBMSChart(bms);\n    var keysounds = BMS.Keysounds.fromBMSChart(bms);\n    var songInfo = BMS.SongInfo.fromBMSChart(bms);\n    var positioning = BMS.Positioning.fromBMSChart(bms);\n    var spacing = BMS.Spacing.fromBMSChart(bms);\n    var data = {\n        notes: notes,\n        landmineNotes: landmineNotes,\n        timing: timing,\n        keysounds: keysounds,\n        songInfo: songInfo,\n        positioning: positioning,\n        spacing: spacing,\n        barLines: generateBarLinesFromBMS(notes, bms),\n        expertJudgmentWindow: getJudgmentWindowFromBMS(bms),\n    };\n    return new __1.default(data, playerOptions);\n}\nexports.fromBMSChart = fromBMSChart;\nfunction getJudgmentWindowFromBMS(bms) {\n    // http://hitkey.nekokan.dyndns.info/diary1501.php\n    var rank = +bms.headers.get('rank') || 2;\n    if (rank === 0)\n        return [8, 24]; // Very Hard\n    if (rank === 1)\n        return [15, 30]; // Hard\n    if (rank === 3)\n        return [21, 60]; // Easy\n    return [18, 40]; // Normal\n}\nfunction generateBarLinesFromBMS(bmsNotes, bms) {\n    var max = lodash_1.default.max(bmsNotes.map(function (note) { return note.endBeat || note.beat; })) || 0;\n    var barLines = [0];\n    var currentBeat = 0;\n    var currentMeasure = 0;\n    do {\n        currentBeat += bms.timeSignatures.getBeats(currentMeasure);\n        currentMeasure += 1;\n        barLines.push(currentBeat);\n    } while (currentBeat <= max);\n    return barLines;\n}\n//# sourceMappingURL=BMSNotechartLoader.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=types.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._slicesForNotesAndTiming = exports.beatForLoc = exports.timingInfoForBmson = exports.barLinesForBmson = void 0;\nvar lodash_1 = __importDefault(require(\"lodash\"));\nvar utils = __importStar(require(\"./utils\"));\nfunction barLinesForBmson(bmson) {\n    var lines = bmson.lines;\n    return (0, lodash_1.default)(lines)\n        .map(function (_a) {\n        var y = _a.y;\n        return beatForLoc(y);\n    })\n        .sortBy()\n        .value();\n}\nexports.barLinesForBmson = barLinesForBmson;\nfunction timingInfoForBmson(bmson) {\n    return {\n        initialBPM: bmson.info.initBPM,\n        actions: __spreadArray(__spreadArray([], __read((bmson.bpmNotes || []).map(function (_a) {\n            var y = _a.y, v = _a.v;\n            return ({\n                type: 'bpm',\n                beat: beatForLoc(y),\n                bpm: v,\n            });\n        })), false), __read((bmson.stopNotes || []).map(function (_a) {\n            var y = _a.y, v = _a.v;\n            return ({\n                type: 'stop',\n                beat: beatForLoc(y),\n                stopBeats: beatForLoc(Math.floor(v)),\n            });\n        })), false),\n    };\n}\nexports.timingInfoForBmson = timingInfoForBmson;\nfunction beatForLoc(y) {\n    return y / 240;\n}\nexports.beatForLoc = beatForLoc;\nfunction slicesForNotesAndTiming(notes, timing) {\n    return utils.slicesForNotesAndTiming(notes, timing, {\n        beatForPulse: beatForLoc,\n    });\n}\nexports._slicesForNotesAndTiming = slicesForNotesAndTiming;\n//# sourceMappingURL=legacy.js.map","\"use strict\";\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.slicesForNotesAndTiming = void 0;\nvar lodash_1 = __importDefault(require(\"lodash\"));\n/**\n * Takes the notes for a certain `soundChannel` and returns instructions\n * on how to slice the keysound file, given the `y` position of a note.\n *\n * @param notes An {Array} of `notes` inside `bmson.soundChannel[i]`\n * @param timing The {BMS.Timing} object that corresponds to the bmson\n * @param options An {Object} of options with the following keys:\n *  * `beatForPulse` A {Function} used to resolve beat for a given pulse number\n * @returns an ES6 {Map} that maps `y` position of the note to an SoundSlice\n */\nfunction slicesForNotesAndTiming(notes, timing, options) {\n    var e_1, _a, e_2, _b;\n    var beatForPulse = options.beatForPulse;\n    var all = new Set();\n    var play = new Set();\n    var restart = new Set();\n    try {\n        for (var notes_1 = __values(notes), notes_1_1 = notes_1.next(); !notes_1_1.done; notes_1_1 = notes_1.next()) {\n            var _c = notes_1_1.value, x = _c.x, y = _c.y, c = _c.c;\n            all.add(y);\n            if (x) {\n                play.add(y);\n            }\n            if (!c) {\n                restart.add(y);\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (notes_1_1 && !notes_1_1.done && (_a = notes_1.return)) _a.call(notes_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    var result = new Map();\n    var soundTime = null;\n    var mustAdd = true;\n    var t;\n    var lastAdded;\n    try {\n        for (var _d = __values(lodash_1.default.sortBy(__spreadArray([], __read(all), false))), _e = _d.next(); !_e.done; _e = _d.next()) {\n            var y = _e.value;\n            var t = timing.beatToSeconds(beatForPulse(y));\n            if (soundTime === null || restart.has(y)) {\n                soundTime = 0;\n            }\n            else {\n                soundTime += t - t;\n            }\n            var shouldAdd = mustAdd || play.has(y) || restart.has(y);\n            if (shouldAdd) {\n                if (lastAdded && !restart.has(y)) {\n                    lastAdded.keysoundEnd = soundTime;\n                }\n                var obj = { keysoundStart: soundTime, keysoundEnd: undefined };\n                result.set(y, obj);\n                lastAdded = obj;\n            }\n            mustAdd = play.has(y);\n            t = t;\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (_e && !_e.done && (_b = _d.return)) _b.call(_d);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    return result;\n}\nexports.slicesForNotesAndTiming = slicesForNotesAndTiming;\n//# sourceMappingURL=utils.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BMSChart = void 0;\nvar headers_1 = require(\"./headers\");\nvar objects_1 = require(\"./objects\");\nvar time_signatures_1 = require(\"../time-signatures\");\n/**\n * A BMSChart holds information about a particular BMS notechart.\n * Note that a BMSChart does not contain any information about `#RANDOM`,\n * as they are already processed after compilation.\n *\n * There is not many useful things you can do with a BMSChart other than\n * accessing the header fields and objects inside it.\n *\n * To extract information from a BMSChart,\n * please look at the documentation of higher-level classes,\n * such as {Keysounds}, {Notes}, and {Timing}.\n */\nvar BMSChart = /** @class */ (function () {\n    function BMSChart() {\n        /**\n         * {BMSHeaders} representing the BMS-specific headers of this notechart\n         */\n        this.headers = new headers_1.BMSHeaders();\n        /**\n         * {BMSObjects} representing all objects of this notechart\n         */\n        this.objects = new objects_1.BMSObjects();\n        /**\n         * {TimeSignatures} representing the time signature information in this chart\n         */\n        this.timeSignatures = new time_signatures_1.TimeSignatures();\n    }\n    /**\n     * Public: Converts measure number and fraction into beat.\n     * A single beat is equivalent to a quarter note in common time signature.\n     *\n     * @param {number} measure representing the measure number, starting from 0\n     * @param {number} fraction representing the fraction inside that measure, from 0 to 1\n     */\n    BMSChart.prototype.measureToBeat = function (measure, fraction) {\n        return this.timeSignatures.measureToBeat(measure, fraction);\n    };\n    return BMSChart;\n}());\nexports.BMSChart = BMSChart;\n//# sourceMappingURL=chart.js.map","export default document.querySelector('#warp-root')!\n","import './Button.scss'\nimport React, { forwardRef } from 'react'\n\nconst Button = forwardRef<\n  HTMLButtonElement,\n  {\n    children?: ReactNode\n    onClick?: React.DOMAttributes<HTMLButtonElement>['onClick']\n  }\n>(({ children, onClick }, ref) => (\n  <button className='Button' onClick={onClick} ref={ref}>\n    {children}\n  </button>\n))\n\nexport default Button\n","import React from 'react'\n\ninterface VBox {\n  padding?: string | number\n  gap?: string | number\n}\n\nconst VBox: FC<VBox> = ({ children, padding, gap }) => (\n  <div style={{ display: 'flex', flexDirection: 'column', padding, gap }}>\n    {children}\n  </div>\n)\n\nexport default VBox\n","import './ComboBox.scss'\nimport React, { useState } from 'react'\nimport { useCombobox } from 'downshift'\nimport fuzzysort from 'fuzzysort'\n\nexport type ComboBoxItem = {\n  label: string\n}\n\nexport function ComboBox<T extends ComboBoxItem>(props: {\n  items: T[]\n  onSelect: (item: T) => void\n}) {\n  const [inputItems, setInputItems] = useState(props.items)\n  const {\n    isOpen,\n    getLabelProps,\n    getMenuProps,\n    getInputProps,\n    getComboboxProps,\n    highlightedIndex,\n    getItemProps,\n    setHighlightedIndex,\n  } = useCombobox({\n    items: inputItems,\n    initialHighlightedIndex: 0,\n    isOpen: true,\n    onInputValueChange: ({ inputValue }) => {\n      const results = inputValue\n        ? fuzzysort\n            .go(inputValue, props.items, { key: 'label' })\n            .map((r) => r.obj)\n        : props.items\n      setInputItems(results)\n    },\n    onHighlightedIndexChange: ({ highlightedIndex }) => {\n      if (highlightedIndex === -1 && inputItems.length > 0) {\n        setHighlightedIndex(0)\n      }\n    },\n    onSelectedItemChange: ({ selectedItem, type }) => {\n      if (\n        selectedItem &&\n        (type === useCombobox.stateChangeTypes.InputKeyDownEnter ||\n          type === useCombobox.stateChangeTypes.ItemClick)\n      ) {\n        props.onSelect(selectedItem)\n      }\n    },\n    itemToString: (item) => item?.label || '',\n  })\n\n  return (\n    <div className='ComboBox'>\n      <label hidden {...getLabelProps()}>\n        Choose an element:\n      </label>\n      <div {...getComboboxProps()} className='ComboBoxsearch'>\n        <input {...getInputProps()} className='ComboBoxinput' />\n      </div>\n      <ul {...getMenuProps()} className='ComboBoxmenu'>\n        {isOpen &&\n          inputItems.map((item, index) => (\n            <li\n              data-highlighted={highlightedIndex === index}\n              key={`${item.label}${index}`}\n              {...getItemProps({ item, index })}\n            >\n              {item.label}\n            </li>\n          ))}\n      </ul>\n    </div>\n  )\n}\n","import './index.scss'\n\nimport React, { ReactNode } from 'react'\nimport ReactDOM from 'react-dom'\nimport WARP from 'bemuse/utils/warp-element'\nimport Panel from 'bemuse/ui/Panel'\nimport Button from 'bemuse/ui/Button'\nimport VBox from 'bemuse/ui/VBox'\nimport * as AlertDialog from '@radix-ui/react-alert-dialog'\nimport { ComboBox } from './ComboBox'\n\nexport async function showAlert(title: string, message: ReactNode) {\n  await registerActiveModal(\n    new Promise<void>((resolve) => {\n      const container = document.createElement('div')\n      WARP.appendChild(container)\n      const onClick = () => {\n        WARP.removeChild(container)\n        ReactDOM.unmountComponentAtNode(container)\n        resolve()\n      }\n      const popup = (\n        <AlertDialog.Root open>\n          <AlertDialog.Overlay className='AlertDialogoverlay' />\n          <AlertDialog.Content className='AlertDialogcontent'>\n            <Panel title={<AlertDialog.Title>{title}</AlertDialog.Title>}>\n              <VBox padding='1em' gap='0.75em'>\n                <AlertDialog.Description>{message}</AlertDialog.Description>\n                <div style={{ textAlign: 'right' }}>\n                  <AlertDialog.Action asChild>\n                    <Button onClick={onClick} ref={(b) => b && b.focus()}>\n                      OK\n                    </Button>\n                  </AlertDialog.Action>\n                </div>\n              </VBox>\n            </Panel>\n          </AlertDialog.Content>\n        </AlertDialog.Root>\n      )\n      ReactDOM.render(popup, container)\n    })\n  )\n}\n\nexport async function showQuickPick<T extends QuickPickItem>(\n  items: T[],\n  options: QuickPickOptions\n) {\n  return registerActiveModal(\n    new Promise<T>((resolve) => {\n      const container = document.createElement('div')\n      WARP.appendChild(container)\n      const onSelect = (item: T) => {\n        WARP.removeChild(container)\n        ReactDOM.unmountComponentAtNode(container)\n        resolve(item)\n      }\n      const popup = (\n        <AlertDialog.Root open>\n          <AlertDialog.Overlay className='AlertDialogoverlay' />\n          <AlertDialog.Content className='AlertDialogcontent'>\n            <Panel\n              title={<AlertDialog.Title>{options.title}</AlertDialog.Title>}\n            >\n              <VBox padding='1em' gap='0.75em'>\n                <ComboBox items={items} onSelect={onSelect} />\n              </VBox>\n            </Panel>\n          </AlertDialog.Content>\n        </AlertDialog.Root>\n      )\n      ReactDOM.render(popup, container)\n    })\n  )\n}\n\nexport type QuickPickItem = {\n  label: string\n}\n\nexport type QuickPickOptions = {\n  title: string\n}\n\nconst activeModals = new Set<Promise<any>>()\n\nfunction registerActiveModal<T extends Promise<any>>(promise: T) {\n  activeModals.add(promise)\n  Promise.resolve(promise).finally(() => {\n    activeModals.delete(promise)\n  })\n  return promise\n}\n\nexport function isModalActive() {\n  return activeModals.size > 0\n}\n","\nvar content = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./Panel.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./Panel.scss\", function() {\n\t\tvar newContent = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.3.1_sass@1.56.0+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./Panel.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@charset \\\"UTF-8\\\";\\n.Panel {\\n  border: 1px solid #151413;\\n  border-radius: 4px 4px 0 0;\\n  box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);\\n  background: #353433;\\n}\\n.Paneltitle {\\n  background: #252423 linear-gradient(to bottom, #353433 0%, #252423 50%, #151413 50%, #252423 100%);\\n  border-bottom: 0;\\n  text-align: center;\\n  color: #8b8685;\\n  padding: 0.5ex 1em;\\n}\\n.Paneltitle > h2 {\\n  margin: 0;\\n  font: inherit;\\n}\", \"\"]);\n\n// exports\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Speedcore = void 0;\nvar segment_1 = require(\"./segment\");\n/**\n * Speedcore is a small internally-used library.\n * A Speedcore represents a single dimensional keyframed linear motion\n * (as in equation x = f(t)), and is useful when working\n * with BPM changes ({Timing}), note spacing factor ({Spacing}), or scrolling\n * segments ({Positioning}).\n * A Speedcore is constructed from an array of Segments.\n *\n * A {Segment} is defined as `{ t, x, dx }`, such that:\n *\n * * speedcore.x(segment.t) = segment.x\n * * speedcore.t(segment.x) = segment.t\n * * speedcore.x(segment.t + dt) = segment.x + (segment.dx / dt)\n *\n *\n * ## Explanation\n *\n * One way to think of these segments is to think about tempo changes, where:\n *\n * * `t` is the elapsed time (in seconds) since song start.\n * * `x` is the elapsed beat since song start.\n * * `dx` is the amount of `x` increase per `t`. In this case, it has the\n *   unit of beats per second.\n *\n * For example, consider a song that starts at 140 BPM.\n * 32 beats later, the tempo changes to 160 BPM.\n * 128 beats later (at beat 160), the tempo reverts to 140 BPM.\n *\n * We can derive three segments:\n *\n * 1. At time 0, we are at beat 0, and moving at 2.333 beats per second.\n * 2. At 13.714s, we are at beat 32, moving at 2.667 beats per second.\n * 3. At 61.714s, we are at beat 160, moving at 2.333 beats per second.\n *\n * This maps out to this data structure:\n *\n * ```js\n * [ [0]: { t:  0.000,  x:   0,  dx: 2.333,  inclusive: true },\n *   [1]: { t: 13.714,  x:  32,  dx: 2.667,  inclusive: true },\n *   [2]: { t: 61.714,  x: 160,  dx: 2.333,  inclusive: true } ]\n * ```\n *\n * With this data, it is possible to find out the value of `x` at any given `t`.\n *\n * For example, to answer the question, what is the beat number at 30s?\n * First, we find the segment with maximum value of `t < 30`, and we get\n * the segment `[1]`.\n *\n * We calculate `segment.x + (t - segment.t) * segment.dx`.\n * The result beat number is (32 + (30 - 13.714) * 2.667) = 75.435.\n *\n * We can also perform the reverse calculation in a similar way, by reversing\n * the equation.\n *\n * Interestingly, we can use these segments to represent the effect of\n * both BPM changes and STOP segments in the same array.\n * For example, a 150-BPM song with a 2-beat stop in the 32nd beat\n * can be represented like this:\n *\n * ```js\n * [ [0]: { t:  0.0,  x:  0,  dx: 2.5,  inclusive: true  },\n *   [1]: { t: 12.8,  x: 32,  dx: 0,    inclusive: true  },\n *   [2]: { t: 13.6,  x: 32,  dx: 2.5,  inclusive: false } ]\n * ```\n */\nvar Speedcore = /** @class */ (function () {\n    /**\n     * Constructs a new `Speedcore` from given segments.\n     */\n    function Speedcore(segments) {\n        segments.forEach(segment_1.Segment);\n        this._segments = segments;\n    }\n    Speedcore.prototype._reached = function (index, targetFn, position) {\n        if (index >= this._segments.length)\n            return false;\n        var segment = this._segments[index];\n        var target = targetFn(segment);\n        return segment.inclusive ? position >= target : position > target;\n    };\n    Speedcore.prototype._segmentAt = function (targetFn, position) {\n        for (var i = 0; i < this._segments.length; i++) {\n            if (!this._reached(i + 1, targetFn, position))\n                return this._segments[i];\n        }\n        throw new Error('Unable to find a segment matching a criteria (this should never happen)!');\n    };\n    Speedcore.prototype.segmentAtX = function (x) {\n        return this._segmentAt(X, x);\n    };\n    Speedcore.prototype.segmentAtT = function (t) {\n        return this._segmentAt(T, t);\n    };\n    /**\n     * Calculates the _t_, given _x_.\n     */\n    Speedcore.prototype.t = function (x) {\n        var segment = this.segmentAtX(x);\n        return segment.t + (x - segment.x) / (segment.dx || 1);\n    };\n    /**\n     * Calculates the _x_, given _t_.\n     * @param {number} t\n     */\n    Speedcore.prototype.x = function (t) {\n        var segment = this.segmentAtT(t);\n        return segment.x + (t - segment.t) * segment.dx;\n    };\n    /**\n     * Finds the _dx_, given _t_.\n     * @param {number} t\n     */\n    Speedcore.prototype.dx = function (t) {\n        var segment = this.segmentAtT(t);\n        return segment.dx;\n    };\n    return Speedcore;\n}());\nexports.Speedcore = Speedcore;\nvar T = function (segment) { return segment.t; };\nvar X = function (segment) { return segment.x; };\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NotechartLoader = void 0;\nvar BMS = __importStar(require(\"bms\"));\nvar BMSNotechartLoader = __importStar(require(\"./BMSNotechartLoader\"));\nvar BmsonNotechartLoader = __importStar(require(\"./BmsonNotechartLoader\"));\nvar coerceToBuffer = function (bufferOrArrayBuffer) {\n    return Buffer.isBuffer(bufferOrArrayBuffer)\n        ? bufferOrArrayBuffer\n        : Buffer.from(new Uint8Array(bufferOrArrayBuffer));\n};\nvar NotechartLoader = /** @class */ (function () {\n    function NotechartLoader() {\n    }\n    NotechartLoader.prototype.load = function (arraybuffer, resource, options) {\n        if (resource.name.match(/\\.bmson$/i)) {\n            return this.loadBmson(arraybuffer, resource, options);\n        }\n        else {\n            return this.loadBMS(arraybuffer, resource, options);\n        }\n    };\n    NotechartLoader.prototype.loadBMS = function (arraybuffer, resource, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var buffer, readerOptions, source, compileResult, chart, notechart;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        buffer = coerceToBuffer(arraybuffer);\n                        readerOptions = BMS.Reader.getReaderOptionsFromFilename(resource.name);\n                        return [4 /*yield*/, BMS.Reader.readAsync(buffer, readerOptions)];\n                    case 1:\n                        source = _a.sent();\n                        compileResult = BMS.Compiler.compile(source);\n                        chart = compileResult.chart;\n                        notechart = BMSNotechartLoader.fromBMSChart(chart, options);\n                        return [2 /*return*/, notechart];\n                }\n            });\n        });\n    };\n    NotechartLoader.prototype.loadBmson = function (arraybuffer, resource, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var buffer, source;\n            return __generator(this, function (_a) {\n                buffer = coerceToBuffer(arraybuffer);\n                source = buffer.toString('utf-8');\n                return [2 /*return*/, BmsonNotechartLoader.load(source, options)];\n            });\n        });\n    };\n    return NotechartLoader;\n}());\nexports.NotechartLoader = NotechartLoader;\nexports.default = NotechartLoader;\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.load = void 0;\nvar bmson = __importStar(require(\"bmson\"));\nvar BMS = __importStar(require(\"bms\"));\nvar __1 = __importDefault(require(\"../\"));\nfunction load(source, playerOptions) {\n    var data = JSON.parse(source);\n    var songInfo = bmson.songInfoForBmson(data);\n    var score = bmson.musicalScoreForBmson(data, {\n        double: playerOptions.double,\n    });\n    var barLines = bmson.barLinesForBmson(data);\n    var stuff = {\n        notes: score.notes.all(),\n        timing: score.timing,\n        keysounds: score.keysounds,\n        songInfo: songInfo,\n        positioning: new BMS.Positioning([{ t: 0, x: 0, dx: 1, inclusive: true }]),\n        spacing: new BMS.Spacing([]),\n        barLines: barLines,\n        images: {\n            // HACK: Hardcoded here, probably should belong in bmson package\n            eyecatch: data.info.eyecatch_image,\n            background: data.info.back_image,\n        },\n        expertJudgmentWindow: getExpertJudgmentWindowForBmson(data),\n    };\n    return new __1.default(stuff, playerOptions);\n}\nexports.load = load;\nfunction getExpertJudgmentWindowForBmson(data) {\n    var judgeRank = (function () {\n        if (!data.info)\n            return 100;\n        if (!data.info.judge_rank)\n            return 100;\n        return +data.info.judge_rank || 100;\n    })() / 100;\n    return [18 * judgeRank, 40 * judgeRank];\n}\n//# sourceMappingURL=BmsonNotechartLoader.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.keysForBmson = exports.hasScratch = exports.beatForPulseForBmson = exports._slicesForNotesAndTiming = exports.musicalScoreForBmson = exports.timingInfoForBmson = exports.barLinesForBmson = exports.songInfoForBmson = void 0;\nvar lodash_1 = __importDefault(require(\"lodash\"));\nvar BMS = __importStar(require(\"bms\"));\nvar legacy = __importStar(require(\"./legacy\"));\nvar utils = __importStar(require(\"./utils\"));\n__exportStar(require(\"./types\"), exports);\n/**\n * Returns a BMS.SongInfo corresponding to this BMS file.\n */\nfunction songInfoForBmson(bmson) {\n    var bmsonInfo = bmson.info;\n    var info = {};\n    if (bmsonInfo.title)\n        info.title = bmsonInfo.title;\n    if (bmsonInfo.artist)\n        info.artist = bmsonInfo.artist;\n    if (bmsonInfo.genre)\n        info.genre = bmsonInfo.genre;\n    if (bmsonInfo.level)\n        info.level = bmsonInfo.level;\n    info.subtitles = getSubtitles();\n    if (bmsonInfo.subartists)\n        info.subartists = bmsonInfo.subartists;\n    return new BMS.SongInfo(info);\n    function getSubtitles() {\n        if (!bmson.version)\n            return ['Warning: legacy bmson'];\n        var subtitles = [];\n        if (bmsonInfo.chart_name && typeof bmsonInfo.chart_name === 'string') {\n            subtitles.push(bmsonInfo.chart_name);\n        }\n        if (bmsonInfo.subtitle && typeof bmsonInfo.subtitle === 'string') {\n            subtitles.push.apply(subtitles, __spreadArray([], __read(bmsonInfo.subtitle.split('\\n')), false));\n        }\n        return subtitles;\n    }\n}\nexports.songInfoForBmson = songInfoForBmson;\n/**\n * Returns the barlines as an array of beats.\n */\nfunction barLinesForBmson(bmson) {\n    if (!bmson.version)\n        return legacy.barLinesForBmson(bmson);\n    var beatForPulse = beatForPulseForBmson(bmson);\n    var lines = bmson.lines;\n    return (0, lodash_1.default)(lines)\n        .map(function (_a) {\n        var y = _a.y;\n        return beatForPulse(y);\n    })\n        .sortBy()\n        .value();\n}\nexports.barLinesForBmson = barLinesForBmson;\n/**\n * Returns the information to be passed to BMS.Timing constructor\n * in order to generate the timing data represented by the `bmson` object.\n * @param {Bmson} bmson\n */\nfunction timingInfoForBmson(bmson) {\n    if (!bmson.version)\n        return legacy.timingInfoForBmson(bmson);\n    var beatForPulse = beatForPulseForBmson(bmson);\n    return {\n        initialBPM: bmson.info.init_bpm,\n        actions: __spreadArray(__spreadArray([], __read((bmson.bpm_events || []).map(function (_a) {\n            var y = _a.y, bpm = _a.bpm;\n            return ({\n                type: 'bpm',\n                beat: beatForPulse(y),\n                bpm: bpm,\n            });\n        })), false), __read((bmson.stop_events || []).map(function (_a) {\n            var y = _a.y, duration = _a.duration;\n            return ({\n                type: 'stop',\n                beat: beatForPulse(y),\n                stopBeats: beatForPulse(Math.floor(duration)),\n            });\n        })), false),\n    };\n}\nexports.timingInfoForBmson = timingInfoForBmson;\n/**\n * Returns the timing data represented by the `bmson` object.\n * @param {Bmson} bmson\n */\nfunction timingForBmson(bmson) {\n    var _a = timingInfoForBmson(bmson), initialBPM = _a.initialBPM, actions = _a.actions;\n    return new BMS.Timing(initialBPM, actions);\n}\n/**\n * Returns the musical score (comprised of BMS.Notes and BMS.Keysounds).\n * @param {Bmson} bmson\n */\nfunction musicalScoreForBmson(bmson, options) {\n    if (options === void 0) { options = {}; }\n    var timing = timingForBmson(bmson);\n    var _a = notesDataAndKeysoundsDataForBmsonAndTiming(bmson, timing, options), notes = _a.notes, keysounds = _a.keysounds;\n    return {\n        /**\n         * The {BMS.Timing} object for this musical score.\n         */\n        timing: timing,\n        /**\n         * A {BMS.Notes} representing notes inside the bmson notechart.\n         */\n        notes: new BMS.Notes(notes),\n        /**\n         * A {BMS.Keysounds} representing mapping between keysound in the\n         * `notes` field to the actual keysound file name.\n         */\n        keysounds: new BMS.Keysounds(keysounds),\n    };\n}\nexports.musicalScoreForBmson = musicalScoreForBmson;\nfunction soundChannelsForBmson(bmson) {\n    return bmson.version\n        ? bmson.sound_channels\n        : bmson.soundChannel;\n}\nfunction notesDataAndKeysoundsDataForBmsonAndTiming(bmson, timing, options) {\n    var e_1, _a, e_2, _b;\n    var nextKeysoundNumber = 1;\n    var beatForPulse = beatForPulseForBmson(bmson);\n    var notes = [];\n    var keysounds = {};\n    var soundChannels = soundChannelsForBmson(bmson);\n    if (soundChannels) {\n        try {\n            for (var soundChannels_1 = __values(soundChannels), soundChannels_1_1 = soundChannels_1.next(); !soundChannels_1_1.done; soundChannels_1_1 = soundChannels_1.next()) {\n                var _c = soundChannels_1_1.value, name_1 = _c.name, soundChannelNotes = _c.notes;\n                var sortedNotes = lodash_1.default.sortBy(soundChannelNotes, 'y');\n                var keysoundNumber = nextKeysoundNumber++;\n                var keysoundId = lodash_1.default.padStart('' + keysoundNumber, 4, '0');\n                var slices = utils.slicesForNotesAndTiming(soundChannelNotes, timing, {\n                    beatForPulse: beatForPulse,\n                });\n                keysounds[keysoundId] = name_1;\n                try {\n                    for (var sortedNotes_1 = (e_2 = void 0, __values(sortedNotes)), sortedNotes_1_1 = sortedNotes_1.next(); !sortedNotes_1_1.done; sortedNotes_1_1 = sortedNotes_1.next()) {\n                        var _d = sortedNotes_1_1.value, x = _d.x, y = _d.y, l = _d.l;\n                        var note = {\n                            column: getColumn(x, options),\n                            beat: beatForPulse(y),\n                            keysound: keysoundId,\n                            endBeat: undefined,\n                        };\n                        if (l > 0) {\n                            note.endBeat = beatForPulse(y + l);\n                        }\n                        var slice = slices.get(y);\n                        if (slice) {\n                            Object.assign(note, slice);\n                            notes.push(note);\n                        }\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (sortedNotes_1_1 && !sortedNotes_1_1.done && (_b = sortedNotes_1.return)) _b.call(sortedNotes_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (soundChannels_1_1 && !soundChannels_1_1.done && (_a = soundChannels_1.return)) _a.call(soundChannels_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    }\n    return { notes: notes, keysounds: keysounds };\n}\nvar legacy_1 = require(\"./legacy\");\nObject.defineProperty(exports, \"_slicesForNotesAndTiming\", { enumerable: true, get: function () { return legacy_1._slicesForNotesAndTiming; } });\nfunction beatForPulseForBmson(bmson) {\n    if (!bmson.version)\n        return legacy.beatForLoc;\n    var resolution = (bmson.info && bmson.info.resolution) || 240;\n    return function (y) { return y / resolution; };\n}\nexports.beatForPulseForBmson = beatForPulseForBmson;\nfunction getColumn(x, options) {\n    switch (x) {\n        case 1:\n            return '1';\n        case 2:\n            return '2';\n        case 3:\n            return '3';\n        case 4:\n            return '4';\n        case 5:\n            return '5';\n        case 6:\n            return '6';\n        case 7:\n            return '7';\n        case 8:\n            return 'SC';\n    }\n    if (options.double) {\n        switch (x) {\n            case 9:\n                return '8';\n            case 10:\n                return '9';\n            case 11:\n                return '10';\n            case 12:\n                return '11';\n            case 13:\n                return '12';\n            case 14:\n                return '13';\n            case 15:\n                return '14';\n            case 16:\n                return 'SC2';\n        }\n    }\n    return undefined;\n}\n/**\n * Checks if there is a scratch in a bmson file\n */\nfunction hasScratch(bmson) {\n    var e_3, _a, e_4, _b;\n    var soundChannels = soundChannelsForBmson(bmson);\n    if (soundChannels) {\n        try {\n            for (var soundChannels_2 = __values(soundChannels), soundChannels_2_1 = soundChannels_2.next(); !soundChannels_2_1.done; soundChannels_2_1 = soundChannels_2.next()) {\n                var notes = soundChannels_2_1.value.notes;\n                try {\n                    for (var notes_1 = (e_4 = void 0, __values(notes)), notes_1_1 = notes_1.next(); !notes_1_1.done; notes_1_1 = notes_1.next()) {\n                        var x = notes_1_1.value.x;\n                        if (x === 8 || x === 18)\n                            return true;\n                    }\n                }\n                catch (e_4_1) { e_4 = { error: e_4_1 }; }\n                finally {\n                    try {\n                        if (notes_1_1 && !notes_1_1.done && (_b = notes_1.return)) _b.call(notes_1);\n                    }\n                    finally { if (e_4) throw e_4.error; }\n                }\n            }\n        }\n        catch (e_3_1) { e_3 = { error: e_3_1 }; }\n        finally {\n            try {\n                if (soundChannels_2_1 && !soundChannels_2_1.done && (_a = soundChannels_2.return)) _a.call(soundChannels_2);\n            }\n            finally { if (e_3) throw e_3.error; }\n        }\n    }\n    return false;\n}\nexports.hasScratch = hasScratch;\n/**\n * Checks the key mode for a bmson file\n */\nfunction keysForBmson(bmson) {\n    var e_5, _a, e_6, _b;\n    var soundChannels = soundChannelsForBmson(bmson);\n    var hasKeys = false;\n    var hasSecondPlayer = false;\n    var hasDeluxeKeys = false;\n    if (soundChannels) {\n        try {\n            for (var soundChannels_3 = __values(soundChannels), soundChannels_3_1 = soundChannels_3.next(); !soundChannels_3_1.done; soundChannels_3_1 = soundChannels_3.next()) {\n                var notes = soundChannels_3_1.value.notes;\n                try {\n                    for (var notes_2 = (e_6 = void 0, __values(notes)), notes_2_1 = notes_2.next(); !notes_2_1.done; notes_2_1 = notes_2.next()) {\n                        var x = notes_2_1.value.x;\n                        hasKeys = true;\n                        if (x >= 11 && x <= 20)\n                            hasSecondPlayer = true;\n                        if (x === 6 || x === 7 || x === 16 || x === 17)\n                            hasDeluxeKeys = true;\n                    }\n                }\n                catch (e_6_1) { e_6 = { error: e_6_1 }; }\n                finally {\n                    try {\n                        if (notes_2_1 && !notes_2_1.done && (_b = notes_2.return)) _b.call(notes_2);\n                    }\n                    finally { if (e_6) throw e_6.error; }\n                }\n            }\n        }\n        catch (e_5_1) { e_5 = { error: e_5_1 }; }\n        finally {\n            try {\n                if (soundChannels_3_1 && !soundChannels_3_1.done && (_a = soundChannels_3.return)) _a.call(soundChannels_3);\n            }\n            finally { if (e_5) throw e_5.error; }\n        }\n    }\n    if (!hasKeys)\n        return 'empty';\n    if (hasSecondPlayer) {\n        return hasDeluxeKeys ? '14K' : '10K';\n    }\n    else {\n        return hasDeluxeKeys ? '7K' : '5K';\n    }\n}\nexports.keysForBmson = keysForBmson;\n//# sourceMappingURL=index.js.map","\"use strict\";\n/* eslint camelcase: off */\n/* REASON: These snake case names are specified in bmsons spec. */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=types.js.map","export default readBlob\n\n// Reads the blob as a specified type. The blob will not actually be read\n// unless the ``as()`` method is called.\n//\n// .. js:function:: as(type)\n//\n//    Starts reading the blob as ``type``. The ``type`` is a String such as\n//    \"arraybuffer\" or \"text\".\nexport function readBlob(blob) {\n  return {\n    as(type) {\n      return new Promise(function (resolve, reject) {\n        const reader = new FileReader()\n        reader.onload = function () {\n          resolve(reader.result)\n        }\n        reader.onerror = function () {\n          reject(new Error('Unable to read from Blob'))\n        }\n        switch (type) {\n          case 'arraybuffer':\n            reader.readAsArrayBuffer(blob)\n            break\n          case 'text':\n            reader.readAsText(blob)\n            break\n        }\n      })\n    },\n  }\n}\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.assign = exports.values = exports.map = exports.uniq = void 0;\n// A subset of lodash that we actually use.\nvar lodash_uniq_1 = __importDefault(require(\"lodash.uniq\"));\nexports.uniq = lodash_uniq_1.default;\nvar lodash_map_1 = __importDefault(require(\"lodash.map\"));\nexports.map = lodash_map_1.default;\nvar lodash_values_1 = __importDefault(require(\"lodash.values\"));\nexports.values = lodash_values_1.default;\nvar lodash_assign_1 = __importDefault(require(\"lodash.assign\"));\nexports.assign = lodash_assign_1.default;\n//# sourceMappingURL=lodash.js.map","\"use strict\";\n/**\n * Public: The `bms` package is a library for working with rhythm game data.\n *\n * Although this librarys name suggests that it is for BMS file format,\n * almost every part can be used standalone.\n *\n * This package contains:\n *\n * - __Modules that reads and parses BMS files:__\n *\n *   - {Reader} reads the BMS file from a {Buffer}, detects the character set\n *     and decodes the buffer using that character set into a {String}.\n *   - {Compiler} reads the BMS source from a {String}, and converts into\n *     {BMSChart}, an internal representation of a BMS notechart.\n *\n * - __Classes for representing a BMS notechart.__\n *   These module stores the data as close to the BMS file format as possible.\n *\n *   Almost no musical interpretation is made.\n *   For example, a BPM change is simply represented using a\n *   BMSObject with `channel` = `03` or `08`.\n *\n *   - {BMSChart} is composed of {BMSHeaders}, {BMSObjects}, and {TimeSignatures}.\n *   - {BMSHeaders} represents the header sentences in a BMS file.\n *   - {BMSObjects} represents the objects in a BMS file.\n *   - {BMSObject} represents a single object.\n *\n * - __Classes that represent different aspects of a notechart.__\n *   Instance of these classes may be created from a {BMSChart},\n *   but they can be used in a standalone manner as well.\n *\n *   This makes this library very flexible,\n *   and able to accommodate different formats of notechart.\n *   For example, see the [bmson](https: *github.com/bemusic/bmson) package.\n *\n *   Its also possible to use these classes in context other than music gaming,\n *   for example, you can use these classes to help building a music player\n *   that requires precise synchronization between beats.\n *\n *   - {TimeSignatures} represents a collection of time signatures\n *     in a musical score, and lets you convert the measure number and fraction\n *     into beat number.\n *   - {Timing} represents the timing information in a musical score,\n *     and provides methods to convert between musical time (beats) and\n *     metric time (seconds).\n *   - {SongInfo} represents the basic song information,\n *     such as title, artist, and genre.\n *   - {Notes} represents the sound objects inside your notechart.\n *   - {Keysounds} represents a mapping between keysound ID and filename.\n *   - {Positioning} represents a mapping between beat and in-game position.\n *     Some rhythm game lets chart author control the amount of scrolling\n *     per beat. In StepMania 5, this is called the scroll segments.\n *   - {Spacing} represents a mapping between beat and note spacing.\n *     Some rhythm game lets chart author change the note spacing (HI-SPEED)\n *     dynamically. In StepMania 5, this is called the speed segments.\n *\n * - __Low-level utility classes:__\n *\n *   - {Speedcore} represents a linear animation.\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Compiler = exports.Reader = void 0;\nvar Reader = __importStar(require(\"./reader\"));\nexports.Reader = Reader;\nvar Compiler = __importStar(require(\"./compiler\"));\nexports.Compiler = Compiler;\n__exportStar(require(\"./reader/types\"), exports);\n__exportStar(require(\"./bms/chart\"), exports);\n__exportStar(require(\"./bms/headers\"), exports);\n__exportStar(require(\"./bms/objects\"), exports);\n__exportStar(require(\"./speedcore\"), exports);\n__exportStar(require(\"./time-signatures\"), exports);\n__exportStar(require(\"./notes\"), exports);\n__exportStar(require(\"./timing\"), exports);\n__exportStar(require(\"./song-info\"), exports);\n__exportStar(require(\"./keysounds\"), exports);\n__exportStar(require(\"./positioning\"), exports);\n__exportStar(require(\"./spacing\"), exports);\n//# sourceMappingURL=index.js.map","export default document.querySelector('#scene-root')\n"],"sourceRoot":""}