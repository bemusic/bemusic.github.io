{"version":3,"sources":["file:///home/circleci/bemuse/src/utils/main-element.js","file:///home/circleci/bemuse/src/music-collection-viewer/MusicTable.js","file:///home/circleci/bemuse/src/music-collection-viewer/CollectionViewer.jsx","file:///home/circleci/bemuse/src/music-collection-viewer/index.js","file:///home/circleci/bemuse/src/music-collection/isChartPlayable.js","file:///home/circleci/bemuse/src/music-collection/getPlayableCharts.js","file:///home/circleci/bemuse/src/music-collection/index.js","file:///home/circleci/bemuse/src/music-collection/groupSongsIntoCategories.js","file:///home/circleci/bemuse/src/music-collection/preprocessCollection.js","file:///home/circleci/bemuse/src/music-collection/sortSongs.js","file:///home/circleci/bemuse/src/music-previewer/index.js","file:///home/circleci/bemuse/src/music-previewer/default.ogg","file:///home/circleci/bemuse/src/music-previewer/go.ogg","file:///home/circleci/bemuse/src/music-previewer/MusicSelectPreviewer.jsx","file:///home/circleci/bemuse/src/music-collection/getPreviewUrl.js"],"names":["document","querySelector","sorters","ingame","songs","groupSongsIntoCategories","sortSongs","added","title","_","reverse","sortBy","getAdded","song","initial","renderSongWarnings","problems","report","message","_len","arguments","length","keys","Array","_key","push","unreleased","readme","replaygain","artist_url","song_url","youtube_url","long_url","bms_url","exclusive","bmssearch_id","charts","filter","chart","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","getPlayableCharts","Symbol","iterator","next","done","value","info","subtitles","file","err","return","validateSong","react_default","a","createElement","map","problem","index","key","style","fontFamily","marginRight","padding","fontSize","background","MusicTable","_React$Component","props","_this","_classCallCheck","this","_possibleConstructorReturn","_getPrototypeOf","call","state","sort","initialSort","Object","previewUrl","previewEnabled","_inherits","React","Component","_createClass","borderSpacing","colSpan","renderSorter","renderPreview","renderRows","_this2","out","_arr","_loop","_i","onClick","setState","_this3","button","s","MusicSelectPreviewer","url","_this4","categories","data","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","category","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_loop2","id","prompt","concat","color","textAlign","getPreviewUrl","genre","console","log","alert","require","inspect","artist","_iterator3","text","renderMessage","renderTable","e","PropTypes","object","string","CollectionViewer","CollectionViewer_classCallCheck","CollectionViewer_possibleConstructorReturn","CollectionViewer_getPrototypeOf","query","server","OFFICIAL_SERVER_URL","status","CollectionViewer_inherits","CollectionViewer_createClass","load","then","result","catch","music_collection_viewer_MusicTable","preprocessCollection","main","MusicPreviewer","render","music_collection_viewer_CollectionViewer","MAIN","__webpack_require__","d","__webpack_exports__","isChartPlayable","lodash__WEBPACK_IMPORTED_MODULE_0__","lodash__WEBPACK_IMPORTED_MODULE_0___default","n","_isChartPlayable__WEBPACK_IMPORTED_MODULE_1__","orderBy","difficulty","level","global","_ref$fetch","fetch","response","json","grouping","criteria","custom","tutorial","Date","now","parse","groups","group","input","output","_step3$value","_step2$value","u","chart_names","name","_toConsumableArray","min","bpm","toLowerCase","preload","enable","disable","go","preview","instance","getInstance","enabled","currentUrl","backgroundLoaded","backgroundPlayed","instances","Audio","loop","oncanplaythrough","update","goSound","src","volume","backgroundFader","createFader","target","pause","playing","_arr2","_i2","loaded","play","stop","fadeTo","warn","destroy","currentTime","songUrl","audio","played","fader","onended","createInstance","createMusicPreviewer","initialVolume","onTargetReached","volumeChanged","targetVolume","currentSpeed","requested","elapsed","getCurrentVolume","Math","max","currentVolume","requestAnimationFrame","speed","module","exports","p","addEventListener","handleMessage","removeEventListener","nextProps","_ref","type","serverUrl","path"],"mappings":"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","file":"music-7f17a662f97e4df21410.js","sourcesContent":["export default document.querySelector('#scene-root')\n","import _ from 'lodash'\nimport MusicSelectPreviewer from 'bemuse/music-previewer/MusicSelectPreviewer'\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport getPlayableCharts from 'bemuse/music-collection/getPlayableCharts'\nimport getPreviewUrl from 'bemuse/music-collection/getPreviewUrl'\nimport groupSongsIntoCategories from 'bemuse/music-collection/groupSongsIntoCategories'\nimport sortSongs from 'bemuse/music-collection/sortSongs'\n\nconst sorters = {\n  ingame: songs => groupSongsIntoCategories(sortSongs(songs)),\n  added: songs => [\n    {\n      title: 'Sorted by added date',\n      songs: _.reverse(_.sortBy(songs, getAdded))\n    }\n  ]\n}\n\nconst getAdded = song =>\n  song.added || (song.initial ? '0000-00-00' : '9999-99-99')\n\nfunction validateSong (song) {\n  const problems = []\n  const report = (message, ...keys) => problems.push({ keys, message })\n  if (song.unreleased) {\n    report('Not released', 'unreleased')\n  }\n  if (!song.readme) {\n    report('No README file found', 'README.md')\n  }\n  if (!song.replaygain) {\n    report('No replay gain', 'replaygain')\n  }\n  if (!song.artist_url) {\n    report('No artist URL', 'artist_url')\n  }\n  if (!song.added && !song.initial) {\n    report('No added date', 'added')\n  }\n  if (!song.song_url && !song.youtube_url && !song.long_url) {\n    report('No song/YouTube/long URL', 'song_url', 'long_url', 'youtube_url')\n  }\n  if (!song.bms_url && !song.exclusive) {\n    report('No download URL', 'bms_url')\n  }\n  if (!song.bmssearch_id && !song.exclusive) {\n    report('No BMS search ID', 'bmssearch_id')\n  }\n  if (!song.charts.filter(chart => chart.keys === '5K').length) {\n    report('No 5-key charts', '5key')\n  }\n  for (const chart of getPlayableCharts(song.charts)) {\n    if (!chart.info.subtitles.length) {\n      report('Missing subtitle', 'chart_names ' + chart.file)\n    }\n  }\n  return problems\n}\n\nfunction renderSongWarnings (song) {\n  const problems = validateSong(song)\n  if (!problems.length) return null\n  return (\n    <div>\n      {problems.map((problem, index) => (\n        <div key={index}>\n          {problem.keys.map(key => (\n            <code\n              key={key}\n              style={{\n                fontFamily: 'Ubuntu Mono',\n                marginRight: '2',\n                padding: 3,\n                fontSize: '0.8em',\n                background: '#755'\n              }}\n            >\n              {key}\n            </code>\n          ))}\n          {problem.message}\n        </div>\n      ))}\n    </div>\n  )\n}\n\nexport class MusicTable extends React.Component {\n  static propTypes = {\n    data: PropTypes.object,\n    url: PropTypes.string,\n    initialSort: PropTypes.string\n  }\n  constructor (props) {\n    super(props)\n    this.state = {\n      sort: this.props.initialSort || Object.keys(sorters)[0],\n      previewUrl: null,\n      previewEnabled: false\n    }\n  }\n  renderTable () {\n    return (\n      <table style={{ borderSpacing: 4 }}>\n        <thead>\n          <tr>\n            <th colSpan={4}>\n              {this.renderSorter()}\n              {' · '}\n              {this.renderPreview()}\n            </th>\n          </tr>\n          <tr>\n            <th>id</th>\n            <th>song</th>\n            <th>warnings</th>\n          </tr>\n        </thead>\n        <tbody>{this.renderRows()}</tbody>\n      </table>\n    )\n  }\n  renderSorter () {\n    const out = []\n    for (const key of Object.keys(sorters)) {\n      out.push(\n        <button\n          key={key}\n          onClick={() => {\n            this.setState({ sort: key })\n          }}\n        >\n          {key}\n        </button>\n      )\n    }\n    return (\n      <span>\n        <strong>Sort by:</strong> {out}\n      </span>\n    )\n  }\n  renderPreview () {\n    const button = (\n      <button\n        onClick={() => {\n          this.setState(s => ({ previewEnabled: !s.previewEnabled }))\n        }}\n      >\n        {this.state.previewEnabled ? 'disable' : 'enable'}\n      </button>\n    )\n    return (\n      <span>\n        <strong>Music preview:</strong> {button}\n        {this.state.previewEnabled && (\n          <MusicSelectPreviewer url={this.state.previewUrl} />\n        )}\n      </span>\n    )\n  }\n  renderRows () {\n    const categories = sorters[this.state.sort](this.props.data.songs)\n    const out = []\n    for (const category of categories) {\n      out.push(\n        <tr key={category.title}>\n          <th colSpan={4}>{category.title}</th>\n        </tr>\n      )\n      for (const song of category.songs) {\n        out.push(\n          <tr key={song.id}>\n            <td>\n              <strong\n                onClick={() => {\n                  prompt('', `vim '${song.id}/README.md'`)\n                }}\n              >\n                <code style={{ fontFamily: 'Ubuntu Mono' }}>{song.id}</code>\n              </strong>\n              <br />\n              <span style={{ color: '#8b8685' }}>{song.added}</span>\n            </td>\n            <td style={{ textAlign: 'center', background: '#353433' }}>\n              <span\n                style={{ color: '#8b8685' }}\n                onClick={() => {\n                  const previewUrl = getPreviewUrl(this.props.url, song)\n                  this.setState({ previewUrl })\n                }}\n              >\n                {song.genre}\n              </span>\n              <br />\n              <strong\n                onClick={() => {\n                  console.log(song)\n                  alert(require('util').inspect(song))\n                }}\n              >\n                {song.title}\n              </strong>\n              <br />\n              {song.artist}\n            </td>\n            <td>{renderSongWarnings(song)}</td>\n          </tr>\n        )\n      }\n    }\n    return out\n  }\n  renderMessage (text) {\n    return <div style={{ textAlign: 'center' }}>{text}</div>\n  }\n  render () {\n    if (!this.props.data) return this.renderMessage('No data')\n    try {\n      return this.renderTable()\n    } catch (e) {\n      return this.renderMessage(`Error: ${e}`)\n    }\n  }\n}\n\nexport default MusicTable\n","import React from 'react'\nimport preprocessCollection from 'bemuse/music-collection/preprocessCollection'\nimport query from 'bemuse/utils/query'\nimport { OFFICIAL_SERVER_URL, load } from 'bemuse/music-collection'\n\nimport MusicTable from './MusicTable'\n\nexport class CollectionViewer extends React.Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      url: query.server || OFFICIAL_SERVER_URL,\n      status: 'Loading'\n    }\n  }\n  componentDidMount () {\n    load(this.state.url)\n      .then(result => {\n        this.setState({ status: 'Load completed', data: result })\n      })\n      .catch(e => {\n        this.setState({ status: 'Load error: ' + e })\n      })\n  }\n  render () {\n    return (\n      <div>\n        <header style={{ textAlign: 'center' }}>\n          <h1>Bemuse collection viewer</h1>\n          <div>\n            {this.state.url}\n            <br />\n            {this.state.status}\n          </div>\n        </header>\n        <div style={{ padding: 20 }}>\n          <MusicTable\n            data={this.state.data && preprocessCollection(this.state.data)}\n            url={this.state.url}\n            initialSort={query.sort}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default CollectionViewer\n","import * as MusicPreviewer from 'bemuse/music-previewer'\nimport MAIN from 'bemuse/utils/main-element'\nimport React from 'react'\nimport { render } from 'react-dom'\n\nimport CollectionViewer from './CollectionViewer'\n\nexport function main () {\n  MusicPreviewer.preload()\n  render(<CollectionViewer />, MAIN)\n}\n","export function isChartPlayable (chart) {\n  return chart.keys === '7K' || chart.keys === '5K'\n}\n\nexport default isChartPlayable\n","import _ from 'lodash'\n\nimport isChartPlayable from './isChartPlayable'\n\nexport function getPlayableCharts (charts) {\n  return _(charts)\n    .filter(isChartPlayable)\n    .orderBy([\n      chart => (chart.info.difficulty >= 5 ? 1 : 0),\n      chart => chart.keys,\n      chart => chart.info.level\n    ])\n    .value()\n}\n\nexport default getPlayableCharts\n","export const OFFICIAL_SERVER_URL = 'https://music.bemuse.ninja/live'\n\nexport function load (url, { fetch = global.fetch } = {}) {\n  return fetch(url + '/index.json').then(response => response.json())\n}\n","import _ from 'lodash'\n\nconst grouping = [\n  { title: 'Custom Song', criteria: song => song.custom },\n  { title: 'Tutorial', criteria: song => song.tutorial },\n  { title: 'Unreleased', criteria: song => song.unreleased },\n  {\n    title: 'Recently Added Songs',\n    criteria: song =>\n      song.added && Date.now() - Date.parse(song.added) < 60 * 86400000,\n    sort: song => song.added,\n    reverse: true\n  },\n  { title: '☆', criteria: () => true }\n]\n\nexport function groupSongsIntoCategories (songs) {\n  let groups = grouping.map(group => ({\n    input: group,\n    output: { title: group.title, songs: [] }\n  }))\n  for (let song of songs) {\n    for (let { input, output } of groups) {\n      if (input.criteria(song)) {\n        output.songs.push(song)\n        break\n      }\n    }\n  }\n  for (let { input, output } of groups) {\n    if (input.sort) output.songs = _.sortBy(output.songs, input.sort)\n    if (input.reverse) output.songs.reverse()\n  }\n  return _(groups)\n    .map('output')\n    .filter(group => group.songs.length > 0)\n    .value()\n}\n\nexport default groupSongsIntoCategories\n","import u from 'updeep'\n\nexport const preprocessCollection = u({\n  songs: u.map(preprocessSong)\n})\n\nfunction preprocessSong (song) {\n  if (song.chart_names) {\n    song = u(\n      {\n        charts: u.map(chart => {\n          const name = song.chart_names[chart.file]\n          if (!name) return chart\n          return u(\n            {\n              info: {\n                subtitles: subtitles => [...subtitles, name]\n              }\n            },\n            chart\n          )\n        })\n      },\n      song\n    )\n  }\n  return song\n}\n\nexport default preprocessCollection\n","import _ from 'lodash'\nimport isChartPlayable from './isChartPlayable'\n\nexport function sortSongs (songs) {\n  return _.orderBy(songs, [\n    song => {\n      return _(song.charts)\n        .filter(isChartPlayable)\n        .filter(chart => chart.info.difficulty < 5)\n        .filter(chart => chart.info.level > 0)\n        .map(chart => chart.info.level)\n        .min()\n    },\n    song => song.bpm,\n    song => song.title.toLowerCase()\n  ])\n}\n\nexport default sortSongs\n","let instance = null\n\nfunction getInstance () {\n  return instance || (instance = createMusicPreviewer())\n}\n\nexport function preload () {\n  getInstance()\n}\n\nexport function enable () {\n  return getInstance().enable()\n}\n\nexport function disable () {\n  return getInstance().disable()\n}\n\nexport function go () {\n  return getInstance().go()\n}\n\nexport function preview (url) {\n  return getInstance().preview(url)\n}\n\nfunction createFader (audio, initialVolume, onTargetReached) {\n  let targetVolume = 0\n  let currentSpeed = 0\n  let requested = false\n  let volumeChanged\n  audio.volume = initialVolume\n\n  function elapsed () {\n    return (Date.now() - volumeChanged) / 1000\n  }\n\n  function getCurrentVolume () {\n    if (targetVolume > initialVolume) {\n      return Math.min(targetVolume, initialVolume + elapsed() * currentSpeed)\n    }\n    if (targetVolume < initialVolume) {\n      return Math.max(targetVolume, initialVolume - elapsed() * currentSpeed)\n    }\n    return targetVolume\n  }\n\n  function update () {\n    requested = false\n    const currentVolume = getCurrentVolume()\n    audio.volume = currentVolume\n    if (currentVolume === targetVolume) {\n      if (onTargetReached) onTargetReached(targetVolume)\n    } else {\n      if (!requested) {\n        requested = true\n        requestAnimationFrame(update)\n      }\n    }\n  }\n\n  return {\n    fadeTo (target, speed) {\n      if (targetVolume !== target || speed !== currentSpeed) {\n        initialVolume = getCurrentVolume()\n        targetVolume = target\n        currentSpeed = speed\n        volumeChanged = Date.now()\n        update()\n      }\n    }\n  }\n}\n\nfunction createMusicPreviewer () {\n  let enabled = false\n  let currentUrl = null\n  let backgroundLoaded = false\n  let backgroundPlayed = false\n  const instances = {}\n\n  const background = new Audio(require('./default.ogg'))\n  background.preload = 'auto'\n  background.loop = true\n  background.oncanplaythrough = () => {\n    backgroundLoaded = true\n    update()\n  }\n  background.load()\n\n  const goSound = document.createElement('audio')\n  goSound.src = require('./go.ogg')\n  goSound.volume = 0.5\n  goSound.load()\n\n  const backgroundFader = createFader(background, 0.5, target => {\n    if (target === 0 && backgroundPlayed) {\n      backgroundPlayed = false\n      background.pause()\n    }\n  })\n\n  function update () {\n    if (!enabled) {\n      if (backgroundPlayed) {\n        backgroundFader.fadeTo(0, 100)\n        backgroundPlayed = false\n        background.pause()\n      }\n      for (const key of Object.keys(instances)) {\n        const instance = instances[key]\n        instance.destroy()\n      }\n      return\n    }\n    let playing = null\n    for (const key of Object.keys(instances)) {\n      const instance = instances[key]\n      if (key === currentUrl) {\n        if (instance.loaded) {\n          instance.play()\n          playing = instance\n        }\n      } else {\n        instance.stop()\n      }\n    }\n    if (playing) {\n      backgroundFader.fadeTo(0, 1)\n    } else {\n      backgroundFader.fadeTo(0.4, 0.5)\n      if (backgroundLoaded && !backgroundPlayed) {\n        backgroundPlayed = true\n        try {\n          background.play()\n        } catch (e) {\n          console.warn('Cannot play background music')\n        }\n      }\n    }\n  }\n\n  const musicPreviewer = {\n    enable () {\n      if (enabled) return\n      enabled = true\n      update()\n    },\n    disable () {\n      if (!enabled) return\n      enabled = false\n      update()\n    },\n    go () {\n      if (!enabled) return\n      goSound.currentTime = 0\n      try {\n        goSound.play()\n      } catch (e) {\n        console.warn('Cannot play go sound.')\n      }\n    },\n    preview (songUrl) {\n      if (currentUrl === songUrl) return\n      currentUrl = songUrl\n      if (songUrl && !instances[songUrl]) {\n        instances[songUrl] = createInstance(songUrl)\n      }\n      update()\n    }\n  }\n\n  function createInstance (songUrl) {\n    const audio = document.createElement('audio')\n    audio.src = songUrl\n    let played = false\n\n    const fader = createFader(audio, 1, target => {\n      if (target === 0) {\n        audio.pause()\n        delete instances[songUrl]\n        update()\n      }\n    })\n\n    const instance = {\n      loaded: false,\n      play () {\n        if (!played) {\n          try {\n            audio.play()\n            played = true\n          } catch (e) {\n            console.warn('Cannot play', audio.src)\n          }\n        }\n        fader.fadeTo(1, 2)\n      },\n      stop () {\n        fader.fadeTo(0, 4)\n      },\n      destroy () {\n        audio.pause()\n        delete instances[songUrl]\n        update()\n      }\n    }\n\n    audio.oncanplaythrough = () => {\n      instance.loaded = true\n      update()\n    }\n    audio.onended = () => {\n      delete instances[songUrl]\n      update()\n    }\n    audio.load()\n\n    return instance\n  }\n\n  return musicPreviewer\n}\n","module.exports = __webpack_public_path__ + \"354b30433269481d2f132496a0d13f64.ogg\";","module.exports = __webpack_public_path__ + \"38fbcad5f2b14ca6ffc359446f7ec455.ogg\";","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport * as MusicPreviewer from './'\n\nMusicPreviewer.preload()\n\nexport default class MusicSelectPreviewer extends React.Component {\n  static propTypes = {\n    url: PropTypes.string\n  }\n  componentDidMount () {\n    MusicPreviewer.enable()\n    MusicPreviewer.preview(this.props.url)\n    addEventListener('message', this.handleMessage)\n  }\n  componentWillUnmount () {\n    MusicPreviewer.disable()\n    removeEventListener('message', this.handleMessage)\n  }\n  componentWillReceiveProps (nextProps) {\n    MusicPreviewer.preview(nextProps.url)\n  }\n  render () {\n    return null\n  }\n  handleMessage ({ data }) {\n    if (data.type === 'calibration-started') {\n      MusicPreviewer.disable()\n    } else if (data.type === 'calibration-closed') {\n      MusicPreviewer.enable()\n    }\n  }\n}\n","export function getPreviewUrl (serverUrl, song) {\n  if (!song) return null\n  if (song.tutorial) return null\n  return serverUrl + '/' + song.path + '/_bemuse_preview.mp3'\n}\n\nexport default getPreviewUrl\n"],"sourceRoot":""}