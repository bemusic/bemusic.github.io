(this.webpackChunk=this.webpackChunk||[]).push([[43],{91641:function(e,t,n){var a={"./app/entities/Collections.spec.js":80457,"./app/entities/LoadState.spec.js":77412,"./app/entities/MusicSearchText.spec.js":9254,"./app/entities/MusicSelection.spec.js":82076,"./app/entities/Options.spec.js":44469,"./app/interactors/createAutoVelocity.spec.js":16197,"./app/interactors/createCollectionLoader.spec.js":83188,"./app/interactors/findMatchingSong.spec.js":39901,"./app/interactors/getLR2Score.spec.js":53605,"./app/redux/ReduxState.spec.js":76576,"./custom-folder/index.spec.ts":70692,"./custom-song-loader/index.spec.js":24631,"./game/audio/player-audio.spec.js":907,"./game/audio/wave-factory.spec.js":48688,"./game/display/Gauge.spec.js":52516,"./game/display/note-area.spec.js":18030,"./game/display/player-display.spec.js":25238,"./game/input/index.spec.js":62610,"./game/input/touch-plugin.spec.js":19367,"./game/judgments.spec.js":36678,"./game/loaders/samples-loader.spec.js":39227,"./game/state/player-state.spec.js":70759,"./game/state/player-stats.spec.js":63684,"./keysound-cache/createKeysoundCache.spec.js":54592,"./music-collection/index.spec.ts":70874,"./omni-input/index.spec.js":55012,"./online/data-store.spec.js":50469,"./online/index.spec.js":92601,"./progress/formatters.spec.js":23847,"./progress/index.spec.js":77072,"./progress/utils.spec.js":77440,"./resources/bemuse-package.spec.js":57561,"./resources/url.spec.js":89333,"./sampling-master/index.spec.js":27362,"./sampling-master/ogg.spec.ts":28523,"./scintillator/expression/index.spec.js":69020,"./scintillator/index.spec.js":83451,"./scintillator/nodes/concerns/animation.spec.js":27817,"./utils/download.spec.js":42485,"./utils/formatTime.spec.js":13055,"./utils/observable.spec.js":17302,"./utils/read-blob.spec.js":90007}
function s(e){var t=o(e)
return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'")
throw t.code="MODULE_NOT_FOUND",t}return a[e]}s.keys=function(){return Object.keys(a)},s.resolve=o,e.exports=s,s.id=91641},87951:function(e,t,n){"use strict"
var a=n(95970),s=n.n(a),o=n(50146),c=n.n(o)()(s())
c.push([e.id,"#mocha-stats em {\n  color: white;\n}\n\n.mocha-is-passing::before {\n  content: '';\n  display: block;\n  background: #0c0;\n  position: fixed;\n  top: 0;\n  right: 0;\n  height: 10px;\n  left: 0;\n}\n\n.mocha-is-failing::before {\n  content: '';\n  display: block;\n  background: #c00;\n  position: fixed;\n  top: 0;\n  right: 0;\n  height: 10px;\n  left: 0;\n}\n","",{version:3,sources:["webpack://./test/support/mocha-overrides.css"],names:[],mappings:"AAAA;EACE,YAAY;AACd;;AAEA;EACE,WAAW;EACX,cAAc;EACd,gBAAgB;EAChB,eAAe;EACf,MAAM;EACN,QAAQ;EACR,YAAY;EACZ,OAAO;AACT;;AAEA;EACE,WAAW;EACX,cAAc;EACd,gBAAgB;EAChB,eAAe;EACf,MAAM;EACN,QAAQ;EACR,YAAY;EACZ,OAAO;AACT",sourcesContent:["#mocha-stats em {\n  color: white;\n}\n\n.mocha-is-passing::before {\n  content: '';\n  display: block;\n  background: #0c0;\n  position: fixed;\n  top: 0;\n  right: 0;\n  height: 10px;\n  left: 0;\n}\n\n.mocha-is-failing::before {\n  content: '';\n  display: block;\n  background: #c00;\n  position: fixed;\n  top: 0;\n  right: 0;\n  height: 10px;\n  left: 0;\n}\n"],sourceRoot:""}]),t.Z=c},86575:function(e){e.exports={songs:[{id:"[aoi]olivia",path:"[aoi]olivia",title:"オリヴィアの幻術",artist:"葵",genre:"Sexy Dance",bpm:128,artist_url:"http://aoi.prismusic.net/",bms_url:"http://manbow.nothing.sh/event/event.cgi?action=More_def&num=131&event=96",song_url:"https://soundcloud.com/aoi-kakuta/mou5p223mclf",long_url:"https://soundcloud.com/aoi-kakuta/groundbreaking-mix",charts:[{file:"olivia_SPA.bml",md5:"b301d67f3639cd2701c5ef7a25485a34",info:{title:"オリヴィアの幻術",artist:"葵",genre:"Sexy Dance",subtitles:["SP Another"],subartists:["mov:いとう まさき"],difficulty:4,level:11},noteCount:1158,scratch:!0,keys:"7K",bpm:{init:128,min:128,median:128,max:128}},{file:"olivia_SPH.bml",md5:"01ee4891199f523c170677433a625592",info:{title:"オリヴィアの幻術",artist:"葵",genre:"Sexy Dance",subtitles:["SP Hyper"],subartists:["mov:いとう まさき"],difficulty:3,level:7},noteCount:716,scratch:!0,keys:"7K",bpm:{init:128,min:128,median:128,max:128}},{file:"olivia_SPN.bml",md5:"33e4b2616c05ace330c7eb3ccc7d080a",info:{title:"オリヴィアの幻術",artist:"葵",genre:"Sexy Dance",subtitles:["SP Normal"],subartists:["mov:いとう まさき"],difficulty:2,level:4},noteCount:447,scratch:!0,keys:"7K",bpm:{init:128,min:128,median:128,max:128}},{file:"olivia_SPpp.bml",md5:"64d2a8eec9f048634ff9a32cfa064ab8",info:{title:"オリヴィアの幻術",artist:"葵",genre:"Sexy Dance",subtitles:["Tonalite"],subartists:["mov:いとう まさき/obj:止ヒ糸"],difficulty:5,level:8},noteCount:1097,scratch:!0,keys:"7K",bpm:{init:128,min:128,median:128,max:128}}]},{id:"[flicknote]bymyside",path:"[flicknote]bymyside",title:"BY☆MY☆SIDE",artist:"flicknote",genre:"Trance Core",bpm:178,artist_url:"https://soundcloud.com/o_ooooo",song_url:"https://soundcloud.com/o_ooooo/by-my-side",tutorial:1,charts:[{file:"ByMySide-TUTORIAL.bms",md5:"006d92b8410a8683f347f2bee424d9c1",info:{title:"BY☆MY☆SIDE",artist:"flicknote",genre:"Trance Core",subtitles:["TUTORIAL"],subartists:[],difficulty:0,level:0},noteCount:511,scratch:!0,keys:"7K",bpm:{init:178,min:178,median:178,max:178}}]},{id:"[ice]l",path:"[ice]l",title:"L",artist:"Ice",genre:"RENAISSANCE PRAYER",bpm:155,artist_url:"https://soundcloud.com/iceloki",bms_url:"http://manbow.nothing.sh/event/event.cgi?action=More_def&num=146&event=83",song_url:"https://soundcloud.com/iceloki/l-bms-edit",charts:[{file:"L_[DP-Lokinother].bms",md5:"07bde7731a578ffb1af4a27948b002ac",info:{title:"L",artist:"Ice",genre:"RENAISSANCE PRAYER",subtitles:["LOKINOTHER"],subartists:[],difficulty:5,level:12},noteCount:1166,scratch:!0,keys:"14K",bpm:{init:155,min:155,median:155,max:155}},{file:"L_[DPA].bms",md5:"925b52c71c25c554ee603e7a4f8ba4e8",info:{title:"L",artist:"Ice",genre:"RENAISSANCE PRAYER",subtitles:["ANOTHER"],subartists:[],difficulty:4,level:12},noteCount:893,scratch:!0,keys:"14K",bpm:{init:155,min:155,median:155,max:155}},{file:"L_[DPH].bms",md5:"d0302876b6f50419f81e367a80bb1e1f",info:{title:"L",artist:"Ice",genre:"RENAISSANCE PRAYER",subtitles:["HYPER"],subartists:[],difficulty:3,level:12},noteCount:600,scratch:!0,keys:"14K",bpm:{init:155,min:155,median:155,max:155}},{file:"L_[DPN].bms",md5:"d146b4f0a91d4432890d3feaede2da86",info:{title:"L",artist:"Ice",genre:"RENAISSANCE PRAYER",subtitles:["NORMAL"],subartists:[],difficulty:2,level:8},noteCount:355,scratch:!0,keys:"14K",bpm:{init:155,min:155,median:155,max:155}},{file:"L_[SP-Ayauto-normal].bms",md5:"35a9eb6654cd0467755b5088741da080",info:{title:"L",artist:"Ice",genre:"RENAISSANCE PRAYER",subtitles:["AYAUTO-NORMAL"],subartists:[],difficulty:2,level:9},noteCount:495,scratch:!0,keys:"7K",bpm:{init:155,min:155,median:155,max:155}},{file:"L_[SP-hyper-lite].bms",md5:"cc4f7f1cc6fbcaf5a1b149189066f152",info:{title:"L",artist:"Ice",genre:"RENAISSANCE PRAYER",subtitles:["HYPER-LITE"],subartists:[],difficulty:3,level:10},noteCount:999,scratch:!0,keys:"7K",bpm:{init:155,min:155,median:155,max:155}},{file:"L_[SP-Loathe](lai-).bms",md5:"765ced583b56843f6d20b858605a6383",info:{title:"L",artist:"Ice (obj Ice vs lai-)",genre:"RENAISSANCE PRAYER",subtitles:["LOATHE"],subartists:[],difficulty:5,level:18},noteCount:2458,scratch:!0,keys:"7K",bpm:{init:155,min:155,median:155,max:155}},{file:"L_[SP-Lokinother].bms",md5:"d15fa5e17826c126357f03aca678ccbb",info:{title:"L",artist:"Ice",genre:"RENAISSANCE PRAYER",subtitles:["LOKINOTHER"],subartists:[],difficulty:5,level:20},noteCount:3133,scratch:!0,keys:"7K",bpm:{init:155,min:155,median:155,max:155}},{file:"L_[SPA](XEIR).bme",md5:"aadb7d00993afd10642ee637c8981e5b",info:{title:"L",artist:"Ice (object: XEIR)",genre:"RENAISSANCE PRAYER",subtitles:["ANOTHER"],subartists:[],difficulty:4,level:12},noteCount:2101,scratch:!0,keys:"7K",bpm:{init:155,min:155,median:155,max:155}},{file:"L_[SPH](XEIR).bme",md5:"20c14547a180ed2703670af5b83e12d5",info:{title:"L",artist:"Ice (object: XEIR)",genre:"RENAISSANCE PRAYER",subtitles:["HYPER"],subartists:[],difficulty:3,level:11},noteCount:1465,scratch:!0,keys:"7K",bpm:{init:155,min:155,median:155,max:155}},{file:"L_[SPN].bms",md5:"694c89556e73ba4c667a714c51c2764a",info:{title:"L",artist:"Ice",genre:"RENAISSANCE PRAYER",subtitles:["NORMAL"],subartists:[],difficulty:2,level:7},noteCount:639,scratch:!0,keys:"7K",bpm:{init:155,min:155,median:155,max:155}}]},{id:"[puru]homura",path:"[puru]homura",title:"Homura",artist:"puru",genre:"Future Bass",bpm:180,artist_url:"https://soundcloud.com/puru",bms_url:"http://manbow.nothing.sh/event/event.cgi?action=More_def&num=242&event=96",song_url:"https://soundcloud.com/puru/homura",long_url:"https://soundcloud.com/puru/homuraextendmix",charts:[{file:"Homura(A).bms",md5:"53b31ae4944b9d945ea976c0845cf1f8",info:{title:"Homura",artist:"Puru / kkkfff2",genre:"Future Bass",subtitles:["A"],subartists:[],difficulty:4,level:10},noteCount:1128,scratch:!0,keys:"7K",bpm:{init:180,min:180,median:180,max:180}},{file:"Homura(D).bms",md5:"68ca471bb809bc3e3266c75078d0a5eb",info:{title:"Homura",artist:"Puru / kkkfff2",genre:"Future Bass",subtitles:["D"],subartists:[],difficulty:5,level:12},noteCount:1443,scratch:!0,keys:"7K",bpm:{init:180,min:180,median:180,max:180}},{file:"Homura(H).bms",md5:"a59425e69e2ccd8532b3e1522ff46344",info:{title:"Homura",artist:"Puru / kkkfff2",genre:"Future Bass",subtitles:["H"],subartists:[],difficulty:3,level:8},noteCount:916,scratch:!0,keys:"7K",bpm:{init:180,min:180,median:180,max:180}},{file:"Homura(N).bms",md5:"f79071d1c28b394d5f4b2516087bf28c",info:{title:"Homura",artist:"Puru / kkkfff2",genre:"Future Bass",subtitles:["N"],subartists:[],difficulty:2,level:6},noteCount:637,scratch:!0,keys:"7K",bpm:{init:180,min:180,median:180,max:180}}]},{id:"[puru]toki",path:"[puru]toki",title:"Toki",artist:"puru",genre:"ProgressiveTrance",bpm:130,artist_url:"https://soundcloud.com/puru",bms_url:"http://manbow.nothing.sh/event/event.cgi?action=More_def&num=101&event=83",song_url:"https://soundcloud.com/puru/bof2012-toki-bms-ver",long_url:"https://soundcloud.com/pineappledigital/puru-toki-original-mix-preview",charts:[{file:"toki_another14.bms",md5:"ea0ab466efb607f7429b31e8a63b09f4",info:{title:"Toki",artist:"puru / kkkfff2 / Obj. Z_N",genre:"ProgressiveTrance",subtitles:["DP ANOTHER"],subartists:[],difficulty:4,level:11},noteCount:706,scratch:!0,keys:"14K",bpm:{init:130,min:130,median:130,max:130}},{file:"toki_another7.bms",md5:"fbe734a400152f13da14ab34adc70486",info:{title:"Toki",artist:"puru / kkkfff2",genre:"ProgressiveTrance",subtitles:["ANOTHER"],subartists:[],difficulty:4,level:10},noteCount:1087,scratch:!0,keys:"7K",bpm:{init:130,min:130,median:130,max:130}},{file:"toki_beginner7.bms",md5:"abd8fc9eaf68907ffaeaaeb28724ef88",info:{title:"Toki",artist:"puru / kkkfff2",genre:"ProgressiveTrance",subtitles:["BEGINNER"],subartists:[],difficulty:1,level:3},noteCount:342,scratch:!0,keys:"7K",bpm:{init:130,min:130,median:130,max:130}},{file:"toki_clockwise7.bms",md5:"8f0d978c82050ba902d9247792aab764",info:{title:"Toki",artist:"puru / kkkfff2",genre:"ProgressiveTrance",subtitles:["ClockWise"],subartists:["obj.sialua"],difficulty:5,level:3},noteCount:1741,scratch:!0,keys:"7K",bpm:{init:130,min:130,median:130,max:130}},{file:"toki_hyper14.bms",md5:"82d3930443bf62cf68812f0cef08723c",info:{title:"Toki",artist:"puru / kkkfff2 / Obj. Z_N",genre:"ProgressiveTrance",subtitles:["DP HYPER"],subartists:[],difficulty:3,level:9},noteCount:505,scratch:!0,keys:"14K",bpm:{init:130,min:130,median:130,max:130}},{file:"toki_hyper7.bms",md5:"2a0ad67c104b2094009944078ff5dfe0",info:{title:"Toki",artist:"puru / kkkfff2",genre:"ProgressiveTrance",subtitles:["HYPER"],subartists:[],difficulty:3,level:8},noteCount:825,scratch:!0,keys:"7K",bpm:{init:130,min:130,median:130,max:130}},{file:"toki_LN1_fix.bms",md5:"6ce2114a47f2c93a78a537587b1d5554",info:{title:"Toki",artist:"puru / kkkfff2",genre:"ProgressiveTrance",subtitles:["Grandfather's Clock"],subartists:["obj:K-SPIN"],difficulty:3,level:11},noteCount:916,scratch:!0,keys:"7K",bpm:{init:130,min:130,median:130,max:130}},{file:"toki_LN2_fix.bms",md5:"eb5118053664ea036ea0fe9c60d3daed",info:{title:"Toki",artist:"puru / kkkfff2",genre:"ProgressiveTrance",subtitles:["Grandfather's Curtain"],subartists:["obj:K-SPIN"],difficulty:4,level:12},noteCount:1134,scratch:!0,keys:"7K",bpm:{init:130,min:130,median:130,max:130}},{file:"toki_normal7.bms",md5:"6cd9cb6787509ae84a738a78cf980e8a",info:{title:"Toki",artist:"puru / kkkfff2",genre:"ProgressiveTrance",subtitles:["NORMAL"],subartists:[],difficulty:0,level:6},noteCount:485,scratch:!0,keys:"7K",bpm:{init:130,min:130,median:130,max:130}}]},{id:"[ricora]epilogue",path:"[ricora]epilogue",title:"僕たちの旅とエピローグ。",artist:"ああああ",genre:"game music",bpm:170,artist_url:"https://soundcloud.com/ricora",bms_url:"http://manbow.nothing.sh/event/event.cgi?action=More_def&num=98&event=96",song_url:"https://soundcloud.com/ricora/g2rbms",charts:[{file:"another.bms",md5:"23b6aae160154b4dda9cbca7c4368c1c",info:{title:"僕たちの旅とエピローグ。",artist:"ああああ",genre:"game music",subtitles:["another"],subartists:[],difficulty:0,level:12},noteCount:1235,scratch:!0,keys:"7K",bpm:{init:98,min:94,median:170,max:185}},{file:"hyper.bms",md5:"c6e94c372e952a3146baf07b83e1052d",info:{title:"僕たちの旅とエピローグ。",artist:"ああああ",genre:"game music",subtitles:["hyper"],subartists:[],difficulty:0,level:9},noteCount:776,scratch:!0,keys:"7K",bpm:{init:98,min:94,median:170,max:185}},{file:"normal.bms",md5:"aeeec7740bfde42989d477f86d5ca91e",info:{title:"僕たちの旅とエピローグ。",artist:"ああああ",genre:"game music",subtitles:["normal"],subartists:[],difficulty:0,level:5},noteCount:405,scratch:!0,keys:"5K",bpm:{init:98,min:94,median:170,max:185}}]},{id:"[sky_delta]kreuz",path:"[sky_delta]kreuz",title:"Kreuz",artist:"sky_delta",genre:"IDM",bpm:183,artist_url:"https://soundcloud.com/sky_delta",bms_url:"http://manbow.nothing.sh/event/event.cgi?action=More_def&num=89&event=96",song_url:"https://soundcloud.com/sky_delta/kreuz",charts:[{file:"kreuz_spa.bms",md5:"5c29aeca8a8b2f303d6587f50277c939",info:{title:"Kreuz",artist:"sky_delta",genre:"IDM",subtitles:["Another"],subartists:[],difficulty:4,level:12},noteCount:1523,scratch:!0,keys:"7K",bpm:{init:183,min:91.5,median:183,max:183}},{file:"kreuz_sph.bms",md5:"eefb650199700b7682f930b597c2c50c",info:{title:"Kreuz",artist:"sky_delta",genre:"IDM",subtitles:["Hyper"],subartists:[],difficulty:3,level:9},noteCount:891,scratch:!0,keys:"7K",bpm:{init:183,min:91.5,median:183,max:183}},{file:"kreuz_spn.bms",md5:"86e3a22472e94adda5f89b36e00389ca",info:{title:"Kreuz",artist:"sky_delta",genre:"IDM",subtitles:["Normal"],subartists:[],difficulty:2,level:5},noteCount:421,scratch:!0,keys:"7K",bpm:{init:183,min:91.5,median:183,max:183}}]},{id:"[snack]dddd",path:"[snack]dddd",title:"Developers, Developers, Developers, Developers!",artist:"Snack",genre:"Tribute",bpm:200,artist_url:"http://korsnack.kr/",bms_url:"http://k-bms.com/party_pabat/party2015.jsp?board_num=15&num=16&order=reg&odtype=a",song_url:"https://soundcloud.com/korsnack/ddddevelopers",charts:[{file:"dddd_dpa.bme",md5:"1d33d50e2d0a06e85f8eb6b5eab8ea08",info:{title:"Developers, Developers, Developers, Developers!",artist:"Snack",genre:"Tribute",subtitles:["DP ANOTHER"],subartists:[],difficulty:4,level:12},noteCount:954,scratch:!0,keys:"14K",bpm:{init:200,min:200,median:200,max:200}},{file:"dddd_dph.bme",md5:"98ef1bd4ed2ec2aad3b9550d86a50f9e",info:{title:"Developers, Developers, Developers, Developers!",artist:"Snack",genre:"Tribute",subtitles:["DP HYPER"],subartists:[],difficulty:3,level:10},noteCount:660,scratch:!0,keys:"14K",bpm:{init:200,min:200,median:200,max:200}},{file:"dddd_dpn.bme",md5:"5051253910a8b732cb07018c8b9ffa8d",info:{title:"Developers, Developers, Developers, Developers!",artist:"Snack",genre:"Tribute",subtitles:["DP NORMAL"],subartists:[],difficulty:2,level:7},noteCount:481,scratch:!0,keys:"14K",bpm:{init:200,min:200,median:200,max:200}},{file:"dddd_spa.bme",md5:"e50d342e7ba934b97080a5b070cca22b",info:{title:"Developers, Developers, Developers, Developers!",artist:"Snack",genre:"Tribute",subtitles:["SP ANOTHER"],subartists:[],difficulty:4,level:12},noteCount:1800,scratch:!0,keys:"7K",bpm:{init:200,min:200,median:200,max:200}},{file:"dddd_sph.bme",md5:"3a513929761da3509f50560933a7b453",info:{title:"Developers, Developers, Developers, Developers!",artist:"Snack",genre:"Tribute",subtitles:["SP HYPER"],subartists:[],difficulty:3,level:10},noteCount:1400,scratch:!0,keys:"7K",bpm:{init:200,min:200,median:200,max:200}},{file:"dddd_spn.bme",md5:"1c259d92801ad4b197296ff89420d863",info:{title:"Developers, Developers, Developers, Developers!",artist:"Snack",genre:"Tribute",subtitles:["SP NORMAL"],subartists:[],difficulty:2,level:7},noteCount:990,scratch:!0,keys:"7K",bpm:{init:200,min:200,median:200,max:200}},{file:"dddd_spx.bme",md5:"fa1c8c0053054438632d1f9e647f9dba",info:{title:"Developers, Developers, Developers, Developers!",artist:"Snack",genre:"Tribute",subtitles:["SP EXCEPTION"],subartists:[],difficulty:5,level:13},noteCount:2500,scratch:!0,keys:"7K",bpm:{init:200,min:200,median:200,max:200}}]},{id:"[tis]airtrip",path:"[tis]airtrip",title:"AirTrip-SF#2-",artist:"TiS",genre:"PROGRESSIVE FUSION",bpm:266,artist_url:"https://soundcloud.com/house-x",bms_url:"http://manbow.nothing.sh/event/event.cgi?action=More_def&num=154&event=96",song_url:"https://soundcloud.com/house-x/airtrip-bms-mix",charts:[{file:"airtrip_a.bme",md5:"f14357d72c2c11081fd45dc00aa4cffa",info:{title:"AirTrip-SF#2-",artist:"TiS",genre:"PROGRESSIVE FUSION",subtitles:["ANOTHER"],subartists:[],difficulty:4,level:12},noteCount:1921,scratch:!0,keys:"7K",bpm:{init:266,min:266,median:266,max:266}},{file:"airtrip_h.bme",md5:"a43cc5cd115c32c934bed8e056362e2b",info:{title:"AirTrip-SF#2-",artist:"TiS",genre:"PROGRESSIVE FUSION",subtitles:["HYPER"],subartists:[],difficulty:3,level:11},noteCount:1506,scratch:!0,keys:"7K",bpm:{init:266,min:266,median:266,max:266}},{file:"airtrip_n.bme",md5:"2058a2b19f6e03a42799bfdf8b62dc48",info:{title:"AirTrip-SF#2-",artist:"TiS",genre:"PROGRESSIVE FUSION",subtitles:["NORMAL"],subartists:[],difficulty:2,level:5},noteCount:592,scratch:!0,keys:"7K",bpm:{init:266,min:266,median:266,max:266}}]},{id:"[void]caelumize",path:"[void]caelumize",title:"Caelumize",artist:"void",genre:"Filmscore / Neurocore",bpm:175,artist_url:"http://mournfinale.com/",bms_url:"http://manbow.nothing.sh/event/event.cgi?action=More_def&num=389&event=88",long_url:"https://soundcloud.com/mournfinale/void-caelumize",charts:[{file:"01spb.bml",md5:"dcbbecfead7fd61547c2e37910bf656f",info:{title:"Caelumize",artist:"void",genre:"Filmscore / Neurocore",subtitles:[],subartists:["Momomi Aoyama"],difficulty:1,level:3},noteCount:348,scratch:!0,keys:"7K",bpm:{init:175,min:175,median:175,max:175}},{file:"02spn.bml",md5:"53dfc76d4bca81101f40411b6556e442",info:{title:"Caelumize",artist:"void",genre:"Filmscore / Neurocore",subtitles:[],subartists:["Momomi Aoyama"],difficulty:2,level:6},noteCount:584,scratch:!0,keys:"7K",bpm:{init:175,min:175,median:175,max:175}},{file:"03sph.bml",md5:"4aab905d3502fc436669c84db02a1954",info:{title:"Caelumize",artist:"void",genre:"Filmscore / Neurocore",subtitles:[],subartists:["Momomi Aoyama"],difficulty:3,level:9},noteCount:975,scratch:!0,keys:"7K",bpm:{init:175,min:175,median:175,max:175}},{file:"04spa.bml",md5:"ff9f57e9d4f55e61d90de053816fc0f4",info:{title:"Caelumize",artist:"void",genre:"Filmscore / Neurocore",subtitles:[],subartists:["Momomi Aoyama"],difficulty:4,level:11},noteCount:1331,scratch:!0,keys:"7K",bpm:{init:175,min:175,median:175,max:175}}]},{id:"[w_tre]chicken",path:"[w_tre]chicken",title:"CHICKEN for the WIN",artist:"w_tre",genre:"electro",bpm:128,artist_url:"http://soundcloud.com/7_wtre",bms_url:"http://manbow.nothing.sh/event/event.cgi?action=More_def&num=32&event=96",song_url:"https://soundcloud.com/7_wtre/c4tw",charts:[{file:"chicken_5a.bms",md5:"feadbe808a674445c759145c039036ce",info:{title:"CHICKEN for the WIN",artist:"innkeeper",genre:"electro",subtitles:["5 ENRAGED"],subartists:["SmiGoon Respect CHICKEN"],difficulty:4,level:10},noteCount:973,scratch:!0,keys:"5K",bpm:{init:128,min:128,median:128,max:128}},{file:"chicken_5h.bms",md5:"2e5b7e5a4727abde6bf608c9bbf4301b",info:{title:"CHICKEN for the WIN",artist:"innkeeper",genre:"electro",subtitles:["5 BUFFED"],subartists:["SmiGoon Respect CHICKEN"],difficulty:3,level:7},noteCount:682,scratch:!0,keys:"5K",bpm:{init:128,min:128,median:128,max:128}},{file:"chicken_5n.bms",md5:"fae9b6067e63a497118e695706792d07",info:{title:"CHICKEN for the WIN",artist:"innkeeper",genre:"electro",subtitles:["5 SUMMONED"],subartists:["SmiGoon Respect CHICKEN"],difficulty:2,level:3},noteCount:352,scratch:!0,keys:"5K",bpm:{init:128,min:128,median:128,max:128}},{file:"chicken_7a.bme",md5:"2c41613fb1dcff6126a9b745a8ffcf74",info:{title:"CHICKEN for the WIN",artist:"innkeeper",genre:"electro",subtitles:["7 ENRAGED"],subartists:["Pattern : KRX"],difficulty:4,level:11},noteCount:1332,scratch:!0,keys:"7K",bpm:{init:128,min:64,median:128,max:128}},{file:"chicken_7h.bme",md5:"deaf9009669eb8353fcf5199b6d72a2e",info:{title:"CHICKEN for the WIN",artist:"innkeeper",genre:"electro",subtitles:["7 BUFFED"],subartists:["Pattern : KRX"],difficulty:3,level:8},noteCount:871,scratch:!0,keys:"7K",bpm:{init:128,min:128,median:128,max:128}},{file:"chicken_7n.bme",md5:"379ea003d006df4a6a7e250e03996b0c",info:{title:"CHICKEN for the WIN",artist:"innkeeper",genre:"electro",subtitles:["7 SUMMONED"],subartists:["Pattern : KRX"],difficulty:2,level:5},noteCount:532,scratch:!0,keys:"7K",bpm:{init:128,min:128,median:128,max:128}}]},{id:"[w_tre]mom",path:"[w_tre]mom",title:"mom",artist:"w_tre",genre:"piano",bpm:90,artist_url:"http://soundcloud.com/7_wtre",bms_url:"http://k-bms.com/party_pabat/party2015.jsp?board_num=15&num=32&order=reg&odtype=a",song_url:"https://soundcloud.com/7_wtre/mom",charts:[{file:"mom_s1.bme",md5:"9ca6f832f8d5b85549c3129e740d1705",info:{title:"mom",artist:"w_tre",genre:"piano",subtitles:["[normal]"],subartists:[],difficulty:0,level:2},noteCount:155,scratch:!0,keys:"7K",bpm:{init:90,min:90,median:90,max:90}},{file:"mom_s2.bme",md5:"557b4da440303c0421d972876600a513",info:{title:"mom",artist:"w_tre",genre:"piano",subtitles:["[hyper]"],subartists:[],difficulty:0,level:5},noteCount:434,scratch:!0,keys:"7K",bpm:{init:90,min:90,median:90,max:90}},{file:"mom_s3.bme",md5:"1444f6dfaa7fd802586af5b331bac1ca",info:{title:"mom",artist:"w_tre",genre:"piano",subtitles:["[another]"],subartists:[],difficulty:0,level:9},noteCount:925,scratch:!0,keys:"7K",bpm:{init:90,min:90,median:90,max:90}},{file:"mom_s4.bme",md5:"010492dbce773e39992651ce11a146d5",info:{title:"mom",artist:"w_tre",genre:"piano",subtitles:["[insane]"],subartists:["obj. sialua"],difficulty:5,level:12},noteCount:1758,scratch:!0,keys:"7K",bpm:{init:90,min:90,median:90,max:90}}]},{id:"[yukitani]acp",path:"[yukitani]acp",title:"Amusing Colorful Pudding.",artist:"yukitani",genre:"Electro Swing Pop",bpm:226,artist_url:"https://soundcloud.com/yukitani",bms_url:"http://manbow.nothing.sh/event/event.cgi?action=More_def&num=147&event=96",song_url:"https://soundcloud.com/yukitani/amusing-colorful-pudding",charts:[{file:"acp.bme",md5:"1df76e4d513ea545bf5cadfd52731abe",info:{title:"Amusing Colorful Pudding.",artist:"yukitani / DKN",genre:"Electro Swing Pop",subtitles:["dorodoro"],subartists:[],difficulty:0,level:12},noteCount:1820,scratch:!0,keys:"7K",bpm:{init:226,min:226,median:226,max:226}},{file:"acph.bme",md5:"963868a59ecc4b8f80cd1d377b17557a",info:{title:"Amusing Colorful Pudding.",artist:"yukitani / DKN",genre:"Electro Swing Pop",subtitles:["nameraca"],subartists:[],difficulty:0,level:10},noteCount:1130,scratch:!0,keys:"7K",bpm:{init:226,min:226,median:226,max:226}},{file:"acpn.bme",md5:"15e39902521c9012a403da7d556009de",info:{title:"Amusing Colorful Pudding.",artist:"yukitani / DKN",genre:"Electro Swing Pop",subtitles:["funwari"],subartists:[],difficulty:0,level:6},noteCount:576,scratch:!0,keys:"7K",bpm:{init:226,min:226,median:226,max:226}}]}]}},73730:function(e){function t(e){var t=new Error("Cannot find module '"+e+"'")
throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=73730,e.exports=t},49886:function(e,t,n){"use strict"
var a=n(62270),s=n.n(a),o=n(48274),c=n.n(o)
t.Z=e=>{return c()("boolean"==typeof e.enabled,"enabled must be a boolean"),c()("number"==typeof e.initialSpeed,"initialSpeed must be a number"),c()("number"==typeof e.desiredLeadTime,"desiredLeadTime must be a number"),c()("number"==typeof e.songBPM,"songBPM must be a number"),e.enabled?function({songBPM:e,desiredLeadTime:t,laneCover:n}){const a=1-Math.abs(n),o=3e5/e*a,c=s().minBy(s().range(1,999).map((e=>e/10)),(e=>Math.abs(t-o/e)))
return{getInitialSpeed(){return c},handleGameFinish(e,{saveSpeed:t,saveLeadTime:n}){t(e),e.toFixed(1)!==c.toFixed(1)&&n(Math.round(o/e))}}}({desiredLeadTime:e.desiredLeadTime,songBPM:e.songBPM,laneCover:e.laneCover||0}):(t=e.initialSpeed,{getInitialSpeed(){return t},handleGameFinish(e,{saveSpeed:t}){t(e)}})
var t}},14179:function(e,t,n){"use strict"
n.d(t,{o:function(){return c},Z:function(){return r}})
var a=n(20294),s=n(21081)
var o=function(e){const t=e.subscribe((e=>e()))
return{dispose:()=>t.unsubscribe()}}
function c({onBeginLoading:e,onLoad:t,onErrorLoading:n,fetch:c}){const r=new a.xQ,i=r.groupBy((e=>e)).flatMap((o=>o.switchMap((o=>a.y$.concat(a.y$.of((()=>e(o))),a.y$.fromPromise((0,s.zD)(o,{fetch:c}).then((e=>()=>t(o,e)),(e=>()=>n(o,e)))))))))
return{load:function(e){r.next(e)},dispose:o(i).dispose}}var r=c},18774:function(e,t){"use strict"
t.Z=function({songs:e,title:t,getTitle:n}){for(const o of e)if(a=n(o),s=t,String(a).toLowerCase().trim()===String(s).toLowerCase().trim())return o
var a,s}},70692:function(e,t,n){"use strict"
n.r(t)
var a=n(94533)
const s={log:e=>{},setStatus:e=>{},updateState:()=>{}}
class o{constructor(){this.map=new Map}async get(e){return this.map.get(e)}async set(e,t){this.map.set(e,t)}async del(e){this.map.delete(e)}}const c={"normal.bms":"#TITLE meow [NORMAL]\n#BPM 90\n#00111:01","hyper.bms":"#TITLE meow [HYPER]\n#BPM 90\n#00111:01"},r={"normal.bms":"#TITLE nyan [NORMAL]\n#BPM 90\n#00111:01","hyper.bms":"#TITLE nyan [HYPER]\n#BPM 90\n#00111:01"}
it("allows setting custom folder and loading it in-game",(async()=>{const e={song1:c,song2:r},t=new i
await t.setFolder(e),await t.checkState((async e=>{expect(e.chartFilesScanned).not.to.equal(!0)})),await t.scan(),await t.checkState((async e=>{expect(e.songs).to.have.length(2)}))})),it("can scan for new songs",(async()=>{const e={song1:c},t=new i
await t.setFolder(e),await t.scan(),await t.checkState((async e=>{expect(e.songs).to.have.length(1)})),e.song2=r,await t.scan(),await t.checkState((async e=>{expect(e.songs).to.have.length(2)}))})),it("detects deleted folders",(async()=>{const e={song1:c,song2:r},t=new i
await t.setFolder(e),await t.scan(),await t.checkState((async e=>{expect(e.songs).to.have.length(2)})),delete e.song1,await t.scan(),await t.checkState((async e=>{expect(e.songs).to.have.length(1)}))}))
class i{constructor(){this.context=new o,this.context=new o}async setFolder(e){await(0,a.bW)(this.context,u(e))}async scan(){await(0,a.xm)(this.context,s)}async checkState(e){const t=await(0,a.x9)(this.context)
expect(t).not.to.equal(void 0),await e(t)}}function u(e){return{kind:"directory",queryPermission:async()=>"granted",[Symbol.asyncIterator]:async function*(){for(const[t,n]of Object.entries(e))"string"==typeof n?yield[t,l(t,n)]:yield[t,u(n)]},getDirectoryHandle:async t=>(expect(e[t]).to.be.an("object"),u(e[t])),getFileHandle:async t=>(expect(e[t]).to.be.a("string"),l(t,e[t]))}}function l(e,t){return{kind:"file",queryPermission:async()=>"granted",getFile:async()=>{const n=new Blob([t],{type:"text/plain"})
return Object.assign(n,{name:e,lastModified:1})}}}},53294:function(e,t,n){"use strict"
n.d(t,{B9:function(){return u},bw:function(){return r},qK:function(){return i}})
var a=n(35982),s=n(88339),o=n(11598),c=n(62270)
const r=n.n(c)().tap
function i(e,t={}){return(0,s.fromBMSChart)(function(e=""){return a.Compiler.compile(e).chart}(e),t)}function u(e,t={}){return new o.Z(i(e,t),1,t)}},21081:function(e,t,n){"use strict"
n.d(t,{d8:function(){return o},p_:function(){return a},zD:function(){return s}})
const a="https://music4.bemuse.ninja/server"
async function s(e,{fetch:t=n.g.fetch}={}){const a=o(e),s=await t(a).then((e=>e.json()))
if(Array.isArray(s.songs))return s
if(Array.isArray(s.charts)){const e=a.replace(/[^/]*$/,"")
return{songs:[{...s,id:"song",path:e}]}}throw new Error(`Invalid server file at ${a}: Does not contain "songs" array.`)}function o(e){return e.endsWith("/bemuse-song.json")?e:e.replace(/\/(?:index\.json)?$/,"")+"/index.json"}},70874:function(e,t,n){"use strict"
n.r(t)
var a=n(21081)
describe("getServerIndexFileUrl",(()=>{it("adds index.json",(()=>{expect((0,a.d8)("https://server")).to.equal("https://server/index.json")})),it("allows subdirectories",(()=>{expect((0,a.d8)("https://server/dir/")).to.equal("https://server/dir/index.json")})),it("allows trailing slashes",(()=>{expect((0,a.d8)("https://server/dir")).to.equal("https://server/dir/index.json")})),it("allows trailing /index.json",(()=>{expect((0,a.d8)("https://server/index.json")).to.equal("https://server/index.json")}))}))},28523:function(e,t,n){"use strict"
n.r(t)
var a=n(37057),s=n(52973)
describe("ogg decoder",(()=>{it("can decode ogg file",(async()=>{const e=await(0,a.Z)(n(10843)).as("arraybuffer"),t=await(0,s.g)(new AudioContext,e)
expect(t.duration).to.closeTo(.04510204081632653,.001)}))}))},48379:function(e,t,n){"use strict"
n.r(t),n.d(t,{main:function(){return C}})
n(14886),n(41171)
var a=n(87672),s=n.n(a),o=n(95541),c=n.n(o),r=n(24324),i=n.n(r),u=n(26419),l=n.n(u),p=n(15669),d=n.n(p),m=n(95076),f=n.n(m),g=n(87951),h={}
h.styleTagTransform=f(),h.setAttributes=l(),h.insert=i().bind(null,"head"),h.domAPI=c(),h.insertStyleElement=d()
s()(g.Z,h)
var b=g.Z&&g.Z.locals?g.Z.locals:void 0,_={}
_.styleTagTransform=f(),_.setAttributes=l(),_.insert=i().bind(null,"head"),_.domAPI=c(),_.insertStyleElement=d()
s()(b,_),b&&b.locals&&b.locals
var j=function(){const e=n(91641)
for(const t of e.keys())describe(t,(()=>{e(t)}))},y=n(57954),x=n(39424),v=n.n(x),w=n(7386),k=n.n(w),S=n(70393)
var E=function(){mocha.setup("bdd"),y.ZP.use(v()),y.ZP.use(k()),n.g.expect=y.ZP.expect,n.g.sinon=S.ZP}
function C(){!function(){const e=document.createElement("div")
e.id="mocha",document.body.appendChild(e)}(),E(),j(),function(){const e=[]
mocha.run().on("test end",(function(e){e.err&&(console.log("%cFailed Spec: %c%s\n %c%s","color: black; font: 16px sans-serif","color: black; font: bold 16px sans-serif",e.title,"color: red; font: bold 1em sans-serif",e.err.message),console.error(e.err.stack))})).on("test end",(function(t){"passed"===t.state?e.push({fullName:t.title,status:"passed"}):t.pending?e.push({fullName:t.title,status:"pending"}):e.push({fullName:t.title,status:"failed",failedExpectations:[{message:t.err.message,stack:t.err.stack}]})})).on("suite end",(function(t){t.root&&(e.some((e=>"failed"===e.status))?document.documentElement.classList.add("mocha-is-failing"):document.documentElement.classList.add("mocha-is-passing"))}))}()}},80457:function(e,t,n){"use strict"
n.r(t)
var a=n(32136),s=n(28010),o=n(22266)
describe("Collections",(function(){it("should receive collection data",(()=>(0,o.$v)(a.E3).when(a.qH("https://test-server/")).and(a.rE("https://test-server/",{x:1})).then(a.V4("https://test-server/"),s.PN,(0,o.We)(!0)))),it("should allow errors",(()=>(0,o.$v)(a.E3).when(a.qH("https://test-server/")).and(a.nF("https://test-server/",new Error("oh no"))).then(a.V4("https://test-server/"),s.VZ,(0,o.We)(!0))))}))},77412:function(e,t,n){"use strict"
n.r(t)
var a=n(28010),s=n(22266)
describe("LoadState",(function(){it("initLoading should be loading",(()=>(0,s.$v)(a.cT()).then(a.hg,(0,s.We)(!0)))),it("completeWithValue should turn it into completed",(()=>(0,s.$v)(a.cT()).when(a.FY(99)).then(a.PN,(0,s.We)(!0)).and(a.S3,(0,s.We)(99)))),it("errorWithReason should turn it into error",(()=>(0,s.$v)(a.cT()).when(a.nA(new Error("x"))).then(a.PN,(0,s.We)(!1)).and(a.VZ,(0,s.We)(!0)).and(a.vU,o,(0,s.We)("x"))))}))
const o=e=>e.message},9254:function(e,t,n){"use strict"
n.r(t)
var a=n(18628),s=n(22266)
describe("MusicSearchText",(function(){it("is initially blank",(()=>(0,s.$v)(a.E3).then(a.fn,(0,s.We)("")).and(a.iJ,(0,s.We)("")))),it("should set inputText when typing",(()=>(0,s.$v)(a.E3).when(a.eE("hello")).then(a.fn,(0,s.We)("")).and(a.iJ,(0,s.We)("hello")))),it("should copy inputText to searchText when debounced",(()=>(0,s.$v)(a.E3).and(a.eE("hello")).when(a.Rq).then(a.fn,(0,s.We)("hello")).and(a.iJ,(0,s.We)("hello")))),it("should allow setting text, changing both",(()=>(0,s.$v)(a.E3).when(a.Hd("meow")).then(a.fn,(0,s.We)("meow")).and(a.iJ,(0,s.We)("meow"))))}))},82076:function(e,t,n){"use strict"
n.r(t)
var a=n(31606),s=n(22266)
describe("MusicSelection",(function(){it("allows selecting song",(()=>(0,s.$v)(a.E3).when(a.AC("song1")).then(a.Oh([{id:"song0",title:"TEST"},{id:"song1",title:"BY MY SIDE"}]),(0,s.We)({id:"song1",title:"BY MY SIDE"})))),it("should fallback to avilaable song if not available",(()=>(0,s.$v)(a.E3).when(a.AC("song1")).then(a.Oh([{id:"song0",title:"TEST"},{id:"song2",title:"RUNNING OUT"}]),(0,s.We)({id:"song0",title:"TEST"})))),it("should allow selecting chart",(()=>(0,s.$v)(a.E3).when(a.Eb("song1","chart1.bml",8)).then((e=>e.selectedSongId),(0,s.We)("song1")).and((e=>e.selectedChartId),(0,s.We)("chart1.bml")).and((e=>e.selectedChartLevel),(0,s.We)(8))))
const e=(0,s.$v)(a.E3).and(a.Eb("song1","chart1.bml",8))
it("selects the chart if available",(()=>e.then(a.v8([{file:"chart0.bml",info:{level:1}},{file:"chart1.bml",info:{level:8}},{file:"chart2.bml",info:{level:12}}]),(0,s.We)({file:"chart1.bml",info:{level:8}})))),it("selects chart with closest level if matching chart not available",(()=>e.then(a.v8([{file:"pattern0.bml",info:{level:2}},{file:"pattern1.bml",info:{level:9}},{file:"pattern2.bml",info:{level:10}}]),(0,s.We)({file:"pattern1.bml",info:{level:9}}))))}))},44469:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(22266),c=n(40297),r=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("Options",(()=>{function e({check:e,toggle:t,defaultSetting:n}){it("defaults to "+n,(()=>{(0,o.$v)(c.initialState).then(e,(0,o.We)(n))})),it("can be toggled",(()=>{(0,o.$v)(c.initialState).when(t).then(e,(0,o.We)(!n))})),it("can be toggled again",(()=>{(0,o.$v)(c.initialState).when(t).and(t).then(e,(0,o.We)(n))}))}describe("Lane cover",(()=>{it("should be a number",(()=>{var e=new r
s()(e._expr(e._capt(0===e._capt(e._capt(c,"arguments/0/left/callee/object").laneCover(e._capt({"player.P1.lane-cover":"0"},"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(Options.laneCover({ 'player.P1.lane-cover': '0' }) === 0)",filepath:"Options.spec.js",line:9}))})),it("should be maximum 50%",(()=>{var e=new r
s()(e._expr(e._capt(.5===e._capt(e._capt(c,"arguments/0/left/callee/object").laneCover(e._capt({"player.P1.lane-cover":"99"},"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(Options.laneCover({ 'player.P1.lane-cover': '99' }) === 0.5)",filepath:"Options.spec.js",line:12}))})),it("should be minimum -50%",(()=>{var e=new r
s()(e._expr(e._capt(e._capt(e._capt(c,"arguments/0/left/callee/object").laneCover(e._capt({"player.P1.lane-cover":"-99"},"arguments/0/left/arguments/0")),"arguments/0/left")===e._capt(-.5,"arguments/0/right"),"arguments/0"),{content:"assert(Options.laneCover({ 'player.P1.lane-cover': '-99' }) === -0.5)",filepath:"Options.spec.js",line:15}))}))})),describe("key config",(()=>{it("can be set and get",(()=>{(0,o.$v)(c.initialState).when(c.changeKeyMapping("KB","4","65")).then(c.getKeyMapping("KB","4"),(0,o.We)("65"))})),it("can be retrieved for current mode by column",(()=>{(0,o.$v)(c.initialState).when(c.changePlayMode("KB")).then(c.keyboardMapping,(e=>{var t=new r
s()(t._expr(t._capt("32"===t._capt(t._capt(e,"arguments/0/left/object")[4],"arguments/0/left"),"arguments/0"),{content:"assert(mapping['4'] === '32')",filepath:"Options.spec.js",line:29}))})),(0,o.$v)(c.initialState).when(c.changePlayMode("BM")).then(c.keyboardMapping,(e=>{var t=new r
s()(t._expr(t._capt("68"===t._capt(t._capt(e,"arguments/0/left/object")[4],"arguments/0/left"),"arguments/0"),{content:"assert(mapping['4'] === '68')",filepath:"Options.spec.js",line:35}))}))})),describe("key setting progression (in options screen)",(()=>{it("SC → SC2",(()=>{var e=new r,t=new r
s()(e._expr(e._capt("SC2"===e._capt(e._capt(c,"arguments/0/left/callee/object").nextKeyToEdit("SC","left"),"arguments/0/left"),"arguments/0"),{content:"assert(Options.nextKeyToEdit('SC', 'left') === 'SC2')",filepath:"Options.spec.js",line:40})),s()(t._expr(t._capt("SC2"===t._capt(t._capt(c,"arguments/0/left/callee/object").nextKeyToEdit("SC","right"),"arguments/0/left"),"arguments/0"),{content:"assert(Options.nextKeyToEdit('SC', 'right') === 'SC2')",filepath:"Options.spec.js",line:41}))})),it("1 → 2",(()=>{var e=new r,t=new r,n=new r
s()(e._expr(e._capt("2"===e._capt(e._capt(c,"arguments/0/left/callee/object").nextKeyToEdit("1","left"),"arguments/0/left"),"arguments/0"),{content:"assert(Options.nextKeyToEdit('1', 'left') === '2')",filepath:"Options.spec.js",line:44})),s()(t._expr(t._capt("2"===t._capt(t._capt(c,"arguments/0/left/callee/object").nextKeyToEdit("1","right"),"arguments/0/left"),"arguments/0"),{content:"assert(Options.nextKeyToEdit('1', 'right') === '2')",filepath:"Options.spec.js",line:45})),s()(n._expr(n._capt("2"===n._capt(n._capt(c,"arguments/0/left/callee/object").nextKeyToEdit("1","off"),"arguments/0/left"),"arguments/0"),{content:"assert(Options.nextKeyToEdit('1', 'off') === '2')",filepath:"Options.spec.js",line:46}))})),it("7 → done (scratch off / left)",(()=>{var e=new r,t=new r
s()(e._expr(e._capt(null===e._capt(e._capt(c,"arguments/0/left/callee/object").nextKeyToEdit("7","off"),"arguments/0/left"),"arguments/0"),{content:"assert(Options.nextKeyToEdit('7', 'off') === null)",filepath:"Options.spec.js",line:49})),s()(t._expr(t._capt(null===t._capt(t._capt(c,"arguments/0/left/callee/object").nextKeyToEdit("7","left"),"arguments/0/left"),"arguments/0"),{content:"assert(Options.nextKeyToEdit('7', 'left') === null)",filepath:"Options.spec.js",line:50}))})),it("7 → SC (scratch right)",(()=>{var e=new r
s()(e._expr(e._capt("SC"===e._capt(e._capt(c,"arguments/0/left/callee/object").nextKeyToEdit("7","right"),"arguments/0/left"),"arguments/0"),{content:"assert(Options.nextKeyToEdit('7', 'right') === 'SC')",filepath:"Options.spec.js",line:53}))})),it("SC2 → done (scratch right)",(()=>{var e=new r
s()(e._expr(e._capt(null===e._capt(e._capt(c,"arguments/0/left/callee/object").nextKeyToEdit("SC2","right"),"arguments/0/left"),"arguments/0"),{content:"assert(Options.nextKeyToEdit('SC2', 'right') === null)",filepath:"Options.spec.js",line:56}))})),it("SC2 → 1 (scratch left)",(()=>{var e=new r
s()(e._expr(e._capt("1"===e._capt(e._capt(c,"arguments/0/left/callee/object").nextKeyToEdit("SC2","left"),"arguments/0/left"),"arguments/0"),{content:"assert(Options.nextKeyToEdit('SC2', 'left') === '1')",filepath:"Options.spec.js",line:59}))}))}))})),describe("speed",(()=>{it("can be set and get",(()=>{(0,o.$v)(c.initialState).when(c.changeSpeed(4.5)).then(c.speed,(0,o.We)(4.5))}))})),describe("lead time",(()=>{it("defaults to 1685 ms (initial speed of tutorial)",(()=>{(0,o.$v)(c.initialState).then(c.leadTime,(0,o.We)(1685))}))})),describe("scratch position",(()=>{it("switches to keyboard mode if off",(()=>{(0,o.$v)(c.initialState).when(c.changeScratchPosition("off")).then(c.scratchPosition,(0,o.We)("off")).and((e=>{var t=new r
s()(t._expr(t._capt("KB"===t._capt(t._capt(e,"arguments/0/left/object")["player.P1.mode"],"arguments/0/left"),"arguments/0"),{content:"assert(state['player.P1.mode'] === 'KB')",filepath:"Options.spec.js",line:84}))}))})),it("switches to BMS mode if on",(()=>{(0,o.$v)(c.initialState).when(c.changeScratchPosition("right")).then(c.scratchPosition,(0,o.We)("right")).and((e=>{var t=new r
s()(t._expr(t._capt("BM"===t._capt(t._capt(e,"arguments/0/left/object")["player.P1.mode"],"arguments/0/left"),"arguments/0"),{content:"assert(state['player.P1.mode'] === 'BM')",filepath:"Options.spec.js",line:92}))}))})),it("remembers previous scratch position prior to turning off",(()=>{(0,o.$v)(c.initialState).when(c.changeScratchPosition("right")).and(c.changeScratchPosition("off")).then(c.scratchPosition,(0,o.We)("off")).and((e=>{var t=new r,n=new r
s()(t._expr(t._capt("KB"===t._capt(t._capt(e,"arguments/0/left/object")["player.P1.mode"],"arguments/0/left"),"arguments/0"),{content:"assert(state['player.P1.mode'] === 'KB')",filepath:"Options.spec.js",line:101})),s()(n._expr(n._capt("right"===n._capt(n._capt(e,"arguments/0/left/object")["player.P1.scratch"],"arguments/0/left"),"arguments/0"),{content:"assert(state['player.P1.scratch'] === 'right')",filepath:"Options.spec.js",line:102}))}))}))})),describe("background animations",(()=>{e({check:c.isBackgroundAnimationsEnabled,toggle:c.toggleBackgroundAnimations,defaultSetting:!0})})),describe("auto velocity",(()=>{e({check:c.isAutoVelocityEnabled,toggle:c.toggleAutoVelocity,defaultSetting:!1})})),describe("expert gauge",(()=>{e({check:c.isGaugeEnabled,toggle:c.toggleGauge,defaultSetting:!1})})),describe("new feature announcements",(()=>{it("should track its acknowledgement",(()=>{(0,o.$v)(c.initialState).then(c.hasAcknowledged("twitter"),(0,o.We)(!1))})),it("can be acknowledged by the user",(()=>{(0,o.$v)(c.initialState).when(c.acknowledge("twitter")).then(c.hasAcknowledged("twitter"),(0,o.We)(!0))}))})),describe("auto/input latency",(()=>{it("defaults to 0",(()=>{(0,o.$v)(c.initialState).then(c.audioInputLatency,(0,o.We)(0))})),it("can be adjusted",(()=>{(0,o.$v)(c.initialState).when(c.changeAudioInputLatency(32)).then(c.audioInputLatency,(0,o.We)(32))}))})),describe("last used version",(()=>{it("should be tracked so that it can display “what’s new” dialog",(()=>{(0,o.$v)(c.initialState).when(c.updateLastSeenVersion("50.0")).then(c.lastSeenVersion,(0,o.We)("50.0"))}))}))}))},16197:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(49886),c=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("createAutoVelocity",(function(){describe("when disabled",(function(){it("initial speed should be from options",(()=>{var e=new c
const t=(0,o.Z)({enabled:!1,initialSpeed:3.8,desiredLeadTime:1e3,songBPM:220})
s()(e._expr(e._capt(3.8===e._capt(e._capt(t,"arguments/0/left/callee/object").getInitialSpeed(),"arguments/0/left"),"arguments/0"),{content:"assert(autoVelocity.getInitialSpeed() === 3.8)",filepath:"createAutoVelocity.spec.js",line:14}))})),it("should save speed after playing game",(()=>{var e=new c,t=new c
const n=(0,o.Z)({enabled:!1,initialSpeed:3.8,desiredLeadTime:1e3,songBPM:220}),a=sinon.spy(),r=sinon.spy()
n.handleGameFinish(2.4,{saveSpeed:a,saveLeadTime:r}),s()(e._expr(e._capt(e._capt(a,"arguments/0/callee/object").calledWith(2.4),"arguments/0"),{content:"assert(saveSpeed.calledWith(2.4))",filepath:"createAutoVelocity.spec.js",line:26})),s()(t._expr(t._capt(!t._capt(t._capt(r,"arguments/0/argument/object").called,"arguments/0/argument"),"arguments/0"),{content:"assert(!saveLeadTime.called)",filepath:"createAutoVelocity.spec.js",line:27}))}))})),describe("when enabled",(function(){it("initial speed should be from song’s BPM",(()=>{var e=new c
const t=(0,o.Z)({enabled:!0,initialSpeed:3.8,desiredLeadTime:1200,songBPM:140})
s()(e._expr(e._capt(1.8===e._capt(e._capt(t,"arguments/0/left/callee/object").getInitialSpeed(),"arguments/0/left"),"arguments/0"),{content:"assert(autoVelocity.getInitialSpeed() === 1.8)",filepath:"createAutoVelocity.spec.js",line:39}))})),it("should also take into consideration the lane cover",(()=>{var e=new c
const t=(0,o.Z)({enabled:!0,initialSpeed:3.8,desiredLeadTime:1200,songBPM:140,laneCover:.5})
s()(e._expr(e._capt(.9===e._capt(e._capt(t,"arguments/0/left/callee/object").getInitialSpeed(),"arguments/0/left"),"arguments/0"),{content:"assert(autoVelocity.getInitialSpeed() === 0.9)",filepath:"createAutoVelocity.spec.js",line:49}))})),it("should also take into consideration the lane cover",(()=>{var e=new c
const t=(0,o.Z)({enabled:!0,initialSpeed:3.8,desiredLeadTime:1200,songBPM:140,laneCover:-.5})
s()(e._expr(e._capt(.9===e._capt(e._capt(t,"arguments/0/left/callee/object").getInitialSpeed(),"arguments/0/left"),"arguments/0"),{content:"assert(autoVelocity.getInitialSpeed() === 0.9)",filepath:"createAutoVelocity.spec.js",line:59}))})),it("initial speed should be from song’s BPM [ANOTHER]",(()=>{var e=new c
const t=(0,o.Z)({enabled:!0,initialSpeed:3.8,desiredLeadTime:600,songBPM:162})
s()(e._expr(e._capt(3.1===e._capt(e._capt(t,"arguments/0/left/callee/object").getInitialSpeed(),"arguments/0/left"),"arguments/0"),{content:"assert(autoVelocity.getInitialSpeed() === 3.1)",filepath:"createAutoVelocity.spec.js",line:68}))})),it("initial speed should be from song’s BPM [TUTORIAL]",(()=>{var e=new c
const t=(0,o.Z)({enabled:!0,initialSpeed:3.8,desiredLeadTime:1685,songBPM:178})
s()(e._expr(e._capt(1===e._capt(e._capt(t,"arguments/0/left/callee/object").getInitialSpeed(),"arguments/0/left"),"arguments/0"),{content:"assert(autoVelocity.getInitialSpeed() === 1.0)",filepath:"createAutoVelocity.spec.js",line:77}))})),it("should save speed and lead time after playing game",(()=>{var e=new c,t=new c
const n=(0,o.Z)({enabled:!0,initialSpeed:3.8,desiredLeadTime:1685,songBPM:178}),a=sinon.spy(),r=sinon.spy()
n.handleGameFinish(3,{saveSpeed:a,saveLeadTime:r}),s()(e._expr(e._capt(e._capt(a,"arguments/0/callee/object").calledWith(3),"arguments/0"),{content:"assert(saveSpeed.calledWith(3))",filepath:"createAutoVelocity.spec.js",line:89})),s()(t._expr(t._capt(t._capt(r,"arguments/0/callee/object").calledWith(562),"arguments/0"),{content:"assert(saveLeadTime.calledWith(562))",filepath:"createAutoVelocity.spec.js",line:90}))})),it("should not save if speed remains the same",(()=>{var e=new c,t=new c
const n=(0,o.Z)({enabled:!0,initialSpeed:3.8,desiredLeadTime:1685,songBPM:178}),a=sinon.spy(),r=sinon.spy()
n.handleGameFinish(1,{saveSpeed:a,saveLeadTime:r}),s()(e._expr(e._capt(e._capt(a,"arguments/0/callee/object").calledWith(1),"arguments/0"),{content:"assert(saveSpeed.calledWith(1))",filepath:"createAutoVelocity.spec.js",line:102})),s()(t._expr(t._capt(!t._capt(t._capt(r,"arguments/0/argument/object").called,"arguments/0/argument"),"arguments/0"),{content:"assert(!saveLeadTime.called)",filepath:"createAutoVelocity.spec.js",line:103}))}))}))}))},83188:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a)
function o(e){return function t(n,a){return new Promise((t=>t(e()))).catch((e=>{if(0===a)throw e
return new Promise((e=>setTimeout((()=>{e(t(2*n,a-1))}),n)))}))}(1,9)}var c=n(14179),r=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
function i({fetch:e}){const t=sinon.spy(),n=sinon.spy(),a=sinon.spy()
return{collectionLoader:(0,c.o)({onBeginLoading:t,onErrorLoading:n,onLoad:a,fetch:e}),onBeginLoading:t,onErrorLoading:n,onLoad:a}}describe("createCollectionLoader",(()=>{describe("load(url)",(function(){it("should load the collection and call `onLoad`",(async()=>{var e=new r,t=new r
const{collectionLoader:a,onBeginLoading:c,onLoad:u}=i({fetch:e=>{var t=new r
return s()(t._expr(t._capt("/base/src/app/test-fixtures/example-music-server/index.json"===t._capt(e,"arguments/0/left"),"arguments/0"),{content:"assert(url === '/base/src/app/test-fixtures/example-music-server/index.json')",filepath:"createCollectionLoader.spec.js",line:24})),Promise.resolve({json:()=>n(86575)})}})
a.load("/base/src/app/test-fixtures/example-music-server"),await o((()=>s()(e._expr(e._capt(e._capt(u,"arguments/0/object").called,"arguments/0"),{content:"assert(onLoad.called)",filepath:"createCollectionLoader.spec.js",line:35})))),s()(t._expr(t._capt(t._capt(c,"arguments/0/object").called,"arguments/0"),{content:"assert(onBeginLoading.called)",filepath:"createCollectionLoader.spec.js",line:36,async:!0}))})),it("should load the collection and call `onErrorLoading` when there is an error",(async()=>{var e=new r
const{collectionLoader:t,onErrorLoading:n}=i({fetch:e=>Promise.reject(new Error("???"))})
t.load("/base/src/app/test-fixtures/example-music-server"),await o((()=>s()(e._expr(e._capt(e._capt(n,"arguments/0/object").called,"arguments/0"),{content:"assert(onErrorLoading.called)",filepath:"createCollectionLoader.spec.js",line:44}))))}))}))}))},39901:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(18774),c=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("selecting a song by title",(function(){const e=["DE/CON-STRUKT","Everyday evermore","Chicken","Piece of Mine","Goliath"],t=e=>e
it("finds a matching song",(()=>{var n=new c
s()(n._expr(n._capt("DE/CON-STRUKT"===n._capt((0,o.Z)(n._capt({songs:e,getTitle:t,title:"DE/CON-STRUKT"},"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(findMatchingSong({songs,getTitle,title: 'DE/CON-STRUKT'}) === 'DE/CON-STRUKT')",filepath:"findMatchingSong.spec.js",line:18}))})),it("matches case-insensitively",(()=>{var n=new c
s()(n._expr(n._capt("Everyday evermore"===n._capt((0,o.Z)(n._capt({songs:e,getTitle:t,title:"everyday evermore"},"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(findMatchingSong({songs,getTitle,title: 'everyday evermore'}) === 'Everyday evermore')",filepath:"findMatchingSong.spec.js",line:25}))}))}))},53605:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(7063),c=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("Calculating LR2 score",(function(){const e=[18,40]
it("perfect great = 2 points",(()=>{var t=new c
s()(t._expr(t._capt(2===t._capt((0,o.Z)(t._capt([.001],"arguments/0/left/arguments/0"),t._capt(e,"arguments/0/left/arguments/1")),"arguments/0/left"),"arguments/0"),{content:"assert(getLR2Score([0.001], LR2_NORMAL_TIMEGATE) === 2)",filepath:"getLR2Score.spec.js",line:8}))})),it("great = 1 point",(()=>{var t=new c
s()(t._expr(t._capt(1===t._capt((0,o.Z)(t._capt([.02],"arguments/0/left/arguments/0"),t._capt(e,"arguments/0/left/arguments/1")),"arguments/0/left"),"arguments/0"),{content:"assert(getLR2Score([0.02], LR2_NORMAL_TIMEGATE) === 1)",filepath:"getLR2Score.spec.js",line:11}))})),it("other = 0 points",(()=>{var t=new c
s()(t._expr(t._capt(0===t._capt((0,o.Z)(t._capt([.06],"arguments/0/left/arguments/0"),t._capt(e,"arguments/0/left/arguments/1")),"arguments/0/left"),"arguments/0"),{content:"assert(getLR2Score([0.06], LR2_NORMAL_TIMEGATE) === 0)",filepath:"getLR2Score.spec.js",line:14}))})),it("sums the points",(()=>{var t=new c
s()(t._expr(t._capt(4===t._capt((0,o.Z)(t._capt([.01,.02,.03,.05],"arguments/0/left/arguments/0"),t._capt(e,"arguments/0/left/arguments/1")),"arguments/0/left"),"arguments/0"),{content:"assert(getLR2Score([0.01,0.02,0.03,0.05], LR2_NORMAL_TIMEGATE) === 4)",filepath:"getLR2Score.spec.js",line:17}))})),it("works with arbitrary timegates",(()=>{var e=new c
s()(e._expr(e._capt(7===e._capt((0,o.Z)(e._capt([.01,.02,.03,.05],"arguments/0/left/arguments/0"),e._capt([35,70],"arguments/0/left/arguments/1")),"arguments/0/left"),"arguments/0"),{content:"assert(getLR2Score([0.01,0.02,0.03,0.05], [35,70]) === 7)",filepath:"getLR2Score.spec.js",line:20}))}))}))},76576:function(e,t,n){"use strict"
n.r(t)
var a=n(37476),s=n(22266)
const{dispatch:o,initialState:c}=(0,s.oH)(a.I6)
describe("ReduxState",(function(){describe("integration test",(function(){const e=(0,s.$v)(c).and(o({type:a.tA,url:"/music"})).and(o({type:a.HO,options:{"player.P1.mode":"BM","player.P1.scratch":"left"}})).and(o({type:a.ti,url:"/music",data:{songs:[{title:"Exargon",id:"exargon",charts:[{keys:"7K",file:"exargon_7another.bms",info:{level:12}},{keys:"7K",file:"exargon_7hyper.bms",info:{level:10}},{keys:"7K",file:"exargon_7normal.bms",info:{level:8}}]},{title:"Anhedonia",id:"anhedonia",charts:[{keys:"7K",file:"01_anhedonia_n.bms",info:{level:6}},{keys:"7K",file:"00_anhedonia_7b.bms",info:{level:1}}]},{title:"Blooming",id:"blooming",charts:[{keys:"7K",file:"Trish_Blooming_7key_Another.bms",info:{level:11}},{keys:"7K",file:"Trish_Blooming_7key_Feeling.bms",info:{level:13}}]}]}}))
it("should intially selected easiest song and chart",(()=>e.then(a.eB,(e=>e.title),(0,s.We)("Anhedonia")).and(a.Qw,(e=>e.file),(0,s.We)("00_anhedonia_7b.bms"))))}))}))},24631:function(e,t,n){"use strict"
n.r(t)
var a=n(68562),s=n(795).Buffer
describe("SongLoader",(function(){function e(e){return Promise.resolve(s.from(e).buffer)}function t(e){return{fileList:Promise.resolve(Object.keys(e)),file(t){return Promise.resolve(e[t])}}}describe("with BMS files",(function(){const n=t({"01.bme":{read(){return e("#TITLE meow [NORMAL]\n#BPM 90\n#00111:01")}},"02.bms":{read(){return e("#TITLE meow [HYPER]\n#BPM 90\n#00111:01")}},"03.bml":{read(){return e("#TITLE meow [ANOTHER]\n#BPM 100\n#00111:01")}}})
let s
before((async function(){const e={onMessage:e=>console.log(e)},t=await(0,a.F)(n,e)
s=t})),it("should have correct title",(function(){expect(s.title).to.equal("meow")})),it("should have correct number of charts",(function(){expect(s.charts).to.have.length(3)})),it("should have resources key pointing to the resources",(function(){expect(s.resources).to.equal(n)}))})),describe("with bmson files",(function(){const n=t({"01.bmson":{read(){return e('{"info":{"title":"meow","initBPM":90}}')}}})
let s
before((async function(){const e=await(0,a.F)(n)
s=e})),it("should have correct title",(function(){expect(s.title).to.equal("meow")})),it("should have correct number of charts",(function(){expect(s.charts).to.have.length(1)}))}))}))},907:function(e,t,n){"use strict"
n.r(t)
var a=n(75349),s=n(53294)
describe("PlayerAudio",(function(){let e,t,n
function o(s){e=s,n={playAuto:sinon.stub().returns({}),playNote:sinon.stub().returns({}),playFree:sinon.stub().returns({})},t=new a.Z({player:e,waveFactory:n})}it("should play autokeysounds on correct time",(function(){o({notechart:{autos:[{time:1,keysound:"0x"},{time:2,keysound:"0y"},{time:2,keysound:"0z"}],notes:[]},options:{autosound:!1}}),t.update(0),expect(n.playAuto).to.have.callCount(0),t.update(1),expect(n.playAuto).to.have.callCount(1),expect(n.playAuto).to.have.been.calledWithMatch({keysound:"0x"}),t.update(2),expect(n.playAuto).to.have.callCount(3)})),it("should play notes automatically when autosound is on",(function(){o({notechart:{autos:[],notes:[{time:1,keysound:"0x"}]},options:{autosound:!0}}),t.update(1),expect(n.playNote).to.have.been.calledWithMatch({keysound:"0x"})})),it("should not play notes automatically when autosound is off",(function(){o({notechart:{autos:[],notes:[{time:1,keysound:"0x"}]},options:{}}),t.update(1),expect(n.playNote).to.not.have.been.called})),it("should play notes ahead of time",(function(){o({notechart:{autos:[{time:1,keysound:"0x"}],notes:[]},options:{}}),t.update(.999),expect(n.playAuto).to.have.been.calledWithMatch({keysound:"0x"}),expect(n.playAuto.getCall(0).args[1]).to.be.closeTo(.001,1e-5)})),it("should play hit notes",(function(){o((0,s.B9)()),t.update(.999,{notifications:{sounds:[{note:{keysound:"0x"},type:"hit",judgment:1}]},stats:{}}),expect(n.playNote).to.have.been.calledWithMatch({keysound:"0x"})})),it("badly hit note should sound off-pitch",(function(){o((0,s.B9)())
const e={bad:sinon.stub()}
n.playNote.returns(e),t.update(.999,{notifications:{sounds:[{note:{keysound:"0x"},type:"hit",judgment:4}]},stats:{}}),expect(e.bad).to.have.been.called})),it("should work even without audio",(function(){o((0,s.B9)()),n.playNote.returns(null),t.update(.999,{notifications:{sounds:[{note:{keysound:"0x"},type:"hit",judgment:4}]},stats:{}})})),it("should stop sound when broken",(function(){o((0,s.B9)())
const e={keysound:"0x"},a={stop:sinon.spy()}
n.playNote.returns(a),t.update(.999,{notifications:{sounds:[{note:e,type:"hit"}]},stats:{}}),t.update(1.1,{notifications:{sounds:[{note:e,type:"break"}]},stats:{}}),expect(a.stop).to.have.been.called})),it("should play sounds when hitting blank space",(function(){o((0,s.B9)()),t.update(.999,{notifications:{sounds:[{note:{keysound:"0x"},type:"free"}]},stats:{}}),expect(n.playFree).to.have.been.calledWithMatch({keysound:"0x"})})),it("should play hit note once",(function(){o((0,s.B9)())
const e={keysound:"0x"}
t.update(.999,{notifications:{sounds:[{note:e,type:"hit"}]},stats:{}}),t.update(1,{notifications:{sounds:[{note:e,type:"hit"}]},stats:{}}),expect(n.playNote).to.have.callCount(1)}))}))},48688:function(e,t,n){"use strict"
n.r(t)
var a=n(26826),s=n.n(a),o=n(38274)
function c(e){return{keysound:e}}describe("WaveFactory",(function(){let e,t,n,a,r
beforeEach((function(){e={group:sinon.stub()},t={play:sinon.stub()},n={"wow.wav":t},a={"0z":"wow.wav"},r=new o.Z(e,n,a)})),describe("playAuto",(function(){it("should play an autokeysound",(function(){r.playAuto(c("0z"),.1),expect(t.play).to.have.been.calledWith(.1)}))})),describe("playNote",(function(){it("should play the keysound",(function(){r.playNote(c("0z"),.1),expect(t.play).to.have.been.calledWith(.1)})),it("should stop old sound",(function(){const e={stop:sinon.spy()}
return t.play.returns(e),r.playNote(c("0z"),0),r.playNote(c("0z"),0),s()(0).then((()=>expect(e.stop).to.have.callCount(1)))}))})),describe("playFree",(function(){it("should play the keysound",(function(){r.playFree(c("0z")),expect(t.play).to.have.been.called}))}))}))},52516:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(99963),c=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("an inactive gauge",(()=>{it("does not display anything",(()=>{var e=new c,t=new c,n=new c
const a=(0,o.s)("off")
a.update(),s()(e._expr(e._capt(!1===e._capt(e._capt(a,"arguments/0/left/callee/object").shouldDisplay(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.shouldDisplay() === false)",filepath:"Gauge.spec.js",line:9})),s()(t._expr(t._capt(0===t._capt(t._capt(a,"arguments/0/left/callee/object").getPrimary(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.getPrimary() === 0)",filepath:"Gauge.spec.js",line:10})),s()(n._expr(n._capt(0===n._capt(n._capt(a,"arguments/0/left/callee/object").getSecondary(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.getSecondary() === 0)",filepath:"Gauge.spec.js",line:11}))}))})),describe("a hope gauge",(()=>{function e(e,t){const n=(0,o.s)("hope"),[a,s]=t,c={stats:{maxPossibleScore:e,numJudgments:a,totalCombo:s}}
return n.update(c),n}it("should be displayed if user can attain A rank",(()=>{var t=new c
const n=e(450001,[50,100])
s()(t._expr(t._capt(t._capt(n,"arguments/0/callee/object").shouldDisplay(),"arguments/0"),{content:"assert(gauge.shouldDisplay())",filepath:"Gauge.spec.js",line:26}))})),it("should be hidden if user cannot attain A rank anymore",(()=>{var t=new c
const n=e(449999,[50,100])
s()(t._expr(t._capt(!t._capt(t._capt(n,"arguments/0/argument/callee/object").shouldDisplay(),"arguments/0/argument"),"arguments/0"),{content:"assert(!gauge.shouldDisplay())",filepath:"Gauge.spec.js",line:30}))})),describe("primary",(()=>{it("starts at half",(()=>{var t=new c
const n=e(555555,[0,100])
s()(t._expr(t._capt(.5===t._capt(t._capt(n,"arguments/0/left/callee/object").getPrimary(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.getPrimary() === 0.5)",filepath:"Gauge.spec.js",line:35}))})),it("completely fills in if player finishes with ≥520000",(()=>{var t=new c
const n=e(555555,[100,100])
s()(t._expr(t._capt(1===t._capt(t._capt(n,"arguments/0/left/callee/object").getPrimary(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.getPrimary() === 1)",filepath:"Gauge.spec.js",line:39}))})),it("is active if player can still attain S rank",(()=>{var t=new c,n=new c
const a=e(500001,[100,100])
s()(t._expr(t._capt(t._capt(t._capt(a,"arguments/0/left/callee/object").getPrimary(),"arguments/0/left")>0,"arguments/0"),{content:"assert(gauge.getPrimary() > 0)",filepath:"Gauge.spec.js",line:43})),s()(n._expr(n._capt(n._capt(n._capt(a,"arguments/0/left/callee/object").getPrimary(),"arguments/0/left")<.01,"arguments/0"),{content:"assert(gauge.getPrimary() < 0.01)",filepath:"Gauge.spec.js",line:44}))})),it("is inactive if player cannot attain S rank anymore",(()=>{var t=new c
const n=e(499999,[100,100])
s()(t._expr(t._capt(0===t._capt(t._capt(n,"arguments/0/left/callee/object").getPrimary(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.getPrimary() === 0)",filepath:"Gauge.spec.js",line:48}))}))})),describe("secondary",(()=>{it("inactive while player still can attain S rank",(()=>{var t=new c
const n=e(500001,[40,100])
s()(t._expr(t._capt(0===t._capt(t._capt(n,"arguments/0/left/callee/object").getSecondary(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.getSecondary() === 0)",filepath:"Gauge.spec.js",line:54}))})),it("active while player still can attain A rank",(()=>{var t=new c
const n=e(499999,[40,100])
s()(t._expr(t._capt(t._capt(t._capt(n,"arguments/0/left/callee/object").getSecondary(),"arguments/0/left")>=.99,"arguments/0"),{content:"assert(gauge.getSecondary() >= 0.99)",filepath:"Gauge.spec.js",line:58}))})),it("zeroes out when user cannot attain A rank anymore",(()=>{var t=new c
const n=e(449999,[40,100])
s()(t._expr(t._capt(0===t._capt(t._capt(n,"arguments/0/left/callee/object").getSecondary(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.getSecondary() === 0)",filepath:"Gauge.spec.js",line:62}))}))})),describe("extra",(()=>{it("starts at 0",(()=>{var t=new c
const n=e(555555,[0,100])
s()(t._expr(t._capt(0===t._capt(t._capt(n,"arguments/0/left/callee/object").getExtra(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.getExtra() === 0)",filepath:"Gauge.spec.js",line:68}))})),it("is not activated if hoped score would not exceed 520000",(()=>{var t=new c
const n=e(519999,[100,100])
s()(t._expr(t._capt(0===t._capt(t._capt(n,"arguments/0/left/callee/object").getExtra(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.getExtra() === 0)",filepath:"Gauge.spec.js",line:72}))})),it("is activated if hoped score would exceed 520000",(()=>{var t=new c
const n=e(520001,[100,100])
s()(t._expr(t._capt(t._capt(t._capt(n,"arguments/0/left/callee/object").getExtra(),"arguments/0/left")>0,"arguments/0"),{content:"assert(gauge.getExtra() > 0)",filepath:"Gauge.spec.js",line:76}))})),it("completely fills in if player finishes with ≥540000",(()=>{var t=new c,n=new c
const a=e(539999,[100,100])
s()(t._expr(t._capt(t._capt(t._capt(a,"arguments/0/left/callee/object").getExtra(),"arguments/0/left")<1,"arguments/0"),{content:"assert(preGauge.getExtra() < 1)",filepath:"Gauge.spec.js",line:80}))
const o=e(54e4,[100,100])
s()(n._expr(n._capt(1===n._capt(n._capt(o,"arguments/0/left/callee/object").getExtra(),"arguments/0/left"),"arguments/0"),{content:"assert(gauge.getExtra() === 1)",filepath:"Gauge.spec.js",line:82}))}))}))}))},18030:function(e,t,n){"use strict"
n.r(t)
var a=n(25331)
describe("NoteArea",(function(){it("allows querying the visible note from a list of notes",(function(){const e=new a.Z([{position:1,column:"A"},{position:2,column:"A"},{position:3,column:"A"},{position:4,column:"A"},{position:5,column:"A"},{position:6,column:"A"},{position:10,end:{position:12},column:"B"},{position:11,column:"C"}],[])
expect(e.getVisibleNotes(1.5,3.5)).to.have.length(2),expect(e.getVisibleNotes(2.5,3.5,1)).to.have.length(2),expect(e.getVisibleNotes(-1,7)).to.have.length(6),expect(e.getVisibleNotes(8,10.1)).to.have.length(1),expect(e.getVisibleNotes(8,10.1)).to.have.length(1),expect(e.getVisibleNotes(8,14)).to.have.length(2),expect(e.getVisibleNotes(11.5,14)).to.have.length(1),expect(e.getVisibleNotes(12.5,14)).to.have.length(0)})),it("allows querying barlines",(function(){const e=new a.Z([],[{beat:0,position:0},{beat:4,position:4},{beat:7,position:7}])
expect(e.getVisibleBarLines(1.5,4.5)).to.have.length(1)}))}))},25238:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(63241),c=n(53294),r=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("PlayerDisplay",(function(){let e,t
function n(t){e=new o.Z(t,{})}function a(n,a,s){t=e.update(n,a,s)}function i(){return{speed:1,input:{get:()=>({value:0,changed:!1})},notifications:{judgments:[]},getNoteStatus:sinon.stub().returns("unjudged"),getNoteJudgment:sinon.stub().returns(0),stats:{score:0}}}function u(e){return Object.assign(i(),e)}it("reacts to input",(function(){var e=new r,o=new r,i=new r,l=new r,p=new r
const d=e=>u({input:new Map(e)})
n({notechart:(0,c.qK)(),columns:["wow"],options:{placement:"center",scratch:"left"}}),a(555,.5,d([["wow",{value:0,changed:!1}]])),s()(e._expr(e._capt(0===e._capt(e._capt(t,"arguments/0/left/object").wow_active,"arguments/0/left"),"arguments/0"),{content:"assert(data['wow_active'] === 0)",filepath:"player-display.spec.js",line:31})),a(557,2.5,d([["wow",{value:1,changed:!0}]])),s()(o._expr(o._capt(1===o._capt(o._capt(t,"arguments/0/left/object").wow_active,"arguments/0/left"),"arguments/0"),{content:"assert(data['wow_active'] === 1)",filepath:"player-display.spec.js",line:34})),s()(i._expr(i._capt(557===i._capt(i._capt(t,"arguments/0/left/object").wow_down,"arguments/0/left"),"arguments/0"),{content:"assert(data['wow_down'] === 557)",filepath:"player-display.spec.js",line:35})),a(558,3.5,d([["wow",{value:0,changed:!0}]])),s()(l._expr(l._capt(0===l._capt(l._capt(t,"arguments/0/left/object").wow_active,"arguments/0/left"),"arguments/0"),{content:"assert(data['wow_active'] === 0)",filepath:"player-display.spec.js",line:38})),s()(p._expr(p._capt(558===p._capt(p._capt(t,"arguments/0/left/object").wow_up,"arguments/0/left"),"arguments/0"),{content:"assert(data['wow_up'] === 558)",filepath:"player-display.spec.js",line:39}))})),describe("with note",(function(){beforeEach((function(){n((0,c.B9)("#BPM 60\n#00111:11"))})),it("displays unjudged notes",(function(){var e=new r
a(3.95,3.95,i()),s()(e._expr(e._capt(1===e._capt(e._capt(e._capt(t,"arguments/0/left/object/object").note_1,"arguments/0/left/object").length,"arguments/0/left"),"arguments/0"),{content:"assert(data['note_1'].length === 1)",filepath:"player-display.spec.js",line:48}))})),it("hides judged notes",(function(){var e=new r
a(3.95,3.95,(0,c.bw)(i(),(e=>e.getNoteStatus.returns("judged")))),s()(e._expr(e._capt(!e._capt(e._capt(e._capt(e._capt(t,"arguments/0/argument/object/left/object").note_1,"arguments/0/argument/object/left")||e._capt([],"arguments/0/argument/object/right"),"arguments/0/argument/object").length,"arguments/0/argument"),"arguments/0"),{content:"assert(!(data['note_1'] || []).length)",filepath:"player-display.spec.js",line:53}))}))})),describe("with long note",(function(){beforeEach((function(){n((0,c.B9)("#BPM 60\n#00151:1111"))})),it("displays unjudged long notes",(function(){var e=new r,n=new r,o=new r
a(3.95,3.95,i()),s()(e._expr(e._capt(1===e._capt(e._capt(e._capt(t,"arguments/0/left/object/object").longnote_1,"arguments/0/left/object").length,"arguments/0/left"),"arguments/0"),{content:"assert(data['longnote_1'].length === 1)",filepath:"player-display.spec.js",line:63})),s()(n._expr(n._capt(!n._capt(n._capt(n._capt(n._capt(t,"arguments/0/argument/object/object/object").longnote_1,"arguments/0/argument/object/object")[0],"arguments/0/argument/object").active,"arguments/0/argument"),"arguments/0"),{content:"assert(!data['longnote_1'][0].active)",filepath:"player-display.spec.js",line:64})),s()(o._expr(o._capt(!o._capt(o._capt(o._capt(o._capt(t,"arguments/0/argument/object/object/object").longnote_1,"arguments/0/argument/object/object")[0],"arguments/0/argument/object").missed,"arguments/0/argument"),"arguments/0"),{content:"assert(!data['longnote_1'][0].missed)",filepath:"player-display.spec.js",line:65}))})),it("displays holding long notes",(function(){var e=new r
a(3.95,3.95,(0,c.bw)(i(),(e=>e.getNoteJudgment.returns(1)))),s()(e._expr(e._capt(e._capt(e._capt(e._capt(t,"arguments/0/object/object/object").longnote_1,"arguments/0/object/object")[0],"arguments/0/object").active,"arguments/0"),{content:"assert(data['longnote_1'][0].active)",filepath:"player-display.spec.js",line:70}))})),it("displays holding long notes event it is bad",(function(){var e=new r
a(3.95,3.95,(0,c.bw)(i(),(e=>e.getNoteJudgment.returns(4)))),s()(e._expr(e._capt(e._capt(e._capt(e._capt(t,"arguments/0/object/object/object").longnote_1,"arguments/0/object/object")[0],"arguments/0/object").active,"arguments/0"),{content:"assert(data['longnote_1'][0].active)",filepath:"player-display.spec.js",line:75}))})),it("displays missed long notes",(function(){var e=new r
const n=i()
n.getNoteJudgment.returns(-1),n.getNoteStatus.returns("judged"),a(3.95,3.95,n),s()(e._expr(e._capt(e._capt(e._capt(e._capt(t,"arguments/0/object/object/object").longnote_1,"arguments/0/object/object")[0],"arguments/0/object").missed,"arguments/0"),{content:"assert(data['longnote_1'][0].missed)",filepath:"player-display.spec.js",line:82}))}))})),describe("with notification",(function(){beforeEach((function(){n((0,c.B9)())})),it("sets judgment time",(function(){var e=new r,n=new r
a(12,34,u({notifications:{judgments:[{judgment:1,delta:0,combo:123,column:"SC"}]}})),s()(e._expr(e._capt(12===e._capt(e._capt(t,"arguments/0/left/object").judge_1,"arguments/0/left"),"arguments/0"),{content:"assert(data['judge_1'] === 12)",filepath:"player-display.spec.js",line:93})),s()(n._expr(n._capt(12===n._capt(n._capt(t,"arguments/0/left/object").judge_deviation_none,"arguments/0/left"),"arguments/0"),{content:"assert(data['judge_deviation_none'] === 12)",filepath:"player-display.spec.js",line:94}))})),it("sets judgment deviation (early)",(function(){var e=new r,n=new r
a(12,34,u({notifications:{judgments:[{judgment:2,delta:-.03,combo:123,column:"SC"}]}})),s()(e._expr(e._capt(12===e._capt(e._capt(t,"arguments/0/left/object").judge_2,"arguments/0/left"),"arguments/0"),{content:"assert(data['judge_2'] === 12)",filepath:"player-display.spec.js",line:99})),s()(n._expr(n._capt(12===n._capt(n._capt(t,"arguments/0/left/object").judge_deviation_early,"arguments/0/left"),"arguments/0"),{content:"assert(data['judge_deviation_early'] === 12)",filepath:"player-display.spec.js",line:100}))})),it("sets judgment deviation (late)",(function(){var e=new r,n=new r
a(12,34,u({notifications:{judgments:[{judgment:2,delta:.03,combo:123,column:"SC"}]}})),s()(e._expr(e._capt(12===e._capt(e._capt(t,"arguments/0/left/object").judge_2,"arguments/0/left"),"arguments/0"),{content:"assert(data['judge_2'] === 12)",filepath:"player-display.spec.js",line:105})),s()(n._expr(n._capt(12===n._capt(n._capt(t,"arguments/0/left/object").judge_deviation_late,"arguments/0/left"),"arguments/0"),{content:"assert(data['judge_deviation_late'] === 12)",filepath:"player-display.spec.js",line:106}))})),it("sets judgment missed time",(function(){var e=new r
a(12,34,u({notifications:{judgments:[{judgment:-1,delta:0,combo:0,column:"SC"}]}})),s()(e._expr(e._capt(12===e._capt(e._capt(t,"arguments/0/left/object").judge_missed,"arguments/0/left"),"arguments/0"),{content:"assert(data['judge_missed'] === 12)",filepath:"player-display.spec.js",line:111}))})),it("sets combo",(function(){var e=new r
a(12,34,u({notifications:{judgments:[{judgment:1,delta:0,combo:123,column:"SC"}]}})),s()(e._expr(e._capt(123===e._capt(e._capt(t,"arguments/0/left/object").combo,"arguments/0/left"),"arguments/0"),{content:"assert(data['combo'] === 123)",filepath:"player-display.spec.js",line:116}))})),it("sets note explode time",(function(){var e=new r
a(12,34,u({notifications:{judgments:[{judgment:1,delta:0,combo:123,column:"SC"}]}})),s()(e._expr(e._capt(12===e._capt(e._capt(t,"arguments/0/left/object").SC_explode,"arguments/0/left"),"arguments/0"),{content:"assert(data['SC_explode'] === 12)",filepath:"player-display.spec.js",line:121}))})),it("does not set note explode time if missed",(function(){var e=new r
a(12,34,u({notifications:{judgments:[{judgment:-1,delta:0,combo:123,column:"SC"}]}})),s()(e._expr(e._capt(!e._capt(e._capt(e._capt(e._capt(t,"arguments/0/argument/object/left/object").SC_explode,"arguments/0/argument/object/left")||e._capt([],"arguments/0/argument/object/right"),"arguments/0/argument/object").length,"arguments/0/argument"),"arguments/0"),{content:"assert(!(data['SC_explode'] || []).length)",filepath:"player-display.spec.js",line:126}))}))}))}))},62610:function(e,t,n){"use strict"
n.r(t)
var a=n(88371)
describe("GameInput",(function(){let e,t
beforeEach((function(){e=new a.Z,t={out:{},get(){return this.out}},e.use(t)})),it("should return control with default value of 0",(function(){expect(e.get("wow").value).to.equal(0)})),describe("Control#value",(function(){it("should return control with correct value",(function(){t.out={wow:-1},e.update(),expect(e.get("wow").value).to.equal(-1)}))})),describe("Control#changed",(function(){it("should return changed state between last update",(function(){e.update(),expect(e.get("wow").changed).to.equal(!1),t.out={wow:0},e.update(),expect(e.get("wow").changed).to.equal(!1),t.out={wow:-1},e.update(),expect(e.get("wow").changed).to.equal(!0),t.out={wow:1},e.update(),expect(e.get("wow").changed).to.equal(!0),t.out={wow:1},e.update(),expect(e.get("wow").changed).to.equal(!1),e.update(),expect(e.get("wow").changed).to.equal(!1),t.out={wow:0},e.update(),expect(e.get("wow").changed).to.equal(!0)}))}))}))},19367:function(e,t,n){"use strict"
n.r(t)
var a=n(213),s=n(57317)
describe("TouchPlugin",(function(){it("should get value when touching",(function(){const e=new s.Z({skinData:{},refs:{p1_1:new Set([{getBounds:()=>new a.Rectangle(64,64,64,64)}]),p1_2:new Set([{getBounds:()=>new a.Rectangle(128,64,64,64)}])},input:[{x:72,y:72,id:"touch1"},{x:32,y:32,id:"touch2"}]}).get()
expect(e.p1_1).to.equal(1),expect(e.p1_2).to.equal(0)}))}))},36678:function(e,t,n){"use strict"
n.r(t)
var a=n(76177),s=n(53294)
describe("tutorial song",(()=>{it("beginning is easy",(()=>{const e=(0,s.qK)("#PLAYLEVEL 0"),t=(0,a.el)(e,{tutorial:!0})
expect((0,a.pH)(9.89,10,t)).to.equal(3)})),it("ending is hard",(()=>{const e=(0,s.qK)("#PLAYLEVEL 0"),t=(0,a.el)(e,{tutorial:!0})
expect((0,a.pH)(109.89,110,t)).to.equal(4)}))})),describe("beginner timegates",(()=>{it("very easy applied to lv1",(()=>{const e=(0,s.qK)("#PLAYLEVEL 1"),t=(0,a.el)(e,{})
expect((0,a.nr)(3,t)).to.equal(.18)})),it("very easy applied to lv2",(()=>{const e=(0,s.qK)("#PLAYLEVEL 2"),t=(0,a.el)(e,{})
expect((0,a.nr)(3,t)).to.equal(.18)})),it("very easy applied to lv3",(()=>{const e=(0,s.qK)("#PLAYLEVEL 3"),t=(0,a.el)(e,{})
expect((0,a.nr)(3,t)).to.equal(.16)})),it("very easy applied to lv4",(()=>{const e=(0,s.qK)("#PLAYLEVEL 4"),t=(0,a.el)(e,{})
expect((0,a.nr)(3,t)).to.equal(.14)})),it("very easy applied to lv5",(()=>{const e=(0,s.qK)("#PLAYLEVEL 5"),t=(0,a.el)(e,{})
expect((0,a.nr)(3,t)).to.equal(.12)})),it("is not applied for more than lv6",(()=>{const e=(0,s.qK)("#PLAYLEVEL 6"),t=(0,a.el)(e,{})
expect((0,a.nr)(3,t)).to.equal(.1)}))})),describe("insane song",(()=>{it("gets normal timing regardless of level",(()=>{const e=(0,s.qK)("\n      #PLAYLEVEL 1\n      #DIFFICULTY 5\n    "),t=(0,a.el)(e,{})
expect((0,a.nr)(3,t)).to.equal(.1)}))}))},39227:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(26215),c=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("SamplesLoader",(function(){let e,t,n,a
beforeEach((function(){e={file:sinon.stub()},t={decode:sinon.stub(),sample:sinon.stub()},a={isCached:()=>!1,cache:sinon.spy((()=>{}))},n=new o.Z(e,t,{keysoundCache:a})})),describe("#loadFiles",(function(){it("should not include undecodable audio",(function(){return e.file.returns(Promise.reject(new Error("cannot decode"))),e.file.withArgs("a.wav").returns(Promise.resolve({read:()=>Promise.resolve("ok1")})),t.decode.withArgs("ok1").returns(Promise.reject(new Error(".."))),expect(n.loadFiles(["a.wav"])).to.eventually.deep.eq({})})),it("should cache",(function(){return e.file.returns(Promise.reject(new Error("invalid filename"))),e.file.withArgs("a.wav").returns(Promise.resolve({read:()=>Promise.resolve("ok1")})),t.decode.withArgs("ok1").returns(Promise.resolve("ok2")),t.sample.withArgs("ok2").returns(Promise.resolve("ok3")),n.loadFiles(["a.wav"]).then((()=>{var e=new c,t=new c
s()(e._expr(e._capt(e._capt(e._capt(a,"arguments/0/object/object").cache,"arguments/0/object").calledOnce,"arguments/0"),{content:"assert(keysoundCache.cache.calledOnce)",filepath:"samples-loader.spec.js",line:40})),s()(t._expr(t._capt(t._capt(t._capt(a,"arguments/0/callee/object/object").cache,"arguments/0/callee/object").calledWith("a.wav","ok2"),"arguments/0"),{content:"assert(keysoundCache.cache.calledWith('a.wav', 'ok2'))",filepath:"samples-loader.spec.js",line:41}))}))})),it("should use cache",(function(){return e.file.returns(Promise.reject(new Error("unexpected call"))),a.isCached=e=>"name.wav"===e,a.get=e=>{if("name.wav"===e)return"buffer"
throw new Error("expected name.wav")},t.sample.withArgs("buffer").returns(Promise.resolve("sample")),expect(n.loadFiles(["name.wav"])).to.eventually.deep.eq({"name.wav":"sample"})})),it("should try mp3",(function(){return e.file.returns(Promise.reject(new Error("invalid filename"))),e.file.withArgs("a.mp3").returns(Promise.resolve({read:()=>Promise.resolve("ok1")})),t.decode.withArgs("ok1").returns(Promise.resolve("ok2")),t.sample.withArgs("ok2").returns(Promise.resolve("ok3")),expect(n.loadFiles(["a.wav"])).to.eventually.deep.eq({"a.wav":"ok3"})})),it("should not include failed matches",(function(){return e.file.returns(Promise.reject(new Error("i give up"))),expect(n.loadFiles(["a.wav"])).to.eventually.deep.eq({})}))}))}))},70759:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(88371),c=n(11598),r=n(54140),i=n(53294),u=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("PlayerState",(function(){it("updates the input",(function(){var e=new u
const t=new r.Z({number:1,columns:["wow"],notechart:(0,i.qK)(""),options:{speed:1}})
t.update(0,{get:e=>({name:e})}),s()(e._expr(e._capt("p1_wow"===e._capt(e._capt(e._capt(e._capt(t,"arguments/0/left/object/callee/object/object").input,"arguments/0/left/object/callee/object").get("wow"),"arguments/0/left/object").name,"arguments/0/left"),"arguments/0"),{content:"assert(state.input.get('wow').name === 'p1_wow')",filepath:"player-state.spec.js",line:20}))})),describe("with player and chart",(function(){let e,t,n,a,l
function p(s,u={speed:1}){e=(0,i.qK)(s),t=new c.Z(e,1,u),n=new r.Z(t),a=new o.Z,l={},a.use({get:()=>l})}function d(e,t){l=t,a.update(),n.update(e,a)}describe("node judging",(function(){it("judges notes",(function(){var t=new u,a=new u,o=new u,c=new u,r=new u,i=new u,l=new u,m=new u,f=new u,g=new u,h=new u,b=new u,_=new u,j=new u,y=new u,x=new u,v=new u,w=new u
p("\n          #BPM 120\n          #00111:0101\n        ")
const k=e.notes[0].column
s().equal(t._expr(t._capt(t._capt(n,"arguments/0/callee/object").getNoteStatus(t._capt(t._capt(t._capt(e,"arguments/0/arguments/0/object/object").notes,"arguments/0/arguments/0/object")[0],"arguments/0/arguments/0")),"arguments/0"),{content:"assert.equal(state.getNoteStatus(chart.notes[0]), 'unjudged')",filepath:"player-state.spec.js",line:54}),"unjudged"),s().equal(a._expr(a._capt(a._capt(a._capt(n,"arguments/0/object/object").stats,"arguments/0/object").combo,"arguments/0"),{content:"assert.equal(state.stats.combo, 0)",filepath:"player-state.spec.js",line:55}),0),s().equal(o._expr(o._capt(o._capt(o._capt(n,"arguments/0/object/object").stats,"arguments/0/object").poor,"arguments/0"),{content:"assert.equal(state.stats.poor, false)",filepath:"player-state.spec.js",line:56}),!1),s().equal(c._expr(c._capt(c._capt(c._capt(n,"arguments/0/object/object").stats,"arguments/0/object").totalCombo,"arguments/0"),{content:"assert.equal(state.stats.totalCombo, 2)",filepath:"player-state.spec.js",line:57}),2),s().equal(r._expr(r._capt(r._capt(r._capt(r._capt(n,"arguments/0/object/object/object").notifications,"arguments/0/object/object").judgments,"arguments/0/object").length,"arguments/0"),{content:"assert.equal(state.notifications.judgments.length, 0)",filepath:"player-state.spec.js",line:58}),0),d(1.999,{}),s().equal(i._expr(i._capt(i._capt(n,"arguments/0/callee/object").getNoteStatus(i._capt(i._capt(i._capt(e,"arguments/0/arguments/0/object/object").notes,"arguments/0/arguments/0/object")[0],"arguments/0/arguments/0")),"arguments/0"),{content:"assert.equal(state.getNoteStatus(chart.notes[0]), 'unjudged')",filepath:"player-state.spec.js",line:61}),"unjudged"),d(2,{p1_1:1}),s().equal(l._expr(l._capt(l._capt(n,"arguments/0/callee/object").getNoteStatus(l._capt(l._capt(l._capt(e,"arguments/0/arguments/0/object/object").notes,"arguments/0/arguments/0/object")[0],"arguments/0/arguments/0")),"arguments/0"),{content:"assert.equal(state.getNoteStatus(chart.notes[0]), 'judged')",filepath:"player-state.spec.js",line:64}),"judged"),s().equal(m._expr(m._capt(m._capt(n,"arguments/0/callee/object").getNoteJudgment(m._capt(m._capt(m._capt(e,"arguments/0/arguments/0/object/object").notes,"arguments/0/arguments/0/object")[0],"arguments/0/arguments/0")),"arguments/0"),{content:"assert.equal(state.getNoteJudgment(chart.notes[0]), 1)",filepath:"player-state.spec.js",line:65}),1),s().equal(f._expr(f._capt(f._capt(n,"arguments/0/callee/object").getNoteStatus(f._capt(f._capt(f._capt(e,"arguments/0/arguments/0/object/object").notes,"arguments/0/arguments/0/object")[1],"arguments/0/arguments/0")),"arguments/0"),{content:"assert.equal(state.getNoteStatus(chart.notes[1]), 'unjudged')",filepath:"player-state.spec.js",line:66}),"unjudged"),s().deepEqual(g._expr(g._capt(g._capt(g._capt(g._capt(n,"arguments/0/object/object/object").notifications,"arguments/0/object/object").judgments,"arguments/0/object")[0],"arguments/0"),{content:"assert.deepEqual(state.notifications.judgments[0], {judgment: 1,combo: 1,delta: 0,column})",filepath:"player-state.spec.js",line:67}),h._expr(h._capt({judgment:1,combo:1,delta:0,column:k},"arguments/1"),{content:"assert.deepEqual(state.notifications.judgments[0], {judgment: 1,combo: 1,delta: 0,column})",filepath:"player-state.spec.js",line:67})),s()(b._expr(b._capt(!b._capt(b._capt(b._capt(n,"arguments/0/argument/object/object").stats,"arguments/0/argument/object").poor,"arguments/0/argument"),"arguments/0"),{content:"assert(!state.stats.poor)",filepath:"player-state.spec.js",line:73})),d(2.1,{p1_1:0}),d(5,{p1_1:0}),s().equal(_._expr(_._capt(_._capt(n,"arguments/0/callee/object").getNoteStatus(_._capt(_._capt(_._capt(e,"arguments/0/arguments/0/object/object").notes,"arguments/0/arguments/0/object")[1],"arguments/0/arguments/0")),"arguments/0"),{content:"assert.equal(state.getNoteStatus(chart.notes[1]), 'judged')",filepath:"player-state.spec.js",line:77}),"judged"),s().equal(j._expr(j._capt(j._capt(n,"arguments/0/callee/object").getNoteJudgment(j._capt(j._capt(j._capt(e,"arguments/0/arguments/0/object/object").notes,"arguments/0/arguments/0/object")[1],"arguments/0/arguments/0")),"arguments/0"),{content:"assert.equal(state.getNoteJudgment(chart.notes[1]), -1)",filepath:"player-state.spec.js",line:78}),y._expr(y._capt(-1,"arguments/1"),{content:"assert.equal(state.getNoteJudgment(chart.notes[1]), -1)",filepath:"player-state.spec.js",line:78})),s().deepEqual(x._expr(x._capt(x._capt(x._capt(x._capt(n,"arguments/0/object/object/object").notifications,"arguments/0/object/object").judgments,"arguments/0/object")[0],"arguments/0"),{content:"assert.deepEqual(state.notifications.judgments[0], {judgment: -1,combo: 0,delta: 2,column})",filepath:"player-state.spec.js",line:79}),v._expr(v._capt({judgment:v._capt(-1,"arguments/1/properties/0/value"),combo:0,delta:2,column:k},"arguments/1"),{content:"assert.deepEqual(state.notifications.judgments[0], {judgment: -1,combo: 0,delta: 2,column})",filepath:"player-state.spec.js",line:79})),s().equal(w._expr(w._capt(w._capt(w._capt(n,"arguments/0/object/object").stats,"arguments/0/object").poor,"arguments/0"),{content:"assert.equal(state.stats.poor, true)",filepath:"player-state.spec.js",line:85}),!0)})),it("judges multiple notes in different column",(function(){var t=new u,a=new u
p("\n          #BPM 120\n          #00111:01\n          #00112:01\n        "),d(2,{p1_1:1,p1_2:1}),s()(t._expr(t._capt("judged"===t._capt(t._capt(n,"arguments/0/left/callee/object").getNoteStatus(t._capt(t._capt(t._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[0],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[0]) === 'judged')",filepath:"player-state.spec.js",line:96})),s()(a._expr(a._capt("judged"===a._capt(a._capt(n,"arguments/0/left/callee/object").getNoteStatus(a._capt(a._capt(a._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[1],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[1]) === 'judged')",filepath:"player-state.spec.js",line:97}))})),it("judges single note from one column at a time",(function(){var t=new u,a=new u,o=new u,c=new u,r=new u,i=new u,l=new u,m=new u,f=new u,g=new u,h=new u,b=new u
p("\n          #BPM 480\n          #00111:01010100000000000000000000000000\n        "),d(.531,{p1_1:1}),s()(t._expr(t._capt("judged"===t._capt(t._capt(n,"arguments/0/left/callee/object").getNoteStatus(t._capt(t._capt(t._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[0],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[0]) === 'judged')",filepath:"player-state.spec.js",line:107})),s()(a._expr(a._capt("unjudged"===a._capt(a._capt(n,"arguments/0/left/callee/object").getNoteStatus(a._capt(a._capt(a._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[1],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[1]) === 'unjudged')",filepath:"player-state.spec.js",line:108})),s()(o._expr(o._capt("unjudged"===o._capt(o._capt(n,"arguments/0/left/callee/object").getNoteStatus(o._capt(o._capt(o._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[2],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[2]) === 'unjudged')",filepath:"player-state.spec.js",line:109})),d(.531,{p1_1:0}),d(.531,{p1_1:1}),s()(c._expr(c._capt("judged"===c._capt(c._capt(n,"arguments/0/left/callee/object").getNoteStatus(c._capt(c._capt(c._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[0],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[0]) === 'judged')",filepath:"player-state.spec.js",line:112})),s()(r._expr(r._capt("judged"===r._capt(r._capt(n,"arguments/0/left/callee/object").getNoteStatus(r._capt(r._capt(r._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[1],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[1]) === 'judged')",filepath:"player-state.spec.js",line:113})),s()(i._expr(i._capt("unjudged"===i._capt(i._capt(n,"arguments/0/left/callee/object").getNoteStatus(i._capt(i._capt(i._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[2],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[2]) === 'unjudged')",filepath:"player-state.spec.js",line:114})),d(.531,{p1_1:0}),d(.531,{p1_1:1}),s()(l._expr(l._capt("judged"===l._capt(l._capt(n,"arguments/0/left/callee/object").getNoteStatus(l._capt(l._capt(l._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[0],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[0]) === 'judged')",filepath:"player-state.spec.js",line:117})),s()(m._expr(m._capt("judged"===m._capt(m._capt(n,"arguments/0/left/callee/object").getNoteStatus(m._capt(m._capt(m._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[1],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[1]) === 'judged')",filepath:"player-state.spec.js",line:118})),s()(f._expr(f._capt("judged"===f._capt(f._capt(n,"arguments/0/left/callee/object").getNoteStatus(f._capt(f._capt(f._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[2],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[2]) === 'judged')",filepath:"player-state.spec.js",line:119})),s()(g._expr(g._capt(g._capt(g._capt(n,"arguments/0/left/callee/object").getNoteJudgment(g._capt(g._capt(g._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[0],"arguments/0/left/arguments/0")),"arguments/0/left")>1,"arguments/0"),{content:"assert(state.getNoteJudgment(chart.notes[0]) > 1)",filepath:"player-state.spec.js",line:121})),s()(h._expr(h._capt(1===h._capt(h._capt(n,"arguments/0/left/callee/object").getNoteJudgment(h._capt(h._capt(h._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[1],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteJudgment(chart.notes[1]) === 1)",filepath:"player-state.spec.js",line:122})),s()(b._expr(b._capt(b._capt(b._capt(n,"arguments/0/left/callee/object").getNoteJudgment(b._capt(b._capt(b._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[2],"arguments/0/left/arguments/0")),"arguments/0/left")>1,"arguments/0"),{content:"assert(state.getNoteJudgment(chart.notes[2]) > 1)",filepath:"player-state.spec.js",line:123}))})),it("leaves note unjudged when bad and there are closer note",(function(){var t=new u,a=new u,o=new u
p("\n          #BPM 120\n          #00111:01010100000000000000000000000000\n        "),d(2.125,{p1_1:1}),s()(t._expr(t._capt("unjudged"===t._capt(t._capt(n,"arguments/0/left/callee/object").getNoteStatus(t._capt(t._capt(t._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[0],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[0]) === 'unjudged')",filepath:"player-state.spec.js",line:133})),s()(a._expr(a._capt("judged"===a._capt(a._capt(n,"arguments/0/left/callee/object").getNoteStatus(a._capt(a._capt(a._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[1],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[1]) === 'judged')",filepath:"player-state.spec.js",line:134})),s()(o._expr(o._capt("unjudged"===o._capt(o._capt(n,"arguments/0/left/callee/object").getNoteStatus(o._capt(o._capt(o._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[2],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[2]) === 'unjudged')",filepath:"player-state.spec.js",line:135}))})),it("records delta when pressed",(function(){var e=new u
p("\n          #BPM 120\n          #00111:01\n        "),sinon.spy(n.stats,"handleDelta"),d(2.01,{p1_1:1}),s()(e._expr(e._capt(e._capt(e._capt(e._capt(n,"arguments/0/callee/object/object/object").stats,"arguments/0/callee/object/object").handleDelta,"arguments/0/callee/object").calledWith(e._capt(2.01-2,"arguments/0/arguments/0")),"arguments/0"),{content:"assert(state.stats.handleDelta.calledWith(2.01 - 2))",filepath:"player-state.spec.js",line:145}))})),it("does not record delta when missed",(function(){var e=new u
p("\n          #BPM 120\n          #00111:01\n        "),sinon.spy(n.stats,"handleDelta"),d(9,{p1_1:1}),s()(e._expr(e._capt(0===e._capt(e._capt(e._capt(e._capt(n,"arguments/0/left/object/object/object").stats,"arguments/0/left/object/object").handleDelta,"arguments/0/left/object").callCount,"arguments/0/left"),"arguments/0"),{content:"assert(state.stats.handleDelta.callCount === 0)",filepath:"player-state.spec.js",line:155}))})),describe("with long note",(function(){let t
beforeEach((function(){p("\n            #BPM 120\n            #00151:0101\n          "),t=e.notes[0]})),it("judges long note",(function(){var e=new u,a=new u,o=new u,c=new u,r=new u,i=new u
d(2,{p1_1:1}),s()(e._expr(e._capt("active"===e._capt(e._capt(n,"arguments/0/left/callee/object").getNoteStatus(e._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(note) === 'active')",filepath:"player-state.spec.js",line:169})),s()(a._expr(a._capt(1===a._capt(a._capt(n,"arguments/0/left/callee/object").getNoteJudgment(a._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteJudgment(note) === 1)",filepath:"player-state.spec.js",line:170})),s()(o._expr(o._capt(1===o._capt(o._capt(o._capt(o._capt(o._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").judgments,"arguments/0/left/object/object")[0],"arguments/0/left/object").judgment,"arguments/0/left"),"arguments/0"),{content:"assert(state.notifications.judgments[0].judgment === 1)",filepath:"player-state.spec.js",line:171})),d(3,{p1_1:0}),s()(c._expr(c._capt("judged"===c._capt(c._capt(n,"arguments/0/left/callee/object").getNoteStatus(c._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(note) === 'judged')",filepath:"player-state.spec.js",line:173})),s()(r._expr(r._capt(1===r._capt(r._capt(n,"arguments/0/left/callee/object").getNoteJudgment(r._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteJudgment(note) === 1)",filepath:"player-state.spec.js",line:174})),s()(i._expr(i._capt(1===i._capt(i._capt(i._capt(i._capt(i._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").judgments,"arguments/0/left/object/object")[0],"arguments/0/left/object").judgment,"arguments/0/left"),"arguments/0"),{content:"assert(state.notifications.judgments[0].judgment === 1)",filepath:"player-state.spec.js",line:175}))})),it("gives 2 discrete judgments, one for down and one for up",(function(){var e=new u,t=new u
d(2,{p1_1:1}),s()(e._expr(e._capt(1===e._capt(e._capt(e._capt(n,"arguments/0/left/object/object").stats,"arguments/0/left/object").numJudgments,"arguments/0/left"),"arguments/0"),{content:"assert(state.stats.numJudgments === 1)",filepath:"player-state.spec.js",line:179})),d(3,{p1_1:0}),s()(t._expr(t._capt(2===t._capt(t._capt(t._capt(n,"arguments/0/left/object/object").stats,"arguments/0/left/object").numJudgments,"arguments/0/left"),"arguments/0"),{content:"assert(state.stats.numJudgments === 2)",filepath:"player-state.spec.js",line:181}))})),it("records delta once",(function(){var e=new u
sinon.spy(n.stats,"handleDelta"),d(2,{p1_1:1}),d(3,{p1_1:0}),s()(e._expr(e._capt(1===e._capt(e._capt(e._capt(e._capt(n,"arguments/0/left/object/object/object").stats,"arguments/0/left/object/object").handleDelta,"arguments/0/left/object").callCount,"arguments/0/left"),"arguments/0"),{content:"assert(state.stats.handleDelta.callCount === 1)",filepath:"player-state.spec.js",line:187}))})),it("judges missed long note",(function(){var e=new u,a=new u
d(2.3,{p1_1:1}),s()(e._expr(e._capt("judged"===e._capt(e._capt(n,"arguments/0/left/callee/object").getNoteStatus(e._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(note) === 'judged')",filepath:"player-state.spec.js",line:191})),s()(a._expr(a._capt(a._capt(a._capt(n,"arguments/0/left/callee/object").getNoteJudgment(a._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left")===a._capt(-1,"arguments/0/right"),"arguments/0"),{content:"assert(state.getNoteJudgment(note) === -1)",filepath:"player-state.spec.js",line:192}))})),it("gives 2 missed judgment for missed longnote",(function(){var e=new u
d(2.3,{p1_1:1}),s()(e._expr(e._capt(2===e._capt(e._capt(e._capt(n,"arguments/0/left/object/object").stats,"arguments/0/left/object").numJudgments,"arguments/0/left"),"arguments/0"),{content:"assert(state.stats.numJudgments === 2)",filepath:"player-state.spec.js",line:196}))})),it("judges long note lifted too fast as missed",(function(){var e=new u,a=new u,o=new u
d(2,{p1_1:1}),d(2.01,{p1_1:0}),s()(e._expr(e._capt("judged"===e._capt(e._capt(n,"arguments/0/left/callee/object").getNoteStatus(e._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(note) === 'judged')",filepath:"player-state.spec.js",line:201})),s()(a._expr(a._capt(a._capt(a._capt(n,"arguments/0/left/callee/object").getNoteJudgment(a._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left")===a._capt(-1,"arguments/0/right"),"arguments/0"),{content:"assert(state.getNoteJudgment(note) === -1)",filepath:"player-state.spec.js",line:202})),s()(o._expr(o._capt(2===o._capt(o._capt(o._capt(n,"arguments/0/left/object/object").stats,"arguments/0/left/object").numJudgments,"arguments/0/left"),"arguments/0"),{content:"assert(state.stats.numJudgments === 2)",filepath:"player-state.spec.js",line:203}))})),it("does not end automatically",(function(){var e=new u,a=new u
d(2,{p1_1:1}),d(3.1,{p1_1:1}),s()(e._expr(e._capt("active"===e._capt(e._capt(n,"arguments/0/left/callee/object").getNoteStatus(e._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(note) === 'active')",filepath:"player-state.spec.js",line:208})),s()(a._expr(a._capt(1===a._capt(a._capt(a._capt(n,"arguments/0/left/object/object").stats,"arguments/0/left/object").numJudgments,"arguments/0/left"),"arguments/0"),{content:"assert(state.stats.numJudgments === 1)",filepath:"player-state.spec.js",line:209}))})),it("judges long note lifted too slow as missed",(function(){var e=new u,a=new u,o=new u,c=new u
d(2,{p1_1:1}),d(4,{p1_1:1}),s()(e._expr(e._capt("judged"===e._capt(e._capt(n,"arguments/0/left/callee/object").getNoteStatus(e._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(note) === 'judged')",filepath:"player-state.spec.js",line:214})),s()(a._expr(a._capt(a._capt(a._capt(n,"arguments/0/left/callee/object").getNoteJudgment(a._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left")===a._capt(-1,"arguments/0/right"),"arguments/0"),{content:"assert(state.getNoteJudgment(note) === -1)",filepath:"player-state.spec.js",line:215})),s().deepEqual(o._expr(o._capt(o._capt(o._capt(o._capt(n,"arguments/0/object/object/object").notifications,"arguments/0/object/object").judgments,"arguments/0/object")[0],"arguments/0"),{content:"assert.deepEqual(state.notifications.judgments[0], {judgment: -1,combo: 0,delta: 1,column: note.column})",filepath:"player-state.spec.js",line:216}),c._expr(c._capt({judgment:c._capt(-1,"arguments/1/properties/0/value"),combo:0,delta:1,column:c._capt(c._capt(t,"arguments/1/properties/3/value/object").column,"arguments/1/properties/3/value")},"arguments/1"),{content:"assert.deepEqual(state.notifications.judgments[0], {judgment: -1,combo: 0,delta: 1,column: note.column})",filepath:"player-state.spec.js",line:216}))}))})),describe("with long scratch note",(function(){let t
beforeEach((function(){p("\n            #BPM 120\n            #00156:0101\n          "),t=e.notes[0]})),it("ends automatically",(function(){var e=new u,a=new u,o=new u,c=new u,r=new u,i=new u
d(2,{p1_SC:1}),s()(e._expr(e._capt("active"===e._capt(e._capt(n,"arguments/0/left/callee/object").getNoteStatus(e._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(note) === 'active')",filepath:"player-state.spec.js",line:236})),s()(a._expr(a._capt(1===a._capt(a._capt(n,"arguments/0/left/callee/object").getNoteJudgment(a._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteJudgment(note) === 1)",filepath:"player-state.spec.js",line:237})),s()(o._expr(o._capt(1===o._capt(o._capt(o._capt(o._capt(o._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").judgments,"arguments/0/left/object/object")[0],"arguments/0/left/object").judgment,"arguments/0/left"),"arguments/0"),{content:"assert(state.notifications.judgments[0].judgment === 1)",filepath:"player-state.spec.js",line:238})),d(3.1,{p1_SC:1}),s()(c._expr(c._capt("judged"===c._capt(c._capt(n,"arguments/0/left/callee/object").getNoteStatus(c._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(note) === 'judged')",filepath:"player-state.spec.js",line:240})),s()(r._expr(r._capt(1===r._capt(r._capt(n,"arguments/0/left/callee/object").getNoteJudgment(r._capt(t,"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteJudgment(note) === 1)",filepath:"player-state.spec.js",line:241})),s()(i._expr(i._capt(1===i._capt(i._capt(i._capt(i._capt(i._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").judgments,"arguments/0/left/object/object")[0],"arguments/0/left/object").judgment,"arguments/0/left"),"arguments/0"),{content:"assert(state.notifications.judgments[0].judgment === 1)",filepath:"player-state.spec.js",line:242}))}))})),describe("with long scratch note next to each other",(function(){beforeEach((function(){p("\n#BPM 120\n#00156:0100000000000000000000000000000000000000000000000000000000000001\n#00256:0100000000000000000000000000000000000000000000000000000000000001\n          ")})),it("should switch to next one on change",(function(){var t=new u,a=new u
d(2,{p1_SC:1}),d(4,{p1_SC:-1}),s()(t._expr(t._capt("judged"===t._capt(t._capt(n,"arguments/0/left/callee/object").getNoteStatus(t._capt(t._capt(t._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[0],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[0]) === 'judged')",filepath:"player-state.spec.js",line:257})),s()(a._expr(a._capt("active"===a._capt(a._capt(n,"arguments/0/left/callee/object").getNoteStatus(a._capt(a._capt(a._capt(e,"arguments/0/left/arguments/0/object/object").notes,"arguments/0/left/arguments/0/object")[1],"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(state.getNoteStatus(chart.notes[1]) === 'active')",filepath:"player-state.spec.js",line:258}))}))})),describe("sound notifications",(function(){it("notifies of note hit",(function(){var t=new u,a=new u
p("\n            #BPM 120\n            #00111:0102\n          "),d(2,{p1_1:1}),s()(t._expr(t._capt(t._capt(t._capt(t._capt(t._capt(t._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").sounds,"arguments/0/left/object/object")[0],"arguments/0/left/object").note,"arguments/0/left")===t._capt(t._capt(t._capt(e,"arguments/0/right/object/object").notes,"arguments/0/right/object")[0],"arguments/0/right"),"arguments/0"),{content:"assert(state.notifications.sounds[0].note === chart.notes[0])",filepath:"player-state.spec.js",line:269})),s()(a._expr(a._capt("hit"===a._capt(a._capt(a._capt(a._capt(a._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").sounds,"arguments/0/left/object/object")[0],"arguments/0/left/object").type,"arguments/0/left"),"arguments/0"),{content:"assert(state.notifications.sounds[0].type === 'hit')",filepath:"player-state.spec.js",line:270}))})),it("should notify missed notes as break",(function(){var t=new u,a=new u
p("\n            #BPM 120\n            #00111:01\n          "),d(5,{p1_1:0}),s()(t._expr(t._capt(t._capt(t._capt(t._capt(t._capt(t._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").sounds,"arguments/0/left/object/object")[0],"arguments/0/left/object").note,"arguments/0/left")===t._capt(t._capt(t._capt(e,"arguments/0/right/object/object").notes,"arguments/0/right/object")[0],"arguments/0/right"),"arguments/0"),{content:"assert(state.notifications.sounds[0].note === chart.notes[0])",filepath:"player-state.spec.js",line:278})),s()(a._expr(a._capt("break"===a._capt(a._capt(a._capt(a._capt(a._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").sounds,"arguments/0/left/object/object")[0],"arguments/0/left/object").type,"arguments/0/left"),"arguments/0"),{content:"assert(state.notifications.sounds[0].type === 'break')",filepath:"player-state.spec.js",line:279}))})),it("notifies of free keysound hit",(function(){var t=new u,a=new u,o=new u,c=new u,r=new u,i=new u
p("\n            #BPM 60\n            #00111:01\n            #00211:02\n          "),d(4,{p1_1:1}),d(4,{p1_1:0}),d(4,{p1_1:1}),s()(t._expr(t._capt(t._capt(t._capt(t._capt(t._capt(t._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").sounds,"arguments/0/left/object/object")[0],"arguments/0/left/object").note,"arguments/0/left")===t._capt(t._capt(t._capt(e,"arguments/0/right/object/object").notes,"arguments/0/right/object")[0],"arguments/0/right"),"arguments/0"),{content:"assert(state.notifications.sounds[0].note === chart.notes[0])",filepath:"player-state.spec.js",line:294})),s()(a._expr(a._capt("free"===a._capt(a._capt(a._capt(a._capt(a._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").sounds,"arguments/0/left/object/object")[0],"arguments/0/left/object").type,"arguments/0/left"),"arguments/0"),{content:"assert(state.notifications.sounds[0].type === 'free')",filepath:"player-state.spec.js",line:295})),d(4,{p1_1:0}),s()(o._expr(o._capt(!o._capt(o._capt(o._capt(o._capt(n,"arguments/0/argument/object/object/object").notifications,"arguments/0/argument/object/object").sounds,"arguments/0/argument/object").length,"arguments/0/argument"),"arguments/0"),{content:"assert(!state.notifications.sounds.length)",filepath:"player-state.spec.js",line:299})),d(5,{p1_1:1}),s()(c._expr(c._capt(c._capt(c._capt(c._capt(c._capt(c._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").sounds,"arguments/0/left/object/object")[0],"arguments/0/left/object").note,"arguments/0/left")===c._capt(c._capt(c._capt(e,"arguments/0/right/object/object").notes,"arguments/0/right/object")[0],"arguments/0/right"),"arguments/0"),{content:"assert(state.notifications.sounds[0].note === chart.notes[0])",filepath:"player-state.spec.js",line:303})),d(5,{p1_1:0}),d(6.5,{p1_1:1}),s()(r._expr(r._capt(r._capt(r._capt(r._capt(r._capt(r._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").sounds,"arguments/0/left/object/object")[0],"arguments/0/left/object").note,"arguments/0/left")===r._capt(r._capt(r._capt(e,"arguments/0/right/object/object").notes,"arguments/0/right/object")[0],"arguments/0/right"),"arguments/0"),{content:"assert(state.notifications.sounds[0].note === chart.notes[0])",filepath:"player-state.spec.js",line:310})),d(6.5,{p1_1:0}),d(7.5,{p1_1:1}),s()(i._expr(i._capt(i._capt(i._capt(i._capt(i._capt(i._capt(n,"arguments/0/left/object/object/object/object").notifications,"arguments/0/left/object/object/object").sounds,"arguments/0/left/object/object")[0],"arguments/0/left/object").note,"arguments/0/left")===i._capt(i._capt(i._capt(e,"arguments/0/right/object/object").notes,"arguments/0/right/object")[1],"arguments/0/right"),"arguments/0"),{content:"assert(state.notifications.sounds[0].note === chart.notes[1])",filepath:"player-state.spec.js",line:315}))})),it("suppresses freestyle keysound when column is sandwiched between 2 adjacent notes in 3d mode",(function(){var e=new u,t=new u
p("\n              #BPM 60\n              #00111:01\n              #00212:02\n              #00113:02\n            ",{speed:1,placement:"3d"}),d(1,{p1_2:1}),s().equal(e._expr(e._capt(e._capt(e._capt(e._capt(n,"arguments/0/object/object/object").notifications,"arguments/0/object/object").sounds,"arguments/0/object").length,"arguments/0"),{content:"assert.equal(state.notifications.sounds.length, 1)",filepath:"player-state.spec.js",line:328}),1),d(1,{p1_2:0}),d(4,{p1_2:1}),s().equal(t._expr(t._capt(t._capt(t._capt(t._capt(n,"arguments/0/object/object/object").notifications,"arguments/0/object/object").sounds,"arguments/0/object").length,"arguments/0"),{content:"assert.equal(state.notifications.sounds.length, 0)",filepath:"player-state.spec.js",line:332}),0),d(4,{p1_2:0})})),it("does not suppress freestyle keysound outside 3d mode",(function(){var e=new u,t=new u
p("\n              #BPM 60\n              #00111:01\n              #00212:02\n              #00113:02\n            ",{speed:1,placement:"left"}),d(1,{p1_2:1}),s().equal(e._expr(e._capt(e._capt(e._capt(e._capt(n,"arguments/0/object/object/object").notifications,"arguments/0/object/object").sounds,"arguments/0/object").length,"arguments/0"),{content:"assert.equal(state.notifications.sounds.length, 1)",filepath:"player-state.spec.js",line:346}),1),d(1,{p1_2:0}),d(4,{p1_2:1}),s().equal(t._expr(t._capt(t._capt(t._capt(t._capt(n,"arguments/0/object/object/object").notifications,"arguments/0/object/object").sounds,"arguments/0/object").length,"arguments/0"),{content:"assert.equal(state.notifications.sounds.length, 1)",filepath:"player-state.spec.js",line:350}),1),d(4,{p1_2:0})}))}))})),describe("speed",(function(){it("infers speed from player",(function(){var e=new u
p("",{speed:2}),s()(e._expr(e._capt(2===e._capt(e._capt(n,"arguments/0/left/object").speed,"arguments/0/left"),"arguments/0"),{content:"assert(state.speed === 2)",filepath:"player-state.spec.js",line:359}))})),it("updates speed on dedicated buttons",(function(){var e=new u,t=new u
p("",{speed:2}),d(1,{p1_speedup:1}),s()(e._expr(e._capt(2.5===e._capt(e._capt(n,"arguments/0/left/object").speed,"arguments/0/left"),"arguments/0"),{content:"assert(state.speed === 2.5)",filepath:"player-state.spec.js",line:364})),d(1.2,{p1_speedup:0,p1_speeddown:1}),s()(t._expr(t._capt(2===t._capt(t._capt(n,"arguments/0/left/object").speed,"arguments/0/left"),"arguments/0"),{content:"assert(state.speed === 2)",filepath:"player-state.spec.js",line:366}))})),it("supports fine-grained speed modifications",(function(){var e=new u
p("",{speed:2}),d(1,{p1_speedup:1,select:1}),s()(e._expr(e._capt(2.1===e._capt(e._capt(n,"arguments/0/left/object").speed,"arguments/0/left"),"arguments/0"),{content:"assert(state.speed === 2.1)",filepath:"player-state.spec.js",line:371}))})),it("supports pinching to zoom",(function(){var e=new u
p("",{speed:2}),d(1,{p1_pinch:300}),d(1.2,{p1_pinch:450}),s()(e._expr(e._capt(3===e._capt(e._capt(n,"arguments/0/left/object").speed,"arguments/0/left"),"arguments/0"),{content:"assert(state.speed === 3)",filepath:"player-state.spec.js",line:377}))}))})),describe("finish",(function(){it("should become true when song is finished",(function(){var e=new u,t=new u,a=new u
p("#00111:0101"),s()(e._expr(e._capt(!1===e._capt(e._capt(n,"arguments/0/left/object").finished,"arguments/0/left"),"arguments/0"),{content:"assert(state.finished === false)",filepath:"player-state.spec.js",line:384})),d(4,{}),s()(t._expr(t._capt(!1===t._capt(t._capt(n,"arguments/0/left/object").finished,"arguments/0/left"),"arguments/0"),{content:"assert(state.finished === false)",filepath:"player-state.spec.js",line:386})),d(16,{}),s()(a._expr(a._capt(!0===a._capt(a._capt(n,"arguments/0/left/object").finished,"arguments/0/left"),"arguments/0"),{content:"assert(state.finished === true)",filepath:"player-state.spec.js",line:388}))}))}))}))}))},63684:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(30182),c=n(53294),r=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("PlayerStats",(function(){const e=()=>new o.Z((0,c.qK)("#00111:1111111111")),t=()=>new o.Z((0,c.qK)("#00111:"+"11".repeat(1e3)))
describe("#score",(function(){it("returns the score",(function(){var t=new r,n=new r
const a=e()
s()(t._expr(t._capt(0===t._capt(t._capt(a,"arguments/0/left/object").score,"arguments/0/left"),"arguments/0"),{content:"assert(stats.score === 0)",filepath:"player-stats.spec.js",line:14})),a.handleJudgment(1),a.handleJudgment(1),a.handleJudgment(1),a.handleJudgment(1),a.handleJudgment(1),s()(n._expr(n._capt(555555===n._capt(n._capt(a,"arguments/0/left/object").score,"arguments/0/left"),"arguments/0"),{content:"assert(stats.score === 555555)",filepath:"player-stats.spec.js",line:20}))}))})),describe("#comboScore",(function(){it("returns the score",(function(){var e=new r,n=new r
const a=t()
s()(e._expr(e._capt(0===e._capt(e._capt(a,"arguments/0/left/object").comboScore,"arguments/0/left"),"arguments/0"),{content:"assert(stats.comboScore === 0)",filepath:"player-stats.spec.js",line:27}))
for(let e=0;e<1e3;e++)a.handleJudgment(1)
s()(n._expr(n._capt(55555===n._capt(n._capt(a,"arguments/0/left/object").comboScore,"arguments/0/left"),"arguments/0"),{content:"assert(stats.comboScore === 55555)",filepath:"player-stats.spec.js",line:31}))}))})),describe("#maxPossibleComboScore",(function(){it("is always 55555 in best case",(function(){var e=new r,n=new r
const a=t()
s()(e._expr(e._capt(55555===e._capt(e._capt(a,"arguments/0/left/object").maxPossibleComboScore,"arguments/0/left"),"arguments/0"),{content:"assert(stats.maxPossibleComboScore === 55555)",filepath:"player-stats.spec.js",line:38}))
for(let e=0;e<1e3;e++)a.handleJudgment(1),s()(n._expr(n._capt(55555===n._capt(n._capt(a,"arguments/0/left/object").maxPossibleComboScore,"arguments/0/left"),"arguments/0"),{content:"assert(stats.maxPossibleComboScore === 55555)",filepath:"player-stats.spec.js",line:41}))})),it("decreases to 0 in worst case",(function(){var t=new r,n=new r,a=new r
const o=e()
s()(t._expr(t._capt(55555===t._capt(t._capt(o,"arguments/0/left/object").maxPossibleComboScore,"arguments/0/left"),"arguments/0"),{content:"assert(stats.maxPossibleComboScore === 55555)",filepath:"player-stats.spec.js",line:46})),o.handleJudgment(-1),s()(n._expr(n._capt(n._capt(n._capt(o,"arguments/0/left/object").maxPossibleComboScore,"arguments/0/left")<55555,"arguments/0"),{content:"assert(stats.maxPossibleComboScore < 55555)",filepath:"player-stats.spec.js",line:48}))
for(let e=0;e<999;e++)o.handleJudgment(-1)
s()(a._expr(a._capt(0===a._capt(a._capt(o,"arguments/0/left/object").maxPossibleComboScore,"arguments/0/left"),"arguments/0"),{content:"assert(stats.maxPossibleComboScore === 0)",filepath:"player-stats.spec.js",line:52}))}))})),describe("#maxPossibleScore",(function(){it("is always 555555 in best case",(function(){var e=new r,n=new r
const a=t()
s()(e._expr(e._capt(555555===e._capt(e._capt(a,"arguments/0/left/object").maxPossibleScore,"arguments/0/left"),"arguments/0"),{content:"assert(stats.maxPossibleScore === 555555)",filepath:"player-stats.spec.js",line:59}))
for(let e=0;e<1e3;e++)a.handleJudgment(1),s()(n._expr(n._capt(555555===n._capt(n._capt(a,"arguments/0/left/object").maxPossibleScore,"arguments/0/left"),"arguments/0"),{content:"assert(stats.maxPossibleScore === 555555)",filepath:"player-stats.spec.js",line:62}))})),it("decreases to 0 in worst case",(function(){var e=new r,n=new r,a=new r,o=new r
const c=t()
s()(e._expr(e._capt(555555===e._capt(e._capt(c,"arguments/0/left/object").maxPossibleScore,"arguments/0/left"),"arguments/0"),{content:"assert(stats.maxPossibleScore === 555555)",filepath:"player-stats.spec.js",line:67})),c.handleJudgment(-1),s()(n._expr(n._capt(n._capt(n._capt(c,"arguments/0/left/object").maxPossibleScore,"arguments/0/left")<555555,"arguments/0"),{content:"assert(stats.maxPossibleScore < 555555)",filepath:"player-stats.spec.js",line:69})),s()(a._expr(a._capt(a._capt(a._capt(c,"arguments/0/left/object").maxPossibleScore,"arguments/0/left")>a._capt(a._capt(c,"arguments/0/right/object").score,"arguments/0/right"),"arguments/0"),{content:"assert(stats.maxPossibleScore > stats.score)",filepath:"player-stats.spec.js",line:70}))
for(let e=0;e<999;e++)c.handleJudgment(-1)
s()(o._expr(o._capt(0===o._capt(o._capt(c,"arguments/0/left/object").maxPossibleScore,"arguments/0/left"),"arguments/0"),{content:"assert(stats.maxPossibleScore === 0)",filepath:"player-stats.spec.js",line:74}))}))})),describe("#deltas",(function(){it("returns the deltas",(function(){const e=new o.Z((0,c.qK)("#00111:111111"))
e.handleDelta(.031),e.handleDelta(.001),e.handleDelta(-.031),expect(e.deltas).to.deep.equal([.031,.001,-.031])}))})),describe("#log",(function(){it("returns the log",(function(){const e=new o.Z((0,c.qK)("#00111:11111111111111"))
expect(e.score).to.equal(0),e.handleJudgment(1),e.handleJudgment(1),e.handleJudgment(1),e.handleJudgment(2),e.handleJudgment(3),e.handleJudgment(-1),e.handleJudgment(-1),expect(e.log).to.equal("3ABC2M")}))}))}))},54592:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(33237),c=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("A keysound cache",(function(){function e(){const e=(0,o.Z)()
return{startSong:t=>e.receiveSongId(t),cache:(t,n)=>e.cache(t,n),isEmpty:()=>e.isEmpty(),isCached:t=>e.isCached(t),get:t=>e.get(t)}}it("starts empty",(()=>{var t=new c
const n=e()
s()(t._expr(t._capt(t._capt(n,"arguments/0/callee/object").isEmpty(),"arguments/0"),{content:"assert(harness.isEmpty())",filepath:"createKeysoundCache.spec.js",line:8}))})),it("is unusable until song is selected",(()=>{const t=e()
s().throws((()=>{t.cache("sound1","AudioBuffer1")}))})),it("can add keysound to the cache",(()=>{var t=new c,n=new c,a=new c
const o=e()
o.startSong("songId1"),o.cache("sound1","AudioBuffer1"),s()(t._expr(t._capt(!t._capt(t._capt(o,"arguments/0/argument/callee/object").isEmpty(),"arguments/0/argument"),"arguments/0"),{content:"assert(!harness.isEmpty())",filepath:"createKeysoundCache.spec.js",line:22})),s()(n._expr(n._capt(!0===n._capt(n._capt(o,"arguments/0/left/callee/object").isCached("sound1"),"arguments/0/left"),"arguments/0"),{content:"assert(harness.isCached('sound1') === true)",filepath:"createKeysoundCache.spec.js",line:23})),s()(a._expr(a._capt("AudioBuffer1"===a._capt(a._capt(o,"arguments/0/left/callee/object").get("sound1"),"arguments/0/left"),"arguments/0"),{content:"assert(harness.get('sound1') === 'AudioBuffer1')",filepath:"createKeysoundCache.spec.js",line:24}))})),it("keeps keysounds in the cache if song did not change",(()=>{var t=new c
const n=e()
n.startSong("songId1"),n.cache("sound1","AudioBuffer1"),n.startSong("songId1"),s()(t._expr(t._capt(!t._capt(t._capt(n,"arguments/0/argument/callee/object").isEmpty(),"arguments/0/argument"),"arguments/0"),{content:"assert(!harness.isEmpty())",filepath:"createKeysoundCache.spec.js",line:32}))})),it("clears when song change",(()=>{var t=new c
const n=e()
n.startSong("songId1"),n.cache("sound1","AudioBuffer1"),n.startSong("songId2"),s()(t._expr(t._capt(t._capt(n,"arguments/0/callee/object").isEmpty(),"arguments/0"),{content:"assert(harness.isEmpty())",filepath:"createKeysoundCache.spec.js",line:40}))}))}))},55012:function(e,t,n){"use strict"
n.r(t)
var a=n(38500),s=n.n(a),o=n(83396),c=n.n(o),r=n(14090),i=n(7611),u=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("OmniInput",(function(){beforeEach((function(){this.window=function(){const e=new r.EventEmitter,t=[],n=()=>{}
return{addEventListener(t,n){e.on(t,n)},removeEventListener(t,n){e.removeListener(t,n)},setInterval(t){return e.on("timeout",t),t},clearInterval(t){e.removeListener("timeout",t)},keydown(t){e.emit("keydown",{which:t,preventDefault:n})},keyup(t){e.emit("keyup",{which:t,preventDefault:n})},tick(){e.emit("timeout")},gamepads:t,navigator:{getGamepads(){return t}}}}(),this.midi口=new(s().Bus),this.input=new i.FB(this.window,{"getMidi川":()=>this.midi口}),this.midi=(...e)=>{this.midi口.push({data:e,target:{id:"1234"}})}})),afterEach((function(){this.input.dispose()})),it("does not fail when browser support is limited",(()=>{const e={addEventListener(){},removeEventListener(){},navigator:{}}
new i.FB(e)})),describe("keyboard",(function(){it("recognizes input",(function(){var e=new u,t=new u
this.window.keydown(32),c()(e._expr(e._capt(e._capt(e._capt(this.input,"arguments/0/object/callee/object").update(),"arguments/0/object")[32],"arguments/0"),{content:"assert(this.input.update()['32'])",filepath:"index.spec.js",line:75})),this.window.keyup(32),c()(t._expr(t._capt(!t._capt(t._capt(t._capt(this.input,"arguments/0/argument/object/callee/object").update(),"arguments/0/argument/object")[32],"arguments/0/argument"),"arguments/0"),{content:"assert(!this.input.update()['32'])",filepath:"index.spec.js",line:77}))})),it("returns the key name",(function(){var e=new u,t=new u
c()(e._expr(e._capt("Space"===e._capt((0,i.oY)("32"),"arguments/0/left"),"arguments/0"),{content:"assert(getName('32') === 'Space')",filepath:"index.spec.js",line:80})),c()(t._expr(t._capt("A"===t._capt((0,i.oY)("65"),"arguments/0/left"),"arguments/0"),{content:"assert(getName('65') === 'A')",filepath:"index.spec.js",line:81}))}))})),describe("gamepad",(function(){it("recognizes input",(function(){var e=new u,t=new u,n=new u,a=new u,s=new u,o=new u,r=new u,i=new u,l=new u
this.window.gamepads.push(null,{index:1,buttons:[{},{value:.9}],axes:[0,.9,-.9]})
const p=this.input.update()
c()(e._expr(e._capt(!e._capt(e._capt(p,"arguments/0/argument/object")["gamepad.1.button.0"],"arguments/0/argument"),"arguments/0"),{content:"assert(!data['gamepad.1.button.0'])",filepath:"index.spec.js",line:93})),c()(t._expr(t._capt(t._capt(p,"arguments/0/object")["gamepad.1.button.1"],"arguments/0"),{content:"assert(data['gamepad.1.button.1'])",filepath:"index.spec.js",line:94})),c()(n._expr(n._capt(!n._capt(n._capt(p,"arguments/0/argument/object")["gamepad.1.axis.0"],"arguments/0/argument"),"arguments/0"),{content:"assert(!data['gamepad.1.axis.0'])",filepath:"index.spec.js",line:95})),c()(a._expr(a._capt(!a._capt(a._capt(p,"arguments/0/argument/object")["gamepad.1.axis.0.positive"],"arguments/0/argument"),"arguments/0"),{content:"assert(!data['gamepad.1.axis.0.positive'])",filepath:"index.spec.js",line:96})),c()(s._expr(s._capt(!s._capt(s._capt(p,"arguments/0/argument/object")["gamepad.1.axis.0.negative"],"arguments/0/argument"),"arguments/0"),{content:"assert(!data['gamepad.1.axis.0.negative'])",filepath:"index.spec.js",line:97})),c()(o._expr(o._capt(o._capt(p,"arguments/0/object")["gamepad.1.axis.1.positive"],"arguments/0"),{content:"assert(data['gamepad.1.axis.1.positive'])",filepath:"index.spec.js",line:98})),c()(r._expr(r._capt(!r._capt(r._capt(p,"arguments/0/argument/object")["gamepad.1.axis.1.negative"],"arguments/0/argument"),"arguments/0"),{content:"assert(!data['gamepad.1.axis.1.negative'])",filepath:"index.spec.js",line:99})),c()(i._expr(i._capt(i._capt(p,"arguments/0/object")["gamepad.1.axis.2.negative"],"arguments/0"),{content:"assert(data['gamepad.1.axis.2.negative'])",filepath:"index.spec.js",line:100})),c()(l._expr(l._capt(!l._capt(l._capt(p,"arguments/0/argument/object")["gamepad.1.axis.2.positive"],"arguments/0/argument"),"arguments/0"),{content:"assert(!data['gamepad.1.axis.2.positive'])",filepath:"index.spec.js",line:101}))}))})),describe("midi",(function(){it("handles notes",(function(){var e=new u,t=new u,n=new u,a=new u
this.midi(146,64,127),c()(e._expr(e._capt(e._capt(e._capt(this.input,"arguments/0/object/callee/object").update(),"arguments/0/object")["midi.1234.2.note.64"],"arguments/0"),{content:"assert(this.input.update()['midi.1234.2.note.64'], 'note on')",filepath:"index.spec.js",line:108}),"note on"),this.midi(130,64,127),c()(t._expr(t._capt(!t._capt(t._capt(t._capt(this.input,"arguments/0/argument/object/callee/object").update(),"arguments/0/argument/object")["midi.1234.2.note.64"],"arguments/0/argument"),"arguments/0"),{content:"assert(!this.input.update()['midi.1234.2.note.64'], 'note off')",filepath:"index.spec.js",line:110}),"note off"),this.midi(146,64,127),c()(n._expr(n._capt(n._capt(n._capt(this.input,"arguments/0/object/callee/object").update(),"arguments/0/object")["midi.1234.2.note.64"],"arguments/0"),{content:"assert(this.input.update()['midi.1234.2.note.64'], 'note on')",filepath:"index.spec.js",line:112}),"note on"),this.midi(146,64,0),c()(a._expr(a._capt(!a._capt(a._capt(a._capt(this.input,"arguments/0/argument/object/callee/object").update(),"arguments/0/argument/object")["midi.1234.2.note.64"],"arguments/0/argument"),"arguments/0"),{content:"assert(!this.input.update()['midi.1234.2.note.64'], 'note off with note on')",filepath:"index.spec.js",line:114}),"note off with note on")})),it("handles pitch bend",(function(){var e=new u,t=new u,n=new u,a=new u
this.midi(225,127,127),c()(e._expr(e._capt(e._capt(e._capt(this.input,"arguments/0/object/callee/object").update(),"arguments/0/object")["midi.1234.1.pitch.up"],"arguments/0"),{content:"assert(this.input.update()['midi.1234.1.pitch.up'])",filepath:"index.spec.js",line:121})),c()(t._expr(t._capt(!t._capt(t._capt(t._capt(this.input,"arguments/0/argument/object/callee/object").update(),"arguments/0/argument/object")["midi.1234.1.pitch.down"],"arguments/0/argument"),"arguments/0"),{content:"assert(!this.input.update()['midi.1234.1.pitch.down'])",filepath:"index.spec.js",line:122})),this.midi(225,127,31),c()(n._expr(n._capt(n._capt(n._capt(this.input,"arguments/0/object/callee/object").update(),"arguments/0/object")["midi.1234.1.pitch.down"],"arguments/0"),{content:"assert(this.input.update()['midi.1234.1.pitch.down'])",filepath:"index.spec.js",line:124})),c()(a._expr(a._capt(!a._capt(a._capt(a._capt(this.input,"arguments/0/argument/object/callee/object").update(),"arguments/0/argument/object")["midi.1234.1.pitch.up"],"arguments/0/argument"),"arguments/0"),{content:"assert(!this.input.update()['midi.1234.1.pitch.up'])",filepath:"index.spec.js",line:125}))})),it("handles sustain pedal",(function(){var e=new u,t=new u
this.midi(188,64,127),c()(e._expr(e._capt(e._capt(e._capt(this.input,"arguments/0/object/callee/object").update(),"arguments/0/object")["midi.1234.12.sustain"],"arguments/0"),{content:"assert(this.input.update()['midi.1234.12.sustain'])",filepath:"index.spec.js",line:129})),this.midi(188,64,0),c()(t._expr(t._capt(!t._capt(t._capt(t._capt(this.input,"arguments/0/argument/object/callee/object").update(),"arguments/0/argument/object")["midi.1234.12.sustain"],"arguments/0/argument"),"arguments/0"),{content:"assert(!this.input.update()['midi.1234.12.sustain'])",filepath:"index.spec.js",line:131}))})),it("handles modulation lever",(function(){var e=new u,t=new u
this.midi(188,1,127),c()(e._expr(e._capt(e._capt(e._capt(this.input,"arguments/0/object/callee/object").update(),"arguments/0/object")["midi.1234.12.mod"],"arguments/0"),{content:"assert(this.input.update()['midi.1234.12.mod'])",filepath:"index.spec.js",line:135})),this.midi(188,1,0),c()(t._expr(t._capt(!t._capt(t._capt(t._capt(this.input,"arguments/0/argument/object/callee/object").update(),"arguments/0/argument/object")["midi.1234.12.mod"],"arguments/0/argument"),"arguments/0"),{content:"assert(!this.input.update()['midi.1234.12.mod'])",filepath:"index.spec.js",line:137}))})),it("returns the key name",(function(){var e=new u,t=new u,n=new u,a=new u,s=new u
c()(e._expr(e._capt(e._capt((0,i.oY)("midi.1234.12.note.60"),"arguments/0/callee/object").match(/C4/),"arguments/0"),{content:"assert(getName('midi.1234.12.note.60').match(/C4/))",filepath:"index.spec.js",line:140})),c()(t._expr(t._capt(t._capt((0,i.oY)("midi.1234.12.pitch.up"),"arguments/0/callee/object").match(/Pitch\+/),"arguments/0"),{content:"assert(getName('midi.1234.12.pitch.up').match(/Pitch\\+/))",filepath:"index.spec.js",line:141})),c()(n._expr(n._capt(n._capt((0,i.oY)("midi.1234.12.pitch.down"),"arguments/0/callee/object").match(/Pitch-/),"arguments/0"),{content:"assert(getName('midi.1234.12.pitch.down').match(/Pitch-/))",filepath:"index.spec.js",line:142})),c()(a._expr(a._capt(a._capt((0,i.oY)("midi.1234.12.sustain"),"arguments/0/callee/object").match(/Sustain/),"arguments/0"),{content:"assert(getName('midi.1234.12.sustain').match(/Sustain/))",filepath:"index.spec.js",line:143})),c()(s._expr(s._capt(s._capt((0,i.oY)("midi.1234.12.mod"),"arguments/0/callee/object").match(/Mod/),"arguments/0"),{content:"assert(getName('midi.1234.12.mod').match(/Mod/))",filepath:"index.spec.js",line:144}))}))})),describe("key川",(function(){it("should return events",(function(){var e=new u
let t
const n=(0,i.qf)(this.input,this.window).onValue((e=>t=e))
this.window.keydown(32),this.window.tick(),c()(e._expr(e._capt("32"===e._capt(t,"arguments/0/left"),"arguments/0"),{content:"assert(last === '32')",filepath:"index.spec.js",line:157})),n()}))})),describe("_key川ForUpdate川",(function(){it("should emit new keys",(function(){var e=new u,t=new u
const n=new(s().Bus),a=[],o=(0,i.fW)(n).onValue((e=>a.push(e)))
n.push({32:!0}),n.push({32:!0}),n.push({32:!1}),n.push({32:!0}),n.push({33:!0}),n.push({32:!0}),n.push({32:!0,35:!0}),n.push({31:!0,35:!0}),c().deepEqual(e._expr(e._capt(a,"arguments/0"),{content:"assert.deepEqual(events, ['32','32','33','32','35','31'])",filepath:"index.spec.js",line:178}),t._expr(t._capt(["32","32","33","32","35","31"],"arguments/1"),{content:"assert.deepEqual(events, ['32','32','33','32','35','31'])",filepath:"index.spec.js",line:178})),o()}))}))}))},50469:function(e,t,n){"use strict"
n.r(t)
var a=n(62270),s=n.n(a),o=n(24927),c=n(67573)
describe("Online DataStore",(function(){describe("initial state",(function(){describe("get",(function(){it("should return initial operation state when not exist",(function(){const e=o.U2(o.Y6,"meow")
expect(e).to.deep.equal(c.lk)}))})),describe("has",(function(){it("has should return false",(function(){const e=o.e$(o.Y6,"meow")
expect(e).to.be.false}))}))})),describe("reducer",(function(){describe("put",(function(){it("should transition state of a record",(function(){const e=o.gz("a",c.YO(1)),t=o.gz("b",c.YO(2)),n=s()().thru((t=>o.u4(t,e))).thru((e=>o.u4(e,t))).value()
expect(o.U2(n,"a").value).to.equal(1),expect(o.U2(n,"b").value).to.equal(2)}))})),describe("putMultiple",(function(){it("should transition state of multiple records",(function(){const e=o.A4({a:c.YO(1),b:c.YO(2)}),t=o.u4(void 0,e)
expect(o.U2(t,"a").value).to.equal(1),expect(o.U2(t,"b").value).to.equal(2)}))}))})),describe("with records",(function(){beforeEach((function(){const e=o.A4({a:c.YO(1),b:c.YO(2),c:c.lk,d:c.lq()})
this.state=o.u4(void 0,e)})),describe("has",(function(){it("has should return true if touched",(function(){expect(o.e$(this.state,"a")).to.be.true,expect(o.e$(this.state,"b")).to.be.true,expect(o.e$(this.state,"c")).to.be.true,expect(o.e$(this.state,"d")).to.be.true})),it("has should return false if untouched",(function(){expect(o.e$(this.state,"e")).to.be.false}))})),describe("clear",(function(){it("should clear the store",(function(){this.state=o.u4(this.state,o.ZH()),expect(o.e$(this.state,"a")).to.be.false}))}))}))}))},92601:function(e,t,n){"use strict"
n.r(t)
var a=n(74179),s=n(43793)
const o=function(){const e=Math.floor(65536*Math.random()).toString(16)
let t=0
return function(){const n=Math.floor(65536*Math.random()).toString(16)
return"bemuse."+Date.now().toString(16)+"."+e+"."+n+"."+(++t).toString(16)}}()
function c(e){let t,n=new Promise((e=>t=e)),a=0
return before((()=>{t()})),e(((e,t)=>{n=n.then(t,(()=>{throw new Error("Previous steps errored")}))
const s=n
it(`${++a}. ${e}`,(()=>s))}))}!function(e){const t={}
function n(){return new a.Z(new s.Z({...e,storage:t}))}describe("Online",(function(){function e(){return{username:o(),password:"wow_bemuse_test",email:"test+"+o()+"@bemuse.ninja"}}this.timeout(2e4),describe("signup",(function(){let t,a
before((function(){t=n()})),after((function(){t=null})),before((function(){a=e()})),it("should succeed",(function(){return expect(t.signUp(a)).to.be.fulfilled})),it("should not allow duplicate signup",(function(){return expect(t.signUp(a)).to.be.rejectedWith(Error)}))})),describe("initially",(function(){let e
before((async()=>{await n().logOut()})),beforeEach((async()=>{e=n()})),describe("user川",(function(){it("should be null",(function(){return expect(e.user川.first().toPromise()).to.eventually.be.null}))}))})),describe("when signed up",(function(){let t
before((function(){t=n()})),describe("user川",(function(){it("should change to signed-up user, and also start with it",(async function(){const a=e()
t.user川.onValue(console.log.bind(console,"user川"))
const s=(async()=>{const e=await t.user川.filter((e=>!!e)).first().toPromise()
expect(e.username).to.equal(a.username)
const s=await n().user川.filter((e=>!!e)).first().toPromise()
expect(s.username).to.equal(a.username)})()
await t.signUp(a),await s}))}))})),describe("with an active user",(function(){let t
const a=e()
before((function(){t=n()})),before((function(){return t.signUp(a)})),beforeEach((function(){return t.logIn(a)})),describe("when log out",(function(){it("should change user川 back to null",(async function(){const e=(async()=>{const e=await t.user川.filter((e=>!e)).first().toPromise()
expect(e).to.be.null})()
await Promise.resolve(t.logOut()),await e}))}))})),describe("submitting high scores",(function(){let t
before((function(){t=n()}))
const a=o()+"_",s=e(),r=e()
c((e=>{let n
e("sign up...",(function(){return t.signUp(s)})),e("records data successfully",(async function(){const e=await t.submitScore({md5:a+"song",playMode:"BM",score:123456,combo:123,total:456,count:[122,1,0,0,333],log:""})
expect(e.playNumber).to.equal(1),expect(e.playCount).to.equal(1),expect(e.recordedAt).to.be.an.instanceof(Date),expect(e.rank).to.equal(1),n=e.recordedAt})),e("does not update if old score is better, but update play count",(async function(){const e=await t.submitScore({md5:a+"song",playMode:"BM",score:123210,combo:124,total:456,count:[123,1,0,0,332],log:""})
expect(e.score).to.equal(123456),expect(e.combo).to.equal(123),expect(e.playNumber).to.equal(1),expect(e.playCount).to.equal(2),expect(e.recordedAt).not.to.be.above(n),n=e.recordedAt})),e("updates data if new score is better",(async function(){const e=await t.submitScore({md5:a+"song",playMode:"BM",score:555555,combo:456,total:456,count:[456,0,0,0,0],log:""})
expect(e.score).to.equal(555555),expect(e.combo).to.equal(456),expect(e.playNumber).to.equal(3),expect(e.playCount).to.equal(3),expect(e.recordedAt).to.be.above(n),expect(e.playerName).to.equal(s.username),n=e.recordedAt})),e("different mode have different score board",(async function(){const e=await t.submitScore({md5:a+"song",playMode:"KB",score:123210,combo:124,total:456,count:[123,1,0,0,332],log:""})
expect(e.score).to.equal(123210),expect(e.rank).to.equal(1)})),e("as another user...",(function(){return t.signUp(r)})),e("saves a separate data",(async function(){const e=await t.submitScore({md5:a+"song",playMode:"BM",score:123210,combo:124,total:456,count:[123,1,0,0,332],log:""})
expect(e.score).to.equal(123210),expect(e.playNumber).to.equal(1),expect(e.playCount).to.equal(1),expect(e.rank).to.equal(2)}))}))})),describe("the scoreboard",(function(){let t
before((function(){return t=n(),t.logOut()}))
const a=o()+"_",s=e(),r=e(),i=e()
c((e=>{let n,o,c
function u(e){return Promise.resolve(o.filter(e).first().toPromise())}e("sign up user1...",(function(){return t.signUp(s)})),e("submit score1...",(function(){return t.submitScore({md5:a+"song1",playMode:"BM",score:222222,combo:456,total:456,count:[0,0,456,0,0],log:""})})),e("sign up user2...",(function(){return t.signUp(r)})),e("submit score2...",(function(){return t.submitScore({md5:a+"song1",playMode:"BM",score:555555,combo:456,total:456,count:[456,0,0,0,0],log:""})})),e("scoreboard should return the top score",(async function(){const e=await t.scoreboard({md5:a+"song1",playMode:"BM"})
expect(e.data).to.have.length(2),expect(e.data[0].rank).to.eq(1),expect(e.data[1].rank).to.eq(2)})),e("log out...",(function(){return t.logOut()})),e("subscribe to scoreboard...",(function(){n=t.Ranking({md5:a+"song1",playMode:"BM",score:111111,combo:123,total:456,count:[0,123,0,0,333],log:""}),o=n.state川,c=o.onValue((e=>{}))})),e("should have scoreboard loading status",(function(){return u((e=>"loading"===e.meta.scoreboard.status))})),e("no new score should be submitted",(function(){return u((e=>"completed"===e.meta.scoreboard.status&&"unauthenticated"===e.meta.submission.status)).then((e=>{expect(e.data).to.have.length(2)}))})),e("sign up user3...",(function(){return t.signUp(i)})),e("should start sending score",(function(){return u((e=>"loading"===e.meta.submission.status))})),e("should finish sending score",(function(){return u((e=>"completed"===e.meta.submission.status)).then((e=>{expect(e.meta.submission.value.rank).to.equal(3)}))})),e("should start loading scoreboard",(function(){return u((e=>"loading"===e.meta.scoreboard.status))})),e("should finish reloading scoreboard",(function(){return u((e=>"completed"===e.meta.scoreboard.status)).then((e=>{expect(e.data).to.have.length(3)}))})),e("resubscribe with read only",(function(){c(),n=t.Ranking({md5:a+"song1",playMode:"BM"}),o=n.state川,c=o.subscribe((()=>{}))})),e("should not submit new score",(function(){return u((e=>"completed"===e.meta.scoreboard.status&&"completed"===e.meta.submission.status)).then((function(e){expect(e.data).to.have.length(3),expect(e.meta.submission.value.playCount).to.equal(1)}))})),after((function(){t.logOut(),c()}))}))}))}))}({fake:!0})},23847:function(e,t,n){"use strict"
n.r(t)
var a=n(33256),s=n(95182)
describe("ProgressFormatters",(function(){describe("BYTES_FORMATTER",(function(){it("should return blank for indeterminate",(function(){const e=new s.E
expect(a.qw(e)).to.equal("")})),it("should format as human readable size",(function(){const e=new s.E
e.report(1,1024),expect(a.qw(e)).to.equal("1B / 1KB")}))})),describe("EXTRA_FORMATTER",(function(){it("should just use the extra",(function(){const e=new s.E
e.report(1,1024,"one.wav"),expect(a.cY(e)).to.equal("one.wav")}))}))}))},77072:function(e,t,n){"use strict"
n.r(t)
var a=n(95182)
describe("Progress",(function(){describe("#watch",(function(){it("should report current progress when watched",(function(){const e=new a.E,t=sinon.spy()
e.report(1,10),e.watch(t),expect(t).to.have.callCount(1),expect(t).to.have.been.calledWith(e)}))})),describe("#toString",(function(){it("should return blank string when no progress",(function(){const e=new a.E
expect(e.toString()).to.equal("")})),it("should return a string representation of the progress",(function(){const e=new a.E
e.report(1,10),expect(e.toString()).to.equal("1 / 10")})),it("should use a formatter",(function(){const e=new a.E
e.report(1,10),e.formatter=e=>e.progress+"",expect(e.toString()).to.equal("0.1")}))})),describe("#report",(function(){it("should fire to all watchers",(function(){const e=new a.E,t=sinon.spy()
e.report(1,10),e.report(2,10),e.watch(t),e.report(3,10),e.report(4,10),expect(t).to.have.callCount(3)})),it("should return a function to unsubscribe",(function(){const e=new a.E,t=sinon.spy()
e.report(1,10),e.report(2,10)
const n=e.watch(t)
e.report(3,10),n(),e.report(4,10),expect(t).to.have.callCount(2)}))})),describe("#progress",(function(){it("returns progress in fraction",(function(){const e=new a.E
e.report(1,10),expect(e.progress).to.equal(.1)})),it("returns null in unavailable",(function(){const e=new a.E
expect(e.progress).to.equal(null)}))}))}))},77440:function(e,t,n){"use strict"
n.r(t)
var a=n(95182),s=n(26230)
describe("ProgressUtils",(function(){describe(".fixed",(function(){it("should report for fixed number of items",(function(){const e=new a.E,t=s.Bd(10,e)
expect(e.current).to.equal(0),expect(e.total).to.equal(10),t("wow"),expect(e.current).to.equal(1),expect(e.total).to.equal(10),expect(e.extra).to.equal("wow")}))})),describe(".wrapPromise",(function(){it("should report number of fulfilled promises",(function(){const e=new a.E,t=s.Lg(e,(e=>e)),n=(t(new Promise((()=>{}))),t(Promise.resolve(1))),o=(t(Promise.reject(new Error("no"))),t(Promise.resolve(3)))
return Promise.all([n,o]).then((()=>{expect(e.current).to.equal(2),expect(e.total).to.equal(4)}))}))})),describe(".bind",(function(){it("should bind from one progress to another",(function(){const e=new a.E,t=new a.E
e.report(10,20),s.ak(e,t),expect(t.current).to.equal(10),expect(t.total).to.equal(20),e.report(15,25),expect(t.current).to.equal(15),expect(t.total).to.equal(25)}))})),describe(".simultaneous",(function(){it("should report in fifo manner",(function(){const e=new a.E,t=s._W(e),n=new a.E,o=new a.E
t.add(n),n.report(10,20),expect(e.current).to.equal(10),t.add(o),o.report(11,30),expect(e.current).to.equal(10),n.report(15,20),expect(e.current).to.equal(15),n.report(20,20),expect(e.current).to.equal(11),o.report(21,30),expect(e.current).to.equal(21),o.report(30,30),expect(e.current).to.equal(30),expect(e.total).to.equal(30)}))}))}))},57561:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(80513),c=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("BemusePackageResources",(function(){describe("#file",(function(){let e
beforeEach((function(){e=new o.C("/base/src/resources/test-fixtures/a/")})),it("returns a file",(function(){return expect(e.file("do.mp3")).to.be.fulfilled})),it("rejects if file not found",(function(){return expect(e.file("wow.mp3")).to.be.rejected})),it("can be read",(function(){return expect(e.file("mi.mp3").then((e=>e.read())).then((e=>e.byteLength))).to.eventually.eq(30093)})),it("can obtain url",(function(){return e.file("mi.mp3").then((e=>e.resolveUrl())).then((e=>{var t=new c
s()(t._expr(t._capt("string"===t._capt(typeof e,"arguments/0/left"),"arguments/0"),{content:"assert(typeof url === 'string')",filepath:"bemuse-package.spec.js",line:37}))}))})),it("cannot read if not bemuse file",(function(){return e=new o.C("/base/src/resources/test-fixtures/b/"),expect(e.file("do.mp3").then((e=>e.read()))).to.be.rejected})),it("data is correct",(function(){return e.file("mi.mp3").then((e=>e.read())).then((e=>new Uint8Array(e))).then((e=>{expect([e[0],e[1],e[2]]).to.deep.equal([255,251,144])}))})),it("supports fallback",(function(){return e=new o.C("/base/src/resources/test-fixtures/a/",{fallback:"/base/src/resources/test-fixtures/f/",fallbackPattern:/\.txt$/}),e.file("meow.txt").then((e=>e.read())).then((e=>new Uint8Array(e))).then((e=>{expect([e[0],e[1]]).to.deep.equal([104,105])}))})),it("supports fallback only with the pattern",(function(){return e=new o.C("/base/spec/resources/fixtures/a/",{fallback:"/base/src/resources/test-fixtures/f/",fallbackPattern:/\.txt$/}),expect(e.file("meow.dat")).to.be.rejected}))}))}))},89333:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(96011),c=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("URLResource",(function(){it("can download a resource from an arbitrary URL",(function(){return new o.ZP("/base/src/resources/test-fixtures/f/meow.txt").read().then((e=>new Uint8Array(e))).then((e=>{expect([e[0],e[1]]).to.deep.equal([104,105])}))})),it("can retrieve back the URL",(function(){return new o.ZP("/base/src/resources/test-fixtures/f/meow.txt").resolveUrl().then((e=>{var t=new c
s()(t._expr(t._capt(/\/meow\.txt$/.test(t._capt(e,"arguments/0/arguments/0")),"arguments/0"),{content:"assert(/\\/meow\\.txt$/.test(url))",filepath:"url.spec.js",line:22}))}))})),it("has a name, which is only the file name without the path",(function(){var e=new c
const t=new o.ZP("/base/src/resources/test-fixtures/f/meow.txt")
s()(e._expr(e._capt("meow.txt"===e._capt(e._capt(t,"arguments/0/left/object").name,"arguments/0/left"),"arguments/0"),{content:"assert(resource.name === 'meow.txt')",filepath:"url.spec.js",line:29}))}))}))},27362:function(e,t,n){"use strict"
n.r(t)
n(43709)
var a=n(83396),s=n.n(a),o=n(10426),c=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("SamplingMaster",(function(){let e,t
before((()=>{WebAudioTestAPI.use()})),beforeEach((()=>{e=new AudioContext,t=new o.ZP(e)})),describe("#unmute",(function(){it("unmutes the audio",(function(){const n=e.createGain()
sinon.stub(e,"createGain").returns(n),sinon.spy(n,"connect"),sinon.spy(n,"disconnect"),t.unmute(),expect(e.createGain).to.have.been.called,expect(n.connect).to.have.been.called,expect(n.disconnect).to.have.been.called}))})),describe("#group",(function(){it("has a destination with gain",(function(){const e=t.group({volume:.5})
expect(e.destination.gain.value).to.equal(.5)})),it("connect upon construct, disconnect upon destroy",(function(){const e=t.group(),n=e.destination
expect(n.$isConnectedTo(t.destination)).to.be.true,e.destroy(),expect(n.$isConnectedTo(t.destination)).to.be.false,expect(e.destination).to.be.null}))})),describe("#decode",(function(){it("returns an audio buffer",(()=>t.decode(new Blob([])).then((e=>{var t=new c
s()(t._expr(t._capt(t._capt(e,"arguments/0/object").numberOfChannels,"arguments/0"),{content:"assert(audioBuffer.numberOfChannels)",filepath:"index.spec.js",line:51}))}))))})),describe("#sample",(function(){it("should coerce blob",(function(){return t.sample(new Blob([]))})),it("should coerce array buffer",(function(){return t.sample(new ArrayBuffer(0))})),it("should support an audiobuffer",(function(){return t.decode(new Blob([])).then((e=>t.sample(e)))})),it("should reject when decoding failed",(function(){return e.DECODE_AUDIO_DATA_FAILED=!0,expect(t.sample(new ArrayBuffer(0)).finally((()=>e.DECODE_AUDIO_DATA_FAILED=!1))).to.be.rejected})),describe("#play",(function(){let n,a,s
beforeEach((function(){return a=e.createBufferSource(),s=e.createBuffer(1,44100,44100),a.buffer=s,sinon.stub(e,"createBufferSource").returns(a),sinon.spy(a,"start"),t.sample(new Blob([])).then((e=>n=e))})),it("should play a buffer source",(function(){n.play(),expect(e.createBufferSource).to.have.been.called,expect(a.start).to.have.been.calledWith(0)})),it("should play a buffer source with delay",(function(){e.$processTo(1),n.play(20),expect(e.createBufferSource).to.have.been.called,expect(a.start).to.have.been.calledWith(21)})),it("should play a buffer slice (without end)",(function(){n.play(0,{start:1,end:void 0}),expect(a.start).to.have.been.calledWith(0,1)})),it("should play a buffer slice (with end)",(function(){n.play(0,{start:1,end:3}),expect(a.start).to.have.been.calledWith(0,1,2+o.tz)})),it("should play to a group",(function(){const e=t.group(),a=n.play(0,{group:e})
expect(a.TEST_node.$isConnectedTo(e.destination)).to.be.true})),function(){try{return new Event("wat").type="customevent",it}catch(e){return it.skip}}()("should call #stop when playing finished",(function(){const t=n.play()
sinon.spy(t,"stop"),e.$processTo(1.5),expect(t.stop).to.have.been.called})),describe("#stop",(function(){it("should stop the buffer source",(function(){const e=n.play()
sinon.spy(a,"stop"),e.stop(),expect(a.stop).to.have.been.called})),it("can be called multiple times",(function(){const e=n.play()
sinon.spy(a,"stop"),e.stop(),e.stop(),e.stop(),expect(a.stop).to.have.been.calledOnce})),it("should call #onstop",(function(){const e=n.play()
e.onstop=sinon.spy(),e.stop(),expect(e.onstop).to.have.been.called}))})),describe("#bad",(function(){it("should change pitch of sound",(function(){n.play().bad(),expect(a.playbackRate.value).not.to.equal(1)}))}))}))})),describe("#destroy",(function(){let e
beforeEach((function(){return t.sample(new Blob([])).then((t=>e=t))})),it("should stop all samples",(function(){const n=e.play(),a=e.play(),s=e.play()
sinon.spy(n,"stop"),sinon.spy(a,"stop"),sinon.spy(s,"stop"),t.destroy(),expect(n.stop).to.have.been.called,expect(a.stop).to.have.been.called,expect(s.stop).to.have.been.called})),it("can no longer create samples",(function(){return t.destroy(),expect(t.sample(new Blob([]))).to.be.rejected})),it("only destroys once",(function(){const n=e.play()
sinon.spy(n,"destroy"),t.destroy(),t.destroy(),expect(n.destroy).to.have.callCount(1)}))})),after((()=>{WebAudioTestAPI.unuse()}))}))},69020:function(e,t,n){"use strict"
n.r(t)
var a=n(33155)
describe("Scintillator Expression",(function(){describe("()",(function(){it("should parse",(function(){const e=new a.Z("a+b")
expect(e({a:1,b:5})).to.equal(6)}))})),describe("#constant",(function(){it("should be false when containing variables",(function(){const e=new a.Z("a+b")
expect(e.constant).to.be.false})),it("should be true when only contains number",(function(){const e=new a.Z("-1.25")
expect(e.constant).to.be.true}))}))}))},83451:function(e,t,n){"use strict"
n.r(t)
var a=n(8050)
const s=e=>`/base/src/scintillator/test-fixtures/${e}`
describe("Scintillator",(function(){describe("#load",(function(){it("should load skin and return skin node",(async function(){const e=await a.load(s("bare.xml"))
expect(e.width).to.equal(123),expect(e.height).to.equal(456)})),it("should reject if invalid",(function(){return expect(a.load(s("invalid_tag.xml"))).to.be.rejected}))})),describe("Context",(function(){it("should instantiate and able to destroy",(async function(){const e=await a.load(s("bare.xml")),t=new a.Context(e)
t.render({}),t.destroy()})),describe("#input",(function(){let e,t
function n(e,n,a){t.view.dispatchEvent(new MouseEvent(`mouse${e}`,{clientX:n,clientY:a}))}function o(e,n,a){const s=new Event(`touch${e}`)
s.touches=n,s.changedTouches=a,t.view.dispatchEvent(s)}beforeEach((async function(){e=await a.load(s("bare.xml")),t=new a.Context(e),t.render({}),t.view.style.position="fixed",t.view.style.top="0",t.view.style.left="0",document.body.appendChild(t.view)})),afterEach((function(){t.destroy(),document.body.removeChild(t.view)})),it("should report touches/mouse inside the region",(function(){n("move",10,10),n("down",10,10),expect(t.input).to.deep.equal([{x:10,y:10,id:"mouse"}])
const e={identifier:1,clientX:80,clientY:80}
o("start",[e],[e]),expect(t.input).to.deep.equal([{x:10,y:10,id:"mouse"},{x:80,y:80,id:"touch1"}]),n("move",20,20),expect(t.input).to.deep.equal([{x:20,y:20,id:"mouse"},{x:80,y:80,id:"touch1"}]),n("up",10,10),expect(t.input).to.deep.equal([{x:80,y:80,id:"touch1"}]),o("end",[],[e]),expect(t.input).to.deep.equal([])}))})),describe("#refs",(function(){it("should be a set of refs to the display object",(async function(){const e=await a.load(s("refs.xml")),t=new a.Context(e)
t.render({}),expect(Array.from(t.refs.a)[0]).to.equal(t.stage.children[0]),t.destroy()}))}))})),describe("Expressions",(function(){it("should be parsed and processed",(async function(){const e=await a.load(s("expr_basic.xml")),t=new a.Context(e)
t.render({})
const n=t.stage
expect(n.children[0].x).to.equal(6),expect(n.children[0].y).to.equal(7),t.destroy()})),it("should support variables",(async function(){const e=await a.load(s("expr_variables.xml")),t=new a.Context(e),n=t.stage
t.render({a:4,b:3}),expect(n.children[0].x).to.equal(7),expect(n.children[0].y).to.equal(12),t.render({a:10,b:20}),expect(n.children[0].x).to.equal(30),expect(n.children[0].y).to.equal(200),t.destroy()}))})),describe("SpriteNode",(function(){it("should allow setting sprite frame",(async function(){const e=await a.load(s("sprite_attrs.xml")),t=new a.Context(e),n=t.stage
t.render({})
const o=n.children[0].texture.frame
expect(o.width).to.equal(10),expect(o.height).to.equal(11),expect(o.x).to.equal(12),expect(o.y).to.equal(13),t.destroy()})),it("should allow setting visibility, width, height",(async function(){const e=await a.load(s("sprite_attrs.xml")),t=new a.Context(e),n=t.stage
t.render({})
const o=n.children[0]
expect(o.width).to.equal(3),expect(o.height).to.equal(1),expect(o.visible).to.equal(!1),t.destroy()})),it("should reject if blend mode is invalid",(function(){return expect(a.load(s("sprite_invalid_blend.xml"))).to.be.rejected}))})),describe("TextNode",(function(){it("should display text",(async function(){const e=await a.load(s("text.xml")),t=new a.Context(e),n=t.stage
t.render({})
const o=n.children[0].children[0]
expect(o.text).to.equal("Hello world"),t.destroy()})),it("should center text",(async function(){const e=await a.load(s("text_center.xml")),t=new a.Context(e),n=t.stage
t.render({})
const o=n.children[0].children[0]
expect(o.x).to.be.lessThan(0),t.destroy()})),it("should support data interpolation",(async function(){const e=await a.load(s("text_interpolation.xml")),t=new a.Context(e),n=t.stage
t.render({lol:"wow"})
const o=n.children[0].children[0]
expect(o.text).to.equal("Hello world wow"),t.destroy()}))})),describe("IfNode",(function(){let e,t,n
beforeEach((async function(){e=await a.load(s("expr_if.xml")),t=new a.Context(e),n=t.stage})),afterEach((function(){t.destroy()})),it("should display child when correct value",(function(){t.render({a:"b"}),expect(n.children[0].children).to.have.length(1),t.render({a:"x"}),expect(n.children[0].children).to.have.length(0)}))})),describe("ObjectNode",(function(){it("should display children",(async function(){const e=await a.load(s("expr_object.xml")),t=new a.Context(e),n=t.stage
t.render({notes:[]}),expect(n.children[0].children).to.have.length(0),t.render({notes:[{key:"a",y:20}]}),expect(n.children[0].children).to.have.length(1),t.render({notes:[{key:"a",y:20},{key:"b",y:10}]}),expect(n.children[0].children).to.have.length(2),t.render({notes:[{key:"b",y:10}]}),expect(n.children[0].children).to.have.length(1),t.destroy()})),it("should update same array with content changed",(async function(){const e=await a.load(s("expr_object.xml")),t=new a.Context(e),n=t.stage,o=[]
t.render({notes:o}),expect(n.children[0].children).to.have.length(0),o.push({key:"a",y:20}),t.render({notes:o}),expect(n.children[0].children).to.have.length(1),t.destroy()})),it("should let children get value from item",(async function(){const e=await a.load(s("expr_object_var.xml")),t=new a.Context(e),n=t.stage
t.render({notes:[]}),t.render({notes:[{key:"a",y:20}]}),expect(n.children[0].children[0].y).to.equal(20),t.render({notes:[{key:"a",y:20},{key:"b",y:10}]}),expect(n.children[0].children[0].y).to.equal(20),t.render({notes:[{key:"b",y:10}]}),expect(n.children[0].children[0].y).to.equal(10),t.destroy()}))})),describe("GroupNode",(function(){it("should allow masking",(async function(){const e=await a.load(s("group_mask.xml")),t=new a.Context(e),n=t.stage.children[0].mask
expect(n).not.to.equal(null),t.destroy()}))})),describe("AnimationNode",(function(){it("should allow animations",(async function(){const e=await a.load(s("animation.xml")),t=new a.Context(e),n=t.stage.children[0]
t.render({t:0}),expect(n.x).to.equal(10),expect(n.y).to.equal(0),t.render({t:.5}),expect(n.x).to.equal(15),expect(n.y).to.equal(1),t.render({t:1}),expect(n.x).to.equal(20),expect(n.y).to.equal(2),t.destroy()})),it("should allow animations on different events",(async function(){const e=await a.load(s("animation.xml")),t=new a.Context(e),n=t.stage.children[0]
t.render({t:.5,exitEvent:.5}),expect(n.x).to.equal(50),expect(n.y).to.equal(0),t.render({t:1,exitEvent:.5}),expect(n.x).to.equal(60),expect(n.y).to.equal(50),t.render({t:1.5,exitEvent:.5}),expect(n.x).to.equal(70),expect(n.y).to.equal(100),t.destroy()})),it("should allow animations on different value",(async function(){const e=await a.load(s("animation_timekey.xml")),t=new a.Context(e),n=t.stage.children[0]
t.render({t:0,x:.5}),expect(n.x).to.equal(15)}))})),describe("defs",(function(){it("should allow reuse of skin nodes",(async function(){const e=await a.load(s("defs.xml")),t=new a.Context(e)
t.render({})
const n=t.stage
expect(n.children[0].x).to.equal(6),expect(n.children[0].y).to.equal(7),expect(n.children[1].x).to.equal(6),expect(n.children[1].y).to.equal(7),t.destroy()}))}))}))},27817:function(e,t,n){"use strict"
n.r(t)
var a=n(38044),s=n.n(a),o=n(83396),c=n.n(o),r=n(34277),i=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
const u=e=>s()(s().parseXML(e).documentElement)
describe("Scintillator::Animation",(function(){describe("_attrs",(function(){it("lists all attributes of an element",(function(){const e=u('<keyframe t="0" x="10" y="30" />')[0]
expect((0,r.pg)(e)).to.deep.equal({t:"0",x:"10",y:"30"})}))})),describe("_compile",(function(){it("compiles animation into keyframes",(function(){const e=u('<animation>\n        <keyframe t="0" x="10" y="30" />\n        <keyframe t="2" x="20" />\n        <keyframe t="5" x="15" y="20" />\n      </animation>')
expect((0,r.u8)(e)).to.deep.equal({on:"",data:[{name:"x",keyframes:[{time:0,value:10,ease:"linear"},{time:2,value:20,ease:"linear"},{time:5,value:15,ease:"linear"}]},{name:"y",keyframes:[{time:0,value:30,ease:"linear"},{time:5,value:20,ease:"linear"}]}]})})),it("throws when there is no time",(function(){const e=u("<animation>\n        <keyframe />\n      </animation>")
expect((()=>(0,r.u8)(e))).to.throw(Error)}))})),describe("#_properties",(function(){it("should return a set of properties",(function(){const e=r.fw.compile(null,u('<group>\n        <animation>\n          <keyframe t="0" x="10" />\n          <keyframe t="1" x="20" />\n        </animation>\n        <animation>\n          <keyframe t="0" y="10" />\n          <keyframe t="1" y="20" />\n        </animation>\n      </group>'))
expect(Array.from(e._properties)).to.deep.equal(["x","y"])}))})),describe("#prop",(function(){it("should return the function for given prop",(function(){var e=new i
const t=r.fw.compile(null,u('<group>\n        <animation>\n          <keyframe t="0" x="10" />\n          <keyframe t="1" x="20" />\n        </animation>\n      </group>'))
c()(e._expr(e._capt(14===e._capt(e._capt(t,"arguments/0/left/callee/callee/object").prop("x")(e._capt({t:.4},"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(anim.prop('x')({ t: 0.4 }) === 14)",filepath:"animation.spec.js",line:85}))})),it("should choose animation that occurs last",(function(){var e=new i,t=new i
const n=r.fw.compile(null,u('<group>\n        <animation on="event1">\n          <keyframe t="0" x="10" />\n          <keyframe t="1" x="20" />\n        </animation>\n        <animation on="event2">\n          <keyframe t="0" x="100" />\n          <keyframe t="1" x="200" />\n        </animation>\n      </group>'))
c()(e._expr(e._capt(12===e._capt(e._capt(n,"arguments/0/left/callee/callee/object").prop("x")(e._capt({event1:.2,event2:0,t:.4},"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(anim.prop('x')({event1: 0.2,event2: 0,t: 0.4}) === 12)",filepath:"animation.spec.js",line:101})),c()(t._expr(t._capt(120===t._capt(t._capt(n,"arguments/0/left/callee/callee/object").prop("x")(t._capt({event1:0,event2:.2,t:.4},"arguments/0/left/arguments/0")),"arguments/0/left"),"arguments/0"),{content:"assert(anim.prop('x')({event1: 0,event2: 0.2,t: 0.4}) === 120)",filepath:"animation.spec.js",line:102}))}))})),describe("#_events",(function(){it("list distinct events",(function(){const e=r.fw.compile(null,u('<group>\n        <animation />\n        <animation />\n        <animation on="exit" />\n        <animation on="exit" />\n      </group>'))
expect(e._events).to.deep.equal(["","exit"])}))}))}))},42485:function(e,t,n){"use strict"
n.r(t)
var a=n(37057)
describe("download",(function(){const e={getRetryDelay:()=>0}
it("resolves with correct type",(function(){return expect((0,a.Z)("/base/src/utils/test-fixtures/download/hello.txt").as("text")).to.eventually.match(/hello world/)})),it("rejects for 404",(function(){return expect((0,a.Z)("/nonexistant").as("blob")).to.be.rejected})),it("rejects for bad url",(function(){return expect((0,a.Z)("file:///nonexistant",e).as("blob")).to.be.rejected})),it("rejects for XHR error",(function(){const t=sinon.stub(XMLHttpRequest.prototype,"send").callsFake((function(){this.onerror(new Error("..."))}))
return expect((0,a.Z)("/base/spec/download/fixtures/hello.txt",e).as("blob").finally((()=>t.restore()))).to.be.rejected}))}))},13055:function(e,t,n){"use strict"
n.r(t)
var a=n(83396),s=n.n(a),o=n(36414),c=function(){function e(){this.captured=[]}return e.prototype._capt=function(e,t){return this.captured.push({value:e,espath:t}),e},e.prototype._expr=function(e,t){var n=this.captured
return this.captured=[],{powerAssertContext:{value:e,events:n},source:t}},e}()
describe("formatTime",(()=>{it("should format the time using minutes:seconds format",(()=>{var e=new c,t=new c,n=new c,a=new c,r=new c
s()(e._expr(e._capt("0:00"===e._capt((0,o.Z)(0),"arguments/0/left"),"arguments/0"),{content:"assert(formatTime(0) === '0:00')",filepath:"formatTime.spec.js",line:7})),s()(t._expr(t._capt("0:01"===t._capt((0,o.Z)(1),"arguments/0/left"),"arguments/0"),{content:"assert(formatTime(1) === '0:01')",filepath:"formatTime.spec.js",line:8})),s()(n._expr(n._capt("0:11"===n._capt((0,o.Z)(11),"arguments/0/left"),"arguments/0"),{content:"assert(formatTime(11) === '0:11')",filepath:"formatTime.spec.js",line:9})),s()(a._expr(a._capt("1:51"===a._capt((0,o.Z)(111),"arguments/0/left"),"arguments/0"),{content:"assert(formatTime(111) === '1:51')",filepath:"formatTime.spec.js",line:10})),s()(r._expr(r._capt("18:31"===r._capt((0,o.Z)(1111),"arguments/0/left"),"arguments/0"),{content:"assert(formatTime(1111) === '18:31')",filepath:"formatTime.spec.js",line:11}))}))}))},17302:function(e,t,n){"use strict"
n.r(t)
var a=n(65e3)
describe("Observable",(function(){describe("stateless mode",(function(){it("should call watchers",(function(){const e=sinon.spy(),t=sinon.spy(),n=new a.Z,s=n.watch(e)
expect(e).not.to.have.been.called,n.notify("1"),expect(e).to.have.been.calledWith("1"),n.watch(t),expect(t).not.to.have.been.called,n.notify("2"),expect(e).to.have.been.calledWith("2"),expect(t).to.have.been.calledWith("2"),s(),n.notify("3"),expect(e).not.to.have.been.calledWith("3"),expect(t).to.have.been.calledWith("3")}))})),describe("stateful mode",(function(){it("should have value",(function(){const e=new a.Z("0")
expect(e.value).to.equal("0")})),it("should call watchers",(function(){const e=sinon.spy(),t=sinon.spy(),n=new a.Z("0"),s=n.watch(e)
expect(e).to.have.been.calledWith("0"),n.value="1",expect(e).to.have.been.calledWith("1"),n.watch(t),expect(t).to.have.been.calledWith("1"),n.value="2",expect(e).to.have.been.calledWith("2"),expect(t).to.have.been.calledWith("2"),s(),n.value="3",expect(e).not.to.have.been.calledWith("3"),expect(t).to.have.been.calledWith("3")}))}))}))},90007:function(e,t,n){"use strict"
n.r(t)
var a=n(2755)
describe("readBlob",(function(){it("rejects when cannot read blob",(function(){const e=new Blob(["hello world"]),t=sinon.stub(FileReader.prototype,"readAsText").callsFake((function(){this.onerror(new Error("..."))}))
return expect((0,a.Z)(e).as("text").finally((()=>t.restore()))).to.be.rejected})),it("resolves with correct type",(function(){const e=new Blob(["hello world"])
return expect((0,a.Z)(e).as("text")).to.eventually.equal("hello world")}))}))},10843:function(e,t,n){"use strict"
e.exports=n.p+"build/assets/guitar-slice-007-bb068ac4fe378b72c62e.ogg"},10416:function(){},55150:function(){}}])

//# sourceMappingURL=test-23f2da9a9815900ce6a8.js.map