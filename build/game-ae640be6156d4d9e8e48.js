/*! For license information please see game-ae640be6156d4d9e8e48.js.LICENSE.txt */
(this.webpackJsonp=this.webpackJsonp||[]).push([[9,21],{100:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(98),i=n(46);class o{constructor(t){this.url=t}read(t){return Object(r.a)(this.url).as("arraybuffer",t)}async resolveUrl(){return Promise.resolve(this.url)}get name(){return Object(i.basename)(this.url)}}class s{constructor(t){this.base=t}async file(t){const e=t.split("/").map((t=>encodeURIComponent(t))).join("/");return new o(new URL(e,this.base).href)}}e.b=o},104:function(t,e,n){"use strict";var r=n(153);e.a=r.a},107:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.match=void 0,e.match=function(t){var e=!1;return{when:function(n,r){if(e)return this;var i=t.match(n);return i&&(e=!0,r(i)),this},else:function(t){if(e)return this;t()}}}},108:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BMSHeaders=void 0;var r=function(){function t(){this._data={},this._dataAll={}}return t.prototype.each=function(t){for(var e in this._data)t(e,this._data[e])},t.prototype.get=function(t){return this._data[t.toLowerCase()]},t.prototype.getAll=function(t){return this._dataAll[t.toLowerCase()]},t.prototype.set=function(t,e){var n=t.toLowerCase();this._data[n]=e,(this._dataAll[n]||(this._dataAll[n]=[])).push(e)},t}();e.BMSHeaders=r},109:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BMSObjects=void 0;var r=function(){function t(){this._objects=[]}return t.prototype.add=function(t){if("01"!==t.channel)for(var e=0;e<this._objects.length;e++){var n=this._objects[e];if(n.channel===t.channel&&n.measure===t.measure&&n.fraction===t.fraction)return void(this._objects[e]=t)}this._objects.push(t)},t.prototype.all=function(){return this._objects.slice()},t.prototype.allSorted=function(){var t=this.all();return t.sort((function(t,e){return t.measure+t.fraction-(e.measure+e.fraction)})),t},t}();e.BMSObjects=r},110:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TimeSignatures=void 0;var r=function(){function t(){this._values={}}return t.prototype.set=function(t,e){this._values[t]=e},t.prototype.get=function(t){return this._values[t]||1},t.prototype.getBeats=function(t){return 4*this.get(t)},t.prototype.measureToBeat=function(t,e){for(var n=0,r=0;r<t;r++)n+=this.getBeats(r);return n+this.getBeats(t)*e},t}();e.TimeSignatures=r},121:function(t,e,n){"use strict";const r=()=>{const t=new Error("Delay aborted");return t.name="AbortError",t},i=({clearTimeout:t,setTimeout:e,willResolve:n})=>(i,{value:o,signal:s}={})=>{if(s&&s.aborted)return Promise.reject(r());let a,u,c;const l=t||clearTimeout,h=()=>{l(a),c(r())},f=new Promise(((t,r)=>{u=()=>{s&&s.removeEventListener("abort",h),n?t(o):r(o)},c=r,a=(e||setTimeout)(u,i)}));return s&&s.addEventListener("abort",h,{once:!0}),f.clear=()=>{l(a),a=null,u()},f},o=t=>{const e=i({...t,willResolve:!0});return e.reject=i({...t,willResolve:!1}),e.range=(t,n,r)=>e(((t,e)=>Math.floor(Math.random()*(e-t+1)+t))(t,n),r),e},s=o();s.createWithTimers=o,t.exports=s,t.exports.default=s},1344:function(t,e,n){"use strict";n.r(e),n.d(e,"load",(function(){return C}));var r=n(608),i=n.n(r),o=n(104),s=n(84),a=n(170),u=n(486),c=n(154),l=n(27);var h=n(613),f=n(614);var p=class{constructor({game:t,samples:e,master:n}){const r=t.options.soundVolume;this._master=n,this._context=n.audioContext,this._players=new Map(t.players.map((t=>[t,new f.a({player:t,samples:e,master:n,volume:r})])))}destroy(){this._master.destroy()}unmute(){this._master.unmute()}get context(){return this._context}update(t,e){for(const[n,r]of this._players)r.update(t,e.player(n))}},d=n(283),m=n(157);var g=class{constructor(t){t.unmute(),this._context=t.context,this._offset=[],this._sum=0,this.update()}update(){const t=Object(m.a)()/1e3,e=t-this._context.currentTime;for(this._offset.push(e),this._sum+=e;this._offset.length>60;)this._sum-=this._offset.shift();this.time=t-this._sum/this._offset.length}},b=n(384),y=n(615);var v=class{constructor(t,e){this._clock=t,this._input=e,this._now=m.a.synchronized(),this._lastRecordedTimeSinceStart=0,this.startTime=null,this._pauseAtTimerValue=1/0,this._unpausedTimeSinceStart=0,this._unpausedTimerValue=0,this.readyFraction=0,this.gettingStarted=!1}get started(){return null!==this.startTime}update(){this._checkStartGame(),this.time=this._calculateTime()}_checkStartGame(){this.started||(this._input.get("start").value&&(this.gettingStarted=!0),this.gettingStarted&&!this._input.get("start").value&&(this.startTime=this._clock.time+this._getWait()),this.started||(this.readyFraction=1-this._getWait()))}_getWait(){const t=this._now()/1e3;return Math.ceil(t)-t}_calculateTime(){let t=null===this.startTime?0:this._clock.time-this.startTime;if(t<0&&(t=0),t<1)return(Math.pow(t,6)-1)/6-1/30;{const e=t-31/30;this._lastRecordedTimeSinceStart=e;const n=this._unpausedTimerValue+(e-this._unpausedTimeSinceStart);return Math.min(n,this._pauseAtTimerValue)}}pauseAt(t){this._unpausedTimerValue+(this._lastRecordedTimeSinceStart-this._unpausedTimeSinceStart)>=this._pauseAtTimerValue&&(this._unpausedTimerValue=this._pauseAtTimerValue,this._unpausedTimeSinceStart=this._lastRecordedTimeSinceStart),this._pauseAtTimerValue=t}},_=n(383);class w{constructor(){this.input=[0,0],this.last=0,this.output=0}combine(...t){for(let e=0;e<2;++e)t[e]&&this.input[e]<=0?(this.input[e]=1,this.last=e):!t[e]&&this.input[e]>0?this.input[e]=-1:this.input[e]%2!=0&&(this.input[e]+=1);return 1!==this.input[0]&&1!==this.input[1]||(this.output=0===this.last?1:-1),this.input[this.last]<=0&&(this.output=0),this.output}}var S=function(t){const e=new _.a(window,{exclusive:!0,continuous:t.players[0].options.input.continuous,sensitivity:t.players[0].options.input.sensitivity}),n=t.players[0].options.input.keyboard,r=new w,i=Object.values(n).indexOf("gamepad.0.button.8")<0,o=Object.values(n).indexOf("gamepad.0.button.9")<0;return{name:"GameKBPlugin",get(){const t=e.update(),s={p1_1:t[n[1]||"83"],p1_2:t[n[2]||"68"],p1_3:t[n[3]||"70"],p1_4:t[n[4]||"32"],p1_5:t[n[5]||"74"],p1_6:t[n[6]||"75"],p1_7:t[n[7]||"76"],p1_SC:r.combine(t[n.SC||"65"],t[n.SC2||"16"]),p1_speedup:t[38],p1_speeddown:t[40],start:t[13]||o&&t["gamepad.0.button.9"],select:t[18]||i&&t["gamepad.0.button.8"]};return(s.start||s.select)&&((s.p1_1||s.p1_3||s.p1_5||s.p1_7)&&(s.p1_speeddown=!0),(s.p1_2||s.p1_4||s.p1_6)&&(s.p1_speedup=!0)),s},destroy(){e.dispose()}}},E=n(616),x=n(182);var A=class{constructor({game:t,display:e,audio:n}){this._audioInputLatency=t.options.audioInputLatency,this._game=t,this._display=e,this._audio=n,this._clock=new g(this._audio),this._input=new b.a,this._timer=new v(this._clock,this._input),this._state=new y.a(t),this._promise=new Promise((t=>this._resolvePromise=t)),this._display.setEscapeHandler((()=>this._quitGame())),this._display.setReplayHandler((()=>this._replayGame())),this.initializeBenchmark(),this.initializeTestModeHooks()}get game(){return this._game}get display(){return this._display}get audio(){return this._audio}get promise(){return this._promise}get state(){return this._state}get latestGameTime(){return this._latestGameTime}start(){this._handleEscape(),this._display.start(),this._input.use(new S(this._game)),this._input.use(new E.a(this._display.context));let t=!1;const e=()=>{t||(this._update(),requestAnimationFrame(e))};requestAnimationFrame(e),this._endGameLoop=()=>t=!0}_handleEscape(){const t=t=>{27===t.keyCode?(t.preventDefault(),t.stopPropagation(),this._quitGame()):112===t.keyCode&&(t.preventDefault(),t.stopPropagation(),this._replayGame())};window.addEventListener("keydown",t,!0),this._promise.finally((function(){window.removeEventListener("keydown",t,!0)}))}_quitGame(){this._resolvePromise({finished:!1,replay:!1})}_replayGame(){this._resolvePromise({finished:!1,replay:!0})}destroy(){this._endGameLoop(),this._audio.destroy(),this._input.destroy(),this._display.destroy()}_update(){this._clock.update(),this._input.update(),this._timer.update();const t=this._timer.time,e=this._audioInputLatency;this._latestGameTime=t,this._state.update(t-e,this._input,this._timer),this._audio.update(t,this._state),this._display.update(t-e,this._state),this._state.finished&&this._resolvePromise&&(this._resolvePromise({finished:!0}),this._resolvePromise=null)}initializeBenchmark(){x.a.enabled&&(x.a.benchmark("update",this,"_update"),x.a.benchmark("input_update",this._input,"update"),x.a.benchmark("state_update",this._state,"update"),x.a.benchmark("audio_update",this._audio,"update"),x.a.benchmark("display_update",this._display,"update"),x.a.benchmark("display_compute",this._display,"_getData"),x.a.benchmark("display_push",this._display._context._instance,"push"),x.a.benchmark("display_render",this._display._context._renderer,"render"))}initializeTestModeHooks(){d.isTestModeEnabled()&&d.setGameLifecycleHandler({pauseAt:t=>(this._timer.pauseAt(t),new Promise((e=>{const n=setInterval((()=>{this._timer.time>=t&&(clearInterval(n),e())}))}))),unpause:()=>{this._timer.pauseAt(1/0)},getScore:()=>{const t=this._state;return t.player(t.game.players[0]).stats.score}})}},k=n(617),O=n(625);var M=function(t,e){return t.file(e).then((t=>t.read())).then((t=>new Blob([t]))).then((t=>URL.createObjectURL(t))).then((t=>new Promise(((e,n)=>{const r=new Image;r.onload=()=>e(r),r.onerror=n,r.src=t}))))},j=n(533);function C(t){const e=t.assets,r=t.bms,f=t.songId;return function(t){const e={},n={},r=[];function i(t,n,i,a){const u=new o.a;n&&r.push({text:n,progress:u}),e[t]=function(){return Promise.all(i.map(s)).then((t=>a(...t.concat([u]))))}}function s(t){return n[t]||(n[t]=e[t]())}function a(){return r.map((t=>({text:t.text,progress:t.progress.progress,progressText:t.progress.toString()})))}i.bar=function(t,e){r.push({text:t,progress:e})};const u=t(i,s),h=new c.a(a()),f=Object(l.throttle)((function(){h.value=a()}),16);for(const t of r)t.progress.watch(f);return{tasks:h,promise:u,get:s}}((function(c,l){c("Scintillator","Loading game engine",[],(function(t){return Object(s.a)(t,Promise.all([n.e(18),n.e(10)]).then(n.bind(null,904)))})),c("Skin","Loading skin",["Scintillator"],(function(e,n){return e.load(e.getSkinUrl({displayMode:t.displayMode}),n)})),c("SkinContext",null,["Scintillator","Skin"],(function(t,e){return new t.Context(e,{touchEventTarget:window})})),e.progress&&(e.progress.current&&c.bar("Loading package",e.progress.current),e.progress.all&&c.bar("Loading song packages",e.progress.all)),c("Notechart","Loading "+t.bms.name,[],(async e=>{const n=new i.a,o=await r.read(e);return n.load(o,t.bms,t.options.players[0])})),c("EyecatchImage",null,["Notechart"],(function(n){if(t.eyecatchImageUrl){const[n,r]=Object(j.a)(e,t.eyecatchImageUrl);return M(n,r)}return M(e,n.eyecatchImage)})),c("BackgroundImage",null,["Notechart"],(function(n){if(t.backImageUrl){const[n,r]=Object(j.a)(e,t.backImageUrl);return M(n,r)}return M(e,n.backgroundImage)}));const d=new o.a,m=new o.a;return c.bar("Loading audio",d),c.bar("Decoding audio",m),c("SamplingMaster",null,[],(async()=>new a.b)),c("Video",t.videoUrl?"Loading video":null,["Notechart"],(async function(n,r){if(!t.videoUrl)return Promise.resolve(null);let i=t.videoUrl;if(!i.includes("://")){const[t,n]=Object(j.a)(e,i),r=await t.file(n);i=await r.resolveUrl()}return new Promise(((e,n)=>{const o=document.createElement("video");if(!o.canPlayType("video/webm"))return e(null);function s(){o.buffered&&o.buffered.length&&o.duration&&r.report(o.buffered.end(0)-o.buffered.start(0),o.duration)}function a(){o.removeEventListener("progress",s,!0),o.removeEventListener("canplaythrough",u,!0),o.removeEventListener("error",c,!0),o.removeEventListener("abort",c,!0)}function u(){a();const n=o.duration||100;r.report(n,n),e({element:o,offset:t.videoOffset})}function c(){a(),console.warn("Cannot load video... Just skip it!"),e(null)}o.src=i,o.preload="auto",o.addEventListener("progress",s,!0),o.addEventListener("canplaythrough",u,!0),o.addEventListener("error",c,!0),o.addEventListener("abort",c,!0),o.load()}))})),c("Game",null,["Notechart"],(async e=>new h.a([e],t.options))),c("GameDisplay",null,["Game","SkinContext","Video"],(async(t,e,n)=>new k.a({game:t,context:e,backgroundImagePromise:l("BackgroundImage"),video:n}))),c("Samples",null,["SamplingMaster","Game"],(function(t,n){u.a.receiveSongId(f);return new O.a(e,t).loadFiles(n.samples,d,m)})),c("GameAudio",null,["Game","Samples","SamplingMaster"],(async(t,e,n)=>new p({game:t,samples:e,master:n}))),c("GameController",null,["Game","GameDisplay","GameAudio"],(async(t,e,n)=>new A({game:t,display:e,audio:n}))),l("GameController")}))}},1347:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));n(930);var r=n(26),i=n.n(r),o=n(23),s=n.n(o),a=n(49),u=n.n(a),c=n(168),l=n(121),h=n.n(l);n(932),n(934);class f extends s.a.Component{render(){return s.a.createElement("div",{className:"LoadingSceneProgressBar"},s.a.createElement("div",{className:"LoadingSceneProgressBarのbar",style:{width:this.props.width}}))}}f.propTypes={width:i.a.oneOfType([i.a.string,i.a.number]).isRequired};class p extends s.a.Component{constructor(){super(...arguments),this.renderItem=({text:t,progressText:e,progress:n})=>{const r=Math.round(100*n||0).toString()+"%",i=e?` (${e})`:"";return s.a.createElement("div",{key:t,className:"LoadingSceneProgressのitem"},s.a.createElement(f,{width:r}),t,s.a.createElement("span",{className:"LoadingSceneProgressのextra"},i))}}render(){return s.a.createElement("div",{className:"LoadingSceneProgress"},this.props.tasks.value.map((t=>this.renderItem(t))))}componentDidMount(){this._unsubscribe=this.props.tasks.watch((()=>this.forceUpdate()))}componentWillUnmount(){this._unsubscribe()}}p.propTypes={tasks:i.a.object};n(936);var d=n(144);class m extends s.a.Component{render(){const t=this.props.song;return s.a.createElement("div",{className:"LoadingSceneSongInfo"},s.a.createElement("div",{className:"LoadingSceneSongInfoのgenre"},t.genre),s.a.createElement("div",{className:"LoadingSceneSongInfoのtitle"},t.title),Object(d.a)()?null:t.subtitles.map((t=>s.a.createElement("div",{key:t,className:"LoadingSceneSongInfoのsubtitle"},t))),s.a.createElement("div",{className:"LoadingSceneSongInfoのartist"},t.artist),t.subartists.map((t=>s.a.createElement("div",{key:t,className:"LoadingSceneSongInfoのsubartist"},t))))}}m.propTypes={song:i.a.shape({title:i.a.string,artist:i.a.string,genre:i.a.string,subtitles:i.a.arrayOf(i.a.string),subartists:i.a.arrayOf(i.a.string),difficulty:i.a.number,level:i.a.number}).isRequired};class g extends s.a.Component{render(){return s.a.createElement(c.a,{className:"LoadingScene",ref:"scene"},s.a.createElement("div",{className:"LoadingSceneのimage",ref:"eyecatch"}),s.a.createElement("div",{className:"LoadingSceneのinfo"},s.a.createElement(m,{song:this.props.song})),s.a.createElement(p,{tasks:this.props.tasks}),s.a.createElement("div",{className:"LoadingSceneのflash"}),s.a.createElement("div",{className:"LoadingSceneのcover"}))}componentDidMount(){this.props.eyecatchImagePromise&&this.props.eyecatchImagePromise.then((t=>{u.a.findDOMNode(this.refs.eyecatch).appendChild(t)})),this.props.registerTeardownCallback((()=>(u.a.findDOMNode(this.refs.scene).classList.add("is-exiting"),h()(500))))}}g.propTypes={song:i.a.shape({title:i.a.string,artist:i.a.string,genre:i.a.string,subtitles:i.a.arrayOf(i.a.string),subartists:i.a.arrayOf(i.a.string),difficulty:i.a.number,level:i.a.number}),tasks:i.a.object,eyecatchImagePromise:i.a.object,registerTeardownCallback:i.a.func}},144:function(t,e,n){"use strict";n.d(e,"f",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return u})),n.d(e,"a",(function(){return c}));var r=n(2);function i(){return"1"===r.a.BEMUSE_SHOW_OPTIONS}function o(){return"1"===r.a.BEMUSE_BENCHMARK}function s(){return"1"===r.a.BEMUSE_NO_FULLSCREEN}function a(){return"1"===r.a.BEMUSE_SHOW_ABOUT}function u(){return"1"===r.a.BEMUSE_SHOW_MODE_SELECT}function c(){return"1"===r.a.BEMUSE_TITLE_DISPLAY}},153:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(154);class i{constructor(){this.current=void 0,this.total=void 0,this._observable=new r.a}report(t,e,n){this.current=t,this.total=e,this.extra=n,this._observable.notify()}watch(t){return t(this),this._observable.watch((()=>t(this)))}get progress(){return this.total&&void 0!==this.current&&null!==this.current?this.current/this.total:null}toString(){return void 0!==this.formatter?this.formatter(this):null!==this.progress?this.current+" / "+this.total:""}}},154:function(t,e,n){"use strict";var r=n(155);e.a=class{constructor(t){this._callbacks=new r.a,this._value=t}get value(){return this._value}set value(t){this._value=t,this.notify(t)}notify(t){this._callbacks.call(t)}watch(t){return void 0!==this._value&&t(this._value),this._callbacks.add(t)}}},155:function(t,e,n){"use strict";e.a=class{constructor(t){if(this._callbacks={},this._nextId=1,"function"==typeof t)this.add(t);else if("object"==typeof t&&t&&t.length)for(let e=0;e<t.length;e++)this.add(t[e])}call(...t){const e=this._callbacks;for(const n in e)e[n](...t)}add(t){const e=this._nextId++;return this._callbacks[e]=t,()=>delete this._callbacks[e]}}},156:function(t,e,n){"use strict";e.a=new AudioContext({latencyHint:"interactive"})},157:function(t,e,n){"use strict";(function(t){var r=n(484),i=n.n(r);const o=t.forModule("timesynchro");let s,a=0;s=window.performance&&"function"==typeof window.performance.now?()=>window.performance.now():()=>Date.now(),s.synchronize=function(t){function e(t){a=t+Date.now()-s()}i()(t,(function(t,n){t?o.error("Cannot synchronize time: "+t):(e(n),o.info("Synchronized time with global server! Offset = "+a))}),e)},s.synchronized=function(){const t=a;return()=>s()+t},e.a=s}).call(this,n(311))},166:function(t,e,n){"use strict";t.exports=function(t,e){if("string"==typeof t)return u(t);if("number"==typeof t)return a(t,e);return null},t.exports.format=a,t.exports.parse=u;var r=/\B(?=(\d{3})+(?!\d))/g,i=/(?:\.0*|(\.[^0]+)0+)$/,o={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},s=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function a(t,e){if(!Number.isFinite(t))return null;var n=Math.abs(t),s=e&&e.thousandsSeparator||"",a=e&&e.unitSeparator||"",u=e&&void 0!==e.decimalPlaces?e.decimalPlaces:2,c=Boolean(e&&e.fixedDecimals),l=e&&e.unit||"";l&&o[l.toLowerCase()]||(l=n>=o.pb?"PB":n>=o.tb?"TB":n>=o.gb?"GB":n>=o.mb?"MB":n>=o.kb?"KB":"B");var h=(t/o[l.toLowerCase()]).toFixed(u);return c||(h=h.replace(i,"$1")),s&&(h=h.split(".").map((function(t,e){return 0===e?t.replace(r,s):t})).join(".")),h+a+l}function u(t){if("number"==typeof t&&!isNaN(t))return t;if("string"!=typeof t)return null;var e,n=s.exec(t),r="b";return n?(e=parseFloat(n[1]),r=n[4].toLowerCase()):(e=parseInt(t,10),r="b"),isNaN(e)?null:Math.floor(o[r]*e)}},167:function(t,e,n){"use strict";function r(t,e,n){if(e.match(/\.(?:bms|bme|bml|bmson)/i))return void n(e);const r=(t+e).split("/");for(let t=0;t<r.length;t++)n(r.slice(t).join("/"))}n.d(e,"a",(function(){return r}))},168:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n(580);var r=n(50),i=n.n(r),o=n(23),s=n.n(o),a=n(26),u=n.n(a);class c extends s.a.Component{render(){return s.a.createElement("div",{className:i()("Scene",this.props.className),onDragEnter:this.props.onDragEnter},this.props.children)}}c.propTypes={className:u.a.string,children:u.a.node,onDragEnter:u.a.func}},170:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return f}));var r=n(156),i=n(79),o=n(176);const s=.001,a=document.createElement("audio");const u=!a.canPlayType('audio/ogg; codecs="vorbis"');class c{constructor(t,{volume:e}={}){this._master=t,this._gain=this._master.audioContext.createGain(),null!=e&&(this._gain.gain.value=e),this._gain.connect(this._master.destination)}get destination(){return this._gain}destroy(){this._gain.disconnect(),this._gain=null}}class l{constructor(t,e){this._master=t,this._buffer=e}play(t,e){return new h(this._master,this._buffer,t,e)}destroy(){this._master=null,this._buffer=null}get duration(){return this._buffer.duration}}class h{constructor(t,e,n,r={}){n=n||0,this._master=t;const i=t.audioContext,o=i.createBufferSource();o.buffer=e,o.onended=()=>this.stop();const a=i.createGain();o.connect(a);const u=r.node||r.group&&r.group.destination||t.destination;a.connect(u),this._source=o,this._gain=this.TEST_node=a;const c=n?Math.max(0,i.currentTime+n):0,l=r.start||0,h=l>0;let f=!1;if(h&&a.gain.setValueAtTime(0,0),void 0!==r.end){const t=Math.max(r.end-l,0);o.start(c,l,t+s),f=i.currentTime+n+t}else o.start(c,l);h&&(a.gain.setValueAtTime(0,i.currentTime+n),a.gain.linearRampToValueAtTime(1,i.currentTime+n+s)),!1!==f&&(a.gain.setValueAtTime(1,f),a.gain.linearRampToValueAtTime(0,f+s)),this._master._startPlaying(this)}stop(){this._source&&(this._source.stop(0),this._source.disconnect(),this._gain.disconnect(),this._source=null,this._gain=null,this._master._stoppedPlaying(this),this.onstop&&this.onstop())}bad(){this._source&&(this._source.playbackRate.value=Math.random()<.5?Math.pow(2,1/24):Math.pow(2,-1/24))}destroy(){this.stop()}}function f(t=r.a){const e=t.createGain(),n=t.createOscillator();n.frequency.value=440,n.start(t.currentTime+.1),n.stop(t.currentTime+.1),e.connect(t.destination),e.disconnect(),async function(t){return t.resume()}(t).catch((t=>{console.error("[sampling-master] Cannot resume AudioContext",t)}))}e.b=class{constructor(t){this._audioContext=t||r.a,this._samples=[],this._groups=[],this._instances=new Set,this._destination=this._audioContext.destination}unmute(){f(this._audioContext)}get audioContext(){return this._audioContext}get destination(){return this._destination}get currentTime(){return this._audioContext.currentTime}destroy(){if(!this._destroyed){this._destroyed=!0;for(const t of this._samples)t.destroy();for(const t of this._instances)t.destroy();this._samples=null,this._instances=null}}decode(t){return this._coerceToArrayBuffer(t).then((t=>this._decodeAudio(t)))}sample(t){return(()=>t.numberOfChannels?Promise.resolve(t):this.decode(t))().then((t=>{if(this._destroyed)throw new Error("SamplingMaster already destroyed!");const e=new l(this,t);return this._samples.push(e),e}))}group(t){const e=new c(this,t);return this._groups.push(e),e}_coerceToArrayBuffer(t){return t instanceof ArrayBuffer?Promise.resolve(t):Object(i.a)(t).as("arraybuffer")}_decodeAudio(t){return new Promise(((e,n)=>{if(u&&t.byteLength>4){const n=new Uint8Array(t,0,4);if(79===n[0]&&103===n[1]&&103===n[2]&&83===n[3])return e(Object(o.a)(this.audioContext,t))}this.audioContext.decodeAudioData(t,(function(t){e(t)}),(function(t){n(new Error("Unable to decode audio: "+t))}))}))}_startPlaying(t){this._instances.add(t)}_stoppedPlaying(t){this._instances.delete(t)}}},172:function(t,e,n){"use strict";var r=n(327),i=n(518);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=v,e.resolve=function(t,e){return v(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e},e.format=function(t){i.isString(t)&&(t=v(t));return t instanceof o?t.format():o.prototype.format.call(t)},e.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),h=["%","/","?",";","#"].concat(l),f=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(519);function v(t,e,n){if(t&&i.isObject(t)&&t instanceof o)return t;var r=new o;return r.parse(t,e,n),r}o.prototype.parse=function(t,e,n){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",c=t.split(a);c[0]=c[0].replace(/\\/g,"/");var v=t=c.join(a);if(v=v.trim(),!n&&1===t.split("#").length){var _=u.exec(v);if(_)return this.path=v,this.href=v,this.pathname=_[1],_[2]?(this.search=_[2],this.query=e?y.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var w=s.exec(v);if(w){var S=(w=w[0]).toLowerCase();this.protocol=S,v=v.substr(w.length)}if(n||w||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===v.substr(0,2);!E||w&&g[w]||(v=v.substr(2),this.slashes=!0)}if(!g[w]&&(E||w&&!b[w])){for(var x,A,k=-1,O=0;O<f.length;O++){-1!==(M=v.indexOf(f[O]))&&(-1===k||M<k)&&(k=M)}-1!==(A=-1===k?v.lastIndexOf("@"):v.lastIndexOf("@",k))&&(x=v.slice(0,A),v=v.slice(A+1),this.auth=decodeURIComponent(x)),k=-1;for(O=0;O<h.length;O++){var M;-1!==(M=v.indexOf(h[O]))&&(-1===k||M<k)&&(k=M)}-1===k&&(k=v.length),this.host=v.slice(0,k),v=v.slice(k),this.parseHost(),this.hostname=this.hostname||"";var j="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!j)for(var C=this.hostname.split(/\./),P=(O=0,C.length);O<P;O++){var T=C[O];if(T&&!T.match(p)){for(var I="",D=0,B=T.length;D<B;D++)T.charCodeAt(D)>127?I+="x":I+=T[D];if(!I.match(p)){var N=C.slice(0,O),L=C.slice(O+1),F=T.match(d);F&&(N.push(F[1]),L.unshift(F[2])),L.length&&(v="/"+L.join(".")+v),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),j||(this.hostname=r.toASCII(this.hostname));var U=this.port?":"+this.port:"",R=this.hostname||"";this.host=R+U,this.href+=this.host,j&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!m[S])for(O=0,P=l.length;O<P;O++){var z=l[O];if(-1!==v.indexOf(z)){var G=encodeURIComponent(z);G===z&&(G=escape(z)),v=v.split(z).join(G)}}var H=v.indexOf("#");-1!==H&&(this.hash=v.substr(H),v=v.slice(0,H));var W=v.indexOf("?");if(-1!==W?(this.search=v.substr(W),this.query=v.substr(W+1),e&&(this.query=y.parse(this.query)),v=v.slice(0,W)):e&&(this.search="",this.query={}),v&&(this.pathname=v),b[S]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var $=this.search||"";this.path=U+$}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=y.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||b[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),e+o+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+r},o.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(i.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var n=new o,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var u=Object.keys(t),c=0;c<u.length;c++){var l=u[c];"protocol"!==l&&(n[l]=t[l])}return b[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!b[t.protocol]){for(var h=Object.keys(t),f=0;f<h.length;f++){var p=h[f];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||g[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var m=n.pathname||"",y=n.search||"";n.path=m+y}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var v=n.pathname&&"/"===n.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),w=_||v||n.host&&t.pathname,S=w,E=n.pathname&&n.pathname.split("/")||[],x=(d=t.pathname&&t.pathname.split("/")||[],n.protocol&&!b[n.protocol]);if(x&&(n.hostname="",n.port=null,n.host&&(""===E[0]?E[0]=n.host:E.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),w=w&&(""===d[0]||""===E[0])),_)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,E=d;else if(d.length)E||(E=[]),E.pop(),E=E.concat(d),n.search=t.search,n.query=t.query;else if(!i.isNullOrUndefined(t.search)){if(x)n.hostname=n.host=E.shift(),(j=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=j.shift(),n.host=n.hostname=j.shift());return n.search=t.search,n.query=t.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!E.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var A=E.slice(-1)[0],k=(n.host||t.host||E.length>1)&&("."===A||".."===A)||""===A,O=0,M=E.length;M>=0;M--)"."===(A=E[M])?E.splice(M,1):".."===A?(E.splice(M,1),O++):O&&(E.splice(M,1),O--);if(!w&&!S)for(;O--;O)E.unshift("..");!w||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),k&&"/"!==E.join("/").substr(-1)&&E.push("");var j,C=""===E[0]||E[0]&&"/"===E[0].charAt(0);x&&(n.hostname=n.host=C?"":E.length?E.shift():"",(j=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=j.shift(),n.host=n.hostname=j.shift()));return(w=w||n.host&&E.length)&&!C&&E.unshift(""),E.length?n.pathname=E.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},174:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return m}));var r=n(84);class i{constructor(){this.buffer=[],this.loggingFunction=t=>{this.buffer&&this.buffer.push(t)},this.log=t=>{this.loggingFunction(t)},this.setLoggingFunction=t=>{this.loggingFunction=t,this.buffer&&(this.buffer.forEach((e=>t(e))),this.buffer=null)}}}class o{constructor(t,e,n,r){this._name=t,this._size=e,this._path=n,this._archiveRef=r}get name(){return this._name}get size(){return this._size}extract(){return this._archiveRef.extractSingleFile(this._path)}}class s{static init(t={}){return s._options={workerUrl:"../dist/worker-bundle.js",...t},s._options}static open(t,e=null){e=e||s._options||s.init()&&console.warn("Automatically initializing using options: ",s._options);return new s(t,e).open()}constructor(t,e){this._worker=new Worker(e.workerUrl),this._worker.addEventListener("message",this._workerMsg.bind(this)),this._callbacks=[],this._content={},this._processed=0,this._file=t}async open(){return await this._postMessage({type:"HELLO"},((t,e,n)=>{"READY"===n.type&&t()})),await this._postMessage({type:"OPEN",file:this._file},((t,e,n)=>{"OPENED"===n.type&&t(this)}))}hasEncryptedData(){return this._postMessage({type:"CHECK_ENCRYPTION"},((t,e,n)=>{"ENCRYPTION_STATUS"===n.type&&t(n.status)}))}usePassword(t){return this._postMessage({type:"SET_PASSPHRASE",passphrase:t},((t,e,n)=>{"PASSPHRASE_STATUS"===n.type&&t(n.status)}))}getFilesObject(){return this._processed>0?Promise.resolve().then((()=>this._content)):this._postMessage({type:"LIST_FILES"},((t,e,n)=>{if("ENTRY"===n.type){const t=n.entry,[e,r]=this._getProp(this._content,t.path);return"FILE"===t.type&&(e[r]=new o(t.fileName,t.size,t.path,this)),!0}"END"===n.type&&(this._processed=1,t(this._cloneContent(this._content)))}))}getFilesArray(){return this.getFilesObject().then((t=>this._objectToArray(t)))}extractSingleFile(t){return this._postMessage({type:"EXTRACT_SINGLE_FILE",target:t},((t,e,n)=>{if("FILE"===n.type){t(new File([n.entry.fileData],n.entry.fileName,{type:"application/octet-stream"}))}}))}extractFiles(t){return this._processed>1?Promise.resolve().then((()=>this._content)):this._postMessage({type:"EXTRACT_FILES"},((e,n,r)=>{if("ENTRY"===r.type){const[e,n]=this._getProp(this._content,r.entry.path);return"FILE"===r.entry.type&&(e[n]=new File([r.entry.fileData],r.entry.fileName,{type:"application/octet-stream"}),void 0!==t&&setTimeout(t.bind(null,{file:e[n],path:r.entry.path}))),!0}"END"===r.type&&(this._processed=2,this._worker.terminate(),e(this._cloneContent(this._content)))}))}_cloneContent(t){if(t instanceof File||t instanceof o||null===t)return t;const e={};for(const n of Object.keys(t))e[n]=this._cloneContent(t[n]);return e}_objectToArray(t,e=""){const n=[];for(const r of Object.keys(t))t[r]instanceof File||t[r]instanceof o||null===t[r]?n.push({file:t[r]||r,path:e}):n.push(...this._objectToArray(t[r],`${e}${r}/`));return n}_getProp(t,e){const n=e.split("/");""===n[n.length-1]&&n.pop();let r=t,i=null;for(const t of n)r[t]=r[t]||{},i=r,r=r[t];return[i,n[n.length-1]]}_postMessage(t,e){return this._worker.postMessage(t),new Promise(((t,n)=>{this._callbacks.push(this._msgHandler.bind(this,e,t,n))}))}_msgHandler(t,e,n,r){if("BUSY"===r.type)n("worker is busy");else{if("ERROR"!==r.type)return t(e,n,r);n(r.error)}}_workerMsg({data:t}){(0,this._callbacks[this._callbacks.length-1])(t)||this._callbacks.pop()}}var a=n(167);s.init({workerUrl:"/vendor/libarchive.js-1.3.0/dist/worker-bundle.js"});var u=n(79),c=n(104),l=n(98);const h=/\.(?:zip|rar|7z|tar(?:\.(?:gz|bz2))?)/i,f=/https?:\/\/(?:(?:www|dl)\.dropbox\.com|dl\.dropboxusercontent\.com)\/(sh?)\/([^?]*)(.*)?$/;class p{constructor(t){this._logging=new i,this.setLoggingFunction=this._logging.setLoggingFunction,this._files=Promise.resolve(t.getFiles(this._logging.log)).then((t=>async function(t,e){if(1!==t.length)return t;const n=t[0];if(!n.name.match(h))return t;return e("Archive file detected! Now unarchiving…"),async function(t){const e=[],n=await s.open(t),r=await n.extractFiles(),i=(t,n="")=>{for(const r of Object.keys(t))t[r]instanceof File?Object(a.a)(n,r,(n=>{e.push({name:n,file:t[r]})})):t[r]&&"object"==typeof t[r]&&i(t[r],n+r+"/")};return i(r),e}(n.file)}(t,this._logging.log)))}file(t){return this._files.then((function(e){for(const n of e)if(n.name.toLowerCase()===t.toLowerCase())return new d(n.file);throw new Error("unable to find "+t)}))}get fileList(){return Promise.resolve(this._files).then((t=>t.map((t=>t.name))))}}class d{constructor(t){this._file=t}read(t){return r.a(t,Object(u.a)(this._file).as("arraybuffer"))}resolveUrl(){return Promise.resolve(URL.createObjectURL(this._file))}get name(){return this._file.name}}async function m(t,e){const n=t.replace(/[?#].*/,"").split("/").pop(),r=t.match(f);r&&(t=`https://dl.dropboxusercontent.com/${r[1]}/${r[2]}`);const i=new c.a;let o=0;i.watch((()=>{Date.now()<o+5e3||(e(`Downloading: ${i}`),o=Date.now())}));return{name:n,file:await Object(l.a)(t).as("blob",i)}}},176:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(169);let i;const o=n.n(r)()(1);async function s(t,e){const r=await(i||(i=n.e(14).then(n.t.bind(null,553,7)).then((t=>t.default)).then((t=>(0,eval)(t+";stbvorbis")))),i);return o((()=>function(t,e,n){return new Promise(((r,i)=>{const o=[];let s,u=0;t.decode(n,(function(t){if(t.data&&(s=t.sampleRate,o.push(t.data),u+=t.data[0].length),t.error){const e=t.error instanceof Error?t.error:`stbvorbis.js Error: ${t.error}`;i(e)}t.eof&&r(async function(t,e,n,r){if(!n)throw new Error("stbvorbis.js Error: No length");if(!r)throw new Error("stbvorbis.js Error: No sample rate");const i=e[0].length,o=t.createBuffer(i,n,r),s=Array(o.numberOfChannels).fill(null).map(((t,e)=>new a(o.getChannelData(e))));for(const t of e)t.forEach(((t,e)=>{s[e].write(t)}));return o}(e,o,u,s))}))}))}(r,t,e)))}class a{constructor(t){this.data=t,this.offset=0}write(t){const{offset:e,data:n}=this;for(let r=0;r<t.length;r++)n[r+e]=t[r];this.offset+=t.length}}},179:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Notechart=void 0;var a=s(n(27)),u=s(n(55));i(n(292),e);var c=function(){function t(t,e){void 0===e&&(e={});var n=this,r=t.notes,i=t.timing,o=t.keysounds,s=t.songInfo,a=t.positioning,c=t.spacing,l=t.barLines,h=t.images,f=t.expertJudgmentWindow,p=t.landmineNotes,d=void 0===p?[]:p;(0,u.default)(r,'Expected "data.notes"'),(0,u.default)(i,'Expected "data.timing"'),(0,u.default)(o,'Expected "data.keysounds"'),(0,u.default)(s,'Expected "data.songInfo"'),(0,u.default)(a,'Expected "data.positioning"'),(0,u.default)(c,'Expected "data.spacing"'),(0,u.default)(l,'Expected "data.barLines"'),this.expertJudgmentWindow=f,r=this._preTransform(r,e),this._timing=i,this._positioning=a,this._spacing=c,this._keysounds=o,this._duration=0,this._notes=this._generatePlayableNotesFromBMS(r),this._landmines=this._generatePlayableNotesFromBMS(d),this._autos=this._generateAutoKeysoundEventsFromBMS(r),this._barLines=this._generateBarLineEvents(l),this._samples=this._generateKeysoundFiles(o),this._infos=new Map(this._notes.map((function(t){return[t,n._getNoteInfo(t)]}))),this._songInfo=s,this._images=h}return Object.defineProperty(t.prototype,"notes",{get:function(){return this._notes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"landmines",{get:function(){return this._landmines},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autos",{get:function(){return this._autos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"samples",{get:function(){return this._samples},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"keysounds",{get:function(){return this._keysounds.all()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barLines",{get:function(){return this._barLines},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return["SC","1","2","3","4","5","6","7"]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"songInfo",{get:function(){return this._songInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"eyecatchImage",{get:function(){return this._images&&this._images.eyecatch||"eyecatch_image.png"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this._images&&this._images.background||"back_image.png"},enumerable:!1,configurable:!0}),t.prototype.info=function(t){return this._infos.get(t)},t.prototype.beatToSeconds=function(t){return this._timing.beatToSeconds(t)},t.prototype.beatToPosition=function(t){return this._positioning.position(t)},t.prototype.measureToBeat=function(t){return(this._barLines[t]||this._barLines[this._barLines.length-1]).beat},t.prototype.secondsToBeat=function(t){return this._timing.secondsToBeat(t)},t.prototype.secondsToPosition=function(t){return this.beatToPosition(this.secondsToBeat(t))},t.prototype.bpmAtBeat=function(t){return this._timing.bpmAtBeat(t)},t.prototype.scrollSpeedAtBeat=function(t){return this._positioning.speed(t)},t.prototype.spacingAtBeat=function(t){return this._spacing.factor(t)},t.prototype.getKeyMode=function(t){var e,n,r={};try{for(var i=o(this.notes),s=i.next();!s.done;s=i.next()){r[s.value.column]=!0}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return("off"!==t||r[1]||r[7])&&("left"!==t||r[6]||r[7])&&("right"!==t||r[1]||r[2])?"7K":"5K"},t.prototype._preTransform=function(t,e){var n=a.default.chain(t),r=function(t){var e,n;try{for(var r=o(t),i=r.next();!i.done;i=r.next()){var s=i.value;if("6"===s.column||"7"===s.column)return"7K"}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return"5K"}(t);if("off"===e.scratch&&(n=n.map((function(t){return t.column&&"SC"===t.column?Object.assign({},t,{column:null}):t}))),"5K"===r){var i=["1","2","3","4","5","6","7"],s=function(t){return function(e){if(e.column){var n=i.indexOf(e.column);if(n>-1){var r=n+t;(0,u.default)(r<i.length,"Weird. Columns must not shift beyond available column");var o=i[r];return Object.assign({},e,{column:o})}}return e}};"off"===e.scratch?n=n.map(s(1)):"right"===e.scratch&&(n=n.map(s(2)))}return n.value()},t.prototype._generatePlayableNotesFromBMS=function(t){var e=this,n=1;return t.filter((function(t){return t.column})).map((function(t){var r=e._generateEvent(t.beat);return r.id=n++,r.column=t.column,r.keysound=t.keysound,r.keysoundStart=t.keysoundStart,r.keysoundEnd=t.keysoundEnd,e._updateDuration(r),void 0!==t.endBeat?(r.end=e._generateEvent(t.endBeat),e._updateDuration(r.end)):r.end=void 0,r}))},t.prototype._generateLandminesFromBMS=function(t){var e=this,n=1;return t.filter((function(t){return t.column})).map((function(t){var r=e._generateEvent(t.beat);return r.id=n++,r.column=t.column,e._updateDuration(r),r}))},t.prototype._updateDuration=function(t){t.time>this._duration&&(this._duration=t.time)},t.prototype._generateAutoKeysoundEventsFromBMS=function(t){var e=this;return t.filter((function(t){return!t.column})).map((function(t){var n=e._generateEvent(t.beat);return n.keysound=t.keysound,n.keysoundStart=t.keysoundStart,n.keysoundEnd=t.keysoundEnd,n}))},t.prototype._generateKeysoundFiles=function(t){var e,n,r,i,s=new Set;try{for(var a=o([this.notes,this.autos]),u=a.next();!u.done;u=a.next()){var c=u.value;try{for(var l=(r=void 0,o(c)),h=l.next();!h.done;h=l.next()){var f=h.value,p=t.get(f.keysound);p&&s.add(p)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return Array.from(s)},t.prototype._generateBarLineEvents=function(t){var e=this;return t.map((function(t){return e._generateEvent(t)}))},t.prototype._generateEvent=function(t){return{beat:t,time:this.beatToSeconds(t),position:this.beatToPosition(t)}},t.prototype._getNoteInfo=function(t){return{combos:t.end?2:1}},t}();e.Notechart=c,e.default=c},1792:function(t,e,n){var r=n(1793);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},1793:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,".GameShellScene {\n  margin: 20px auto;\n  background: #353433;\n  border: 1px solid #555453;\n  padding: 15px;\n  max-width: 720px;\n}\n.GameShellScene .drop-zone {\n  border: 2px dashed #555453;\n  padding: 5px;\n}\n.GameShellScene .drop-zone a.is-active {\n  font-weight: bold;\n}\n.GameShellScene .drop-zone-hint {\n  padding: 10px;\n  text-align: center;\n  color: #8b8685;\n}\n.GameShellScene form > div {\n  margin-bottom: 1em;\n}\n.GameShellScene form > div.text .label {\n  display: block;\n  color: #8b8685;\n  font-weight: bold;\n  font-size: 0.8em;\n  margin: 0;\n  margin-bottom: 0.5ex;\n}\n.GameShellScene form > div.text input {\n  font: inherit;\n  display: block;\n  width: 100%;\n  box-sizing: border-box;\n  border: 1px inset #555453;\n  background: #252423;\n  color: #bfb;\n}\n.GameShellScene form > div.text input:disabled {\n  opacity: 0.2;\n}\n.GameShellScene form > div.checkbox input {\n  margin-right: 1ex;\n}\n.GameShellScene form > div.radio > h3 {\n  display: block;\n  color: #8b8685;\n  font-weight: bold;\n  font-size: 0.8em;\n  margin: 0;\n  margin-bottom: 0.5ex;\n}\n.GameShellScene form > div.radio > label {\n  display: block;\n}\n.GameShellScene form > div.radio input {\n  margin-right: 1ex;\n}\n.GameShellScene button {\n  background: #8b8685;\n  border: 1px outset #aba6a5;\n  font: inherit;\n  font-size: 1.5em;\n  color: #e9e8e7;\n  display: block;\n  width: 100%;\n  box-sizing: border-box;\n}\n.GameShellScene a {\n  color: #fed;\n}",""])},180:function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return f}));const r=1024,i=-975,o=1024,s=3.922,a=4.555,u=960,c=60;function l(t){const e=Math.max(0,t-1);t<0&&(t=0),t>1&&(t=1);const n=s+(a-s)*t,c=r+Math.cos(n)*o,l=i-Math.sin(n)*o,h=u/(u-c);return{y:l*h+360+2048*e,projection:h}}const h=c;function f(t,e){let n,r,i=.75,o=1;for(let t=0;t<8;t++)n=(i+o)/2,r=l(n),r.y>e?o=n:i=n;if(n<.8)return null;const s=640+r.projection*-c,a=640+r.projection*c;let u=Math.floor((t-s)/(a-s)*7);return u>=-1&&u<=7?(u<0&&(u=0),u>6&&(u=6),String(u+1)):null}},182:function(t,e,n){"use strict";var r=n(157),i=n(144),o=n(23),s=n.n(o),a=n(49),u=n.n(a),c=(n(487),n(26)),l=n.n(c);class h extends s.a.Component{constructor(t){super(t),this.renderTable=()=>{const t=this.props.bench.stats;return s.a.createElement("table",null,s.a.createElement("tbody",null,Object.keys(t).map((e=>{const n=t[e];return s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement("strong",null,e)),s.a.createElement("td",{align:"right"},""+n))}))))},this.handleInteraction=t=>{t.preventDefault(),t.stopPropagation(),this.setState({show:!this.state.show})},this.state={show:!1,text:"wow"}}render(){return s.a.createElement("div",{className:"BenchmarkPanel",onClick:this.handleInteraction,onTouchStart:this.handleInteraction},this.state.show?s.a.createElement("article",null,s.a.createElement("b",null,"Benchmark Stats"),s.a.createElement("br",null),this.renderTable()):"Show Benchmark Stats")}componentDidMount(){setInterval((()=>this.forceUpdate()),1e3)}}function f(){let t=0,e=0,n=0;const i=[];let o=0,s=0;return{push:function(a){const u=Object(r.a)();for(t+=a,e+=1,n=t/e,o+=a,i.push({delta:a,time:u});i[0]&&i[0].time<u-1e3;)o-=i.shift().delta;s=o/i.length},toString:()=>p(n)+" / "+p(s)}}function p(t){return t.toFixed(2)+"ms"}h.propTypes={bench:l.a.object};e.a=window.BEMUSE_BENCHMARK=Object(i.c)()?new function(){const t={},e={enabled:!0,stats:t,wrap:(e,n)=>function(){const i=Object(r.a)();try{return n.apply(this,arguments)}finally{const n=Object(r.a)();(t[e]||(t[e]=new f(e))).push(n-i)}},benchmark(t,e,n){e[n]=this.wrap(t,e[n])},toString(){const e=[];return Object.keys(t).forEach((function(n){e.push("- "+n+": "+t[n])})),e.join("\n")}},n=document.createElement("div");return n.setAttribute("style","position:fixed;top:10px;right:10px;z-index:99999"),document.body.appendChild(n),u.a.render(s.a.createElement(h,{bench:e}),n),e}:new function(){return{enabled:!1,wrap:(t,e)=>e}}},1834:function(t,e,n){"use strict";n.r(e),n.d(e,"main",(function(){return S}));var r=n(1344),i=n(480),o=n(929),s=(n(1792),n(497)),a=n(26),u=n.n(a),c=n(23),l=n.n(c),h=n(50),f=n.n(h);class p extends l.a.Component{constructor(t){super(t),this.handleDrop=t=>{t.preventDefault();const e=t.nativeEvent,n=new s.a(e);n.fileList.then((t=>t.filter((t=>/\.(bms|bme|bml)$/i.test(t))))).map((t=>n.file(t).then((e=>({name:t,resource:e}))))).then((t=>{this.setState({files:t,resources:n})})).catch((e=>{throw"FileError"===e.constructor.name?new Error("File Error code "+t.code):e}))},this.handleItemClick=t=>()=>{this.props.onSelect(this.state.resources,t.resource)},this.handleClear=()=>{this.props.onSelect(null,null)},this.state={files:[]}}render(){const t=this.state.files;return l.a.createElement("div",{className:"drop-zone"},t.length?l.a.createElement("ul",null,t.map((t=>l.a.createElement("li",null,l.a.createElement("a",{href:"javascript://",onClick:this.handleItemClick,className:f()({"is-active":t.resource===this.props.selectedResource})},t.name)))),this.props.selectedResource?l.a.createElement("li",null,l.a.createElement("a",{href:"javascript://",onClick:this.handleClear},"Clear")):null):l.a.createElement("div",{className:"drop-zone-hint"},"Drop BMS folder here",l.a.createElement("br",null),"(only works on Google Chrome)"))}}p.propTypes={selectedResource:u.a.any,onSelect:u.a.func};class d extends l.a.Component{constructor(t){super(t),this.submit=t=>{t.preventDefault(),this.props.play(this.state.options)},this.bindOption=t=>e=>{t(this.state.options,e.target.value),this.forceUpdate()},this.handleDragOver=t=>{t.preventDefault()},this.handleDrop=t=>{t.preventDefault(),this.refs.dropzone.handleDrop(t)},this.handleSelectFile=(t,e)=>{this.setState({options:Object.assign(this.state.options,{resources:t,resource:e})}),this.forceUpdate()},this.state={options:this.props.options}}render(){const t=this.state.options;return l.a.createElement("div",{className:"GameShellScene",onDragOver:this.handleDragOver,onDrop:this.handleDrop},l.a.createElement("h1",null,"Bemuse Game Shell"),l.a.createElement("p",null,"This tool is intended for developers testing the game."),l.a.createElement("form",{onSubmit:this.submit},l.a.createElement("div",{className:"text"},l.a.createElement("label",null,l.a.createElement("span",{className:"label"},"BMS URL:"),l.a.createElement("input",{type:"text",disabled:t.resource,onChange:this.bindOption(((t,e)=>t.url=e)),value:t.url}))),l.a.createElement("div",{className:"text"},l.a.createElement("label",null,l.a.createElement("span",{className:"label"},"-or- Drop BMS folder here"),l.a.createElement(p,{ref:"dropzone",selectedResource:t.resource,onSelect:this.handleSelectFile}))),l.a.createElement("div",{className:"text"},l.a.createElement("label",null,l.a.createElement("span",{className:"label"},"Audio-Input Latency"),l.a.createElement("input",{type:"text",onChange:this.bindOption(((t,e)=>t.game.audioInputLatency=e)),value:t.game.audioInputLatency}))),l.a.createElement("div",{className:"text"},l.a.createElement("label",null,l.a.createElement("span",{className:"label"},"HI-SPEED:"),l.a.createElement("input",{type:"text",onChange:this.bindOption(((t,e)=>t.players[0].speed=e)),value:t.players[0].speed}))),l.a.createElement("div",{className:"radio"},l.a.createElement("h3",null,"Placement"),["left","center","right"].map((e=>l.a.createElement("label",null,l.a.createElement("input",{type:"radio",value:e,onChange:this.bindOption(((t,e)=>t.players[0].placement=e)),checked:t.players[0].placement===e}),l.a.createElement("span",{className:"label"},e))))),l.a.createElement("button",{type:"submit"},"Play")))}}d.propTypes={options:u.a.object,play:u.a.func};var m=n(1347),g=n(232),b=n(100),y=n(156),v=n(2),_=n(172),w=n(170);async function S(){window.addEventListener("touchstart",(function t(){Object(w.c)(y.a),window.removeEventListener("touchstart",t)}));const t=await async function(){const t=(v.a.keyboard||"").split(",").map((t=>+t));let e={url:v.a.bms||"/music/[snack]dddd/dddd_sph.bme",game:{audioInputLatency:+v.a.latency||0},players:[{speed:+v.a.speed||3,autoplay:!!v.a.autoplay,placement:"center",scratch:v.a.scratch||"left",input:{keyboard:{1:t[0]||83,2:t[1]||68,3:t[2]||70,4:t[3]||32,5:t[4]||74,6:t[5]||75,7:t[6]||76,SC:t[7]||65,SC2:t[8]||16}}}]};e=await function(t){return new Promise((function(e){const n=l.a.createElement(d,{options:t,play:function(t){e(t)}});g.a.display(n)}))}(e);const n=e.url,r=Object(_.resolveUrl)(n,"assets/");return{bms:e.resource||new b.b(n),assets:e.resources||new i.a(r),metadata:{title:"Loading",subtitles:[],artist:"",genre:"",subartists:[]},options:Object.assign({},e.game,{players:e.players})}}(),{tasks:e,promise:n}=r.load(t);await g.a.display(l.a.createElement(m.a,{tasks:e,song:t.metadata}));const s=await n;await g.a.display(new o.a(s.display)),s.start()}},232:function(t,e,n){"use strict";var r=n(99),i=n(23),o=n.n(i),s=n(49),a=n.n(s);const u=new class{constructor(){this._transitioning=!1,this._stack=[]}display(t){return this._transitionTo((()=>t))}push(t){const e=this.currentScene;return this._transitionTo((()=>(this._stack.push(e),t)))}pop(){return this._transitionTo((()=>this._stack.pop()))}async _transitionTo(t){if(this._transitioning)throw new Error("Scene is transitioning!");try{this._transitioning=!0,this.currentSceneInstance&&(await Promise.resolve(this.currentSceneInstance.teardown()),function(t){t&&t.parentNode===r.a&&r.a.removeChild(t)}(this.currentElement));let e=t();"function"!=typeof e&&(e=new c(e,this.ReactSceneContainer));const n=document.createElement("div");n.className="scene-manager--scene",r.a.appendChild(n),this.currentElement=n,this.currentScene=e,this.currentSceneInstance=e(n)}finally{this._transitioning=!1}}};function c(t,e){return function(n){let r=async()=>{};const i=o.a.cloneElement(t,{scene:t,registerTeardownCallback:t=>{r=t}}),s=e?o.a.createElement(e,null,i):i;return a.a.render(s,n),{async teardown(){try{return await r()}finally{a.a.unmountComponentAtNode(n)}}}}}e.a=u},234:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getReaderOptionsFromFilename=e.readAsync=e.read=void 0;var r=n(537);e.read=function(t){throw new Error("Synchronous read unsupported in browser!")},e.readAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],i=t[1],o=i&&i.forceEncoding||r.detect(n);return new Promise((function(t,e){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=function(){e(new Error("cannot read it"))},r.readAsText(new Blob([n]),o)}))};var i=n(235);Object.defineProperty(e,"getReaderOptionsFromFilename",{enumerable:!0,get:function(){return i.getReaderOptionsFromFilename}})},235:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getReaderOptionsFromFilename=void 0,e.getReaderOptionsFromFilename=function(t){var e;return t.match(/\.sjis\.\w+$/i)&&(e="Shift-JIS"),t.match(/\.euc_kr\.\w+$/i)&&(e="EUC-KR"),t.match(/\.utf8\.\w+$/i)&&(e="UTF-8"),{forceEncoding:e}}},236:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compile=void 0;var r=n(107),i=n(39),o={bms:{random:/^#RANDOM\s+(\d+)$/i,if:/^#IF\s+(\d+)$/i,endif:/^#ENDIF$/i,timeSignature:/^#(\d\d\d)02:(\S*)$/,channel:/^#(?:EXT\s+#)?(\d\d\d)(\S\S):(\S*)$/,header:/^#(\w+)(?:\s+(\S.*))?$/},dtx:{random:/^#RANDOM\s+(\d+)$/i,if:/^#IF\s+(\d+)$/i,endif:/^#ENDIF$/i,timeSignature:/^#(\d\d\d)02:\s*(\S*)$/,channel:/^#(?:EXT\s+#)?(\d\d\d)(\S\S):\s*(\S*)$/,header:/^#(\w+):(?:\s+(\S.*))?$/}};e.compile=function(t,e){e=e||{};var n=new i.BMSChart,s=e.rng||function(t){return 1+Math.floor(Math.random()*t)},a=e.format&&o[e.format]||o.bms,u=[],c=[!1],l={headerSentences:0,channelSentences:0,controlSentences:0,skippedSentences:0,malformedSentences:0,chart:n,warnings:[]};return function(t,e){t.split(/\r\n|\r|\n/).map((function(t){return t.trim()})).forEach((function(t,n){e(t,n+1)}))}(t,(function(t,e){var i=!0;if("#"===t.charAt(0)&&((0,r.match)(t).when(a.random,(function(t){l.controlSentences+=1,u.push(s(+t[1]))})).when(a.if,(function(t){l.controlSentences+=1,c.push(u[u.length-1]!==+t[1])})).when(a.endif,(function(t){l.controlSentences+=1,c.pop()})).else((function(){i=!1})),!i)){var o=c[c.length-1];(0,r.match)(t).when(a.timeSignature,(function(t){l.channelSentences+=1,o||n.timeSignatures.set(+t[1],+t[2])})).when(a.channel,(function(t){l.channelSentences+=1,o||function(t,e,r,i){var o=Math.floor(r.length/2);if(0===o)return;for(var s=0;s<o;s++){var a=r.substr(2*s,2),u=s/o;"00"!==a&&n.objects.add({measure:t,fraction:u,value:a,channel:e,lineNumber:i})}}(+t[1],t[2],t[3],e)})).when(a.header,(function(t){l.headerSentences+=1,o||n.headers.set(t[1],t[2])})).else((function(){!function(t,e){l.warnings.push({lineNumber:t,message:e})}(e,"Invalid command")}))}})),l}},237:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},238:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Segment=void 0;var i=r(n(178));e.Segment=(0,i.default)({t:"number",x:"number",dx:"number"})},239:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Notes=void 0;var a=n(240),u=s(n(55)),c=o(n(241)),l=n(39),h=function(){function t(t){t.forEach(a.Note),this._notes=t}return t.prototype.count=function(){return this._notes.length},t.prototype.all=function(){return this._notes.slice()},t.fromBMSChart=function(e,n){l.BMSChart;var r=(n=n||{}).mapping||t.CHANNEL_MAPPING.IIDX_P1;return new f(e,{mapping:r}).build()},t.CHANNEL_MAPPING=c,t}();e.Notes=h;var f=function(){function t(t,e){this._chart=t,(0,u.default)(e.mapping,"Expected options.mapping"),(0,u.default)("object"==typeof e.mapping,"options.mapping must be object"),this._mapping=e.mapping,this._notes=[],this._activeLN={},this._lastNote={},this._lnObj=(this._chart.headers.get("lnobj")||"").toLowerCase(),this._channelMapping=this._mapping,this._objects=this._chart.objects.allSorted()}return t.prototype.build=function(){var t=this;return this._objects.forEach((function(e){t._handle(e)})),new h(this._notes)},t.prototype._handle=function(t){if("01"===t.channel)this._handleNormalNote(t);else switch(t.channel.charAt(0).toUpperCase()){case"1":case"2":case"D":case"E":this._handleNormalNote(t);break;case"5":case"6":this._handleLongNote(t)}},t.prototype._handleNormalNote=function(t){var e=this._normalizeChannel(t.channel),n=this._getBeat(t);if(t.value.toLowerCase()===this._lnObj)this._lastNote[e]&&(this._lastNote[e].endBeat=n);else{var r={beat:n,endBeat:void 0,keysound:t.value,column:this._getColumn(e)};this._lastNote[e]=r,this._notes.push(r)}},t.prototype._handleLongNote=function(t){var e=this._normalizeChannel(t.channel),n=this._getBeat(t);if(this._activeLN[e]){var r=this._activeLN[e];r.endBeat=n,this._notes.push(r),delete this._activeLN[e]}else this._activeLN[e]={beat:n,keysound:t.value,column:this._getColumn(e)}},t.prototype._getBeat=function(t){return this._chart.measureToBeat(t.measure,t.fraction)},t.prototype._getColumn=function(t){return this._channelMapping[t]},t.prototype._normalizeChannel=function(t){return t.replace(/^5/,"1").replace(/^6/,"2")},t}()},240:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Note=void 0;var i=r(n(178));e.Note=(0,i.default)({beat:"number",endBeat:i.default.maybe("number"),column:i.default.maybe("string"),keysound:"string"})},241:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IIDX_DP_LANDMINE=e.IIDX_P1_LANDMINE=e.IIDX_DP=e.IIDX_P1=void 0,e.IIDX_P1={11:"1",12:"2",13:"3",14:"4",15:"5",18:"6",19:"7",16:"SC"},e.IIDX_DP={11:"1",12:"2",13:"3",14:"4",15:"5",18:"6",19:"7",16:"SC",21:"8",22:"9",23:"10",24:"11",25:"12",28:"13",29:"14",26:"SC2"},e.IIDX_P1_LANDMINE={D1:"1",D2:"2",D3:"3",D4:"4",D5:"5",D8:"6",D9:"7",D6:"SC"},e.IIDX_DP_LANDMINE={D1:"1",D2:"2",D3:"3",D4:"4",D5:"5",D8:"6",D9:"7",D6:"SC",E1:"8",E2:"9",E3:"10",E4:"11",E5:"12",E8:"13",E9:"14",E6:"SC2"}},242:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Timing=void 0;var r=n(60),i=n(80),o=n(39),s={bpm:1,stop:2},a=function(){function t(t,e){var n={bpm:t,beat:0,seconds:0},o=[];o.push({t:0,x:0,dx:n.bpm/60,bpm:n.bpm,inclusive:!0}),(e=e.slice()).sort((function(t,e){return t.beat-e.beat||s[t.type]-s[e.type]})),e.forEach((function(t){var e=t.beat,r=n.seconds+60*(e-n.beat)/n.bpm;switch(t.type){case"bpm":n.bpm=t.bpm,o.push({t:r,x:e,dx:n.bpm/60,bpm:n.bpm,inclusive:!0});break;case"stop":o.push({t:r,x:e,dx:0,bpm:n.bpm,inclusive:!0}),r+=60*(t.stopBeats||0)/n.bpm,o.push({t:r,x:e,dx:n.bpm/60,bpm:n.bpm,inclusive:!1});break;default:throw new Error("Unrecognized segment object!")}n.beat=e,n.seconds=r})),this._speedcore=new r.Speedcore(o),this._eventBeats=(0,i.uniq)((0,i.map)(e,(function(t){return t.beat})))}return t.prototype.beatToSeconds=function(t){return this._speedcore.t(t)},t.prototype.secondsToBeat=function(t){return this._speedcore.x(t)},t.prototype.bpmAtBeat=function(t){return this._speedcore.segmentAtX(t).bpm},t.prototype.getEventBeats=function(){return this._eventBeats},t.fromBMSChart=function(e){o.BMSChart;var n=[];return e.objects.all().forEach((function(t){var r,i=e.measureToBeat(t.measure,t.fraction);if("03"===t.channel)r=parseInt(t.value,16),n.push({type:"bpm",beat:i,bpm:r});else if("08"===t.channel)r=+e.headers.get("bpm"+t.value),isNaN(r)||n.push({type:"bpm",beat:i,bpm:r});else if("09"===t.channel){var o=+e.headers.get("stop"+t.value)/48;n.push({type:"stop",beat:i,stopBeats:o})}})),new t(+e.headers.get("bpm")||60,n)},t}();e.Timing=a},243:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SongInfo=void 0;var r=n(107),i=n(80),o=n(39),s=function(){function t(t){this.title="NO TITLE",this.artist="NO ARTIST",this.genre="NO GENRE",this.subtitles=[],this.subartists=[],this.difficulty=0,this.level=0,t&&(0,i.assign)(this,t)}return t.fromBMSChart=function(e){o.BMSChart;var n={},i=e.headers.get("title"),s=e.headers.get("artist"),a=e.headers.get("genre"),u=+e.headers.get("difficulty")||0,c=+e.headers.get("playlevel")||0,l=e.headers.getAll("subtitle"),h=e.headers.getAll("subartist");if("string"==typeof i&&!l){var f=function(t){i=t[1],l=[t[2]]};(0,r.match)(i).when(/^(.*\S)\s*-(.+?)-$/,f).when(/^(.*\S)\s*～(.+?)～$/,f).when(/^(.*\S)\s*\((.+?)\)$/,f).when(/^(.*\S)\s*\[(.+?)\]$/,f).when(/^(.*\S)\s*<(.+?)>$/,f)}return i&&(n.title=i),s&&(n.artist=s),a&&(n.genre=a),l&&(n.subtitles=l),h&&(n.subartists=h),u&&(n.difficulty=u),c&&(n.level=c),new t(n)},t}();e.SongInfo=s},244:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Keysounds=void 0;var r=n(80),i=n(39),o=function(){function t(t){this._map=t}return t.prototype.get=function(t){return this._map[t.toLowerCase()]},t.prototype.files=function(){return(0,r.uniq)((0,r.values)(this._map))},t.prototype.all=function(){return this._map},t.fromBMSChart=function(e){i.BMSChart;var n={};return e.headers.each((function(t,e){var r=t.match(/^wav(\S\S)$/i);r&&(n[r[1].toLowerCase()]=e)})),new t(n)},t}();e.Keysounds=o},245:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Positioning=void 0;var r=n(60),i=n(39),o=function(){function t(t){this._speedcore=new r.Speedcore(t)}return t.prototype.speed=function(t){return this._speedcore.dx(t)},t.prototype.position=function(t){return this._speedcore.x(t)},t.fromBMSChart=function(e){i.BMSChart;var n=[],r=0;return n.push({t:0,x:r,dx:1,inclusive:!0}),e.objects.allSorted().forEach((function(t){if("SC"===t.channel){var i=e.measureToBeat(t.measure,t.fraction),o=+e.headers.get("scroll"+t.value);if(isNaN(o))return;var s=n[n.length-1];r+=(i-s.t)*s.dx,0===i&&1===n.length?n[0].dx=o:n.push({t:i,x:r,dx:o,inclusive:!0})}})),new t(n)},t}();e.Positioning=o},246:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Spacing=void 0;var r=n(60),i=n(39),o=function(){function t(t){t.length>0&&(this._speedcore=new r.Speedcore(t))}return t.prototype.factor=function(t){return this._speedcore?this._speedcore.x(t):1},t.fromBMSChart=function(e){i.BMSChart;var n=[];return e.objects.allSorted().forEach((function(t){if("SP"===t.channel){var r=e.measureToBeat(t.measure,t.fraction),i=+e.headers.get("speed"+t.value);if(isNaN(i))return;if(n.length>0){var o=n[n.length-1];o.dx=(i-o.x)/(r-o.t)}n.push({t:r,x:i,dx:0,inclusive:!0})}})),n.length>0&&n.unshift({t:0,x:n[0].x,dx:0,inclusive:!0}),new t(n)},t}();e.Spacing=o},283:function(t,e,n){"use strict";n.r(e),n.d(e,"enableTestMode",(function(){return o})),n.d(e,"setGameLifecycleHandler",(function(){return s})),n.d(e,"isTestModeEnabled",(function(){return a})),n.d(e,"pauseAt",(function(){return u})),n.d(e,"unpause",(function(){return c})),n.d(e,"getScore",(function(){return l}));let r=!1,i={pauseAt(t){throw new Error("Cannot pause: No lifecycle handler registered!")},unpause(){throw new Error("Cannot unpause: No lifecycle handler registered!")},getScore(){throw new Error("Cannot get score: No lifecycle handler registered!")}};function o(){if(!r){r=!0,console.log("[Bemuse test mode enabled]");const t=document.createElement("div");t.setAttribute("style","\n        position: fixed;\n        top: 20px;\n        left: 20px;\n        font: 20px Comic Sans MS, sans-serif;\n        z-index: 99999;\n        background: rgba(0,0,0,0.5);\n        color: #0f0;\n        border: 2px solid #0f0;\n        padding: 4px;\n        pointer-events: none;\n      "),t.innerHTML="\n      <strong>Test mode:</strong>\n      Bemuse is being controlled by automated test software.\n    ",document.body.appendChild(t)}}function s(t){console.log("[Bemuse test mode] A pause handler has been registered."),i=t}function a(){return!!r}function u(t){return i.pauseAt(t)}function c(){return i.unpause()}function l(){return i.getScore()}},289:function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},290:function(t,e){(function(e){t.exports=e}).call(this,{})},291:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.fromBMSChart=void 0;var a=o(n(85)),u=s(n(27)),c=s(n(179));function l(t){var e=+t.headers.get("rank")||2;return 0===e?[8,24]:1===e?[15,30]:3===e?[21,60]:[18,40]}function h(t,e){var n=u.default.max(t.map((function(t){return t.endBeat||t.beat})))||0,r=[0],i=0,o=0;do{i+=e.timeSignatures.getBeats(o),o+=1,r.push(i)}while(i<=n);return r}e.fromBMSChart=function(t,e){var n=a.Notes.fromBMSChart(t,{mapping:e.double?a.Notes.CHANNEL_MAPPING.IIDX_DP:a.Notes.CHANNEL_MAPPING.IIDX_P1}).all(),r={notes:n,landmineNotes:a.Notes.fromBMSChart(t,{mapping:e.double?a.Notes.CHANNEL_MAPPING.IIDX_DP_LANDMINE:a.Notes.CHANNEL_MAPPING.IIDX_P1_LANDMINE}).all(),timing:a.Timing.fromBMSChart(t),keysounds:a.Keysounds.fromBMSChart(t),songInfo:a.SongInfo.fromBMSChart(t),positioning:a.Positioning.fromBMSChart(t),spacing:a.Spacing.fromBMSChart(t),barLines:h(n,t),expertJudgmentWindow:l(t)};return new c.default(r,e)}},292:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},311:function(t,e,n){"use strict";function r(t){return{info:i(t,"info"),warn:i(t,"warn"),error:i(t,"error")}}function i(t,e){return(...r)=>{console.log(`[${(new Date).toJSON()}] [${t}] [${e}] ${n(123).format(...r)}`)}}n.r(e),n.d(e,"forModule",(function(){return r}))},320:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},a=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e._slicesForNotesAndTiming=e.beatForLoc=e.timingInfoForBmson=e.barLinesForBmson=void 0;var c=u(n(27)),l=o(n(321));function h(t){return t/240}e.barLinesForBmson=function(t){var e=t.lines;return(0,c.default)(e).map((function(t){return h(t.y)})).sortBy().value()},e.timingInfoForBmson=function(t){return{initialBPM:t.info.initBPM,actions:a(a([],s((t.bpmNotes||[]).map((function(t){var e=t.y,n=t.v;return{type:"bpm",beat:h(e),bpm:n}}))),!1),s((t.stopNotes||[]).map((function(t){var e=t.y,n=t.v;return{type:"stop",beat:h(e),stopBeats:h(Math.floor(n))}}))),!1)}},e.beatForLoc=h,e._slicesForNotesAndTiming=function(t,e){return l.slicesForNotesAndTiming(t,e,{beatForPulse:h})}},321:function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},o=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.slicesForNotesAndTiming=void 0;var a=s(n(27));e.slicesForNotesAndTiming=function(t,e,n){var s,u,c,l,h=n.beatForPulse,f=new Set,p=new Set,d=new Set;try{for(var m=r(t),g=m.next();!g.done;g=m.next()){var b=g.value,y=b.x,v=b.y,_=b.c;f.add(v),y&&p.add(v),_||d.add(v)}}catch(t){s={error:t}}finally{try{g&&!g.done&&(u=m.return)&&u.call(m)}finally{if(s)throw s.error}}var w,S,E=new Map,x=null,A=!0;try{for(var k=r(a.default.sortBy(o([],i(f),!1))),O=k.next();!O.done;O=k.next()){v=O.value;var M=e.beatToSeconds(h(v));if(null===x||d.has(v)?x=0:x+=M-w,A||p.has(v)||d.has(v)){S&&!d.has(v)&&(S.keysoundEnd=x);var j={keysoundStart:x,keysoundEnd:void 0};E.set(v,j),S=j}A=p.has(v),w=M}}catch(t){c={error:t}}finally{try{O&&!O.done&&(l=k.return)&&l.call(k)}finally{if(c)throw c.error}}return E}},322:function(t,e,n){"use strict";e.a=class{constructor(t,e,n){this.notechart=t,this.number=e,this.options={autoplayEnabled:!!n.autoplayEnabled,autosound:!!n.autosound,speed:+n.speed,placement:n.placement||"center",scratch:n.scratch||"left",input:n.input,laneCover:+(n.laneCover||0),gauge:n.gauge,tutorial:!!n.tutorial}}get columns(){return this.notechart.columns}}},323:function(t,e,n){"use strict";var r=n(67),i=n(27),o=n.n(i);const s=t=>Math.floor(5e5*t),a=(t,e)=>Math.floor(55555*t/e);e.a=class{constructor(t){this.totalCombo=o()(t.notes).map((e=>t.info(e).combos)).sum(),this.totalNotes=t.notes.length,this.combo=0,this.maxCombo=0,this.rawSumJudgmentWeight=0,this.rawTotalComboScore=this._calculateRawTotalComboScore(this.totalCombo),this._remainingMaxPossibleRawComboScore=this.rawTotalComboScore,this.rawSumComboScore=0,this.counts={[r.b]:0,1:0,2:0,3:0,4:0},this.numJudgments=0,this.poor=!1,this._log=[],this.deltas=[]}get score(){return this.accuracyScore+this.comboScore}get accuracyScore(){return s(this.accuracy)}get comboScore(){return a(this.rawSumComboScore,this.rawTotalComboScore)}get maxPossibleScore(){return this.maxPossibleAccuracyScore+this.maxPossibleComboScore}get maxPossibleAccuracyScore(){const t=this.totalCombo-this.numJudgments,e=(this.rawSumJudgmentWeight+r.i(1)*t)/(r.i(1)*this.totalCombo);return s(e)}get maxPossibleComboScore(){const t=this.rawSumComboScore+this._remainingMaxPossibleRawComboScore;return a(t,this.rawTotalComboScore)}get accuracy(){return this.rawSumJudgmentWeight/(r.i(1)*this.totalCombo)}get currentAccuracy(){return this.rawSumJudgmentWeight/(r.i(1)*this.numJudgments||1)}get log(){return this._log.map((({character:t,count:e})=>`${e>1?e:""}${t}`)).join("")}handleJudgment(t){if(this.counts[t]+=1,this.numJudgments+=1,r.c(t)){const t=this.totalCombo-this.numJudgments;this.combo=0,this.poor=!0,this._remainingMaxPossibleRawComboScore=this._calculateRawTotalComboScore(t)}else{this.combo+=1;const t=this._calculateRawComboScore(this.combo);this.rawSumComboScore+=t,this._remainingMaxPossibleRawComboScore-=t,this.poor=!1}this.rawSumJudgmentWeight+=r.i(t),this.combo>this.maxCombo&&(this.maxCombo=this.combo),this._recordLog(t)}handleDelta(t){this.deltas.push(t)}_calculateRawTotalComboScore(t){let e=0;for(let n=1;n<=t;n++)e+=this._calculateRawComboScore(n);return e}_calculateRawComboScore(t){return 0===t?0:t<23?1:t<51?2:t<92?3:t<161?4:5}_recordLog(t){const e=this._getLogCharacter(t);e&&(0===this._log.length||this._log[this._log.length-1].character!==e?this._log.push({character:e,count:1}):this._log[this._log.length-1].count+=1)}_getLogCharacter(t){switch(t){case 1:return"A";case 2:return"B";case 3:return"C";case 4:return"D";case r.b:return"M"}}}},324:function(t,e,n){"use strict";var r=n(27),i=n.n(r);function o(t,e,n){return 1-(n-t)/(e-t)}function s(t){return t.position}e.a=class{constructor(t,e){this._notes=i.a.sortBy(t,s),this._barLines=i()(e).map("position").sortBy().value()}getVisibleNotes(t,e,n){const r=[],i=this._notes;n||(n=0);for(let s=0;s<i.length;s++){const a=i[s];if(a.end?!(a.position>e||a.end.position<t-n):!(a.position>e||a.position<t-n)){const n={note:a};if(a.end){const r=o(t,e,a.position),i=o(t,e,a.end.position);n.y=Math.min(r,i),n.height=Math.abs(r-i)}else n.y=o(t,e,a.position);r.push(n)}}return r}getVisibleBarLines(t,e,n){return n||(n=0),this._barLines.filter((r=>t-n<=r&&r<=e)).map((n=>({id:n,y:o(t,e,n)})))}}},325:function(t,e,n){"use strict";function r(t){return"hope"===t?function(){let t,e,n;return{update(r){const i=r.stats,o=i.numJudgments/i.totalCombo,s=(t,e,n)=>{const r=e+(n-e)*o,s=i.maxPossibleScore;return Math.max(0,(s-t)/(r-t))},a=.5*s(5e5,555555,51e4);if(t=Math.min(1,a),n=Math.max(0,Math.min(1,a-1)),a>0)e=0;else{const t=s(45e4,5e5,5e5);e=t}},shouldDisplay:()=>t>0||e>0,getPrimary:()=>t,getSecondary:()=>e,getExtra:()=>n}}():{update(){},shouldDisplay:()=>!1,getPrimary:()=>0,getSecondary:()=>0,getExtra:()=>0}}n.d(e,"a",(function(){return r}))},326:function(t,e,n){"use strict";e.a=function(t){const e=Math.floor(t%60);return Math.floor(t/60)+":"+(e<10?"0":"")+e}},327:function(t,e,n){(function(t,r){var i;!function(o){e&&e.nodeType,t&&t.nodeType;var s="object"==typeof r&&r;s.global!==s&&s.window!==s&&s.self;var a,u=2147483647,c=36,l=/^xn--/,h=/[^\x20-\x7E]/,f=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,m=String.fromCharCode;function g(t){throw new RangeError(p[t])}function b(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function y(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+b((t=t.replace(f,".")).split("."),e).join(".")}function v(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function _(t){return b(t,(function(t){var e="";return t>65535&&(e+=m((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=m(t)})).join("")}function w(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function S(t,e,n){var r=0;for(t=n?d(t/700):t>>1,t+=d(t/e);t>455;r+=c)t=d(t/35);return d(r+36*t/(t+38))}function E(t){var e,n,r,i,o,s,a,l,h,f,p,m=[],b=t.length,y=0,v=128,w=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&g("not-basic"),m.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<b;){for(o=y,s=1,a=c;i>=b&&g("invalid-input"),((l=(p=t.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:c)>=c||l>d((u-y)/s))&&g("overflow"),y+=l*s,!(l<(h=a<=w?1:a>=w+26?26:a-w));a+=c)s>d(u/(f=c-h))&&g("overflow"),s*=f;w=S(y-o,e=m.length+1,0==o),d(y/e)>u-v&&g("overflow"),v+=d(y/e),y%=e,m.splice(y++,0,v)}return _(m)}function x(t){var e,n,r,i,o,s,a,l,h,f,p,b,y,_,E,x=[];for(b=(t=v(t)).length,e=128,n=0,o=72,s=0;s<b;++s)(p=t[s])<128&&x.push(m(p));for(r=i=x.length,i&&x.push("-");r<b;){for(a=u,s=0;s<b;++s)(p=t[s])>=e&&p<a&&(a=p);for(a-e>d((u-n)/(y=r+1))&&g("overflow"),n+=(a-e)*y,e=a,s=0;s<b;++s)if((p=t[s])<e&&++n>u&&g("overflow"),p==e){for(l=n,h=c;!(l<(f=h<=o?1:h>=o+26?26:h-o));h+=c)E=l-f,_=c-f,x.push(m(w(f+E%_,0))),l=d(E/_);x.push(m(w(l,0))),o=S(n,y,r==i),n=0,++r}++n,++e}return x.join("")}a={version:"1.4.1",ucs2:{decode:v,encode:_},decode:E,encode:x,toASCII:function(t){return y(t,(function(t){return h.test(t)?"xn--"+x(t):t}))},toUnicode:function(t){return y(t,(function(t){return l.test(t)?E(t.slice(4).toLowerCase()):t}))}},void 0===(i=function(){return a}.call(e,n,e,t))||(t.exports=i)}()}).call(this,n(89)(t),n(29))},383:function(t,e,n){"use strict";n.d(e,"a",(function(){return p})),n.d(e,"e",(function(){return d})),n.d(e,"b",(function(){return m})),n.d(e,"d",(function(){return b}));var r=n(490),i=n.n(r),o=n(27),s=n.n(o),a=n(72),u=n.n(a);function c(t){return u.a.fromBinder((e=>{for(const n of t.inputs.values())e(new u.a.Next(n));for(const n of t.outputs.values())e(new u.a.Next(n));t.onstatechange=t=>{e(new u.a.Next(t.port))}}))}function l(t){return"input"!==t.type?u.a.never():u.a.fromEvent(t,"midimessage")}var h=function(){return u.a.fromPromise(navigator.requestMIDIAccess?navigator.requestMIDIAccess():Promise.reject(new Error("MIDI is not supported"))).flatMap(c).flatMapError((t=>(console.warn("MIDI Error:",t.stack),u.a.never()))).flatMap(l).doLog("messageforport")};class f{constructor(){this.stop=1,this.charge=0,this.previous=!1,this.active=!1,this.positive=!1}update(t,e=3){if(!1===this.previous)return this.previous=t,0;if(this.previous!==t){let n=t-this.previous;n>1?n-=2.005:n<-1&&(n+=2.005);const r=n>0;this.active&&this.positive!==r?(this.positive=r,this.active=!1,this.charge=0):this.active||((0===this.charge||this.stop<=e)&&(this.charge+=Math.ceil(Math.abs(n)/.01)),this.charge>=2&&(this.active=!0,this.positive=r)),this.stop=0,this.previous=t}return this.stop>2*e&&(this.active=!1,this.charge=0,this.stop=0),this.stop+=1,this.active?this.positive?1:-1:0}}class p{constructor(t=window,e={}){const n=(e.getMidi川||h)();this._window=t,this._exclusive=!!e.exclusive,this._continuousAxis=!!e.continuous,this.setGamepadSensitivity(e.sensitivity||3),this._disposables=[y(t,"keydown",(t=>this._handleKeyDown(t))),y(t,"keyup",(t=>this._handleKeyUp(t))),n.onValue((t=>this._handleMIDIMessage(t)))],this._status={},this._axis={}}_handleKeyDown(t){this._status[`${t.which}`]=!0,this._exclusive&&t.preventDefault()}_handleKeyUp(t){this._status[`${t.which}`]=!1}_handleMIDIMessage(t){if(!t||!t.data)return;const e=t.data,n=`midi.${t.target.id}.${15&t.data[0]}`,r=t=>{this._status[`${n}.note.${e[1]}`]=t};if(128==(240&e[0]))r(!1);else if(144==(240&e[0]))e[2]>0?r(!0):r(!1);else if(176==(240&e[0]))64===e[1]?this._status[`${n}.sustain`]=e[2]>=64:1===e[1]&&(this._status[`${n}.mod`]=e[2]>=16);else if(224==(240&e[0])){const t=e[1]|e[2]<<7;this._status[`${n}.pitch.up`]=t>=8448,this._status[`${n}.pitch.down`]=t<7936}}_updateGamepads(){const t=this._window.navigator,e=t.getGamepads?t.getGamepads():t.webkitGetGamepads?t.webkitGetGamepads():[];if(e)for(let t=0;t<e.length;t++){const n=e[t];n&&this._updateGamepad(n)}}_updateGamepad(t){const e=`gamepad.${t.index}`;for(let n=0;n<t.buttons.length;n++){const r=t.buttons[n];this._status[`${e}.button.${n}`]=r&&r.value>=.5}for(let n=0;n<t.axes.length;n++){const r=`${e}.axis.${n}`;let i=t.axes[n];this._continuousAxis&&(null==this._axis[r]&&(this._axis[r]=new f),i=this._axis[r].update(i)),this._status[`${r}.positive`]=i>=this._deadzone,this._status[`${r}.negative`]=i<=-this._deadzone}}update(){return this._updateGamepads(),this._status}setGamepadSensitivity(t){this._sensitivity=t,this._deadzone=.05*(9-this._sensitivity),this._deadzone<.01&&(this._deadzone=.01),this._analogThreshold=18-2*this._sensitivity}setGamepadContinuousAxisEnabled(t){this._continuousAxis=t}dispose(){for(const t of this._disposables)t()}}function d(t=new p,e=window){return m(u.a.fromBinder((n=>{const r=e.setInterval((()=>{n(new u.a.Next(t.update()))}),16);return()=>e.clearInterval(r)})))}function m(t){return t.map((t=>Object.keys(t).filter((e=>t[e])))).diff([],((t,e)=>s.a.difference(e,t))).flatMap((t=>u.a.fromArray(t)))}e.c=p;const g={};function b(t){if(+t)return s.a.capitalize(i()(+t));{const e=t.match(/^gamepad\.(\d+)\.axis\.(\d+)\.(\w+)/);if(e)return`Joy${e[1]} Axis${e[2]} (${"positive"===e[3]?"+":"-"})`}{const e=t.match(/^gamepad\.(\d+)\.button\.(\d+)/);if(e)return`Joy${e[1]} Btn${e[2]}`}{const e=t.match(/^midi\.(.+)\.(\d+)\.(.+)$/);if(e){const t=e[3].split("."),n=e[1],r=`MIDI${g[n]||(g[n]=Object.keys(g).length+1)} Ch${+e[2]+1}`;if("note"===t[0]){const e=+t[1];return`${r} ${["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][e%12]}${Math.floor(e/12)-1}`}if("pitch"===t[0])return`${r} Pitch${"up"===t[1]?"+":"-"}`;if("sustain"===t[0])return"Sustain";if("mod"===t[0])return"Mod"}}return`${String(t).replace(/\./g," ")}?`}function y(t,e,n){return t.addEventListener(e,n),function(){t.removeEventListener(e,n)}}},384:function(t,e,n){"use strict";var r=class{constructor(){this.value=0,this.changed=!1}get justPressed(){return this.changed&&this.value}},i=n(27),o=n.n(i),s=n(182);e.a=class{constructor(){this._controls=new Map,this._plugins=[]}update(){const t=new Map;for(const[t,e]of this._controls)e.changed=!1;for(const e of this._plugins)for(const[n,r]of e.get())t.set(n,r);for(const[e,n]of t){const t=this.get(e);t.value!==n&&(t.changed=!0,t.value=n)}}destroy(){for(const t of this._plugins)t.destroy()}get(t){return this._controls.has(t)||this._controls.set(t,new r),this._controls.get(t)}use(t){const e={},n="input:"+t.name;this._plugins.push({get:s.a.wrap(n,(function(){const n=t.get(),r=[];for(const t of o.a.union(o.a.keys(n),o.a.keys(e))){const i=+e[t]||0,o=+n[t]||0;i!==o&&r.push([t,o]),e[t]=o}return r})),destroy:()=>"function"!=typeof t.destroy||t.destroy()})}}},39:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BMSChart=void 0;var r=n(108),i=n(109),o=n(110),s=function(){function t(){this.headers=new r.BMSHeaders,this.objects=new i.BMSObjects,this.timeSignatures=new o.TimeSignatures}return t.prototype.measureToBeat=function(t,e){return this.timeSignatures.measureToBeat(t,e)},t}();e.BMSChart=s},46:function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(e=s+"/"+e,i="/"===s.charAt(0))}return(i?"/":"")+(e=n(r(e.split("/"),(function(t){return!!t})),!i).join("/"))||"."},e.normalize=function(t){var o=e.isAbsolute(t),s="/"===i(t,-1);return(t=n(r(t.split("/"),(function(t){return!!t})),!o).join("/"))||o||(t="."),t&&s&&(t+="/"),(o?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),o=r(n.split("/")),s=Math.min(i.length,o.length),a=s,u=0;u<s;u++)if(i[u]!==o[u]){a=u;break}var c=[];for(u=a;u<i.length;u++)c.push("..");return(c=c.concat(o.slice(a))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,i=!0,o=t.length-1;o>=1;--o)if(47===(e=t.charCodeAt(o))){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=function(t){"string"!=typeof t&&(t+="");var e,n=0,r=-1,i=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!i){n=e+1;break}}else-1===r&&(i=!1,r=e+1);return-1===r?"":t.slice(n,r)}(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,r=-1,i=!0,o=0,s=t.length-1;s>=0;--s){var a=t.charCodeAt(s);if(47!==a)-1===r&&(i=!1,r=s+1),46===a?-1===e?e=s:1!==o&&(o=1):-1!==e&&(o=-1);else if(!i){n=s+1;break}}return-1===e||-1===r||0===o||1===o&&e===r-1&&e===n+1?"":t.slice(e,r)};var i="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(33))},480:function(t,e,n){"use strict";var r=n(104),i=n(84),o=n(79),s=n(27),a=n.n(s),u=n(169),c=n.n(u),l=n(100);class h{constructor(t,e,n){this.resources=t,this.ref=e,this.name=n}read(t){return i.a(t,this.resources.getBlob(this.ref).then((t=>Object(o.a)(t).as("arraybuffer"))))}async resolveUrl(){const t=await this.resources.getBlob(this.ref);return URL.createObjectURL(t)}}class f{constructor(t,e){this.resources=t,this._basePromise=t.base.file(e.path)}load(){return this._promise||(this._promise=this.resources.loadPayload(this._basePromise))}}async function p(t){if("BEMUSEPACK"!==await Object(o.a)(t.slice(0,10)).as("text"))throw new Error("Invalid magic number");const e=await Object(o.a)(t.slice(10,14)).as("arraybuffer"),n=new Uint8Array(e),r=n[0]+(n[1]<<8)+(n[2]<<16)+(n[3]<<24);return t.slice(14+r)}e.a=class{constructor(t,e={}){this.progress={all:new r.a,current:new r.a},this._getMetadata=a.a.once((async()=>{const t=await this._base.file(this._metadataFilename),e=await t.read(),n=await new Blob([e]).text();return JSON.parse(n)})),this._getRefs=a.a.once((async()=>(await this._getMetadata()).refs.map((t=>new f(this,t))))),this._getFileMap=a.a.once((async()=>{const t=await this._getMetadata(),e=new Map;for(const n of t.files)e.set(n.name.toLowerCase(),n);return e})),"string"==typeof t&&(t=new l.a(new URL(t,location.href)));const n="string"==typeof e.fallback?new l.a(new URL(e.fallback,location.href)):e.fallback;this._base=t,this._fallback=n,this._fallbackPattern=e.fallbackPattern,this._metadataFilename=e.metadataFilename||"metadata.json";const o=i.d(this.progress.current);this.loadPayload=i.e(this.progress.all,c()(2,(t=>t.then((t=>t.read((()=>{const t=new r.a;return o.add(t),t})()))).then((t=>new Blob([t]))).then(p))))}get base(){return this._base}async file(t){const e=(await this._getFileMap()).get(t.toLowerCase());if(e)return new h(this,e.ref,e.name);if(this._fallback&&this._fallbackPattern&&this._fallbackPattern.test(t))return this._fallback.file(t);throw new Error("Unable to find: "+t)}async getBlob([t,e,n]){const r=(await this._getRefs())[t];return(await r.load()).slice(e,n)}}},484:function(t,e,n){var r=n(485);t.exports=function(t,e,n){var i=new WebSocket(t),o=[];function s(){try{i.send(""+(new Date).getTime())}catch(t){}}i.onmessage=function(t){var e,i,a,u,c;"k"==t.data&&s(),t.data.indexOf(",")>=0&&(e=t.data,i=e.split(","),a=+i[0],u=+i[1],c=(new Date).getTime(),a<=c&&o.push(r.convert([a,u,u,c])),o.length>=8&&n&&n(r.offset(o)),s())},i.onclose=function(){return o.length<1?e(new Error("no offset received")):e(null,r.offset(o))}}},485:function(t,e){e.convert=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return{offset:(n-e+(r-i))/2,delay:i-e-(r-n)}},e.offset=function(t){(t=t.slice()).sort((function(t,e){return t.offset-e.offset})),(t=t.slice(1,t.length-1)).sort((function(t,e){return t.delay-e.delay}));for(var e=0,n=0,r=Math.ceil(t.length/8),i=0;i<t.length&&(t[i].delay>t[0].delay&&r--,0!==r);i++)e+=t[i].offset,n+=1;return e/n}},486:function(t,e,n){"use strict";var r=n(542);e.a=Object(r.a)()},487:function(t,e,n){var r=n(488);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},488:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,".BenchmarkPanel {\n  background: #449;\n  border: 2px solid #66e;\n  padding: 4px;\n}\n.BenchmarkPanel table {\n  font-size: 10px;\n}",""])},489:function(t,e,n){"use strict";var r,i=n(27),o=n.n(i),s=n(323),a=n(67),u=n(55),c=n.n(u);!function(t){t.Active="active",t.Unjudged="unjudged",t.Judged="judged"}(r||(r={}));e.a=class{constructor(t){var e;this.player=t,this.notifications={sounds:[],judgments:[]},this.finished=!1,this.tainted=!1,this.input=new Map,this._gameTime=0,this._pinching=null,this._columns=t.columns,this._noteBufferByColumn=o()(t.notechart.notes).sortBy((t=>t.time)).groupBy((t=>t.column)).mapValues((e=this,function(t){let n=0;return{notes:t,get startIndex(){return n},update(){for(;n<t.length&&"judged"===e.getNoteStatus(t[n]);)n+=1}}})).value(),this._noteResult=new Map,this._duration=t.notechart.duration,this._judge=Object(a.d)(t.notechart,{tutorial:t.options.tutorial}),this.stats=new s.a(t.notechart),this.speed=t.options.speed}update(t,e){this._gameTime=t,this._rawInput=e,this.notifications={sounds:[],judgments:[]},this._updateInputColumnMap(),this._judgeNotes(),this._updateSpeed(),t>this._duration+3&&(this.finished=!0)}getNoteStatus(t){const e=this._noteResult.get(t);return e?e.status:r.Unjudged}getNoteJudgment(t){const e=this._noteResult.get(t);return e?e.judgment:a.a.Unjudged}getPlayerInput(t){return this._rawInput.get(`p${this.player.number}_${t}`)}_updateInputColumnMap(){this.input=new Map(this._columns.map((t=>[t,this.getPlayerInput(t)])))}_judgeNotes(){for(const t of this._columns){const e=this._noteBufferByColumn[t];if(e){const n=this.input.get(t);this._judgeColumn(e,n,t),e.update()}}}_updateSpeed(){this.getPlayerInput("speedup").justPressed&&this._modifySpeed(1),this.getPlayerInput("speeddown").justPressed&&this._modifySpeed(-1);const t=this.getPlayerInput("pinch").value;if(t&&!this._pinching?this._pinching={start:t,speed:this.speed}:t||(this._pinching=null),t&&this._pinching){const e=this._pinching,n=e.speed*t/e.start;this.speed=Math.max(.2,Math.round(10*n)/10)}}_modifySpeed(t){const e=this._rawInput.get("select").value?.1:this.speed<.5?.3:.5;this.speed+=t*e,this.speed<.2&&(this.speed=.2)}_shouldAutoplay(){return this.player.options.autoplayEnabled||!!window.BEMUSE_AUTOPLAY}_judgeColumn(t,e,n){let r,i;const o=t.notes;let s=!1;for(let n=t.startIndex;n<o.length;n++){const a=o[n];if(this._shouldJudge(a,e,t)){const t="active"!==this.getNoteStatus(a);if(r=a,i=this._judgeNote(a),this._shouldAutoplay()&&(s=!0),t)break}}if(e.justPressed||s)if(r&&null!=i)this.notifications.sounds.push({note:r,type:"hit",judgment:i});else{const t=this._getFreestyleNote(o);if(t){("3d"!==this.player.options.placement||!this._isSandwiched(n))&&this.notifications.sounds.push({note:t,type:"free"})}}}_getClosestNote(t){return o.a.minBy(t,(t=>Math.abs(this._gameTime-t.time)))}_getFreestyleNote(t){return o.a.minBy(t,(t=>Math.abs(this._gameTime-t.time)+(this._gameTime<t.time-1?1e6:0)))}_isSandwiched(t){const e={2:["1","3"],3:["2","4"],4:["3","5"],5:["4","6"],6:["5","7"]};return!!e[t]&&e[t].every((t=>{const e=this._noteBufferByColumn[t];return!!e&&e.notes.some((t=>Math.abs(this._gameTime-t.time)<.1))}))}_shouldJudge(t,e,n){const r=this.getNoteStatus(t);if("unjudged"===r){if(this._shouldAutoplay()&&this._gameTime>=t.time)return this.tainted=!0,!0;const r=Object(a.g)(this._gameTime,t.time,this._judge),i=r===a.b;let o=r>0&&e.changed&&e.value;return Object(a.e)(r)&&this._getClosestNote(n.notes)!==t&&(o=!1),i||o}if("active"===r){const n=t.end||c()(!1,"note.end must exist");if(this._shouldAutoplay()&&this._gameTime>=n.time)return this.tainted=!0,!0;const r=Object(a.f)(this._gameTime,n.time,this._judge)===a.b,i=e.changed,o="SC"===t.column,s=this._gameTime>=n.time;return r||i||o&&s}return!1}_judgeNote(t){let e=this._gameTime-t.time,n=Object(a.g)(this._gameTime,t.time,this._judge),i=this._noteResult.get(t);const o=!i||"unjudged"===i.status,s=i&&"active"===i.status;if(this._shouldAutoplay()&&n>=1&&(n=1),t.end){if(o){const o=n===a.b?r.Judged:r.Active;n===a.b&&this._setJudgment(n,e,t.column),i={status:o,judgment:n,delta:e}}else if(s){const o="SC"===t.column;e=this._gameTime-t.end.time,n=Object(a.f)(this._gameTime,t.end.time,this._judge)||a.b,o&&e>0&&(n=1),i={status:r.Judged,judgment:n,delta:e}}}else i={status:r.Judged,judgment:n,delta:e};if(n===a.b&&this.notifications.sounds.push({note:t,type:"break"}),o&&n!==a.b&&this.stats.handleDelta(e),!i)throw new Error("Invariant violation: result must not be undefined");if(!n)throw new Error("Invariant violation: note should be judged by this point");return this._noteResult.set(t,i),this._setJudgment(n,e,t.column),n}_setJudgment(t,e,n){this.stats.handleJudgment(t);const r={judgment:t,combo:this.stats.combo,delta:e,column:n};this.notifications.judgments.push(r)}}},490:function(t,e){function n(t){if(t&&"object"==typeof t){var e=t.which||t.keyCode||t.charCode;e&&(t=e)}if("number"==typeof t)return s[t];var n,o=String(t);return(n=r[o.toLowerCase()])?n:(n=i[o.toLowerCase()])||(1===o.length?o.charCodeAt(0):void 0)}n.isEventKey=function(t,e){if(t&&"object"==typeof t){var n=t.which||t.keyCode||t.charCode;if(null==n)return!1;if("string"==typeof e){var o;if(o=r[e.toLowerCase()])return o===n;if(o=i[e.toLowerCase()])return o===n}else if("number"==typeof e)return e===n;return!1}};var r=(e=t.exports=n).code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=e.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(o=97;o<123;o++)r[String.fromCharCode(o)]=o-32;for(var o=48;o<58;o++)r[o-48]=o;for(o=1;o<13;o++)r["f"+o]=o+111;for(o=0;o<10;o++)r["numpad "+o]=o+96;var s=e.names=e.title={};for(o in r)s[r[o]]=o;for(var a in i)r[a]=i[a]},491:function(t,e,n){"use strict";var r=n(180),i=n(324),o=n(67),s=n(325);e.a=class{constructor(t,e){this._currentSpeed=1,this._player=t,this._noteArea=new i.a(t.notechart.notes,t.notechart.barLines),this._stateful={},this._defaultData={placement:t.options.placement,scratch:t.options.scratch,key_mode:t.notechart.getKeyMode(t.options.scratch),lane_lift:Math.max(0,-t.options.laneCover),lane_press:Math.max(0,t.options.laneCover)},this._gauge=Object(s.a)(t.options.gauge),this._touch3dMode="touch3d"===e.displayMode}update(t,e,n){const i=this._touch3dMode,s=this._player,a=this._noteArea,u=this._stateful,c=s.notechart.secondsToBeat(e),l=s.notechart.beatToPosition(c),h=s.notechart.spacingAtBeat(c),f=Object.assign({},this._defaultData),p=(t,e)=>(f[t]||(f[t]=[])).push(e),d=this._gauge;this._currentSpeed+=(n.speed-this._currentSpeed)/3;const m=this._currentSpeed*h;f.beat=c,function(){const t=a.getVisibleNotes(l,y(),1);if(i){const e=(t,e,n,i=1)=>{const o=r.b(e-.01),s=+n||-1,a=r.a,u=o.projection*a*(2*(s-.5)/7-1),c=o.projection*i*a*2/7;p(`note3d_${n}`,{key:t,y:o.y,x:u+640,width:c})},i=3/128;for(const r of t){const t=r.note,o=t.column;if(r.height){let n=0;const s=r.y+r.height;for(let a=s-Math.max(0,Math.floor((s-1)/i)*i);a>=0&&a>=r.y;a-=i)e(t.id+"x"+n++,a,o,.8);e(t.id,r.y+r.height,o)}else"judged"!==n.getNoteStatus(t)&&e(t.id,r.y,o)}}else for(const e of t){const t=e.note,r=t.column;if(e.height){const i=n.getNoteJudgment(t),s=n.getNoteStatus(t);p(`longnote_${r}`,{key:t.id,y:e.y,height:e.height,active:0!==i&&i!==o.b,missed:"judged"===s&&i===o.b})}else"judged"!==n.getNoteStatus(t)&&p(`note_${r}`,{key:t.id,y:e.y})}}(),function(){const t=a.getVisibleBarLines(l,y(),1);for(const e of t)if(i){const t=r.b(e.y-.01);p("barlines3d",{key:e.id,y:t.y,x:t.projection*-r.a+640,width:t.projection*r.a*2})}else p("barlines",{key:e.id,y:e.y})}(),function(){const e=n.input;for(const n of s.columns){const r=e.get(n);f[`${n}_active`]=0!==r.value?1:0,r.changed&&(0!==r.value?u[`${n}_down`]=t:u[`${n}_up`]=t)}}(),function(){const e=n.notifications.judgments,r=e[e.length-1];if(r){const e=-1===r.judgment?"missed":`${r.judgment}`;u[`judge_${e}`]=t;const n=-1===r.judgment||1===r.judgment?"none":r.delta>0?"late":r.delta<0?"early":"none";u[`judge_deviation_${n}`]=t,u.combo=r.combo}f.score=n.stats.score}(),function(){d.update(n),d.shouldDisplay()?u.gauge_enter||(u.gauge_enter=t):u.gauge_enter&&(u.gauge_exit||(u.gauge_exit=t));f.gauge_primary=d.getPrimary(),f.gauge_secondary=d.getSecondary(),f.gauge_extra=d.getExtra()}(),function(){const e=n.notifications.judgments;for(let n=0;n<e.length;n++){const r=e[n];Object(o.c)(r.judgment)||(u[`${r.column}_explode`]=t)}}(),f.speed=n.speed.toFixed(1)+"x",f.stat_1=b(1),f.stat_2=b(2),f.stat_3=b(3),f.stat_4=b(4),f.stat_missed=b(o.b),f.stat_acc=(100*(n.stats.currentAccuracy||0)).toFixed(2)+"%";const g=s.notechart.bpmAtBeat(c);return f.bpm=g<1?"":Math.round(g)%1e4||"",Object.assign(f,u),f;function b(t){return n.stats.counts&&n.stats.counts[t]}function y(){return l+5/m}}}},492:function(t,e,n){"use strict";const r=n(493);t.exports=async(t,e,{concurrency:n=1/0,stopOnError:i=!0}={})=>new Promise(((o,s)=>{if("function"!=typeof e)throw new TypeError("Mapper function is required");if(!Number.isSafeInteger(n)&&n!==1/0||!(n>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${n}\` (${typeof n})`);const a=[],u=[],c=t[Symbol.iterator]();let l=!1,h=!1,f=0,p=0;const d=()=>{if(l)return;const t=c.next(),n=p;if(p++,t.done)return h=!0,void(0===f&&(i||0===u.length?o(a):s(new r(u))));f++,(async()=>{try{const r=await t.value;a[n]=await e(r,n),f--,d()}catch(t){i?(l=!0,s(t)):(u.push(t),f--,d())}})()};for(let t=0;t<n&&(d(),!h);t++);}))},493:function(t,e,n){"use strict";const r=n(494),i=n(495);class o extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError("Expected input to be an Array, got "+typeof t);let e=(t=[...t].map((t=>t instanceof Error?t:null!==t&&"object"==typeof t?Object.assign(new Error(t.message),t):new Error(t)))).map((t=>"string"==typeof t.stack?i(t.stack).replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""):String(t))).join("\n");e="\n"+r(e,4),super(e),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:t})}*[Symbol.iterator](){for(const t of this._errors)yield t}}t.exports=o},494:function(t,e,n){"use strict";t.exports=(t,e=1,n)=>{if(n={indent:" ",includeEmptyLines:!1,...n},"string"!=typeof t)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if("number"!=typeof e)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if("string"!=typeof n.indent)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof n.indent}\``);if(0===e)return t;const r=n.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(r,n.indent.repeat(e))}},495:function(t,e,n){"use strict";const r=n(496),i=/\s+at.*(?:\(|\s)(.*)\)?/,o=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,s=void 0===r.homedir?"":r.homedir();t.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split("\n").filter((t=>{const e=t.match(i);if(null===e||!e[1])return!0;const n=e[1];return!n.includes(".app/Contents/Resources/electron.asar")&&!n.includes(".app/Contents/Resources/default_app.asar")&&!o.test(n)})).filter((t=>""!==t.trim())).map((t=>e.pretty?t.replace(i,((t,e)=>t.replace(e,e.replace(s,"~")))):t)).join("\n"))},496:function(t,e){},497:function(t,e,n){"use strict";var r=n(174),i=n(167);class o extends r.b{constructor(t){super({getFiles:e=>async function(t,e){const n=[],o=t.dataTransfer;if(!o)throw new Error("Expect event.dataTransfer to be present");if(o.types.indexOf("text/uri-list")>-1){const t=o.getData("text/uri-list").split(/\r\n|\r|\n/).filter((t=>t&&!t.startsWith("#")))[0];if(r.a.test(t&&t.replace(/[?#].*/,"")))return e("Link to archive file detected. Trying to download"),[await Object(r.d)(t,e)]}else if(o.items)for(const t of Array.from(o.items))await s(t);else if(o.files)for(const t of Array.from(o.files))l(t);return n;async function s(t){const e=t.webkitGetAsEntry&&t.webkitGetAsEntry();if(e)await a(e);else{const e=t.getAsFile&&t.getAsFile();e&&l(e)}}function a(t,e=""){return t.isFile?u(t,e):t.isDirectory?c(t,e):void 0}async function u(t,e=""){const n=await new Promise(((e,n)=>{t.file(e,n)}));return l(n,e),n}async function c(t,e=""){const n=[],r=t.createReader(),i=()=>new Promise(((t,e)=>{r.readEntries(t,e)}));for(;;){const t=await i();if(!t||0===t.length)break;n.push(...Array.from(t))}for(const r of n)await a(r,e+t.name+"/")}function l(t,e=""){t&&Object(i.a)(e,t.name,(e=>{n.push({name:e,file:t})}))}}(t,e)})}}e.a=o},50:function(t,e,n){var r;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var o=typeof r;if("string"===o||"number"===o)t.push(r);else if(Array.isArray(r)){if(r.length){var s=i.apply(null,r);s&&t.push(s)}}else if("object"===o){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){t.push(r.toString());continue}for(var a in r)n.call(r,a)&&r[a]&&t.push(a)}}}return t.join(" ")}t.exports?(i.default=i,t.exports=i):void 0===(r=function(){return i}.apply(e,[]))||(t.exports=r)}()},518:function(t,e,n){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},519:function(t,e,n){"use strict";e.decode=e.parse=n(520),e.encode=e.stringify=n(521)},520:function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var h,f,p,d,m=t[l].replace(a,"%20"),g=m.indexOf(n);g>=0?(h=m.substr(0,g),f=m.substr(g+1)):(h=m,f=""),p=decodeURIComponent(h),d=decodeURIComponent(f),r(s,p)?i(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},521:function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?o(s(t),(function(s){var a=encodeURIComponent(r(s))+n;return i(t[s])?o(t[s],(function(t){return a+encodeURIComponent(r(t))})).join(e):a+encodeURIComponent(r(t[s]))})).join(e):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},533:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(100);function i(t,e){if(e.includes("://"))return[new r.a(new URL(e)),e.split("/").slice(-1)[0]];const n=e.split("/");let i=t;for(;n.length>1;){const t=n.shift();i=new o(i,t)}return[i,n[0]]}class o{constructor(t,e){this.base=t,this.dirName=e}async file(t){return this.base.file(`${this.dirName}/${t}`)}}},542:function(t,e,n){"use strict";var r=n(55),i=n.n(r);e.a=function(){const t=new Map;let e;return{receiveSongId(n){e!==n&&(e=n,t.clear())},isEmpty:()=>0===t.size,isCached:e=>t.has(e),cache(n,r){i()(e,"Expected current song to be set."),t.set(n,r)},get:e=>t.get(e)}}},543:function(t,e,n){"use strict";e.a=class{constructor(t,e,n,{volume:r}={}){this._master=t,this._samples=e,this._map=n,this._exclusiveInstances=new Map,this._group=this._master.group({volume:r})}playAuto(t,e,n){return this._play({note:t,delay:e,exclusive:!0,slice:n})}playNote(t,e,n){return this._play({note:t,delay:e,exclusive:!0,slice:n})}playFree(t,e,n){return this._play({note:t,delay:0,exclusive:!1,slice:n})}_play({note:t,delay:e,exclusive:n}){const r=t.keysound;n&&this._stopOldExclusiveSound(r,e);const i=this._map[r.toLowerCase()];if(!i)return null;const o=this._samples[i];if(!o)return null;const s=o.play(e,{start:t.keysoundStart,end:t.keysoundEnd,group:this._group});return n&&this._exclusiveInstances.set(r,s),s}_stopOldExclusiveSound(t,e){const n=this._exclusiveInstances.get(t);n&&(setTimeout((()=>n.stop()),1e3*e),this._exclusiveInstances.delete(t))}}},580:function(t,e,n){var r=n(581);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},581:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,'.Scene {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  overflow: hidden;\n  font-family: "Source Sans Pro", "Segoe UI", "Helvetica Neue", sans-serif;\n}\n.Scene > .SceneHeading {\n  position: absolute;\n  top: 20px;\n  right: 0;\n  left: 0;\n}\n@media (min-width: 720px) {\n  .Scene > .SceneHeading {\n    top: 2rem;\n  }\n}\n.Scene > .SceneToolbar {\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}',""])},60:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Speedcore=void 0;var r=n(238),i=function(){function t(t){t.forEach(r.Segment),this._segments=t}return t.prototype._reached=function(t,e,n){if(t>=this._segments.length)return!1;var r=this._segments[t],i=e(r);return r.inclusive?n>=i:n>i},t.prototype._segmentAt=function(t,e){for(var n=0;n<this._segments.length;n++)if(!this._reached(n+1,t,e))return this._segments[n];throw new Error("Unable to find a segment matching a criteria (this should never happen)!")},t.prototype.segmentAtX=function(t){return this._segmentAt(s,t)},t.prototype.segmentAtT=function(t){return this._segmentAt(o,t)},t.prototype.t=function(t){var e=this.segmentAtX(t);return e.t+(t-e.x)/(e.dx||1)},t.prototype.x=function(t){var e=this.segmentAtT(t);return e.x+(t-e.t)*e.dx},t.prototype.dx=function(t){return this.segmentAtT(t).dx},t}();e.Speedcore=i;var o=function(t){return t.t},s=function(t){return t.x}},608:function(t,e,n){"use strict";(function(t){var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.NotechartLoader=void 0;var u=o(n(85)),c=o(n(291)),l=o(n(610)),h=function(e){return t.isBuffer(e)?e:t.from(new Uint8Array(e))},f=function(){function t(){}return t.prototype.load=function(t,e,n){return e.name.match(/\.bmson$/i)?this.loadBmson(t,e,n):this.loadBMS(t,e,n)},t.prototype.loadBMS=function(t,e,n){return s(this,void 0,void 0,(function(){var r,i,o,s,l;return a(this,(function(a){switch(a.label){case 0:return r=h(t),i=u.Reader.getReaderOptionsFromFilename(e.name),[4,u.Reader.readAsync(r,i)];case 1:return o=a.sent(),s=u.Compiler.compile(o),l=s.chart,[2,c.fromBMSChart(l,n)]}}))}))},t.prototype.loadBmson=function(t,e,n){return s(this,void 0,void 0,(function(){var e,r;return a(this,(function(i){return e=h(t),r=e.toString("utf-8"),[2,l.load(r,n)]}))}))},t}();e.NotechartLoader=f,e.default=f}).call(this,n(37).Buffer)},610:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.load=void 0;var a=o(n(611)),u=o(n(85)),c=s(n(179));function l(t){var e=(t.info&&t.info.judge_rank&&+t.info.judge_rank||100)/100;return[18*e,40*e]}e.load=function(t,e){var n=JSON.parse(t),r=a.songInfoForBmson(n),i=a.musicalScoreForBmson(n,{double:e.double}),o=a.barLinesForBmson(n),s={notes:i.notes.all(),timing:i.timing,keysounds:i.keysounds,songInfo:r,positioning:new u.Positioning([{t:0,x:0,dx:1,inclusive:!0}]),spacing:new u.Spacing([]),barLines:o,images:{eyecatch:n.info.eyecatch_image,background:n.info.back_image},expertJudgmentWindow:l(n)};return new c.default(s,e)}},611:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)},a=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},u=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},c=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.keysForBmson=e.hasScratch=e.beatForPulseForBmson=e._slicesForNotesAndTiming=e.musicalScoreForBmson=e.timingInfoForBmson=e.barLinesForBmson=e.songInfoForBmson=void 0;var h=l(n(27)),f=o(n(85)),p=o(n(320)),d=o(n(321));function m(t){if(!t.version)return p.timingInfoForBmson(t);var e=y(t);return{initialBPM:t.info.init_bpm,actions:u(u([],a((t.bpm_events||[]).map((function(t){var n=t.y,r=t.bpm;return{type:"bpm",beat:e(n),bpm:r}}))),!1),a((t.stop_events||[]).map((function(t){var n=t.y,r=t.duration;return{type:"stop",beat:e(n),stopBeats:e(Math.floor(r))}}))),!1)}}function g(t){return t.version?t.sound_channels:t.soundChannel}s(n(612),e),e.songInfoForBmson=function(t){var e=t.info,n={};return e.title&&(n.title=e.title),e.artist&&(n.artist=e.artist),e.genre&&(n.genre=e.genre),e.level&&(n.level=e.level),n.subtitles=function(){if(!t.version)return["Warning: legacy bmson"];var n=[];e.chart_name&&"string"==typeof e.chart_name&&n.push(e.chart_name);e.subtitle&&"string"==typeof e.subtitle&&n.push.apply(n,u([],a(e.subtitle.split("\n")),!1));return n}(),e.subartists&&(n.subartists=e.subartists),new f.SongInfo(n)},e.barLinesForBmson=function(t){if(!t.version)return p.barLinesForBmson(t);var e=y(t),n=t.lines;return(0,h.default)(n).map((function(t){var n=t.y;return e(n)})).sortBy().value()},e.timingInfoForBmson=m,e.musicalScoreForBmson=function(t,e){void 0===e&&(e={});var n=function(t){var e=m(t),n=e.initialBPM,r=e.actions;return new f.Timing(n,r)}(t),r=function(t,e,n){var r,i,o,s,a=1,u=y(t),l=[],f={},p=g(t);if(p)try{for(var m=c(p),b=m.next();!b.done;b=m.next()){var _=b.value,w=_.name,S=_.notes,E=h.default.sortBy(S,"y"),x=a++,A=h.default.padStart(""+x,4,"0"),k=d.slicesForNotesAndTiming(S,e,{beatForPulse:u});f[A]=w;try{for(var O=(o=void 0,c(E)),M=O.next();!M.done;M=O.next()){var j=M.value,C=j.x,P=j.y,T=j.l,I={column:v(C,n),beat:u(P),keysound:A,endBeat:void 0};T>0&&(I.endBeat=u(P+T));var D=k.get(P);D&&(Object.assign(I,D),l.push(I))}}catch(t){o={error:t}}finally{try{M&&!M.done&&(s=O.return)&&s.call(O)}finally{if(o)throw o.error}}}}catch(t){r={error:t}}finally{try{b&&!b.done&&(i=m.return)&&i.call(m)}finally{if(r)throw r.error}}return{notes:l,keysounds:f}}(t,n,e),i=r.notes,o=r.keysounds;return{timing:n,notes:new f.Notes(i),keysounds:new f.Keysounds(o)}};var b=n(320);function y(t){if(!t.version)return p.beatForLoc;var e=t.info&&t.info.resolution||240;return function(t){return t/e}}function v(t,e){switch(t){case 1:return"1";case 2:return"2";case 3:return"3";case 4:return"4";case 5:return"5";case 6:return"6";case 7:return"7";case 8:return"SC"}if(e.double)switch(t){case 9:return"8";case 10:return"9";case 11:return"10";case 12:return"11";case 13:return"12";case 14:return"13";case 15:return"14";case 16:return"SC2"}}Object.defineProperty(e,"_slicesForNotesAndTiming",{enumerable:!0,get:function(){return b._slicesForNotesAndTiming}}),e.beatForPulseForBmson=y,e.hasScratch=function(t){var e,n,r,i,o=g(t);if(o)try{for(var s=c(o),a=s.next();!a.done;a=s.next()){var u=a.value.notes;try{for(var l=(r=void 0,c(u)),h=l.next();!h.done;h=l.next()){var f=h.value.x;if(8===f||18===f)return!0}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return!1},e.keysForBmson=function(t){var e,n,r,i,o=g(t),s=!1,a=!1,u=!1;if(o)try{for(var l=c(o),h=l.next();!h.done;h=l.next()){var f=h.value.notes;try{for(var p=(r=void 0,c(f)),d=p.next();!d.done;d=p.next()){var m=d.value.x;s=!0,m>=11&&m<=20&&(a=!0),6!==m&&7!==m&&16!==m&&17!==m||(u=!0)}}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return s?a?u?"14K":"10K":u?"7K":"5K":"empty"}},612:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},613:function(t,e,n){"use strict";var r=n(322);e.a=class{constructor(t,e){this.options=e,this.players=e.players.map((function(n,i){return n=Object.assign({},n,{autosound:e.audioInputLatency>=.01,tutorial:e.tutorial}),new r.a(t[i],i+1,n)}))}get samples(){const t=new Set;for(const e of this.players)for(const n of e.notechart.samples)t.add(n);return Array.from(t)}}},614:function(t,e,n){"use strict";var r=n(27),i=n.n(r),o=n(543),s=n(67);function a(t){t=i.a.sortBy(t,"time");let e=0;return{next(n){const r=[];for(;e<t.length&&n>=t[e].time;e++)r.push(t[e]);return r}}}e.a=class{constructor({player:t,samples:e,master:n,waveFactory:r,volume:i}){const s=t.notechart;this._waveFactory=r||new o.a(n,e,s.keysounds,{volume:i}),this._autos=a(s.autos),this._notes=a(s.notes),this._played=new Map,this._autosound=!!t.options.autosound}update(t,e){this._playAutokeysounds(t),this._playAutosounds(t,e),this._handleSoundNotifications(e&&e.notifications.sounds||[])}_playAutokeysounds(t){for(const e of this._autos.next(t+1/30))this._waveFactory.playAuto(e,e.time-t)}_playAutosounds(t,e){const n=this._notes.next(t+1/30),r=e&&e.stats.poor;if(this._autosound&&!r)for(const e of n)this._hitNote(e,e.time-t)}_handleSoundNotifications(t){for(const e of t){const{type:t,note:n}=e;"hit"===t?this._hitNote(n,0,e.judgment):"break"===t?this._breakNote(n):"free"===t&&this._waveFactory.playFree(n,0)}}_hitNote(t,e,n){let r=this._played.get(t);r||(r=this._waveFactory.playNote(t,e),this._played.set(t,r)),r&&Object(s.e)(n)&&r.bad()}_breakNote(t){const e=this._played.get(t);e&&e.stop()}}},615:function(t,e,n){"use strict";var r=n(489),i=n(55),o=n.n(i);e.a=class{constructor(t){this.game=t,this.readyFraction=0,this.gettingStarted=!1,this.started=!1,this.finished=!1,this._players=new Map(t.players.map((t=>[t,new r.a(t)])))}update(t,e,n){let r=!0;for(const[n,i]of this._players)i.update(t,e),i.finished||(r=!1);this.readyFraction=n.readyFraction,this.gettingStarted=n.gettingStarted,this.started=n.started,this.finished=r}player(t){return this._players.get(t)||o()(!1,"Invariant violation: No player state found for player %s",t.number)}}},616:function(t,e,n){"use strict";var r=n(180),i=n(182);const o=["p1_1","p1_2","p1_3","p1_4","p1_5","p1_6","p1_7","start"];function s(){const t=[];return window.BEMUSE_TOUCH_STATS.push(t),{record(e){for(const{x:n,y:r}of e)t.push({x:Math.round(n),y:Math.round(r)})},done(){t.length&&(localStorage._stats_touch=JSON.stringify(window.BEMUSE_TOUCH_STATS))}}}window.BEMUSE_TOUCH_STATS=[],e.a=function(t){let e=null,n=null;const a=i.a.wrap("input:touch:I",(function(){return t.input})),u=i.a.wrap("input:touch:SC",(function(r){const i=t.refs.p1_SC;if(!i)return 0;n=null;for(const t of r){for(const e of i)if(d(e.getBounds(),32).contains(t.x,t.y)){n=t.y;break}if(null!==n)break}if(null===n)return e=null,0;null===e&&(e=n);n>e+24?e=n-24:n<e-24&&(e=n+24);return n>e+4?-1:n<e-4?1:0})),c=i.a.wrap("input:touch:B",(function(e,n){const r=t.refs[n];if(r)for(const t of r){const n=d(t.getBounds());for(const t of e)if(n.contains(t.x,t.y))return 1}return 0})),l=i.a.wrap("input:touch:P",(function(t){let e=null,n=null;for(const r of t)if(r.y<p)if(null===e)e=r.y;else{if(null!==n)return 0;n=r.y}return null!==e&&null!==n?Math.abs(e-n):0})),h=new s,f="touch3d"===t.skinData.displayMode,p=f?r.b(.8).y:550;return{name:"TouchPlugin",get(){const t=a(),e={};i.a.enabled&&(i.a.stats["input:touch:n"]=""+t.length),h.record(t),e.p1_SC=u(t);for(const n of o)e[n]=c(t,n);if(f)for(const n of t){const t=r.c(n.x,n.y);t&&(e["p1_"+t]=1)}return e.p1_pinch=l(t),e},destroy(){h.done()}};function d(t,e=4){const n=t.clone();return n.x-=e,n.y-=e,n.width+=2*e,n.height+=2*e,n}}},617:function(t,e,n){"use strict";n(618);var r=n(71),i=n.n(r),o=n(491),s=n(326),a=n(144),u=n(624),c=n.n(u);function l(t,e){const n=document.createElement("button");return n.addEventListener("touchstart",(t=>{t.stopPropagation()}),!0),n.onclick=e=>{e.preventDefault(),t()},n.className=e,n}e.a=class{constructor({game:t,context:e,backgroundImagePromise:n,video:r}){this._game=t,this._context=e;const i=e.skinData;this._players=new Map(t.players.map((t=>[t,new o.a(t,i)]))),this._stateful={},this._wrapper=this._createWrapper({backgroundImagePromise:n,video:r,panelPlacement:t.players[0].options.placement,infoPanelPosition:i.infoPanelPosition}),this._createTouchEscapeButton(),this._createFullScreenButton(),this._escapeHintShown=!1}setEscapeHandler(t){this._onEscape=t}setReplayHandler(t){this._onReplay=t}start(){this._started=(new Date).getTime();const t=this._game.players[0],e=t.notechart.songInfo,n=t.options.autoplayEnabled?"[AUTOPLAY] ":"";this._stateful.song_title=n+e.title,this._stateful.song_artist=e.artist,this._duration=t.notechart.duration}destroy(){this._context.destroy()}update(t,e){const n=((new Date).getTime()-this._started)/1e3,r=this._getData(n,t,e);this._updateStatefulData(n,t,e),this._context.render(Object.assign({},this._stateful,r)),this._synchronizeVideo(t),this._synchronizeTutorialEscapeHint(t)}_synchronizeVideo(t){this._video&&!this._videoStarted&&t>=this._videoOffset&&(this._video.volume=0,this._video.play(),this._video.classList.add("is-playing"),this._videoStarted=!0)}_synchronizeTutorialEscapeHint(t){if(this._game.options.tutorial){t>=101.123595506&&!this._escapeHintShown&&(this._escapeHintShown=!0,this._escapeHint.classList.add("is-shown"))}}_getData(t,e,n){const r={};r.tutorial=this._game.options.tutorial?"yes":"no",r.t=t,r.gameTime=e,r.ready=this._getReady(n),r.song_time=this._getSongTime(e);for(const[i,o]of this._players){const s=n.player(i),a=o.update(t,e,s);for(const t in a)r[`p${i.number}_${t}`]=a[t]}return r}_updateStatefulData(t,e,n){const r=this._stateful;void 0===r.started&&n.started&&(r.started=t),void 0===r.gettingStarted&&n.gettingStarted&&(r.gettingStarted=t)}_getSongTime(t){return Object(s.a)(Math.min(this._duration,Math.max(0,t)))+" / "+Object(s.a)(this._duration)}_getReady(t){const e=t.readyFraction;return e>.5?Math.pow(1-(e-.5)/.5,2):0}_createWrapper({backgroundImagePromise:t,video:e,panelPlacement:n,infoPanelPosition:r}){const o=i()('<div class="game-display"></div>').attr("data-panel-placement",n).attr("data-info-panel-position",r).append('<div class="game-display--bg js-back-image"></div>').append(this.view);return t&&Promise.resolve(t).then((t=>o.find(".js-back-image").append(t))),e&&(this._video=e.element,this._videoOffset=e.offset,i()(e.element).addClass("game-display--video-bg").appendTo(o)),o[0]}_createTouchEscapeButton(){const t=document.createElement("div");t.className="game-display--touch-buttons is-left",this.wrapper.appendChild(t),t.classList.add("is-visible");const e=(e,n)=>{const r=l(n,e);t.appendChild(r)};e("game-display--touch-escape-button",(()=>this._onEscape())),e("game-display--touch-replay-button",(()=>this._onReplay()));const n=document.createElement("div");n.textContent="Click or press Esc to exit the tutorial",n.className="game-display--escape-hint",this._escapeHint=n,t.appendChild(n)}_createFullScreenButton(){if(Object(a.b)()||!c.a.enabled)return;const t=document.createElement("div");t.className="game-display--touch-buttons is-visible is-right",this.wrapper.appendChild(t);const e=l((()=>{c.a.request()}),"game-display--touch-fullscreen-button");t.appendChild(e)}get context(){return this._context}get view(){return this._context.view}get wrapper(){return this._wrapper}}},618:function(t,e,n){var r=n(619);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},619:function(t,e,n){var r=n(8);(t.exports=n(1)(!1)).push([t.i,".game-display {\n  display: block;\n  margin: 0 auto;\n  overflow: hidden;\n  position: relative;\n}\n.game-display--bg {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 10;\n  background: url("+r(n(620))+") center no-repeat;\n  background-size: cover;\n  -webkit-animation: 1.5s game-display--bg-default;\n          animation: 1.5s game-display--bg-default;\n  -webkit-animation-fill-mode: both;\n          animation-fill-mode: both;\n}\n.game-display[data-info-panel-position=top] .game-display--bg {\n  -webkit-animation-name: game-display--bg-down;\n          animation-name: game-display--bg-down;\n}\n.game-display--video-bg {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: -48px;\n  left: 0px;\n  z-index: 11;\n  opacity: 0;\n  transition: 0.5s opacity;\n  will-change: opacity;\n}\n.game-display--video-bg.is-playing {\n  opacity: 1;\n}\n.game-display[data-panel-placement=left] .game-display--video-bg {\n  -webkit-transform: translateX(13.671875%) scale(0.87);\n          transform: translateX(13.671875%) scale(0.87);\n}\n.game-display[data-panel-placement=right] .game-display--video-bg {\n  -webkit-transform: translateX(13.671875%) scale(0.87);\n          transform: translateX(13.671875%) scale(0.87);\n}\n.game-display--bg img {\n  width: 100%;\n  height: 100%;\n  display: block;\n  object-fit: cover;\n  -webkit-animation: 1.2s game-display--bg-default;\n          animation: 1.2s game-display--bg-default;\n  -webkit-animation-fill-mode: both;\n          animation-fill-mode: both;\n}\n.game-display[data-info-panel-position=top] .game-display--bg img {\n  -webkit-animation-name: game-display--bg-down;\n          animation-name: game-display--bg-down;\n}\n.game-display > canvas {\n  position: relative;\n  z-index: 100;\n}\n.game-display--touch-buttons {\n  position: fixed;\n  -webkit-transform: translateZ(0);\n          transform: translateZ(0);\n  top: 0;\n  opacity: 0;\n  z-index: 110;\n}\n.game-display--touch-buttons.is-visible {\n  opacity: 1;\n}\n.game-display--touch-buttons.is-left {\n  left: 0;\n}\n.game-display--touch-buttons.is-right {\n  right: 0;\n}\n.game-display--touch-escape-button, .game-display--touch-replay-button, .game-display--touch-fullscreen-button {\n  position: absolute;\n  top: 12px;\n  margin: 0;\n  padding: 0;\n  border: 0;\n  width: 32px;\n  height: 32px;\n  background: transparent center center no-repeat;\n  background-size: 32px 32px;\n  cursor: pointer;\n}\n.game-display--touch-escape-button {\n  background-image: url("+r(n(621))+");\n  left: 12px;\n}\n.game-display--touch-replay-button {\n  background-image: url("+r(n(622))+");\n  left: 56px;\n}\n.game-display--touch-fullscreen-button {\n  background-image: url("+r(n(623))+');\n  right: 12px;\n}\n:root:-webkit-full-screen .game-display--touch-fullscreen-button {\n  display: none;\n}\n:root:fullscreen .game-display--touch-fullscreen-button {\n  display: none;\n}\n.game-display--escape-hint {\n  position: absolute;\n  left: 12px;\n  top: 56px;\n  display: none;\n  background: #b61a44;\n  padding: 8px 12px;\n  color: white;\n  white-space: nowrap;\n  border-radius: 8px;\n  font-weight: bold;\n  font-size: 1rem;\n  pointer-events: none;\n}\n.game-display--escape-hint.is-shown {\n  display: block;\n}\n.game-display--escape-hint::after {\n  content: "";\n  display: block;\n  position: absolute;\n  width: 0;\n  height: 0;\n  top: -8px;\n  left: 16px;\n  margin-left: -8px;\n  border-width: 0 8px 8px 8px;\n  border-style: solid;\n  border-color: transparent;\n  border-bottom-color: #b61a44;\n}\n\n@-webkit-keyframes game-display--bg-default {\n  from {\n    -webkit-transform: translate(0, 0);\n            transform: translate(0, 0);\n    opacity: 0;\n  }\n  to {\n    -webkit-transform: translate(0, -35px);\n            transform: translate(0, -35px);\n    opacity: 1;\n  }\n}\n\n@keyframes game-display--bg-default {\n  from {\n    -webkit-transform: translate(0, 0);\n            transform: translate(0, 0);\n    opacity: 0;\n  }\n  to {\n    -webkit-transform: translate(0, -35px);\n            transform: translate(0, -35px);\n    opacity: 1;\n  }\n}\n@-webkit-keyframes game-display--bg-down {\n  from {\n    -webkit-transform: translate(0, 0);\n            transform: translate(0, 0);\n    opacity: 0;\n  }\n  to {\n    -webkit-transform: translate(0, 35px);\n            transform: translate(0, 35px);\n    opacity: 1;\n  }\n}\n@keyframes game-display--bg-down {\n  from {\n    -webkit-transform: translate(0, 0);\n            transform: translate(0, 0);\n    opacity: 0;\n  }\n  to {\n    -webkit-transform: translate(0, 35px);\n            transform: translate(0, 35px);\n    opacity: 1;\n  }\n}',""])},620:function(t,e,n){t.exports=n.p+"build/ea410328703171d8f693d3a404a11a8f.jpg"},621:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACxUlEQVR4AdSYgWfrUBTG2xWNhLbQUbQAlUA7oEzKUNSGwqbA84INBs3oJPvj+75wUMe5Sd+yfM3KD+L2nvPdnNz7ndtp+nc6nQIQghjsQALeQQoyIZVniYyJ5T9BI0kRRE/ABryCr5q8ylyTtovugxV4k8Sb4E1i9Nsk3ANr8CFJMviQmN41hXfBAqQVyeYgkTK+AzMwAj7oCb48m8mYjfwnr5j7IDl02eKH4E9JYhl4lo3Mq1ldocyVueJJLkOW+Ck4OBL5BA/AbyCuL3N/llTDtGnxS5A5yvwJDAgvYCCxckflLZsIegM2jpXfg/EV9qCxxP7SSK43Pyn+xRHovgWn0L0jt5cfWQTHmz+CeYuO4jk4WpVQ+5s3Jn0Hty00YreSm853WWe3zwzxQYvdaKAXQTRMv3POH3TZ22++lZVwNI7I4eUOzzY581/UjM0dZql7yZ8X5m5fvmBbEBEFRhKz+5+nw6LSehrefl8h/vHMDEUk8bnEfKxYhL3xKXhlk68NhzcuGb81xkcM8WdsK8ySHr8u6+d1S/t0SUKERfh2rEKD0Ur3rYEro7EZNJIYQbzqHXQDtbIG6pucB0KClLkLLfpmSQ+YGObBJyRKmbPQYpi6SZnffyYkTF3QQpOzTzBub0PCW2NXU6hvm8/9sw7kUb5bgnjlcfS8gbUyf2k7N0G8mj/RlV48jK1vg7cIBPHuvS4uHu7UwzuWgWEbqkKbirGzymLGdHFkNzlTcZKOcYEwIvr4nCVechjpC56O0f35zGaG3Ez5Kl7aMRxSj9HOssVL7J52vP/at28CgIEYiqF4AssQzH/Jmt4z/QfhqptkAzwBn6AwmJ4ISYWH1bUIKobiy2ENES0xTVFtcYMRozHD0Vms7IDxOEACIgOSgskBJaGyYGm4PGGCMkOaeq/N9QVtrh5oc/W7NkecpM6Sp+P1+REepk4aEr9vwAAAAABJRU5ErkJggg=="},622:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAEEklEQVR4AdSaBY/zPAzHBw8cMzMzCo+ZmZmZmfvh7/1P8kt+kq65dLt00k9QZYbUSWynvkj/Pj8/40Et6AZz4ABcgQfwTjzQswMa003/ifd58QfDc8EwOAGWJickK9d0p3+DNnAKrAhxSjp+m+R4DOgBj8CKEo+kM+Y7HfeDZvAQxtgPcEBh3AqKQAqIA0Eijp4V0Zhh+s9HGNn3ZIM/2s4ng10bw97BMqgFMZrRVUuy3mX6yJbkaDlfCO4lhryCfhAXAb1xJPvVJhoKI+18C3iXhPkUSIrCC0giXR+SyGuJhNIArUtLwBrI/IY9KJN0WxyyNeCm8ysSRZ0GnEKdEttWXJkEyZt/AdUGHcXV4EUUCW6seYtxBbIMTMSyyDaL0aKz279z503Oz6nuuBJsjIVfOefvediL37yRkfAiOCKTFTI8YZJTrWlYLGgEM2AbnIMX4hLsgRkak+BQ5oB0TxAnS34nQps1d3surwZsOUhrRQZX2sgdonG/FE6HZiep5wM/5zX2kD1gaXIMSkTOE9LkS5An3Num5lRh8Qwv8wt5wwiwXGYQBJnzIbLDJEs88nrs6nle0k59oXjZsHHiCHSDEpAOfhF/V4LdYYqsW8Gz4jA2TQlK6d+igW2CwiZJ0fkzieGLIF1xJ59xGBnVDmoHXkC1iQbyTk6/YthvSJKmAs3K85LJVE50Qr7wzpKgh8eSB4WSVrLmtxVkKMlmtDkspXlSl2uX7y8rvSWx80F95/mGJ6TPoaxlaZ0g6N7WKhi5Jwj7uGg4T4w5lFfLu83/zZ/50RejkORYjIJoOU/MK2zS/EiMF83MvoKhW3y3d8H5AWApsK4g++CPSKezV7mGptyez2i6SwXNLzq+skExRVoLaAN9YAzMg3UwqdHb6A49nGMPWx0Ka+RJjgcqxVZm85woLIocCpvls+mBCShiNh/4BA2EFIfCttn/SjwwASn8xPIJqr84h8LO+fr3wATEMZsffDxDcprACLouvzwwAUGe8XpyAsiRjv/QpjMBnlsC0JXG17LGEvDeJghd5Uz3lsYm6L1jkMJe0LhRPwY9mQiFdHGbdRIhY1Jhh3ozBMVbnE4qXMvD4juKIQWdC+4WQwaUw5rNlzqdctjMhoh8yV0wXXvAr9EQMbolxhOYHZ1oE7fEvNEUjQObCq0whaao+W3xfMmd/wb7+kOvLW7gxUgG/ccScMo3ae2LEQOuxtJAMegBhzb/3xQtK42rMU9djsq//NK8HOVv8N6w6/G9cBegGtfjxn4g8UGnSLXLn881m/CJzKzgE5kLejZLY2L/at8OLACAgSAI1nolpH9IC8kJ4U0Xi50H21y1yJikbHJGSausWdouD0wgM9DUBZtbB1mbgs3lP5sDJ9FZeHo6n99ybdMJ2yzi/QAAAABJRU5ErkJggg=="},623:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAC30lEQVR4AdyYgacqQRTGt1u0NmqhSyiAFFRAXEUICEHXA563KNiH9tK19cf3vjgexje7e+9p9m4NPxhzzpzzdXbmTJ7rcb1eW2AEFmALIhCDBKRCInORrFmITct7xIHAe2AN9uCiZC++elVPugnm4AAujjjIHs0qJe6DJfgAl5L4kD39n0y8BiYgyQn2DCIp4xkYgBAEoC4EMjeQNWuxOef4PkoMtbKT74DfGYGlYCcHma+srpH4Sm37SSydspLvi/IskE+wAoGDfQPx/ZlRDX3XyU9BainzDWiX8AO0Za+zpfKmLjZ9AWuL8r9A9wfOoK7szWJag5d7Jv9u2eitArfQmyW297uIYPnlT2BYoat4CE6sEtTfPHEag9cKNmKvICbxTjWnfUqSb1W4G20REVLQ/849fyRlz3/56lXCiVyRneIdHm9yhg/0GBtamqVaEeNJVU57B7fDpEjrmZj3fI7N5SuIWSn+SJ9wBH6WwZJ0eN0HFqBLOsal9T1PnrQb9wE797chT+kmWzgnD5v2EwjQJg+oOVt4MBatPAxFwGcwvsNhNs76X6Cgj5VhdzAX9EjzECgF0IlAklcIEJCmrpfV7++KB0mTVovAkmdifMHfzvpOIP/ejhQCjLUiZPlQCDAybPf/+2eykV/YMQlIIUKurUIAn/htMWX+eBgaAb4pQr6NQgCxjcxKv00u+LehECA7oRg0iJ8GiO3J6wUgZ93iNrk1Jmd6Aawi/AVhhq9Q1vBq0QswM+y3rCwGnnZwEWKaPBchBmMHcQyMXCOPlF3o6HXW0K9VxxCan6NHXn+B96TjlpuRa+KRDqn+xALUzY73X/v2UQAgDMBQVA+yKqH+L9zZezRPAnQn//sBlkD6JugYdBFyFe5G0yLoMeQ5nByIiMSEomJxxYhqTDk6PitrQD0OkIDIgKRgckBJqCxYGi5PmKDMkKbOa3N1QyhSDmhz5WVtjjhJnSVPB+jzPZGAyclJbc34AAAAAElFTkSuQmCC"},624:function(t,e,n){!function(){"use strict";var e="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=t.exports,r="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,i=function(){for(var t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=n.length,o={};r<i;r++)if((t=n[r])&&t[1]in e){for(r=0;r<t.length;r++)o[n[0][r]]=t[r];return o}return!1}(),o={change:i.fullscreenchange,error:i.fullscreenerror},s={request:function(t){var n=i.requestFullscreen;t=t||e.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?t[n]():t[n](r?Element.ALLOW_KEYBOARD_INPUT:{})},exit:function(){e[i.exitFullscreen]()},toggle:function(t){this.isFullscreen?this.exit():this.request(t)},onchange:function(t){this.on("change",t)},onerror:function(t){this.on("error",t)},on:function(t,n){var r=o[t];r&&e.addEventListener(r,n,!1)},off:function(t,n){var r=o[t];r&&e.removeEventListener(r,n,!1)},raw:i};i?(Object.defineProperties(s,{isFullscreen:{get:function(){return Boolean(e[i.fullscreenElement])}},element:{enumerable:!0,get:function(){return e[i.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(e[i.fullscreenEnabled])}}}),n?t.exports=s:window.screenfull=s):n?t.exports=!1:window.screenfull=!1}()},625:function(t,e,n){"use strict";var r=n(84),i=n(27),o=n.n(i),s=n(486),a=n(492),u=n.n(a),c=n(68);e.a=class{constructor(t,e,{keysoundCache:n=s.a}={}){this._assets=t,this._master=e,this._keysoundCache=n}loadFiles(t,e,n){const i=r.c(t.length,e),s=r.c(t.length,n);return n&&(n.formatter=c.b),u()(t,(t=>new Promise((e=>{requestAnimationFrame((()=>{e(this._loadSample(t,i,s))}))}))),{concurrency:64}).then((t=>o()(t).filter().fromPairs().value()))}async _loadSample(t,e,n){const r=(async()=>{if(this._keysoundCache.isCached(t)){const r=await this._keysoundCache.get(t);return e(t),n(t),r}const r=await this._getFile(t),i=await r.read();e(t);const o=await this._decode(i);return this._keysoundCache.cache(t,o),n(t),o})();try{const e=await r,n=await this._master.sample(e);return[t,n]}catch(e){return console.error("Unable to load keysound: "+t,e),null}}_decode(t){return this._master.decode(t)}_getFile(t){return t=t.replace(/\\/g,"/"),this._assets.file(t.replace(/\.\w+$/,".ogg")).catch((()=>this._assets.file(t.replace(/\.\w+$/,".m4a")))).catch((()=>this._assets.file(t.replace(/\.\w+$/,".mp3")))).catch((()=>this._assets.file(t)))}}},67:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return g})),n.d(e,"g",(function(){return y})),n.d(e,"f",(function(){return v})),n.d(e,"h",(function(){return _})),n.d(e,"e",(function(){return w})),n.d(e,"c",(function(){return S})),n.d(e,"i",(function(){return E}));var r,i=n(27),o=n.n(i);!function(t){t[t.Missed=-1]="Missed",t[t.Unjudged=0]="Unjudged",t[t.Meticulous=1]="Meticulous",t[t.Precise=2]="Precise",t[t.Good=3]="Good",t[t.Offbeat=4]="Offbeat"}(r||(r={}));const s=r.Unjudged,a=r.Missed,u=[{value:1,timegate:.02,endTimegate:.04},{value:2,timegate:.05,endTimegate:.1},{value:3,timegate:.1,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}],c=[{value:1,timegate:.021,endTimegate:.042},{value:2,timegate:.06,endTimegate:.12},{value:3,timegate:.12,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}],l=[{value:1,timegate:.022,endTimegate:.044},{value:2,timegate:.07,endTimegate:.14},{value:3,timegate:.14,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}],h=[{value:1,timegate:.023,endTimegate:.046},{value:2,timegate:.08,endTimegate:.16},{value:3,timegate:.16,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}],f=[{value:1,timegate:.024,endTimegate:.048},{value:2,timegate:.1,endTimegate:.18},{value:3,timegate:.18,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}];class p{constructor(t){this.timegates=t}getTimegates(t,e){return this.timegates}}class d{getTimegates(t,e){return!e||e<100?f:u}}const m=new p(u);function g(t,{tutorial:e=!1}){const n=t.songInfo,r=n.difficulty>=5;return e?new d:r?m:1===n.level||2===n.level?new p(f):3===n.level?new p(h):4===n.level?new p(l):5===n.level?new p(c):m}function b(t){return function(e,n,r=m){const i=r.getTimegates(e,n),o=Math.abs(e-n);for(let e=0;e<i.length;e++)if(o<t(i[e]))return i[e].value;return e<n?s:a}}const y=b((t=>t.timegate)),v=b((t=>t.endTimegate));function _(t,e=m){return o.a.find(e.getTimegates(null,null),{value:t}).timegate}function w(t){return t>=4}function S(t){return t===a||w(t)}function E(t){return 1===t?100:2===t?80:3===t?50:0}},68:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return u}));var r=n(166),i=n.n(r);const o=t=>e=>null!==e.progress?t(e):"",s=o((t=>i()(t.current)+" / "+i()(t.total))),a=o((t=>(t.current/t.total*100).toFixed(1)+"%")),u=o((t=>t.extra+""))},72:function(t,e,n){(function(t,r){var i;(function(){var o=Array.prototype.slice,s={toString:function(){return"Bacon"},version:"0.7.95"},a=(null!=t?t:this).Error,u=function(){},c=function(t,e){return t},l=function(t,e){if(!e)throw new a(t)},h=function(t){if((null!=t?t._isObservable:void 0)&&!(null!=t?t._isProperty:void 0))throw new a("Observable is not a Property : "+t)},f=function(t){return l("not a function : "+t,v.isFunction(t))},p=Array.isArray||function(t){return t instanceof Array},d=function(t){return t&&t._isObservable},m=function(t){return l("no arguments supported",0===t.length)},g=function(t){for(var e=arguments.length,n=1;1<e?n<e:n>e;1<e?n++:n--)for(var r in arguments[n])t[r]=arguments[n][r];return t},b=function(t,e){var n={}.hasOwnProperty,r=function(){};for(var i in r.prototype=e.prototype,t.prototype=new r,e)n.call(e,i)&&(t[i]=e[i]);return t},y=function(t){return"undefined"!=typeof Symbol&&Symbol[t]?Symbol[t]:"undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol[t]=Symbol.for(t):"@@"+t},v={indexOf:Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1},indexWhere:function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1},head:function(t){return t[0]},always:function(t){return function(){return t}},negate:function(t){return function(e){return!t(e)}},empty:function(t){return 0===t.length},tail:function(t){return t.slice(1,t.length)},filter:function(t,e){for(var n,r=[],i=0;i<e.length;i++)t(n=e[i])&&r.push(n);return r},map:function(t,e){return function(){for(var n,r=[],i=0;i<e.length;i++)n=e[i],r.push(t(n));return r}()},each:function(t,e){for(var n in t){if(Object.prototype.hasOwnProperty.call(t,n))e(n,t[n])}},toArray:function(t){return p(t)?t:[t]},contains:function(t,e){return-1!==v.indexOf(t,e)},id:function(t){return t},last:function(t){return t[t.length-1]},all:function(t){for(var e=arguments.length<=1||void 0===arguments[1]?v.id:arguments[1],n=0;n<t.length;n++)if(!e(t[n]))return!1;return!0},any:function(t){for(var e=arguments.length<=1||void 0===arguments[1]?v.id:arguments[1],n=0;n<t.length;n++)if(e(t[n]))return!0;return!1},without:function(t,e){return v.filter((function(e){return e!==t}),e)},remove:function(t,e){var n=v.indexOf(e,t);if(n>=0)return e.splice(n,1)},fold:function(t,e,n){for(var r=0;r<t.length;r++)e=n(e,t[r]);return e},flatMap:function(t,e){return v.fold(e,[],(function(e,n){return e.concat(t(n))}))},cached:function(t){var e=R;return function(){return(null!=e?e._isNone:void 0)&&(e=t(),t=void 0),e}},bind:function(t,e){return function(){return t.apply(e,arguments)}},isFunction:function(t){return"function"==typeof t},toString:function(t){var e,n,r={}.hasOwnProperty;try{return _++,null==t?"undefined":v.isFunction(t)?"function":p(t)?_>5?"[..]":"["+v.map(v.toString,t).toString()+"]":null!=(null!=t?t.toString:void 0)&&t.toString!==Object.prototype.toString?t.toString():"object"==typeof t?_>5?"{..}":"{"+function(){var i=[];for(e in t)r.call(t,e)&&(n=function(){var n;try{return t[e]}catch(n){return n}}(),i.push(v.toString(e)+":"+v.toString(n)));return i}()+"}":t}finally{_--}}},_=0;s._=v;var w=s.UpdateBarrier=function(){var t,e=[],n={},r=[],i=0,o={};function a(t){t<=i||(r[t-1]||(r[t-1]=[[],0]),i=t)}var u=function(e,n){if(!t&&!r.length)return n();a(1);for(var o=0;o<i-1&&!c(e,r[o][0]);)o++;r[o][0].push([e,n]),t||l()};function c(t,e){for(var n=0;n<e.length;n++)if(e[n][0].id==t.id)return!0;return!1}function l(){var t=i;if(t)for(;i>=t;){var e=r[i-1];if(!e)throw new q("Unexpected stack top: "+e);var n=e[0],o=e[1];if(!(o<n.length)){e[0]=[],e[1]=0;break}var s=n[o],u=(s[0],s[1]);e[1]++,a(i+1);var c=!1;try{for(u(),c=!0;i>t&&0==r[i-1][0].length;)i--}finally{c||(r=[],i=0)}}}var h=function(t,r){var i=e[t],o=i.id,s=n[o];e.splice(t,1),delete n[o],r&&e.length>0&&f(i);for(var a=0;a<s.length;a++)(0,s[a])()},f=function(t){if(!o[t.id]){for(var r,i=t.internalDeps(),s=0;s<i.length;s++)if(r=i[s],f(r),n[r.id]){var a=v.indexOf(e,r);h(a,!1)}o[t.id]=!0}};return{whenDoneWith:function(r,i){if(t){var o=n[r.id];return null==o?(o=n[r.id]=[i],e.push(r)):o.push(i)}return i()},hasWaiters:function(){return e.length>0},inTransaction:function(n,r,i,s){if(t)return i.apply(r,s);t=n;try{var a=i.apply(r,s);!function(){for(;e.length>0;)h(0,!0);o={}}()}finally{t=void 0,l()}return a},currentEventId:function(){return t?t.id:void 0},wrappedSubscribe:function(t,e){var n=!1,r=!1,i=function(){return r=!0},o=function(){return n=!0,i()};return i=t.dispatcher.subscribe((function(r){return u(t,(function(){if(!n&&e(r)===s.noMore)return o()}))})),r&&i(),o},afterTransaction:u}}();function S(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];this.obs=t,this.sync=e,this.lazy=n,this.queue=[]}function E(){S.apply(this,arguments)}function x(t){S.call(this,t,!0)}function A(t,e,n){this.context=t,this.method=e,this.args=n}g(S.prototype,{_isSource:!0,subscribe:function(t){return this.obs.dispatcher.subscribe(t)},toString:function(){return this.obs.toString()},markEnded:function(){return this.ended=!0,!0},consume:function(){return this.lazy?{value:v.always(this.queue[0])}:this.queue[0]},push:function(t){return this.queue=[t],[t]},mayHave:function(){return!0},hasAtLeast:function(){return this.queue.length},flatten:!0}),b(E,S),g(E.prototype,{consume:function(){return this.queue.shift()},push:function(t){return this.queue.push(t)},mayHave:function(t){return!this.ended||this.queue.length>=t},hasAtLeast:function(t){return this.queue.length>=t},flatten:!1}),b(x,S),g(x.prototype,{consume:function(){var t=this.queue;return this.queue=[],{value:function(){return t}}},push:function(t){return this.queue.push(t.value())},hasAtLeast:function(){return!0}}),S.isTrigger=function(t){return(null!=t?t._isSource:void 0)?t.sync:null!=t?t._isEventStream:void 0},S.fromObservable=function(t){return(null!=t?t._isSource:void 0)?t:(null!=t?t._isProperty:void 0)?new S(t,!1):new E(t,!0)},g(A.prototype,{_isDesc:!0,deps:function(){return this.cached||(this.cached=M([this.context].concat(this.args))),this.cached},toString:function(){return v.toString(this.context)+"."+v.toString(this.method)+"("+v.map(v.toString,this.args)+")"}});var k=function(t,e){var n=t||e;if(n&&n._isDesc)return t||e;for(var r=arguments.length,i=Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return new A(t,e,i)},O=function(t,e){return e.desc=t,e},M=function(t){return p(t)?v.flatMap(M,t):d(t)?[t]:(null!=t?t._isSource:void 0)?[t.obs]:[]};s.Desc=A,s.Desc.empty=new s.Desc("","",[]);var j=function(t){return function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if("object"==typeof e&&r.length){var o=e,s=r[0];e=function(){return o[s].apply(o,arguments)},r=r.slice(1)}return t.apply(void 0,[e].concat(r))}},C=function(t){return t=Array.prototype.slice.call(t),D.apply(void 0,t)},P=function(t,e){return function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.apply(void 0,e.concat(r))}},T=function(t,e){var n=t.slice(1).split("."),r=v.map(function(t){return function(e){return function(n){if(null!=n){var r=n[e];return v.isFunction(r)?r.apply(n,t):r}}}}(e),n);return function(t){for(var e=0;e<r.length;e++)t=(0,r[e])(t);return t}},I=function(t){return"string"==typeof t&&t.length>1&&"."===t.charAt(0)},D=j((function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return v.isFunction(t)?n.length?P(t,n):t:I(t)?T(t,n):v.always(t)})),B=function(t,e){return D.apply(void 0,[t].concat(e))},N=function(t,e,n,r){if(null!=e?e._isProperty:void 0){var i=e.sampledBy(t,(function(t,e){return[t,e]}));return r.call(i,(function(t){var e=t[0];t[1];return e})).map((function(t){t[0];return t[1]}))}return e=B(e,n),r.call(t,e)},L=function(t){if(v.isFunction(t))return t;if(I(t)){var e=F(t);return function(t,n){return t[e](n)}}throw new a("not a function or a field key: "+t)},F=function(t){return t.slice(1)};function U(t){this.value=t}g(U.prototype,{_isSome:!0,getOrElse:function(){return this.value},get:function(){return this.value},filter:function(t){return t(this.value)?new U(this.value):R},map:function(t){return new U(t(this.value))},forEach:function(t){return t(this.value)},isDefined:!0,toArray:function(){return[this.value]},inspect:function(){return"Some("+this.value+")"},toString:function(){return this.inspect()}});var R={_isNone:!0,getOrElse:function(t){return t},filter:function(){return R},map:function(){return R},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},z=function(t){return(null!=t?t._isSome:void 0)||(null!=t?t._isNone:void 0)?t:new U(t)};s.noMore="<no-more>",s.more="<more>";var G=0;function H(){this.id=++G}function W(t,e){if(!(this instanceof W))return new W(t,e);H.call(this),!e&&v.isFunction(t)||(null!=t?t._isNext:void 0)?(this.valueF=t,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=t)}function $(t,e){if(!(this instanceof $))return new $(t,e);W.call(this,t,e)}function V(){if(!(this instanceof V))return new V;H.call(this)}function q(t){if(!(this instanceof q))return new q(t);this.error=t,H.call(this)}H.prototype._isEvent=!0,H.prototype.isEvent=function(){return!0},H.prototype.isEnd=function(){return!1},H.prototype.isInitial=function(){return!1},H.prototype.isNext=function(){return!1},H.prototype.isError=function(){return!1},H.prototype.hasValue=function(){return!1},H.prototype.filter=function(){return!0},H.prototype.inspect=function(){return this.toString()},H.prototype.log=function(){return this.toString()},b(W,H),W.prototype.isNext=function(){return!0},W.prototype.hasValue=function(){return!0},W.prototype.value=function(){var t;return(null!=(t=this.valueF)?t._isNext:void 0)?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},W.prototype.fmap=function(t){var e,n;return this.valueInternal?(n=this.valueInternal,this.apply((function(){return t(n)}))):(e=this,this.apply((function(){return t(e.value())})))},W.prototype.apply=function(t){return new W(t)},W.prototype.filter=function(t){return t(this.value())},W.prototype.toString=function(){return v.toString(this.value())},W.prototype.log=function(){return this.value()},W.prototype._isNext=!0,b($,W),$.prototype._isInitial=!0,$.prototype.isInitial=function(){return!0},$.prototype.isNext=function(){return!1},$.prototype.apply=function(t){return new $(t)},$.prototype.toNext=function(){return new W(this)},b(V,H),V.prototype.isEnd=function(){return!0},V.prototype.fmap=function(){return this},V.prototype.apply=function(){return this},V.prototype.toString=function(){return"<end>"},b(q,H),q.prototype.isError=function(){return!0},q.prototype.fmap=function(){return this},q.prototype.apply=function(){return this},q.prototype.toString=function(){return"<error> "+v.toString(this.error)},s.Event=H,s.Initial=$,s.Next=W,s.End=V,s.Error=q;var J=function(t){return new $(t,!0)},K=function(t){return new W(t,!0)},Q=function(){return new V},Y=function(t){return t&&t._isEvent?t:K(t)},X=0,Z=function(){};function tt(t){this.desc=t,this.id=++X,this.initialDesc=this.desc}function et(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];this.unsubscribe=v.bind(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[];for(var e,n=0;n<t.length;n++)e=t[n],this.add(e)}function nt(t,e){this._subscribe=t,this._handleEvent=e,this.subscribe=v.bind(this.subscribe,this),this.handleEvent=v.bind(this.handleEvent,this),this.pushing=!1,this.ended=!1,this.prevError=void 0,this.unsubSrc=void 0,this.subscriptions=[],this.queue=[]}function rt(t,e,n){if(!(this instanceof rt))return new rt(t,e,n);v.isFunction(t)&&(n=e,e=t,t=A.empty),tt.call(this,t),f(e),this.dispatcher=new nt(e,n),Z(this)}g(tt.prototype,{_isObservable:!0,subscribe:function(t){return w.wrappedSubscribe(this,t)},subscribeInternal:function(t){return this.dispatcher.subscribe(t)},onValue:function(){var t=C(arguments);return this.subscribe((function(e){if(e.hasValue())return t(e.value())}))},onValues:function(t){return this.onValue((function(e){return t.apply(void 0,e)}))},onError:function(){var t=C(arguments);return this.subscribe((function(e){if(e.isError())return t(e.error)}))},onEnd:function(){var t=C(arguments);return this.subscribe((function(e){if(e.isEnd())return t()}))},name:function(t){return this._name=t,this},withDescription:function(){return this.desc=k.apply(void 0,arguments),this},toString:function(){return this._name?this._name:this.desc.toString()},deps:function(){return this.desc.deps()},internalDeps:function(){return this.initialDesc.deps()}}),tt.prototype.assign=tt.prototype.onValue,tt.prototype.forEach=tt.prototype.onValue,tt.prototype.inspect=tt.prototype.toString,s.Observable=tt,g(et.prototype,{add:function(t){var e=this;if(!this.unsubscribed){var n=!1,r=u;this.starting.push(t);return r=t(this.unsubscribe,(function(){if(!e.unsubscribed)return n=!0,e.remove(r),v.remove(t,e.starting)})),this.unsubscribed||n?r():this.subscriptions.push(r),v.remove(t,this.starting),r}},remove:function(t){if(!this.unsubscribed)return void 0!==v.remove(t,this.subscriptions)?t():void 0},unsubscribe:function(){if(!this.unsubscribed){this.unsubscribed=!0;for(var t=this.subscriptions,e=0;e<t.length;e++)t[e]();return this.subscriptions=[],this.starting=[],[]}},count:function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},empty:function(){return 0===this.count()}}),s.CompositeUnsubscribe=et,nt.prototype.hasSubscribers=function(){return this.subscriptions.length>0},nt.prototype.removeSub=function(t){return this.subscriptions=v.without(t,this.subscriptions),this.subscriptions},nt.prototype.push=function(t){return t.isEnd()&&(this.ended=!0),w.inTransaction(t,this,this.pushIt,[t])},nt.prototype.pushToSubscriptions=function(t){try{for(var e=this.subscriptions,n=e.length,r=0;r<n;r++){var i=e[r];(i.sink(t)===s.noMore||t.isEnd())&&this.removeSub(i)}return!0}catch(t){throw this.pushing=!1,this.queue=[],t}},nt.prototype.pushIt=function(t){if(this.pushing)return this.queue.push(t),s.more;if(t!==this.prevError){for(t.isError()&&(this.prevError=t),this.pushing=!0,this.pushToSubscriptions(t),this.pushing=!1;this.queue.length;)t=this.queue.shift(),this.push(t);return this.hasSubscribers()?s.more:(this.unsubscribeFromSource(),s.noMore)}},nt.prototype.handleEvent=function(t){return this._handleEvent?this._handleEvent(t):this.push(t)},nt.prototype.unsubscribeFromSource=function(){this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},nt.prototype.subscribe=function(t){var e,n;return this.ended?(t(Q()),u):(f(t),e={sink:t},this.subscriptions.push(e),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),f(this.unsubSrc)),n=this,function(){if(n.removeSub(e),!n.hasSubscribers())return n.unsubscribeFromSource()})},s.Dispatcher=nt,b(rt,tt),g(rt.prototype,{_isEventStream:!0,toProperty:function(t){var e=0===arguments.length?R:z((function(){return t})),n=this.dispatcher,r=new s.Desc(this,"toProperty",[t]);return new at(r,(function(t){var r=!1,i=!1,o=u,a=s.more,c=function(){if(!r)return e.forEach((function(e){if(r=!0,(a=t(new $(e)))===s.noMore)return o(),o=u,u}))};return o=n.subscribe((function(n){return n.hasValue()?n.isInitial()&&!i?(e=new U((function(){return n.value()})),s.more):(n.isInitial()||c(),r=!0,e=new U(n),t(n)):(n.isEnd()&&(a=c()),a!==s.noMore?t(n):void 0)})),i=!0,c(),o}))},toEventStream:function(){return this},withHandler:function(t){return new rt(new s.Desc(this,"withHandler",[t]),this.dispatcher.subscribe,t)}}),s.EventStream=rt,s.never=function(){return new rt(k(s,"never"),(function(t){return t(Q()),u}))},s.when=function(){if(0===arguments.length)return s.never();var t=arguments.length,e="when: expecting arguments in the form (Observable+,function)+";l(e,t%2==0);for(var n=[],r=[],i=0,o=[];i<t;){o[i]=arguments[i],o[i+1]=arguments[i+1];for(var a,u=v.toArray(arguments[i]),c=ot(arguments[i+1]),h={f:c,ixs:[]},f=!1,p=0;p<u.length;p++){a=u[p];var d=v.indexOf(n,a);f||(f=S.isTrigger(a)),d<0&&(n.push(a),d=n.length-1);for(var m,g=0;g<h.ixs.length;g++)(m=h.ixs[g]).index===d&&m.count++;h.ixs.push({index:d,count:1})}l("At least one EventStream required",f||!u.length),u.length>0&&r.push(h),i+=2}if(!n.length)return s.never();n=v.map(S.fromObservable,n);var b=v.any(n,(function(t){return t.flatten}))&&it(v.map((function(t){return t.obs}),n)),y=new s.Desc(s,"when",o),_=new rt(y,(function(t){var e=[],i=!1,o=function(t){for(var e,r=0;r<t.ixs.length;r++)if(e=t.ixs[r],!n[e.index].hasAtLeast(e.count))return!1;return!0},a=function(t){return!t.sync||t.ended},u=function(t){for(var e,r=0;r<t.ixs.length;r++)if(e=t.ixs[r],!n[e.index].mayHave(e.count))return!0},c=function(t){return!t.source.flatten},l=function(l){return function(h){var f=function(){return w.whenDoneWith(_,d)},p=function(){if(!(e.length>0))return s.more;for(var i,a=s.more,u=e.pop(),l=0;l<r.length;l++)if(i=r[l],o(i)){var h=function(){for(var t,e=[],r=0;r<i.ixs.length;r++)t=i.ixs[r],e.push(n[t.index].consume());return e}();return a=t(u.e.apply((function(){var t,e=function(){for(var t,e=[],n=0;n<h.length;n++)t=h[n],e.push(t.value());return e}();return(t=i).f.apply(t,e)}))),e.length&&(e=v.filter(c,e)),a===s.noMore?a:p()}},d=function(){var e=p();return i&&(v.all(n,a)||v.all(r,u))&&(e=s.noMore,t(Q())),e===s.noMore&&h(),e};return l.subscribe((function(n){if(n.isEnd())i=!0,l.markEnded(),f();else if(n.isError())var r=t(n);else l.push(n),l.sync&&(e.push({source:l,e:n}),b||w.hasWaiters()?f():d());return r===s.noMore&&h(),r||s.more}))}};return new s.CompositeUnsubscribe(function(){for(var t,e=[],r=0;r<n.length;r++)t=n[r],e.push(l(t));return e}()).unsubscribe}));return _};var it=function(t){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],n=function(t){if(v.contains(e,t))return!0;var r=t.internalDeps();return r.length?(e.push(t),v.any(r,n)):(e.push(t),!1)};return v.any(t,n)},ot=function(t){return v.isFunction(t)?t:v.always(t)};function st(t,e,n){nt.call(this,e,n),this.property=t,this.subscribe=v.bind(this.subscribe,this),this.current=R,this.currentValueRootId=void 0,this.propertyEnded=!1}function at(t,e,n){tt.call(this,t),f(e),this.dispatcher=new st(this,e,n),Z(this)}s.groupSimultaneous=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];1===e.length&&p(e[0])&&(e=e[0]);var r=function(){for(var t,n=[],r=0;r<e.length;r++)t=e[r],n.push(new x(t));return n}();return O(new s.Desc(s,"groupSimultaneous",e),s.when(r,(function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e})))},b(st,nt),g(st.prototype,{push:function(t){return t.isEnd()&&(this.propertyEnded=!0),t.hasValue()&&(this.current=new U(t),this.currentValueRootId=w.currentEventId()),nt.prototype.push.call(this,t)},maybeSubSource:function(t,e){return e===s.noMore?u:this.propertyEnded?(t(Q()),u):nt.prototype.subscribe.call(this,t)},subscribe:function(t){var e=this,n=s.more;if(this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)){var r=w.currentEventId(),i=this.currentValueRootId;return!this.propertyEnded&&i&&r&&r!==i?(w.whenDoneWith(this.property,(function(){if(e.currentValueRootId===i)return t(J(e.current.get().value()))})),this.maybeSubSource(t,n)):(w.inTransaction(void 0,this,(function(){return n=t(J(this.current.get().value()))}),[]),this.maybeSubSource(t,n))}return this.maybeSubSource(t,n)}}),b(at,tt),g(at.prototype,{_isProperty:!0,changes:function(){var t=this;return new rt(new s.Desc(this,"changes",[]),(function(e){return t.dispatcher.subscribe((function(t){if(!t.isInitial())return e(t)}))}))},withHandler:function(t){return new at(new s.Desc(this,"withHandler",[t]),this.dispatcher.subscribe,t)},toProperty:function(){return m(arguments),this},toEventStream:function(){var t=this;return new rt(new s.Desc(this,"toEventStream",[]),(function(e){return t.dispatcher.subscribe((function(t){return t.isInitial()&&(t=t.toNext()),e(t)}))}))}}),s.Property=at,s.constant=function(t){return new at(new s.Desc(s,"constant",[t]),(function(e){return e(J(t)),e(Q()),u}))},s.fromBinder=function(t){var e=arguments.length<=1||void 0===arguments[1]?v.id:arguments[1],n=new s.Desc(s,"fromBinder",[t,e]);return new rt(n,(function(n){var r=!1,i=!1,o=function(){if(!r)return null!=a?(a(),r=!0):i=!0},a=t((function(){for(var t,r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var u=e.apply(this,i);p(u)&&(null!=(t=v.last(u))?t._isEvent:void 0)||(u=[u]);for(var c,l=s.more,h=0;h<u.length;h++)if(c=u[h],(l=n(c=Y(c)))===s.noMore||c.isEnd())return o(),l;return l}));return i&&o(),o}))},s.Observable.prototype.map=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return N(this,t,n,(function(t){return O(new s.Desc(this,"map",[t]),this.withHandler((function(e){return this.push(e.fmap(t))})))}))};var ut=function(t){return p(t[0])?t[0]:Array.prototype.slice.call(t)},ct=function(t){return v.isFunction(t[0])?[ut(Array.prototype.slice.call(t,1)),t[0]]:[ut(Array.prototype.slice.call(t,0,t.length-1)),v.last(t)]};s.combineAsArray=function(){var t=ut(arguments);if(t.length){for(var e=[],n=0;n<t.length;n++){var r=d(t[n])?t[n]:s.constant(t[n]);e.push(new S(r,!0))}return O(new s.Desc(s,"combineAsArray",t),s.when(e,(function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e})).toProperty())}return s.constant([])},s.onValues=function(){return s.combineAsArray(Array.prototype.slice.call(arguments,0,arguments.length-1)).onValues(arguments[arguments.length-1])},s.combineWith=function(){var t=ct(arguments),e=t[0],n=t[1],r=new s.Desc(s,"combineWith",[n].concat(e));return O(r,s.combineAsArray(e).map((function(t){return n.apply(void 0,t)})))},s.Observable.prototype.combine=function(t,e){var n=L(e),r=new s.Desc(this,"combine",[t,e]);return O(r,s.combineAsArray(this,t).map((function(t){return n(t[0],t[1])})))},s.Observable.prototype.withStateMachine=function(t,e){var n=t,r=new s.Desc(this,"withStateMachine",[t,e]);return O(r,this.withHandler((function(t){var r=e(n,t),i=r[0],o=r[1];n=i;for(var a,u=s.more,c=0;c<o.length;c++)if(a=o[c],(u=this.push(a))===s.noMore)return u;return u})))};var lt=function(t,e){return t===e},ht=function(t){return null!=t&&t._isNone};s.Observable.prototype.skipDuplicates=function(){var t=arguments.length<=0||void 0===arguments[0]?lt:arguments[0],e=new s.Desc(this,"skipDuplicates",[]);return O(e,this.withStateMachine(R,(function(e,n){return n.hasValue()?n.isInitial()||ht(e)||!t(e.get(),n.value())?[new U(n.value()),[n]]:[e,[]]:[e,[n]]})))},s.Observable.prototype.awaiting=function(t){var e=new s.Desc(this,"awaiting",[t]);return O(e,s.groupSimultaneous(this,t).map((function(t){return 0===t[1].length})).toProperty(!1).skipDuplicates())},s.Observable.prototype.not=function(){return O(new s.Desc(this,"not",[]),this.map((function(t){return!t})))},s.Property.prototype.and=function(t){return O(new s.Desc(this,"and",[t]),this.combine(t,(function(t,e){return t&&e})))},s.Property.prototype.or=function(t){return O(new s.Desc(this,"or",[t]),this.combine(t,(function(t,e){return t||e})))},s.scheduler={setTimeout:function(t,e){return setTimeout(t,e)},setInterval:function(t,e){return setInterval(t,e)},clearInterval:function(t){return clearInterval(t)},clearTimeout:function(t){return clearTimeout(t)},now:function(){return(new Date).getTime()}},s.EventStream.prototype.bufferWithTime=function(t){return O(new s.Desc(this,"bufferWithTime",[t]),this.bufferWithTimeOrCount(t,Number.MAX_VALUE))},s.EventStream.prototype.bufferWithCount=function(t){return O(new s.Desc(this,"bufferWithCount",[t]),this.bufferWithTimeOrCount(void 0,t))},s.EventStream.prototype.bufferWithTimeOrCount=function(t,e){var n=function(n){return n.values.length===e?n.flush():void 0!==t?n.schedule():void 0},r=new s.Desc(this,"bufferWithTimeOrCount",[t,e]);return O(r,this.buffer(t,n,n))},s.EventStream.prototype.buffer=function(t){var e=arguments.length<=1||void 0===arguments[1]?u:arguments[1],n=arguments.length<=2||void 0===arguments[2]?u:arguments[2],r={scheduled:null,end:void 0,values:[],flush:function(){if(this.scheduled&&(s.scheduler.clearTimeout(this.scheduled),this.scheduled=null),this.values.length>0){var t=this.values;this.values=[];var e=this.push(K(t));if(null!=this.end)return this.push(this.end);if(e!==s.noMore)return n(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){var e=this;if(!this.scheduled)return this.scheduled=t((function(){return e.flush()}))}},i=s.more;if(!v.isFunction(t)){var o=t;t=function(t){return s.scheduler.setTimeout(t,o)}}return O(new s.Desc(this,"buffer",[]),this.withHandler((function(t){var n=this;return r.push=function(t){return n.push(t)},t.isError()?i=this.push(t):t.isEnd()?(r.end=t,r.scheduled||r.flush()):(r.values.push(t.value()),e(r)),i})))},s.Observable.prototype.filter=function(t){h(t);for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return N(this,t,n,(function(t){return O(new s.Desc(this,"filter",[t]),this.withHandler((function(e){return e.filter(t)?this.push(e):s.more})))}))},s.once=function(t){return new rt(new A(s,"once",[t]),(function(e){return e(Y(t)),e(Q()),u}))},s.EventStream.prototype.concat=function(t){var e=this;return new rt(new s.Desc(e,"concat",[t]),(function(n){var r=u,i=e.dispatcher.subscribe((function(e){return e.isEnd()?r=t.toEventStream().dispatcher.subscribe(n):n(e)}));return function(){return i(),r()}}))},s.Property.prototype.concat=function(t){return ft(this,this.changes().concat(t))},s.concatAll=function(){var t=ut(arguments);return t.length?O(new s.Desc(s,"concatAll",t),v.fold(v.tail(t),v.head(t).toEventStream(),(function(t,e){return t.concat(e)}))):s.never()};var ft=function(t,e){var n=new rt(k(t,"justInitValue"),(function(e){var r=void 0,i=t.dispatcher.subscribe((function(t){return t.isEnd()||(r=t),s.noMore}));return w.whenDoneWith(n,(function(){return null!=r&&e(r),e(Q())})),i}));return n.concat(e).toProperty()};s.Observable.prototype.flatMap=function(){return mt(this,pt(arguments))},s.Observable.prototype.flatMapFirst=function(){return mt(this,pt(arguments),!0)};var pt=function(t){return 1===t.length&&d(t[0])?v.always(t[0]):C(t)},dt=function(t){return d(t)?t:s.once(t)},mt=function(t,e,n,r){var i=[t],o=[],a=new rt(new s.Desc(t,"flatMap"+(n?"First":""),[e]),(function(i){var a=new et,u=[],c=function(t){var n=dt(e(t.value()));return o.push(n),a.add((function(t,e){return n.dispatcher.subscribe((function(r){if(r.isEnd())return v.remove(n,o),l(),h(e),s.noMore;(null!=r?r._isInitial:void 0)&&(r=r.toNext());var a=i(r);return a===s.noMore&&t(),a}))}))},l=function(){var t=u.shift();if(t)return c(t)},h=function(t){if(t(),a.empty())return i(Q())};return a.add((function(e,o){return t.dispatcher.subscribe((function(t){return t.isEnd()?h(o):t.isError()?i(t):n&&a.count()>1?s.more:a.unsubscribed?s.noMore:r&&a.count()>r?u.push(t):c(t)}))})),a.unsubscribe}));return a.internalDeps=function(){return o.length?i.concat(o):i},a};function gt(){if(!(this instanceof gt))return new gt;this.unsubAll=v.bind(this.unsubAll,this),this.subscribeAll=v.bind(this.subscribeAll,this),this.guardedSink=v.bind(this.guardedSink,this),this.sink=void 0,this.subscriptions=[],this.ended=!1,rt.call(this,new s.Desc(s,"Bus",[]),this.subscribeAll)}s.Observable.prototype.flatMapWithConcurrencyLimit=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=new s.Desc(this,"flatMapWithConcurrencyLimit",[t].concat(n));return O(i,mt(this,pt(n),!1,t))},s.Observable.prototype.flatMapConcat=function(){var t=new s.Desc(this,"flatMapConcat",Array.prototype.slice.call(arguments,0));return O(t,this.flatMapWithConcurrencyLimit.apply(this,[1].concat(o.call(arguments))))},s.later=function(t,e){return O(new s.Desc(s,"later",[t,e]),s.fromBinder((function(n){var r=s.scheduler.setTimeout((function(){return n([e,Q()])}),t);return function(){return s.scheduler.clearTimeout(r)}})))},s.Observable.prototype.bufferingThrottle=function(t){var e=new s.Desc(this,"bufferingThrottle",[t]);return O(e,this.flatMapConcat((function(e){return s.once(e).concat(s.later(t).filter(!1))})))},s.Property.prototype.bufferingThrottle=function(){return s.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()},b(gt,rt),g(gt.prototype,{unsubAll:function(){for(var t,e=this.subscriptions,n=0;n<e.length;n++)"function"==typeof(t=e[n]).unsub&&t.unsub()},subscribeAll:function(t){if(this.ended)t(Q());else{this.sink=t;for(var e,n=this.subscriptions.slice(0),r=0;r<n.length;r++)e=n[r],this.subscribeInput(e)}return this.unsubAll},guardedSink:function(t){var e=this;return function(n){return n.isEnd()?(e.unsubscribeInput(t),s.noMore):e.sink(n)}},subscribeInput:function(t){return t.unsub=t.input.dispatcher.subscribe(this.guardedSink(t.input)),t.unsub},unsubscribeInput:function(t){for(var e,n=this.subscriptions,r=0;r<n.length;r++)if((e=n[r]).input===t)return"function"==typeof e.unsub&&e.unsub(),void this.subscriptions.splice(r,1)},plug:function(t){var e=this;if(function(t){if(!(null!=t?t._isObservable:void 0))throw new a("not an Observable : "+t)}(t),!this.ended){var n={input:t};return this.subscriptions.push(n),void 0!==this.sink&&this.subscribeInput(n),function(){return e.unsubscribeInput(t)}}},end:function(){if(this.ended=!0,this.unsubAll(),"function"==typeof this.sink)return this.sink(Q())},push:function(t){if(!this.ended&&"function"==typeof this.sink){var e=!this.pushing;if(!e)return this.pushQueue||(this.pushQueue=[]),void this.pushQueue.push(t);this.pushing=!0;try{return this.sink(K(t))}finally{if(e&&this.pushQueue){for(var n=0;n<this.pushQueue.length;){t=this.pushQueue[n];this.sink(K(t)),n++}this.pushQueue=null}this.pushing=!1}}},error:function(t){if("function"==typeof this.sink)return this.sink(new q(t))}}),s.Bus=gt;var bt=function(t,e){return j((function(n){for(var r=P(e,[function(t,e){return n.apply(void 0,t.concat([e]))}]),i=arguments.length,o=Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return O(new s.Desc(s,t,[n].concat(o)),s.combineAsArray(o).flatMap(r))}))};s.fromCallback=bt("fromCallback",(function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return s.fromBinder((function(e){return B(t,n)(e),u}),(function(t){return[t,Q()]}))})),s.fromNodeCallback=bt("fromNodeCallback",(function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return s.fromBinder((function(e){return B(t,n)(e),u}),(function(t,e){return t?[new q(t),Q()]:[e,Q()]}))})),s.combineTemplate=function(t){function e(t,e,n){return(function(t){return t[t.length-1]}(t))[e]=n,n}function n(t){return p(t)?[]:{}}function r(t){if(d(t))return!0;if(t&&(t.constructor==Object||t.constructor==Array))for(var e in t){if(Object.prototype.hasOwnProperty.call(t,e))if(r(t[e]))return!0}}function i(t,i){if(d(i))u.push(i),a.push(function(t,n){return function(r,i){e(r,t,i[n])}}(t,u.length-1));else if(r(i)){a.push(function(t,r){return function(i){var o=n(r);e(i,t,o),i.push(o)}}(t,i)),o(i),a.push((function(t){t.pop()}))}else a.push(function(t,n){return function(r){e(r,t,n)}}(t,i))}function o(t){v.each(t,i)}var a=[],u=[],c=r(t)?(o(t),s.combineAsArray(u).map((function(e){for(var r=n(t),i=[r],o=0;o<a.length;o++)(0,a[o])(i,e);return r}))):s.constant(t);return O(new s.Desc(s,"combineTemplate",[t]),c)},s.Observable.prototype.mapEnd=function(){var t=C(arguments);return O(new s.Desc(this,"mapEnd",[t]),this.withHandler((function(e){return e.isEnd()?(this.push(K(t(e))),this.push(Q()),s.noMore):this.push(e)})))},s.Observable.prototype.skipErrors=function(){return O(new s.Desc(this,"skipErrors",[]),this.withHandler((function(t){return t.isError()?s.more:this.push(t)})))},s.EventStream.prototype.takeUntil=function(t){var e={};return O(new s.Desc(this,"takeUntil",[t]),s.groupSimultaneous(this.mapEnd(e),t.skipErrors()).withHandler((function(t){if(t.hasValue()){var n=t.value(),r=n[0];if(n[1].length)return this.push(Q());for(var i,o=s.more,a=0;a<r.length;a++)o=(i=r[a])===e?this.push(Q()):this.push(K(i));return o}return this.push(t)})))},s.Property.prototype.takeUntil=function(t){var e=this.changes().takeUntil(t);return O(new s.Desc(this,"takeUntil",[t]),ft(this,e))},s.Observable.prototype.flatMapLatest=function(){var t=pt(arguments),e=this.toEventStream();return O(new s.Desc(this,"flatMapLatest",[t]),e.flatMap((function(n){return dt(t(n)).takeUntil(e)})))},s.Property.prototype.delayChanges=function(t,e){return O(t,ft(this,e(this.changes())))},s.EventStream.prototype.delayChanges=function(t,e){return O(t,e(this))},s.Observable.prototype.delay=function(t){return this.delayChanges(new s.Desc(this,"delay",[t]),(function(e){return e.flatMap((function(e){return s.later(t,e)}))}))},s.Observable.prototype.debounce=function(t){return this.delayChanges(new s.Desc(this,"debounce",[t]),(function(e){return e.flatMapLatest((function(e){return s.later(t,e)}))}))},s.Observable.prototype.debounceImmediate=function(t){return this.delayChanges(new s.Desc(this,"debounceImmediate",[t]),(function(e){return e.flatMapFirst((function(e){return s.once(e).concat(s.later(t).filter(!1))}))}))},s.Observable.prototype.decode=function(t){return O(new s.Desc(this,"decode",[t]),this.combine(s.combineTemplate(t),(function(t,e){return e[t]})))},s.Observable.prototype.scan=function(t,e){var n,r=this;e=L(e);var i=z(t),o=!1;return n=new at(new s.Desc(this,"scan",[t,e]),(function(t){var a=!1,c=u,l=s.more,h=function(){if(!a)return i.forEach((function(e){if(a=o=!0,(l=t(new $((function(){return e}))))===s.noMore)return c(),c=u}))};return c=r.dispatcher.subscribe((function(n){if(n.hasValue()){if(o&&n.isInitial())return s.more;n.isInitial()||h(),a=o=!0;var r=i.getOrElse(void 0),u=e(r,n.value());return i=new U(u),t(n.apply((function(){return u})))}if(n.isEnd()&&(l=h()),l!==s.noMore)return t(n)})),w.whenDoneWith(n,h),c}))},s.Observable.prototype.diff=function(t,e){return e=L(e),O(new s.Desc(this,"diff",[t,e]),this.scan([t],(function(t,n){return[n,e(t[0],n)]})).filter((function(t){return 2===t.length})).map((function(t){return t[1]})))},s.Observable.prototype.doAction=function(){var t=C(arguments);return O(new s.Desc(this,"doAction",[t]),this.withHandler((function(e){return e.hasValue()&&t(e.value()),this.push(e)})))},s.Observable.prototype.doEnd=function(){var t=C(arguments);return O(new s.Desc(this,"doEnd",[t]),this.withHandler((function(e){return e.isEnd()&&t(),this.push(e)})))},s.Observable.prototype.doError=function(){var t=C(arguments);return O(new s.Desc(this,"doError",[t]),this.withHandler((function(e){return e.isError()&&t(e.error),this.push(e)})))},s.Observable.prototype.doLog=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return O(new s.Desc(this,"doLog",e),this.withHandler((function(t){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log&&console.log.apply(console,e.concat([t.log()])),this.push(t)})))},s.Observable.prototype.endOnError=function(t){null==t&&(t=!0);for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return N(this,t,n,(function(t){return O(new s.Desc(this,"endOnError",[]),this.withHandler((function(e){return e.isError()&&t(e.error)?(this.push(e),this.push(Q())):this.push(e)})))}))},tt.prototype.errors=function(){return O(new s.Desc(this,"errors",[]),this.filter((function(){return!1})))},s.Observable.prototype.take=function(t){return t<=0?s.never():O(new s.Desc(this,"take",[t]),this.withHandler((function(e){return e.hasValue()?--t>0?this.push(e):(0===t&&this.push(e),this.push(Q()),s.noMore):this.push(e)})))},s.Observable.prototype.first=function(){return O(new s.Desc(this,"first",[]),this.take(1))},s.Observable.prototype.mapError=function(){var t=C(arguments);return O(new s.Desc(this,"mapError",[t]),this.withHandler((function(e){return e.isError()?this.push(K(t(e.error))):this.push(e)})))},s.Observable.prototype.flatMapError=function(t){var e=new s.Desc(this,"flatMapError",[t]);return O(e,this.mapError((function(t){return new q(t)})).flatMap((function(e){return e instanceof q?t(e.error):s.once(e)})))},s.EventStream.prototype.flatScan=function(t,e){var n=t;return this.flatMapConcat((function(t){return dt(e(n,t)).doAction((function(t){return n=t}))})).toProperty(t)},s.EventStream.prototype.sampledBy=function(t,e){return O(new s.Desc(this,"sampledBy",[t,e]),this.toProperty().sampledBy(t,e))},s.Property.prototype.sampledBy=function(t,e){var n=!1;null!=e?e=L(e):(n=!0,e=function(t){return t.value()});var r=new S(this,!1,n),i=new S(t,!0,n),o=s.when([r,i],e),a=t._isProperty?o.toProperty():o;return O(new s.Desc(this,"sampledBy",[t,e]),a)},s.Property.prototype.sample=function(t){return O(new s.Desc(this,"sample",[t]),this.sampledBy(s.interval(t,{})))},s.Observable.prototype.map=function(t){if(t&&t._isProperty)return t.sampledBy(this,c);for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return N(this,t,n,(function(t){return O(new s.Desc(this,"map",[t]),this.withHandler((function(e){return this.push(e.fmap(t))})))}))},s.Observable.prototype.fold=function(t,e){return O(new s.Desc(this,"fold",[t,e]),this.scan(t,e).sampledBy(this.filter(!1).mapEnd().toProperty()))},tt.prototype.reduce=tt.prototype.fold;var yt=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]];function vt(t){return[t,Q()]}s.fromEventTarget=function(t,e,n){var r=function(t){for(var e,n=0;n<yt.length;n++){var r=[t[(e=yt[n])[0]],t[e[1]]];if(r[0]&&r[1])return r}for(var i=0;i<yt.length;i++){var o=t[(e=yt[i])[0]];if(o)return[o,function(){}]}throw new q("No suitable event methods in "+t)}(t),i=r[0],o=r[1],a=new s.Desc(s,"fromEvent",[t,e]);return O(a,s.fromBinder((function(n){return i.call(t,e,n),function(){return o.call(t,e,n)}}),n))},s.fromEvent=s.fromEventTarget,s.fromPoll=function(t,e){var n=new s.Desc(s,"fromPoll",[t,e]);return O(n,s.fromBinder((function(e){var n=s.scheduler.setInterval(e,t);return function(){return s.scheduler.clearInterval(n)}}),e))},s.fromPromise=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?vt:arguments[2];return O(new s.Desc(s,"fromPromise",[t]),s.fromBinder((function(n){var r=t.then(n,(function(t){return n(new q(t))}));return r&&"function"==typeof r.done&&r.done(),e?function(){if("function"==typeof t.abort)return t.abort()}:function(){}}),n))},s.Observable.prototype.groupBy=function(t){var e=arguments.length<=1||void 0===arguments[1]?s._.id:arguments[1],n={},r=this;return r.filter((function(e){return!n[t(e)]})).map((function(i){var o=t(i),a=r.filter((function(e){return t(e)===o})),u=s.once(i).concat(a),c=e(u,i).withHandler((function(t){if(this.push(t),t.isEnd())return delete n[o]}));return n[o]=c,c}))},s.fromArray=function(t){if(function(t){if(!p(t))throw new a("not an array : "+t)}(t),t.length){var e=0,n=new rt(new s.Desc(s,"fromArray",[t]),(function(r){var i=!1,o=s.more,a=!1,u=!1;return function c(){if(u=!0,!a){for(a=!0;u;)if(u=!1,o!==s.noMore&&!i){var l=t[e++];(o=r(Y(l)))!==s.noMore&&(e===t.length?r(Q()):w.afterTransaction(n,c))}return a=!1}}(),function(){return i=!0}}));return n}return O(new s.Desc(s,"fromArray",t),s.never())},s.EventStream.prototype.holdWhen=function(t){var e=!1,n=[],r=this,i=!1;return new rt(new s.Desc(this,"holdWhen",[t]),(function(o){var s=new et,a=!1,u=function(t){if("function"==typeof t&&t(),s.empty()&&a)return o(Q())};return s.add((function(r,s){return t.subscribeInternal((function(t){if(!t.hasValue())return t.isEnd()?u(s):o(t);if(!(e=t.value())){var r=n;return n=[],function(){for(var t,e=[],n=0;n<r.length;n++)t=r[n],e.push(o(K(t)));return i&&(e.push(o(Q())),s()),e}()}}))})),s.add((function(t,s){return r.subscribeInternal((function(t){return e&&t.hasValue()?n.push(t.value()):t.isEnd()&&n.length?(i=!0,u(s)):o(t)}))})),a=!0,u(),s.unsubscribe}))},s.interval=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return O(new s.Desc(s,"interval",[t,e]),s.fromPoll(t,(function(){return K(e)})))},s.$={},s.$.asEventStream=function(t,e,n){var r=this;return v.isFunction(e)&&(n=e,e=void 0),O(new s.Desc(this.selector||this,"asEventStream",[t]),s.fromBinder((function(n){return r.on(t,e,n),function(){return r.off(t,e,n)}}),n))},"undefined"!=typeof jQuery&&jQuery&&(jQuery.fn.asEventStream=s.$.asEventStream),"undefined"!=typeof Zepto&&Zepto&&(Zepto.fn.asEventStream=s.$.asEventStream),s.Observable.prototype.last=function(){var t;return O(new s.Desc(this,"last",[]),this.withHandler((function(e){if(e.isEnd())return t&&this.push(t),this.push(Q()),s.noMore;t=e})))},s.Observable.prototype.log=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.subscribe((function(t){"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,e.concat([t.log()]))})),this},s.EventStream.prototype.merge=function(t){!function(t){if(!(null!=t?t._isEventStream:void 0))throw new a("not an EventStream : "+t)}(t);return O(new s.Desc(this,"merge",[t]),s.mergeAll(this,t))},s.mergeAll=function(){var t=ut(arguments);return t.length?new rt(new s.Desc(s,"mergeAll",t),(function(e){var n=0,r=v.map((function(r){return function(i){return r.dispatcher.subscribe((function(r){if(r.isEnd())return++n===t.length?e(Q()):s.more;var o=e(r);return o===s.noMore&&i(),o}))}}),t);return new s.CompositeUnsubscribe(r).unsubscribe})):s.never()},s.repeatedly=function(t,e){var n=0;return O(new s.Desc(s,"repeatedly",[t,e]),s.fromPoll(t,(function(){return e[n++%e.length]})))},s.repeat=function(t){var e=0;return s.fromBinder((function(n){var r=!1,i=s.more,o=function(){};function a(t){return t.isEnd()?r?u():r=!0:i=n(t)}function u(){var u;for(r=!0;r&&i!==s.noMore;)u=t(e++),r=!1,u?o=u.subscribeInternal(a):n(Q());return r=!0}return u(),function(){return o()}}))},s.retry=function(t){if(!v.isFunction(t.source))throw new a("'source' option has to be a function");var e=t.source,n=t.retries||0,r=0,i=t.delay||function(){return 0},o=t.isRetryable||function(){return!0},u=!1,c=null;return O(new s.Desc(s,"retry",[t]),s.repeat((function(t){function a(){return e(t).endOnError().withHandler((function(t){return t.isError()?o((c=t).error)&&(0===n||r<n)?void 0:(u=!0,this.push(t)):(t.hasValue()&&(c=null,u=!0),this.push(t))}))}if(u)return null;if(c){var l={error:c.error,retriesDone:r},h=s.later(i(l)).filter(!1);return r++,h.concat(s.once().flatMap(a))}return a()})))},s.sequentially=function(t,e){var n=0;return O(new s.Desc(s,"sequentially",[t,e]),s.fromPoll(t,(function(){var t=e[n++];return n<e.length?t:n===e.length?[t,Q()]:Q()})))},s.Observable.prototype.skip=function(t){return O(new s.Desc(this,"skip",[t]),this.withHandler((function(e){return e.hasValue()&&t>0?(t--,s.more):this.push(e)})))},s.EventStream.prototype.skipUntil=function(t){var e=t.take(1).map(!0).toProperty(!1);return O(new s.Desc(this,"skipUntil",[t]),this.filter(e))},s.EventStream.prototype.skipWhile=function(t){h(t);for(var e=!1,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return N(this,t,r,(function(t){return O(new s.Desc(this,"skipWhile",[t]),this.withHandler((function(n){return!e&&n.hasValue()&&t(n.value())?s.more:(n.hasValue()&&(e=!0),this.push(n))})))}))},s.Observable.prototype.slidingWindow=function(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return O(new s.Desc(this,"slidingWindow",[t,e]),this.scan([],(function(e,n){return e.concat([n]).slice(-t)})).filter((function(t){return t.length>=e})))};var _t=[];Z=function(t){if(_t.length&&!Z.running)try{Z.running=!0,_t.forEach((function(e){e(t)}))}finally{delete Z.running}};function wt(t){this.observable=t}s.spy=function(t){return _t.push(t)},s.Property.prototype.startWith=function(t){return O(new s.Desc(this,"startWith",[t]),this.scan(t,(function(t,e){return e})))},s.EventStream.prototype.startWith=function(t){return O(new s.Desc(this,"startWith",[t]),s.once(t).concat(this))},s.Observable.prototype.takeWhile=function(t){h(t);for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return N(this,t,n,(function(t){return O(new s.Desc(this,"takeWhile",[t]),this.withHandler((function(e){return e.filter(t)?this.push(e):(this.push(Q()),s.noMore)})))}))},s.Observable.prototype.throttle=function(t){return this.delayChanges(new s.Desc(this,"throttle",[t]),(function(e){return e.bufferWithTime(t).map((function(t){return t[t.length-1]}))}))},tt.prototype.firstToPromise=function(t){var e=this;if("function"!=typeof t){if("function"!=typeof Promise)throw new a("There isn't default Promise, use shim or parameter");t=Promise}return new t((function(t,n){return e.subscribe((function(e){return e.hasValue()&&t(e.value()),e.isError()&&n(e.error),s.noMore}))}))},tt.prototype.toPromise=function(t){return this.last().firstToPromise(t)},s.try=function(t){return function(e){try{return s.once(t(e))}catch(t){return new s.Error(t)}}},s.update=function(t){function e(t){return function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(e){return t.apply(void 0,[e].concat(n))}}}for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=r.length-1;o>0;)r[o]instanceof Function||(r[o]=v.always(r[o])),r[o]=e(r[o]),o-=2;return O(new s.Desc(s,"update",[t].concat(r)),s.when.apply(s,r).scan(t,(function(t,e){return e(t)})))},s.zipAsArray=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=ut(e);return O(new s.Desc(s,"zipAsArray",r),s.zipWith(r,(function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e})))},s.zipWith=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=ct(e),i=r[0],o=r[1];return i=v.map((function(t){return t.toEventStream()}),i),O(new s.Desc(s,"zipWith",[o].concat(i)),s.when(i,o))},s.Observable.prototype.zip=function(t,e){return O(new s.Desc(this,"zip",[t]),s.zipWith([this,t],e||Array))},wt.prototype.subscribe=function(t,e,n){var r="function"==typeof t?{next:t,error:e,complete:n}:t,i={closed:!1,unsubscribe:function(){i.closed=!0,o()}},o=this.observable.subscribe((function(t){t.isError()?(r.error&&r.error(t.error),i.unsubscribe()):t.isEnd()?(i.closed=!0,r.complete&&r.complete()):r.next&&r.next(t.value())}));return i},wt.prototype[y("observable")]=function(){return this},s.Observable.prototype.toESObservable=function(){return new wt(this)},s.Observable.prototype[y("observable")]=s.Observable.prototype.toESObservable,s.fromESObservable=function(t){var e;e=t[y("observable")]?t[y("observable")]():t;var n=new s.Desc(s,"fromESObservable",[e]);return new s.EventStream(n,(function(t){var n=e.subscribe({error:function(){t(new s.Error),t(new s.End)},next:function(e){t(new s.Next(e,!0))},complete:function(){t(new s.End)}});return n.unsubscribe?function(){n.unsubscribe()}:n}))},null!==n(289)&&null!=n(290)?(void 0===(i=function(){return s}.apply(e,[]))||(r.exports=i),null!=this&&(this.Bacon=s)):null!==r&&null!=r.exports?(r.exports=s,s.Bacon=s):this.Bacon=s}).call(this)}).call(this,n(29),n(89)(t))},79:function(t,e,n){"use strict";e.a=function(t){return{as:e=>new Promise((function(n,r){const i=new FileReader;switch(i.onload=function(){n(i.result)},i.onerror=function(){r(new Error("Unable to read from Blob"))},e){case"arraybuffer":i.readAsArrayBuffer(t);break;case"text":i.readAsText(t)}}))}}},80:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.assign=e.values=e.map=e.uniq=void 0;var i=r(n(538));e.uniq=i.default;var o=r(n(539));e.map=o.default;var s=r(n(540));e.values=s.default;var a=r(n(541));e.assign=a.default},84:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return u}));var r=n(68);function i(t,e){if(!e)return()=>{};let n=0;return e.report(0,t),r=>e.report(++n,t,r)}async function o(t,e){if(!t)return e;const n=await Promise.resolve(e);return!function(t){return t&&t.byteLength}(n)?t.report(1,1):(t.formatter=r.a,t.report(n.byteLength,n.byteLength)),n}function s(t,e){let n=0,r=0;return async function(...i){t.report(n,++r);const o=await e.apply(this,i);return t.report(++n,r),o}}function a(t,e){return t.watch((()=>e.report(t.current,t.total,t.extra)))}function u(t){const e=[];let n,r=null;function i(){n&&t.report(n.current,n.total,n.extra),e.length>0&&(!n||n.progress>=1)&&function(t){if(n===t)return;r&&(r(),r=null);n=t,n&&(r=n.watch(i))}(e.shift())}return{add(t){e.push(t),i()}}}},85:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.Compiler=e.Reader=void 0;var a=o(n(234));e.Reader=a;var u=o(n(236));e.Compiler=u,s(n(237),e),s(n(39),e),s(n(108),e),s(n(109),e),s(n(60),e),s(n(110),e),s(n(239),e),s(n(242),e),s(n(243),e),s(n(244),e),s(n(245),e),s(n(246),e)},877:function(t,e,n){t.exports=n.p+"build/7d6d69a86d70e4e52079c5ce873435c6.jpg"},929:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(71),i=n.n(r);function o(t){return function(e){const n=()=>!1;return i()(window).on("touchstart",n),function(t,e){const{view:n,wrapper:r}=t,{width:o,height:s}=n;function a(){e.removeEventListener("touchstart",a),e.addEventListener("contextmenu",(t=>{t.preventDefault()}))}function u(){const t=Math.min(window.innerWidth/o,window.innerHeight/s);n.style.width=Math.round(o*t)+"px",n.style.height=Math.round(s*t)+"px",r.style.width=Math.round(o*t)+"px",r.style.height=Math.round(s*t)+"px";const e=(window.innerHeight-s*t)/2;r.style.marginTop=Math.round(e)+"px"}e.appendChild(r),e.addEventListener("touchstart",a),u(),i()(window).on("resize",u)}(t,e),{teardown(){i()(window).off("touchstart",n)}}}}},930:function(t,e,n){var r=n(931);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},931:function(t,e,n){var r=n(8);(t.exports=n(1)(!1)).push([t.i,'@charset "UTF-8";\n.LoadingScene {\n  background: url('+r(n(877))+") center no-repeat;\n  background-size: cover;\n}\n.LoadingSceneのinfo {\n  position: absolute;\n  top: 40%;\n  left: 0;\n  right: 0;\n  -webkit-transform: translateY(-50%);\n          transform: translateY(-50%);\n}\n.LoadingScene .LoadingSceneSongInfo {\n  -webkit-animation: loading-scene--loading-scene-song-info--animation 1s ease;\n          animation: loading-scene--loading-scene-song-info--animation 1s ease;\n}\n.LoadingScene .LoadingSceneProgress {\n  position: absolute;\n  bottom: 10px;\n  left: 10px;\n}\n.LoadingSceneのimage {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.LoadingSceneのimage img {\n  width: 100%;\n  height: 100%;\n  display: block;\n  object-fit: cover;\n  -webkit-animation: loading-scene--eyecatch-fade 0.8s;\n          animation: loading-scene--eyecatch-fade 0.8s;\n}\n.LoadingSceneのflash {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  opacity: 0;\n  pointer-events: none;\n  background: white;\n  -webkit-animation: loading-scene--flash-animation 0.8s ease-out;\n          animation: loading-scene--flash-animation 0.8s ease-out;\n}\n.LoadingSceneのcover {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  opacity: 0;\n  pointer-events: none;\n  background: black;\n}\n.Scene.is-exiting .LoadingSceneのinfo {\n  -webkit-animation: loading-scene--info-exit 0.3s linear;\n          animation: loading-scene--info-exit 0.3s linear;\n}\n.Scene.is-exiting .LoadingSceneのflash {\n  -webkit-animation: loading-scene--flash-exit 0.3s ease;\n          animation: loading-scene--flash-exit 0.3s ease;\n}\n.Scene.is-exiting .LoadingSceneのcover {\n  -webkit-animation: loading-scene--cover-exit 0.3s linear;\n          animation: loading-scene--cover-exit 0.3s linear;\n  opacity: 1;\n}\n\n@-webkit-keyframes loading-scene--eyecatch-fade {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n@keyframes loading-scene--eyecatch-fade {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n@-webkit-keyframes loading-scene--loading-scene-song-info--animation {\n  0% {\n    -webkit-transform: scale(1.5, 0.02);\n            transform: scale(1.5, 0.02);\n  }\n  100% {\n    -webkit-transform: scale(1, 1);\n            transform: scale(1, 1);\n  }\n}\n@keyframes loading-scene--loading-scene-song-info--animation {\n  0% {\n    -webkit-transform: scale(1.5, 0.02);\n            transform: scale(1.5, 0.02);\n  }\n  100% {\n    -webkit-transform: scale(1, 1);\n            transform: scale(1, 1);\n  }\n}\n@-webkit-keyframes loading-scene--info-exit {\n  0% {\n    -webkit-transform: translateY(-50%) scale(1, 1);\n            transform: translateY(-50%) scale(1, 1);\n  }\n  100% {\n    -webkit-transform: translateY(-50%) scale(2, 2);\n            transform: translateY(-50%) scale(2, 2);\n  }\n}\n@keyframes loading-scene--info-exit {\n  0% {\n    -webkit-transform: translateY(-50%) scale(1, 1);\n            transform: translateY(-50%) scale(1, 1);\n  }\n  100% {\n    -webkit-transform: translateY(-50%) scale(2, 2);\n            transform: translateY(-50%) scale(2, 2);\n  }\n}\n@-webkit-keyframes loading-scene--cover-exit {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n@keyframes loading-scene--cover-exit {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n@-webkit-keyframes loading-scene--flash-animation {\n  0% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n@keyframes loading-scene--flash-animation {\n  0% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n@-webkit-keyframes loading-scene--flash-exit {\n  0% {\n    opacity: 0.5;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n@keyframes loading-scene--flash-exit {\n  0% {\n    opacity: 0.5;\n  }\n  100% {\n    opacity: 0;\n  }\n}",""])},932:function(t,e,n){var r=n(933);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},933:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,'@charset "UTF-8";\n.LoadingSceneProgress {\n  color: #333;\n  font-size: 11px;\n}\n.LoadingSceneProgress .LoadingSceneProgressBar {\n  display: inline-block;\n  vertical-align: middle;\n  width: 48px;\n  margin-right: 4px;\n  position: relative;\n  top: -1px;\n}\n.LoadingSceneProgressのextra {\n  font-size: 83%;\n  opacity: 0.7;\n}',""])},934:function(t,e,n){var r=n(935);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},935:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,'@charset "UTF-8";\n.LoadingSceneProgressBar {\n  border: 1px solid rgba(0, 0, 0, 0.6);\n  padding: 1px;\n}\n.LoadingSceneProgressBarのbar {\n  height: 8px;\n  background: rgba(0, 0, 0, 0.6);\n  width: 0%;\n}',""])},936:function(t,e,n){var r=n(937);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},937:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,'@charset "UTF-8";\n.LoadingSceneSongInfo {\n  background: rgba(255, 255, 255, 0.96);\n  color: #191817;\n  text-align: center;\n  padding: 25px 0px;\n  box-shadow: 0 2px 18px rgba(0, 0, 0, 0.2);\n}\n.LoadingSceneSongInfoのgenre {\n  font-size: 1.2rem;\n}\n.LoadingSceneSongInfoのtitle {\n  font-size: 3.2rem;\n  font-weight: bold;\n}\n.LoadingSceneSongInfoのsubtitle {\n  font-size: 2.4rem;\n}\n.LoadingSceneSongInfoのartist {\n  font-size: 1.6rem;\n  margin-top: 0.8ex;\n}\n.LoadingSceneSongInfoのsubartist {\n  font-size: 1rem;\n}',""])},98:function(t,e,n){"use strict";var r=n(121),i=n.n(r),o=n(68);e.a=function(t,{getRetryDelay:e=(()=>1e3+4e3*Math.random())}={}){return{async as(n,r){let s=!1;for(let a=1;;a++)try{return await new Promise(((e,i)=>{const a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType=n,a.onload=()=>{200==+a.status?e(a.response):(403!=+a.status&&404!=+a.status||(s=!0),i(new Error(`Unable to download ${t}: HTTP ${a.status}`)))},a.onerror=()=>i(new Error(`Unable to download ${t}`)),r&&(r.formatter=o.a,a.onprogress=t=>r.report(t.loaded,t.total)),a.send(null)}))}catch(n){if(console.error(`Unable to download ${t} [attempt ${a}]`,n),a>=3||s)throw n;const r=e();await i()(r)}}}}},99:function(t,e,n){"use strict";e.a=document.querySelector("#scene-root")}}]);
//# sourceMappingURL=game-ae640be6156d4d9e8e48.js.map