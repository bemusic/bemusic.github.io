"use strict";(this.webpackChunk=this.webpackChunk||[]).push([[757],{33705:function(e,n,t){var a=t(95970),l=t.n(a),o=t(50146),r=t.n(o)()(l())
r.push([e.id,".GameShellScene {\n  margin: 20px auto;\n  background: #353433;\n  border: 1px solid #555453;\n  padding: 15px;\n  max-width: 720px;\n}\n.GameShellScene .drop-zone {\n  border: 2px dashed #555453;\n  padding: 5px;\n}\n.GameShellScene .drop-zone a.is-active {\n  font-weight: bold;\n}\n.GameShellScene .drop-zone-hint {\n  padding: 10px;\n  text-align: center;\n  color: #8b8685;\n}\n.GameShellScene form > div {\n  margin-bottom: 1em;\n}\n.GameShellScene form > div.text .label {\n  display: block;\n  color: #8b8685;\n  font-weight: bold;\n  font-size: 0.8em;\n  margin: 0;\n  margin-bottom: 0.5ex;\n}\n.GameShellScene form > div.text input {\n  font: inherit;\n  display: block;\n  width: 100%;\n  box-sizing: border-box;\n  border: 1px inset #555453;\n  background: #252423;\n  color: #bfb;\n}\n.GameShellScene form > div.text input:disabled {\n  opacity: 0.2;\n}\n.GameShellScene form > div.checkbox input {\n  margin-right: 1ex;\n}\n.GameShellScene form > div.radio > h3 {\n  display: block;\n  color: #8b8685;\n  font-weight: bold;\n  font-size: 0.8em;\n  margin: 0;\n  margin-bottom: 0.5ex;\n}\n.GameShellScene form > div.radio > label {\n  display: block;\n}\n.GameShellScene form > div.radio input {\n  margin-right: 1ex;\n}\n.GameShellScene button {\n  background: #8b8685;\n  border: 1px outset #aba6a5;\n  font: inherit;\n  font-size: 1.5em;\n  color: #e9e8e7;\n  display: block;\n  width: 100%;\n  box-sizing: border-box;\n}\n.GameShellScene a {\n  color: #fed;\n}","",{version:3,sources:["webpack://./game/ui/GameShellScene.scss"],names:[],mappings:"AAAA;EACE,iBAAA;EACA,mBAAA;EACA,yBAAA;EACA,aAAA;EACA,gBAAA;AACF;AAAE;EACE,0BAAA;EACA,YAAA;AAEJ;AADI;EACE,iBAAA;AAGN;AAAE;EACE,aAAA;EACA,kBAAA;EACA,cAAA;AAEJ;AAQE;EACE,kBAAA;AANJ;AAQM;EAVF,cAAA;EACA,cAAA;EACA,iBAAA;EACA,gBAAA;EACA,SAAA;EACA,oBAAA;AAKJ;AAGM;EACE,aAAA;EACA,cAAA;EACA,WAAA;EACA,sBAAA;EACA,yBAAA;EACA,mBAAA;EACA,WAAA;AADR;AAGM;EACE,YAAA;AADR;AAKM;EACE,iBAAA;AAHR;AAOM;EAhCF,cAAA;EACA,cAAA;EACA,iBAAA;EACA,gBAAA;EACA,SAAA;EACA,oBAAA;AA4BJ;AAEM;EACE,cAAA;AAAR;AAEM;EACE,iBAAA;AAAR;AAIE;EACE,mBAAA;EACA,0BAAA;EACA,aAAA;EACA,gBAAA;EACA,cAAA;EACA,cAAA;EACA,WAAA;EACA,sBAAA;AAFJ;AAIE;EACE,WAAA;AAFJ",sourcesContent:[".GameShellScene {\n  margin: 20px auto;\n  background: #353433;\n  border: 1px solid #555453;\n  padding: 15px;\n  max-width: 720px;\n  .drop-zone {\n    border: 2px dashed #555453;\n    padding: 5px;\n    a.is-active {\n      font-weight: bold;\n    }\n  }\n  .drop-zone-hint {\n    padding: 10px;\n    text-align: center;\n    color: #8b8685;\n  }\n  @mixin option-label {\n    display: block;\n    color: #8b8685;\n    font-weight: bold;\n    font-size: 0.8em;\n    margin: 0;\n    margin-bottom: 0.5ex;\n  }\n  form > div {\n    margin-bottom: 1em;\n    &.text {\n      .label {\n        @include option-label;\n      }\n      input {\n        font: inherit;\n        display: block;\n        width: 100%;\n        box-sizing: border-box;\n        border: 1px inset #555453;\n        background: #252423;\n        color: #bfb;\n      }\n      input:disabled {\n        opacity: 0.2;\n      }\n    }\n    &.checkbox {\n      input {\n        margin-right: 1ex;\n      }\n    }\n    &.radio {\n      > h3 {\n        @include option-label;\n      }\n      > label {\n        display: block;\n      }\n      input {\n        margin-right: 1ex;\n      }\n    }\n  }\n  button {\n    background: #8b8685;\n    border: 1px outset #aba6a5;\n    font: inherit;\n    font-size: 1.5em;\n    color: #e9e8e7;\n    display: block;\n    width: 100%;\n    box-sizing: border-box;\n  }\n  a {\n    color: #fed;\n  }\n}\n"],sourceRoot:""}]),n.Z=r},37913:function(e,n,t){t.r(n),t.d(n,{main:function(){return I}})
var a=t(95414),l=t(80513),o=t(58113),r=t(87672),A=t.n(r),i=t(95541),s=t.n(i),c=t(24324),d=t.n(c),p=t(26419),m=t.n(p),h=t(15669),u=t.n(h),b=t(95076),E=t.n(b),g=t(33705),C={}
C.styleTagTransform=E(),C.setAttributes=m(),C.insert=d().bind(null,"head"),C.domAPI=s(),C.insertStyleElement=u()
A()(g.Z,C),g.Z&&g.Z.locals&&g.Z.locals
var f=t(17957),x=t(87094),S=t.n(x),y=t(63929),v=t(30583),k=t.n(v)
class w extends y.Component{constructor(e){super(e),this.handleDrop=e=>{e.preventDefault()
const n=e.nativeEvent,t=new f.Z(n)
t.fileList.then((e=>e.filter((e=>/\.(bms|bme|bml)$/i.test(e))))).map((e=>t.file(e).then((n=>({name:e,resource:n}))))).then((e=>{this.setState({files:e,resources:t})})).catch((n=>{throw"FileError"===n.constructor.name?new Error("File Error code "+e.code):n}))},this.handleItemClick=e=>()=>{this.props.onSelect(this.state.resources,e.resource)},this.handleClear=()=>{this.props.onSelect(null,null)},this.state={files:[]}}render(){const e=this.state.files
return y.createElement("div",{className:"drop-zone"},e.length?y.createElement("ul",null,e.map((e=>y.createElement("li",null,y.createElement("a",{href:"javascript://",onClick:this.handleItemClick,className:k()({"is-active":e.resource===this.props.selectedResource})},e.name)))),this.props.selectedResource?y.createElement("li",null,y.createElement("a",{href:"javascript://",onClick:this.handleClear},"Clear")):null):y.createElement("div",{className:"drop-zone-hint"},"Drop BMS folder here",y.createElement("br",null),"(only works on Google Chrome)"))}}w.propTypes={selectedResource:S().any,onSelect:S().func}
class B extends y.Component{constructor(e){super(e),this.submit=e=>{e.preventDefault(),this.props.play(this.state.options)},this.bindOption=e=>n=>{e(this.state.options,n.target.value),this.forceUpdate()},this.handleDragOver=e=>{e.preventDefault()},this.handleDrop=e=>{e.preventDefault(),this.refs.dropzone.handleDrop(e)},this.handleSelectFile=(e,n)=>{this.setState({options:Object.assign(this.state.options,{resources:e,resource:n})}),this.forceUpdate()},this.state={options:this.props.options}}render(){const e=this.state.options
return y.createElement("div",{className:"GameShellScene",onDragOver:this.handleDragOver,onDrop:this.handleDrop},y.createElement("h1",null,"Bemuse Game Shell"),y.createElement("p",null,"This tool is intended for developers testing the game."),y.createElement("form",{onSubmit:this.submit},y.createElement("div",{className:"text"},y.createElement("label",null,y.createElement("span",{className:"label"},"BMS URL:"),y.createElement("input",{type:"text",disabled:e.resource,onChange:this.bindOption(((e,n)=>e.url=n)),value:e.url}))),y.createElement("div",{className:"text"},y.createElement("label",null,y.createElement("span",{className:"label"},"-or- Drop BMS folder here"),y.createElement(w,{ref:"dropzone",selectedResource:e.resource,onSelect:this.handleSelectFile}))),y.createElement("div",{className:"text"},y.createElement("label",null,y.createElement("span",{className:"label"},"Audio-Input Latency"),y.createElement("input",{type:"text",onChange:this.bindOption(((e,n)=>e.game.audioInputLatency=n)),value:e.game.audioInputLatency}))),y.createElement("div",{className:"text"},y.createElement("label",null,y.createElement("span",{className:"label"},"HI-SPEED:"),y.createElement("input",{type:"text",onChange:this.bindOption(((e,n)=>e.players[0].speed=n)),value:e.players[0].speed}))),y.createElement("div",{className:"radio"},y.createElement("h3",null,"Placement"),["left","center","right"].map((n=>y.createElement("label",null,y.createElement("input",{type:"radio",value:n,onChange:this.bindOption(((e,n)=>e.players[0].placement=n)),checked:e.players[0].placement===n}),y.createElement("span",{className:"label"},n))))),y.createElement("button",{type:"submit"},"Play")))}}B.propTypes={options:S().object,play:S().func}
var G=t(31701),Z=t(20734),z=t(96011),D=t(22022),N=t(98711),R=t(10426)
async function I(){window.addEventListener("touchstart",(function e(){(0,R.u7)(D.Z),window.removeEventListener("touchstart",e)}))
const e=await async function(){const e=(N.Z.keyboard||"").split(",").map((e=>+e))
let n={url:N.Z.bms||"/music/[snack]dddd/dddd_sph.bme",game:{audioInputLatency:+N.Z.latency||0},players:[{speed:+N.Z.speed||3,autoplay:!!N.Z.autoplay,placement:"center",scratch:N.Z.scratch||"left",input:{keyboard:{1:e[0]||83,2:e[1]||68,3:e[2]||70,4:e[3]||32,5:e[4]||74,6:e[5]||75,7:e[6]||76,SC:e[7]||65,SC2:e[8]||16}}}]}
n=await function(e){return new Promise((function(n){const t=y.createElement(B,{options:e,play:function(e){n(e)}})
Z.ZP.display(t)}))}(n)
const t=n.url,a=new URL("assets/",t)
return{bms:n.resource||new z.ZP(t),assets:n.resources||new l.C(a),metadata:{title:"Loading",subtitles:[],artist:"",genre:"",subartists:[]},options:Object.assign({},n.game,{players:n.players})}}(),{tasks:n,promise:t}=a.load(e)
await Z.ZP.display(y.createElement(G.Z,{tasks:n,song:e.metadata}))
const r=await t
await Z.ZP.display(new o.Z(r.display)),r.start()}}}])

//# sourceMappingURL=game-0091a58a0cf5c8b274b7.js.map