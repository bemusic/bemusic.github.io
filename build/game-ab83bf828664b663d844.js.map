{"version":3,"sources":["file:///home/circleci/bemuse/bemuse/src/progress/utils.ts","file:///home/circleci/bemuse/packages/bms/lib/index.js","file:///home/circleci/bemuse/bemuse/src/ui/images/bg/a.jpg","file:///home/circleci/bemuse/bemuse/src/utils/main-element.js","file:///home/circleci/bemuse/bemuse/src/game/game-scene.js","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingScene.scss?d747","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingScene.scss","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingSceneSongInfo.scss?0d6c","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingSceneSongInfo.scss","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingSceneProgress.scss?a98c","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingSceneProgress.scss","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingSceneProgressBar.scss?89c1","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingSceneProgressBar.scss","file:///home/circleci/bemuse/bemuse/src/resources/url.ts","file:///home/circleci/bemuse/bemuse/src/utils/download.js","file:///home/circleci/bemuse/bemuse/src/progress/index.ts","file:///home/circleci/bemuse/packages/bms/lib/util/match.js","file:///home/circleci/bemuse/packages/bms/lib/bms/headers.js","file:///home/circleci/bemuse/packages/bms/lib/bms/objects.js","file:///home/circleci/bemuse/packages/bms/lib/time-signatures/index.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/timers-browserify@2.0.12/node_modules/timers-browserify/main.js","file:///home/circleci/bemuse/bemuse/src/devtools/query-flags.js","file:///home/circleci/bemuse/bemuse/src/game/audio/index.js","file:///home/circleci/bemuse/bemuse/src/game/clock.js","file:///home/circleci/bemuse/bemuse/src/game/game-timer.js","file:///home/circleci/bemuse/bemuse/src/game/input/dual-input.ts","file:///home/circleci/bemuse/bemuse/src/game/input/omni-input-plugin.js","file:///home/circleci/bemuse/bemuse/src/game/game-controller.js","file:///home/circleci/bemuse/bemuse/src/game/loaders/loadImage.js","file:///home/circleci/bemuse/bemuse/src/game/loaders/game-loader.ts","file:///home/circleci/bemuse/bemuse/src/game/loaders/multitasker.js","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingSceneSongInfo.jsx","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingSceneProgressBar.jsx","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingSceneProgress.jsx","file:///home/circleci/bemuse/bemuse/src/game/ui/LoadingScene.jsx","file:///home/circleci/bemuse/bemuse/src/game/ui/GameShellScene.scss?3dc2","file:///home/circleci/bemuse/bemuse/src/game/ui/GameShellScene.scss","file:///home/circleci/bemuse/bemuse/src/utils/now.js","file:///home/circleci/bemuse/bemuse/src/game/ui/GameShellScene.jsx","file:///home/circleci/bemuse/bemuse/src/game/index.js","file:///home/circleci/bemuse/bemuse/src/progress/Progress.ts","file:///home/circleci/bemuse/bemuse/src/utils/observable.ts","file:///home/circleci/bemuse/bemuse/src/utils/callbacks.ts","file:///home/circleci/bemuse/bemuse/src/audio-context/index.js","file:///home/circleci/bemuse/bemuse/src/ui/Scene.jsx","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/bytes@3.1.0/node_modules/bytes/index.js","file:///home/circleci/bemuse/bemuse/src/sampling-master/index.js","file:///home/circleci/bemuse/bemuse/src/resources/addUnprefixed.ts","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/url@0.11.0/node_modules/url/url.js","file:///home/circleci/bemuse/bemuse/src/resources/resource-logging.ts","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/libarchive.js@1.3.0/node_modules/libarchive.js/src/compressed-file.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/libarchive.js@1.3.0/node_modules/libarchive.js/src/libarchive.js","file:///home/circleci/bemuse/bemuse/src/resources/unarchiver.ts","file:///home/circleci/bemuse/bemuse/src/resources/custom-song-resources.ts","file:///home/circleci/bemuse/bemuse/src/sampling-master/ogg.ts","file:///home/circleci/bemuse/packages/bemuse-notechart/lib/index.js","file:///home/circleci/bemuse/bemuse/src/game/display/touch3d.js","file:///home/circleci/bemuse/bemuse/src/devtools/ui/BenchmarkPanel.jsx","file:///home/circleci/bemuse/bemuse/src/devtools/benchmark.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/setimmediate@1.0.5/node_modules/setimmediate/setImmediate.js","file:///home/circleci/bemuse/bemuse/src/scene-manager/index.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/audio-context@1.0.3/node_modules/audio-context/index.js","file:///home/circleci/bemuse/packages/bms/lib/reader/index.web.js","file:///home/circleci/bemuse/packages/bms/lib/reader/getReaderOptionsFromFilename.js","file:///home/circleci/bemuse/packages/bms/lib/compiler/index.js","file:///home/circleci/bemuse/packages/bms/lib/reader/types.js","file:///home/circleci/bemuse/packages/bms/lib/speedcore/segment.js","file:///home/circleci/bemuse/packages/bms/lib/notes/index.js","file:///home/circleci/bemuse/packages/bms/lib/notes/note.js","file:///home/circleci/bemuse/packages/bms/lib/notes/channels.js","file:///home/circleci/bemuse/packages/bms/lib/timing/index.js","file:///home/circleci/bemuse/packages/bms/lib/song-info/index.js","file:///home/circleci/bemuse/packages/bms/lib/keysounds/index.js","file:///home/circleci/bemuse/packages/bms/lib/positioning/index.js","file:///home/circleci/bemuse/packages/bms/lib/spacing/index.js","file:///home/circleci/bemuse/bemuse/src/devtools/BemuseTestMode.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/webpack@4.46.0/node_modules/webpack/buildin/amd-define.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/webpack@4.46.0/node_modules/webpack/buildin/amd-options.js","file:///home/circleci/bemuse/packages/bemuse-notechart/lib/loader/BMSNotechartLoader.js","file:///home/circleci/bemuse/packages/bemuse-notechart/lib/types.js","file:///home/circleci/bemuse/bemuse/src/logger/index.ts","file:///home/circleci/bemuse/packages/bmson/lib/legacy.js","file:///home/circleci/bemuse/packages/bmson/lib/utils.js","file:///home/circleci/bemuse/bemuse/src/game/player.ts","file:///home/circleci/bemuse/bemuse/src/game/state/player-stats.ts","file:///home/circleci/bemuse/bemuse/src/game/display/note-area.js","file:///home/circleci/bemuse/bemuse/src/game/display/Gauge.js","file:///home/circleci/bemuse/bemuse/src/utils/formatTime.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/punycode@1.4.1/node_modules/punycode/punycode.js","file:///home/circleci/bemuse/packages/bms/lib/bms/chart.js","file:///home/circleci/bemuse/bemuse/src/omni-input/midi.js","file:///home/circleci/bemuse/bemuse/src/omni-input/axis-logic.ts","file:///home/circleci/bemuse/bemuse/src/omni-input/index.js","file:///home/circleci/bemuse/bemuse/src/game/input/control.ts","file:///home/circleci/bemuse/bemuse/src/game/input/index.ts","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/timesynchro@1.0.1/node_modules/timesynchro/client.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/timesynchro@1.0.1/node_modules/timesynchro/timesync.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/path-browserify@0.0.1/node_modules/path-browserify/index.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/classnames@2.3.1/node_modules/classnames/index.js","file:///home/circleci/bemuse/bemuse/src/resources/bemuse-package.ts","file:///home/circleci/bemuse/bemuse/src/keysound-cache/index.js","file:///home/circleci/bemuse/bemuse/src/devtools/ui/BenchmarkPanel.scss?2d95","file:///home/circleci/bemuse/bemuse/src/devtools/ui/BenchmarkPanel.scss","file:///home/circleci/bemuse/bemuse/src/game/state/player-state.ts","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/keycode@2.2.0/node_modules/keycode/index.js","file:///home/circleci/bemuse/bemuse/src/game/display/player-display.js","file:///home/circleci/bemuse/bemuse/src/resources/dnd-resources.ts","file:///home/circleci/bemuse/packages/bms/lib/speedcore/index.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/url@0.11.0/node_modules/url/util.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/bluebird@3.7.2/node_modules/bluebird/js/browser/bluebird.js","file:///home/circleci/bemuse/bemuse/src/resources/resolveRelativeResource.ts","file:///home/circleci/bemuse/bemuse/src/keysound-cache/createKeysoundCache.js","file:///home/circleci/bemuse/bemuse/src/game/audio/wave-factory.js","file:///home/circleci/bemuse/bemuse/src/ui/Scene.scss?4cbf","file:///home/circleci/bemuse/bemuse/src/ui/Scene.scss","file:///home/circleci/bemuse/packages/bemuse-notechart/lib/loader/index.js","file:///home/circleci/bemuse/packages/bemuse-notechart/lib/loader/BmsonNotechartLoader.js","file:///home/circleci/bemuse/packages/bmson/lib/index.js","file:///home/circleci/bemuse/packages/bmson/lib/types.js","file:///home/circleci/bemuse/bemuse/src/game/game.ts","file:///home/circleci/bemuse/bemuse/src/game/audio/player-audio.js","file:///home/circleci/bemuse/bemuse/src/game/state/index.ts","file:///home/circleci/bemuse/bemuse/src/game/input/touch-plugin.js","file:///home/circleci/bemuse/bemuse/src/game/display/index.js","file:///home/circleci/bemuse/bemuse/src/game/display/game-display.scss?0e8d","file:///home/circleci/bemuse/bemuse/src/game/display/game-display.scss","file:///home/circleci/bemuse/bemuse/src/game/display/background/default.jpg","file:///home/circleci/bemuse/bemuse/src/game/display/touch-escape.png","file:///home/circleci/bemuse/bemuse/src/game/display/touch-replay.png","file:///home/circleci/bemuse/bemuse/src/game/display/touch-fullscreen.png","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/screenfull@3.3.3/node_modules/screenfull/dist/screenfull.js","file:///home/circleci/bemuse/bemuse/src/game/loaders/samples-loader.js","file:///home/circleci/bemuse/bemuse/src/game/judgments.ts","file:///home/circleci/bemuse/bemuse/src/progress/formatters.js","file:///home/circleci/bemuse/common/temp/node_modules/.pnpm/baconjs@0.7.95/node_modules/baconjs/dist/Bacon.js","file:///home/circleci/bemuse/bemuse/src/utils/read-blob.js","file:///home/circleci/bemuse/packages/bms/lib/util/lodash.js"],"names":["fixed","total","progress","loaded","report","extra","atomic","promise","Promise","resolve","tap","data","byteLength","hasByteLength","formatter","wrapPromise","f","current","args","apply","this","bind","from","to","watch","simultaneous","target","queue","unsubscribe","update","length","shift","add","push","__createBinding","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","prototype","hasOwnProperty","call","__exportStar","exports","p","Compiler","Reader","module","document","querySelector","GameScene","display","container","handler","window","on","view","wrapper","width","height","disableContextMenu","removeEventListener","addEventListener","e","preventDefault","resize","scale","Math","min","innerWidth","innerHeight","style","round","yOffset","marginTop","appendChild","showCanvas","teardown","off","content","i","options","transform","locals","escape","URLResource","constructor","url","read","as","async","name","URLResources","base","path","split","map","part","encodeURIComponent","join","URL","href","getRetryDelay","random","type","shouldGiveUp","reject","xh","XMLHttpRequest","open","responseType","onload","status","response","Error","onerror","onprogress","send","error","console","waitMs","setTimeout","match","text","matched","when","pattern","callback","else","BMSHeaders","_data","_dataAll","each","toLowerCase","getAll","set","key","BMSObjects","_objects","object","channel","test","measure","fraction","all","slice","allSorted","list","sort","a","b","TimeSignatures","_values","getBeats","measureToBeat","sum","self","Function","Timeout","id","clearFn","_id","_clearFn","scope","arguments","clearTimeout","setInterval","clearInterval","timeout","close","unref","ref","enroll","item","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","setImmediate","global","clearImmediate","shouldShowOptions","BEMUSE_SHOW_OPTIONS","shouldEnableBenchmark","BEMUSE_BENCHMARK","shouldDisableFullScreen","BEMUSE_NO_FULLSCREEN","shouldShowAbout","BEMUSE_SHOW_ABOUT","shouldShowModeSelect","BEMUSE_SHOW_MODE_SELECT","isTitleDisplayMode","BEMUSE_TITLE_DISPLAY","game","samples","master","volume","soundVolume","_master","_context","audioContext","_players","Map","players","player","destroy","unmute","context","t","state","playerAudio","audio","_offset","_sum","realTime","now","delta","currentTime","time","clock","input","_clock","_input","_now","synchronized","_lastRecordedTimeSinceStart","startTime","_pauseAtTimerValue","Infinity","_unpausedTimeSinceStart","_unpausedTimerValue","readyFraction","gettingStarted","started","_checkStartGame","_calculateTime","_getWait","ceil","pow","timeSinceStart","projectedTimerValue","pauseAt","timerValueToPause","DualInput","last","output","combine","exclusive","continuous","sensitivity","kbm","keyboard","scratch","isBtn8Free","values","indexOf","isBtn9Free","p1_1","p1_2","p1_3","p1_4","p1_5","p1_6","p1_7","p1_SC","p1_speedup","p1_speeddown","start","select","dispose","_audioInputLatency","audioInputLatency","_game","_display","_audio","_timer","_state","_promise","_resolvePromise","setEscapeHandler","_quitGame","setReplayHandler","_replayGame","initializeBenchmark","initializeTestModeHooks","latestGameTime","_latestGameTime","_handleEscape","use","stopped","frame","_update","requestAnimationFrame","_endGameLoop","onKeyDown","keyCode","stopPropagation","finally","done","finished","replay","A","enabled","benchmark","_instance","_renderer","BemuseTestMode","interval","unpause","getScore","stats","score","assets","filename","file","then","asset","arrayBuffer","Blob","blob","createObjectURL","src","image","Image","load","spec","bms","songId","tasks","running","taskList","task","dependencies","run","deps","concat","getTaskStatuses","progressText","toString","bar","taskToWatch","Scintillator","getSkinUrl","displayMode","skin","Context","touchEventTarget","loader","arraybuffer","notechart","eyecatchImageUrl","resolveRelativeResource","eyecatchImage","backImageUrl","backgroundImage","audioLoadProgress","audioDecodeProgress","videoUrl","includes","resolveUrl","video","createElement","canPlayType","onProgress","buffered","duration","end","finish","onCanPlayThrough","onError","n","element","offset","videoOffset","warn","preload","backgroundImagePromise","receiveSongId","loadFiles","Component","render","song","props","className","genre","title","subtitles","artist","subartists","propTypes","shape","string","arrayOf","difficulty","number","level","isRequired","oneOfType","renderItem","componentDidMount","_unsubscribe","forceUpdate","componentWillUnmount","Scene","eyecatchImagePromise","findDOMNode","refs","eyecatch","registerTeardownCallback","scene","classList","delay","func","Log","BemuseLogger","forModule","performance","Date","synchronize","server","onResult","err","info","super","handleDrop","event","nativeEvent","resources","fileList","filter","resource","setState","files","catch","code","handleItemClick","onSelect","handleClear","onClick","selectedResource","any","submit","play","bindOption","binder","handleDragOver","dropzone","handleSelectFile","assign","onDragOver","onDrop","onSubmit","disabled","onChange","speed","placement","checked","main","loadSpec","query","x","latency","autoplay","SC","SC2","displayShell","assetsUrl","metadata","getSong","LoadingScene","controller","Progress","_observable","notify","_callbacks","_value","init","_nextId","callbacks","latencyHint","onDragEnter","children","node","parse","format","formatThousandsRegExp","formatDecimalsRegExp","kb","mb","gb","tb","pb","parseRegExp","Number","isFinite","mag","abs","thousandsSeparator","unitSeparator","decimalPlaces","fixedDecimals","Boolean","unit","str","toFixed","replace","val","isNaN","floatValue","results","exec","parseFloat","parseInt","floor","FADE_LENGTH","dummyAudioTag","needsVorbisDecoder","SoundGroup","samplingMaster","_gain","createGain","gain","connect","destination","disconnect","Sample","audioBuffer","_buffer","PlayInstance","buffer","source","createBufferSource","onended","stop","group","_source","TEST_node","max","startOffset","fadeIn","fadeOutAt","setValueAtTime","linearRampToValueAtTime","_startPlaying","_stoppedPlaying","onstop","bad","playbackRate","unmuteAudio","ctx","osc","createOscillator","frequency","resume","resumeContext","_audioContext","_samples","_groups","_instances","Set","_destination","_destroyed","sample","instance","decode","blobOrArrayBuffer","_coerceToArrayBuffer","_decodeAudio","blobOrArrayBufferOrAudioBuffer","numberOfChannels","ArrayBuffer","Uint8Array","decodeAudioData","delete","addUnprefixed","prefix","parts","punycode","util","Url","protocol","slashes","auth","host","port","hostname","hash","search","pathname","urlParse","relative","resolveObject","obj","isString","protocolPattern","portPattern","simplePathPattern","unwise","autoEscape","nonHostChars","hostEndingChars","hostnamePartPattern","hostnamePartStart","unsafeProtocol","hostlessProtocol","slashedProtocol","querystring","parseQueryString","slashesDenoteHost","isObject","u","TypeError","queryIndex","splitter","uSplit","rest","trim","simplePath","substr","proto","lowerProto","atSign","hostEnd","hec","lastIndexOf","decodeURIComponent","parseHost","ipv6Hostname","hostparts","l","newpart","j","charCodeAt","validParts","notHost","bit","unshift","toASCII","h","ae","esc","qm","s","keys","stringify","charAt","rel","tkeys","tk","tkey","rkeys","rk","rkey","relPath","isSourceAbs","isRelAbs","mustEndAbs","removeAllDots","srcPath","psychotic","pop","isNullOrUndefined","authInHost","isNull","hasTrailingSlash","up","splice","isAbsolute","ResourceLogging","loggingFunction","log","setLoggingFunction","fn","forEach","CompressedFile","size","archiveRef","_name","_size","_path","_archiveRef","extract","extractSingleFile","static","_options","workerUrl","_worker","Worker","_workerMsg","_content","_processed","_file","_postMessage","msg","hasEncryptedData","usePassword","archivePassword","passphrase","getFilesObject","entry","prop","_getProp","fileName","_cloneContent","getFilesArray","_objectToArray","File","fileData","extractFiles","extractCallback","terminate","cur","prev","postMessage","_msgHandler","ARCHIVE_REGEXP","DROPBOX_REGEXP","provider","_logging","_files","getFiles","fileEntry","out","archive","extracted","traverse","tree","unarchive","unarchiveIfNeeded","downloadFileEntryFromURL","lastTime","download","decoderPromise","limit","decodeOGG","stbvorbis","ns","default","eval","buffers","sampleRate","totalLength","eof","decodedChunks","createBuffer","channels","Array","fill","_","ch","ChannelDataWriter","getChannelData","chunk","audioSamples","channelIndex","write","doDecodeOGG","__values","Symbol","iterator","next","__importDefault","Notechart","lodash_1","invariant_1","playerOptions","_this","bmsNotes","notes","timing","keysounds","songInfo","positioning","spacing","barLines","images","expertJudgmentWindow","_a","landmineNotes","_preTransform","_timing","_positioning","_spacing","_keysounds","_duration","_notes","_generatePlayableNotesFromBMS","_landmines","_autos","_generateAutoKeysoundEventsFromBMS","_barLines","_generateBarLineEvents","_generateKeysoundFiles","_infos","note","_getNoteInfo","_songInfo","_images","configurable","background","beatToSeconds","beat","beatToPosition","position","secondsToBeat","seconds","secondsToPosition","bpmAtBeat","scrollSpeedAtBeat","spacingAtBeat","factor","getKeyMode","e_1","usedColumns","_b","_c","column","e_1_1","return","chain","e_4","bmsNotes_1","bmsNotes_1_1","e_4_1","getKeys","columnsToShift_1","shiftNote","amount","index","newIndex","newColumn","nextId","_generateEvent","keysound","keysoundStart","keysoundEnd","_updateDuration","endBeat","_generateLandminesFromBMS","e_2","e_3","autos","_d","array","array_1","array_1_1","event_","e_3_1","e_2_1","beats","combos","config","getRow","excess","theta","pointX","cos","pointY","sin","projection","y","PLAY_AREA_WIDTH","getTouchedColumn","mid","row","x0","x1","pos","String","renderTable","bench","stat","align","handleInteraction","show","onTouchStart","Stat","count","average","hist","lastSec","secAvg","wrap","lines","div","setAttribute","body","registerImmediate","html","messagePrefix","onGlobalMessage","nextHandle","tasksByHandle","currentlyRunningATask","doc","attachTo","getPrototypeOf","process","handle","nextTick","runIfPresent","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","canUsePostMessage","MessageChannel","port1","port2","documentElement","script","onreadystatechange","removeChild","attachEvent","_transitioning","_stack","_transitionTo","previousScene","currentScene","getNextScene","currentSceneInstance","parentNode","detach","currentElement","ReactScene","ReactSceneContainer","clonedElement","cloneElement","elementToDisplay","try","unmountComponentAtNode","cache","OfflineContext","OfflineAudioContext","webkitOfflineAudioContext","AudioContext","webkitAudioContext","offline","getReaderOptionsFromFilename","readAsync","chardet","_i","charset","forceEncoding","detect","reader","FileReader","readAsText","getReaderOptionsFromFilename_1","compile","match_1","chart_1","matchers","if","endif","timeSignature","header","dtx","chart","BMSChart","rng","matcher","randomStack","skipStack","headerSentences","channelSentences","controlSentences","skippedSentences","malformedSentences","warnings","line","eachLine","lineNumber","flow","skipped","timeSignatures","items","objects","handleChannelSentence","headers","message","Segment","data_structure_1","dx","Notes","note_1","ChannelMapping","Note","fromBMSChart","mapping","CHANNEL_MAPPING","IIDX_P1","BMSNoteBuilder","build","_chart","_mapping","_activeLN","_lastNote","_lnObj","_channelMapping","_handle","_handleNormalNote","toUpperCase","_handleLongNote","_normalizeChannel","_getBeat","_getColumn","maybe","IIDX_DP_LANDMINE","IIDX_P1_LANDMINE","IIDX_DP","D1","D2","D3","D4","D5","D8","D9","D6","E1","E2","E3","E4","E5","E8","E9","E6","Timing","speedcore_1","precedence","bpm","initialBPM","actions","segments","inclusive","action","stopBeats","_speedcore","Speedcore","_eventBeats","uniq","segmentAtX","getEventBeats","SongInfo","extractSubtitle","Keysounds","_map","Positioning","previous","Spacing","_enabled","_lifecycleHandler","enableTestMode","overlay","innerHTML","setGameLifecycleHandler","isTestModeEnabled","__webpack_amd_options__","BMS","__1","getJudgmentWindowFromBMS","rank","generateBarLinesFromBMS","currentBeat","currentMeasure","double","moduleName","bindLogger","toJSON","__read","r","ar","__spreadArray","pack","_slicesForNotesAndTiming","beatForLoc","timingInfoForBmson","barLinesForBmson","utils","bmson","sortBy","initBPM","bpmNotes","stopNotes","slicesForNotesAndTiming","beatForPulse","restart","notes_1","notes_1_1","c","lastAdded","soundTime","mustAdd","_e","has","autoplayEnabled","autosound","laneCover","gauge","tutorial","columns","getAccuracyScore","accuracy","getComboScore","totalCombo","totalNotes","combo","maxCombo","rawSumJudgmentWeight","rawTotalComboScore","_calculateRawTotalComboScore","_remainingMaxPossibleRawComboScore","rawSumComboScore","counts","numJudgments","poor","_log","deltas","accuracyScore","comboScore","maxPossibleScore","maxPossibleAccuracyScore","maxPossibleComboScore","remainingJudgments","maxPossibleAccuracy","maxPossibleRawComboScore","currentAccuracy","character","handleJudgment","judgment","rawComboScore","_calculateRawComboScore","_recordLog","handleDelta","_getLogCharacter","lower","upper","getVisibleNotes","headroom","entity","head","tail","getVisibleBarLines","getGauge","gaugeType","primary","secondary","playerState","getHope","max1","max2","hopeS","hopeA","shouldDisplay","getPrimary","getSecondary","getExtra","hopeGauge","root","nodeType","freeGlobal","maxInt","regexPunycode","regexNonASCII","regexSeparators","errors","stringFromCharCode","fromCharCode","RangeError","mapDomain","ucs2decode","counter","ucs2encode","digitToBasic","digit","flag","adapt","numPoints","firstTime","baseMinusTMin","basic","oldi","w","baseMinusT","codePoint","inputLength","bias","encode","handledCPCount","basicLength","q","currentValue","handledCPCountPlusOne","qMinusT","headers_1","objects_1","time_signatures_1","observeMidiAccess","access","fromBinder","sink","inputs","Next","outputs","onstatechange","never","fromEvent","fromPromise","navigator","requestMIDIAccess","flatMap","flatMapError","stack","doLog","AxisLogic","charge","positive","axis","threshold","immediateOutput","win","_window","_exclusive","_continuousAxis","setGamepadSensitivity","_disposables","listen","_handleKeyDown","_handleKeyUp","onValue","_handleMIDIMessage","_status","_axis","which","handleNote","bend","_updateGamepads","nav","gamepads","getGamepads","webkitGetGamepads","gamepad","_updateGamepad","buttons","button","axes","axisName","_deadzone","_sensitivity","_analogThreshold","setGamepadContinuousAxisEnabled","diff","difference","fromArray","knownMidiIds","getName","capitalize","midiNote","subject","eventName","listener","changed","justPressed","_controls","_plugins","changes","control","plugin","controlName","union","timesync","callback2","ws","WebSocket","clocks","emit","getTime","fields","convert","onclose","t1","t2","t3","t4","hp","normalizeArray","allowAboveRoot","xs","res","resolvedPath","resolvedAbsolute","cwd","normalize","trailingSlash","paths","arr","fromParts","toParts","samePartsLength","outputParts","sep","delimiter","dirname","hasRoot","matchedSlash","basename","ext","extname","startDot","startPart","preDotState","len","hasOwn","classNames","classes","arg","argType","isArray","inner","BemusePackageFileResource","getBlob","Ref","_basePromise","loadPayload","getPayload","metadataLength","_getMetadata","once","_base","_metadataFilename","JSON","_getRefs","_getFileMap","location","fallback","_fallback","_fallbackPattern","fallbackPattern","metadataFilename","resourcePromise","nextProgress","NoteStatus","notifications","sounds","judgments","tainted","_gameTime","_pinching","_columns","_noteBufferByColumn","groupBy","mapValues","startIndex","getNoteStatus","_noteResult","_judge","gameTime","_rawInput","_updateInputColumnMap","_judgeNotes","_updateSpeed","Unjudged","getNoteJudgment","getPlayerInput","_judgeColumn","_modifySpeed","pinch","pinching","direction","_shouldAutoplay","BEMUSE_AUTOPLAY","judgedNote","autoPlayed","_shouldJudge","shouldBreak","_judgeNote","freestyleNote","_getFreestyleNote","_isSandwiched","_getClosestNote","minBy","every","adjacentColumn","some","missed","hit","noteEnd","lifted","passed","isDown","isUp","Judged","Active","_setJudgment","searchInput","hasKeyCode","charCode","names","foundNamedKey","codes","aliases","isEventKey","nameOrCode","alias","skinData","_currentSpeed","_player","_noteArea","_stateful","_defaultData","key_mode","lane_lift","lane_press","_gauge","_touch3dMode","touch3dMode","noteArea","stateful","entities","getUpperBound","putNote","noteY","columnIndex","areaWidth","xOffset","desiredWidth","longNoteStep","updateVisibleNotes","updateBarLines","updateInput","notification","deviationMode","updateJudgment","updateGauge","updateExplode","getCount","DndResources","dataTransfer","types","getData","startsWith","readItem","addFile","webkitGetAsEntry","readEntry","getAsFile","isFile","readFile","isDirectory","readDirectory","dir","entries","createReader","readMore","readEntries","getFilesFromEvent","segment_1","_segments","_reached","targetFn","segment","_segmentAt","X","segmentAtT","T","define","_dereq_","SomePromiseArray","_SomePromiseArray","promises","ret","setHowMany","setUnwrap","firstLineError","schedule","Queue","Async","_customScheduler","_isTickUsed","_lateQueue","_normalQueue","_haveDrainedQueues","drainQueues","_drainQueues","_schedule","_drainQueue","_drainQueueStep","_settlePromises","receiver","setScheduler","hasCustomScheduler","haveItemsQueued","fatalError","isNode","stderr","exit","throwLater","invokeLater","_queueTick","invoke","settlePromises","_pushOne","_reset","INTERNAL","tryConvertToPromise","debug","calledBind","rejectThis","_reject","targetRejected","promiseRejectionQueued","bindingPromise","_then","bindingResolved","thisArg","_bitField","_resolveCallback","bindingRejected","_propagateFrom","propagateFromFunction","_boundValue","boundValueFunction","maybePromise","_target","_setBoundTo","_setOnCancel","_boundTo","_isBound","old","bluebird","noConflict","cr","callerCache","getterCache","canEvaluate","caller","methodName","classString","ensureMethod","namedGetter","indexedGetter","isIdentifier","propertyName","getter","maybeGetter","getGetter","PromiseArray","apiRejection","tryCatch","errorObj","_async","cancel","cancellation","_warn","child","_isCancellable","_cancelBy","_isFollowing","_followee","_cancelBranched","parent","_cancellationParent","_setWillBeCancelled","_branchHasCancelled","_branchesRemainingToCancel","_enoughBranchesHaveCancelled","canceller","_invokeOnCancel","_cancel","_setCancelled","_cancelPromises","_length","_unsetOnCancel","_onCancelField","isPending","_isCancelled","isCancellable","isCancelled","_doInvokeOnCancel","onCancelCallback","internalOnly","_attachExtraTrace","_resultCancelled","_onCancel","_invokeInternalOnCancel","NEXT_FILTER","instances","cb","boundTo","predicateLoop","matchesPredicate","longStackTraces","contextStack","_trace","CapturedTrace","peekContext","lastIndex","_promiseCreated","_pushContext","_popContext","_peekContext","trace","deactivateLongStackTraces","activateLongStackTraces","Promise_pushContext","Promise_popContext","Promise_PeekContext","Promise_peekContext","Promise_promiseCreated","enableAsyncHooks","disableAsyncHooks","unhandledRejectionHandled","possiblyUnhandledRejection","printWarning","deferUnhandledRejectionCheck","Warning","es5","canAttachTrace","bluebirdFramePattern","nodeFramePattern","parseLinePattern","stackFramePattern","formatStack","indentStackFrames","debugging","env","wForgottenReturn","unhandledRejectionCheck","_notifyUnhandledRejection","unhandledRejectionClear","suppressUnhandledRejections","_ensurePossibleRejectionHandled","_setRejectionIsUnhandled","_notifyUnhandledRejectionIsHandled","fireRejectionEvent","_setReturnedNonUndefined","_returnedNonUndefined","_isRejectionUnhandled","reason","_settledValue","_setUnhandledRejectionIsNotified","_unsetUnhandledRejectionIsNotified","_isUnhandledRejectionNotified","_unsetRejectionIsUnhandled","shouldUseOwnTrace","onPossiblyUnhandledRejection","_getContext","contextBind","onUnhandledRejectionHandled","disableLongStackTraces","longStackTracesIsSupported","Promise_captureStackTrace","_captureStackTrace","Promise_attachExtraTrace","Promise_dereferenceTrace","_dereferenceTrace","longStackTracesCaptureStackTrace","longStackTracesAttachExtraTrace","longStackTracesDereferenceTrace","hasLongStackTraces","legacyHandlers","unhandledrejection","before","onunhandledrejection","after","rejectionhandled","onrejectionhandled","fireDomEvent","dispatch","legacy","dispatchEvent","CustomEvent","domEvent","detail","cancelable","Event","createEvent","initCustomEvent","fireGlobalEvent","method","generatePromiseLifecycleEventObject","eventToObjectGenerator","promiseCreated","promiseFulfilled","promiseRejected","promiseResolved","promiseCancelled","promiseChained","warning","unhandledRejection","rejectionHandled","activeFireEvent","globalEventFired","domEventFired","defaultFireEvent","cancellationExecute","executor","onCancel","_attachCancellationCallback","cancellationAttachCancellationCallback","previousOnCancel","cancellationOnCancel","cancellationSetOnCancel","cancellationClearCancellationData","cancellationPropagateFrom","flags","branchesRemainingToCancel","opts","warningsOption","_clearCancellationData","_execute","monitoring","_fireEvent","nodeSupportsAsyncResource","asyncHooks","isFulfilled","ignoreSelf","_parent","attachExtraTrace","__stackCleaned__","parsed","parseStackAndMessage","notEnumerableProp","formatAndLogError","cleanStack","isTraceLine","isInternalFrame","shouldIgnore","stackFramesAsArray","isSoft","localHandler","localEventFired","formatNonError","maxChars","snip","captureStackTrace","parseLineInfoRegex","parseLineInfo","matches","_promisesCreated","uncycle","inherits","nodes","stackToIndex","cycleEdgeNode","currentChildLength","stacks","currentLastIndex","currentLastLine","commonRootMeetPoint","removeCommonRoots","removeDuplicateOrEmptyJumps","reconstructStack","v8stackFramePattern","v8stackFormatter","stackTraceLimit","ignoreUntil","hasStackAfterThrow","isTTY","color","checkForgottenReturns","returnValue","handlerLine","creatorLine","traceLines","lineMatches","firstUserLine","setBounds","lastLineError","firstFileName","lastFileName","firstStackLines","lastStackLines","firstIndex","deprecated","replacement","returner","thrower","thenReturn","thenThrow","catchThrow","_reason","caught","catchReturn","PromiseReduce","reduce","PromiseAll","promiseAllThis","mapSeries","_TypeError","_RangeError","Objectfreeze","freeze","subError","nameProperty","defaultMessage","SubError","CancellationError","TimeoutError","AggregateError","methods","writable","OperationalError","cause","indent","errorTypes","RejectionError","isES5","getDescriptor","getOwnPropertyDescriptor","getOwnPropertyNames","propertyIsWritable","descriptor","ObjectKeys","desc","PromiseMap","catchFilter","PassThroughHandlerContext","called","cancelPromise","FinallyHandlerCancelReaction","finallyHandler","checkCancel","succeed","fail","reasonOrValue","isFinallyHandler","isRejected","_passThrough","success","lastly","tapCatch","handlerOrPredicate","catchInstances","Proxyable","yieldHandlers","PromiseSpawn","generatorFunction","yieldHandler","internal","_finallyPromise","_generatorFunction","_receiver","_generator","_yieldHandlers","_yieldedPromise","_cancellationPhase","_isResolved","_cleanup","_fulfill","_promiseCancelled","coroutine","returnSentinel","_continue","_promiseFulfilled","_promiseRejected","_run","_rejectCallback","traceParent","promiseFromYieldHandler","bitField","_proxy","PromiseSpawn$","generator","spawn","addYieldHandler","spread","MappingPromiseArray","_filter","constructor$","_callback","_preservedValues","_limit","_inFlight","_queue","_asyncInit","concurrency","_init$","_init","preservedValues","_totalResolved","_resolve","booleans","_resolveFromSyncValue","attempt","maybeWrapAsError","rErrorKey","wrapAsOperationalError","isUntypedError","markAsOriginatingFromRejection","multiArgs","wrapped","spreadAdapter","nodeback","successAdapter","errorAdapter","newReason","asCallback","nodeify","adapter","makeSelfResolutionError","reflectHandler","PromiseInspection","UNDEFINED_BINDING","setReflectHandler","getDomain","domain","getContextDomain","AsyncResource","getContextAsyncHooks","getContext","APPLY","createContext","nodebackForPromise","check","_fulfillmentHandler0","_rejectionHandler0","_promise0","_receiver0","_resolveFromExecutor","deferResolve","deferReject","fillTypes","reflect","didFulfill","didReject","_setIsFinal","fulfillmentValue","rejectionReason","originatesFromRejection","getNewLibraryCopy","is","fromNode","fromCallback","_isFateSealed","_setAsyncGuaranteed","cast","_setFulfilled","fulfilled","rejected","internalData","haveInternalData","settler","_settlePromiseCtx","_settlePromiseLateCancellationObserver","_addCallbacks","_setLength","_setRejected","_setFollowing","_isFinal","_unsetCancelled","_setNoAsyncGuarantee","_receiverAt","_promiseAt","_fulfillmentHandlerAt","_rejectionHandlerAt","_migrateCallback0","follower","fulfill","_migrateCallbackAt","proxyable","shouldBind","_setFollowee","synchronous","ignoreNonErrorWarnings","ensureErrorObject","hasStack","_settlePromiseFromHandler","_settlePromise","isPromise","asyncGuaranteed","_settlePromise0","_clearCallbackDataAtIndex","_fulfillPromises","_rejectPromises","toStringTag","defer","pending","version","toFastProperties","resolveValueIfEmpty","asArray","_iterate","_resolveEmptyArray","toResolutionValue","getActualLength","shouldCopyValues","isResolved","THIS","withAppended","defaultPromisified","__isPromisified__","noCopyPropsPattern","RegExp","defaultFilter","propsFilter","isPromisified","hasPromisified","suffix","getDataPropertyOrDefault","promisifiableMethods","suffixRegexp","inheritedDataKeys","passesDefaultFilter","keyWithoutAsyncSuffix","checkValid","makeNodePromisified","makeNodePromisifiedEval","__","defaultThis","promisified","promisifyAll","promisifier","promisifiedKey","promisify","copyDescriptors","isClass","Es6Map","mapToEntries","extractEntry","PropertiesPromiseArray","isMap","_isMap","castValue","entriesToMap","keyOffset","capacity","_capacity","_front","_willBeOverCapacity","_checkCapacity","wrapMask","front","_resizeTo","oldCapacity","srcIndex","dst","dstIndex","arrayMove","race","ReductionPromiseArray","initialValue","_each","_fn","_initialValue","_currentCancellable","_eachValues","completed","valueOrReason","gotAccum","accum","_gotAccum","gotValue","_eachComplete","sender","_resultCancelled$","toggleScheduled","div2","NativePromise","getNativePromise","MutationObserver","GlobalSetImmediate","ProcessNextTick","isRecentNode","nativePromise","standalone","cordova","attributes","toggle","observe","SettledPromiseArray","_promiseResolved","inspection","_settledValueField","settle","allSettled","CANCELLATION","_howMany","_unwrap","_initialized","howMany","isArrayResolved","_canPossiblyFulfill","_getRangeError","_addFulfilled","_fulfilled","_addRejected","_checkOutcome","_rejected","__isCancelled","hasProp","doGetThen","getThen","isAnyBluebirdPromise","doThenable","HandleWrapper","afterValue","ms","successClear","failureClear","handleWrapper","afterTimeout","NULL","thenable","_isDisposable","_getDisposer","_setDisposable","castPreservingDisposable","tryDispose","Disposer","FunctionDisposer","maybeUnwrapDisposer","isDisposer","ResourceList","doDispose","_unsetDisposable","d","using","spreadArgs","disposer","reflectedResources","resultPromise","inspections","_disposer","tryCatchTarget","globalObject","tryCatcher","Child","Parent","isPrimitive","maybeError","safeToString","appendee","defaultValue","excludedPrototypes","isExcludedProto","visitedKeys","enumeration","thisAssignmentPattern","hasMethods","hasMethodsOtherThanConstructor","hasThisAssignmentAndStaticMethods","FakeConstructor","ic","foo","rident","filledRange","isError","ignore","ArrayFrom","itResult","it","hasEnvVariables","runInAsyncScope","versions","supportsAsync","P","resolveRelativeResources","dirName","DirectoryResources","_lastSongId","nextSongId","clear","isEmpty","isCached","soundName","_exclusiveInstances","_group","playAuto","_play","playNote","playFree","_stopOldExclusiveSound","__awaiter","_arguments","step","__generator","g","label","sent","trys","ops","verb","op","NotechartLoader","BMSNotechartLoader","BmsonNotechartLoader","bluebird_1","coerceToBuffer","bufferOrArrayBuffer","Buffer","isBuffer","loadBmson","loadBMS","readerOptions","compileResult","getExpertJudgmentWindowForBmson","judgeRank","judge_rank","songInfoForBmson","musicalScoreForBmson","stuff","eyecatch_image","back_image","keysForBmson","hasScratch","beatForPulseForBmson","init_bpm","bpm_events","stop_events","soundChannelsForBmson","sound_channels","soundChannel","bmsonInfo","chart_name","subtitle","getSubtitles","timingForBmson","nextKeysoundNumber","soundChannels","soundChannels_1","soundChannels_1_1","name_1","soundChannelNotes","sortedNotes","keysoundNumber","keysoundId","padStart","slices","sortedNotes_1","sortedNotes_1_1","getColumn","notesDataAndKeysoundsDataForBmsonAndTiming","legacy_1","resolution","soundChannels_2","soundChannels_2_1","e_5","e_6","hasKeys","hasSecondPlayer","hasDeluxeKeys","soundChannels_3","soundChannels_3_1","notes_2","notes_2_1","e_6_1","e_5_1","notecharts","autoplayer","waveFactory","_waveFactory","_played","_autosound","_playAutokeysounds","_playAutosounds","_handleSoundNotifications","auto","autosounds","_hitNote","soundNotifications","_breakNote","timer","BUTTONS","StatsRecorder","BEMUSE_TOUCH_STATS","record","localStorage","scratchStartY","scratchY","getInput","getScratch","_expand","getBounds","contains","getButton","bounds","getPinch","pinchThreshold","statsRecorder","lane","rectangle","newRect","clone","createTouchButton","onclick","_wrapper","_createWrapper","panelPlacement","infoPanelPosition","_createTouchEscapeButton","_createFullScreenButton","_escapeHintShown","escapeHandler","_onEscape","replayHandler","_onReplay","_started","gameState","_getData","_updateStatefulData","_synchronizeVideo","_synchronizeTutorialEscapeHint","_video","_videoStarted","_videoOffset","_escapeHint","_getReady","_getSongTime","playerDisplay","playerData","$wrapper","attr","append","find","addClass","appendTo","touchButtons","addTouchButton","escapeHint","textContent","request","isCommonjs","keyboardAllowed","Element","fnMap","eventNameMap","change","fullscreenchange","fullscreenerror","screenfull","elem","requestFullscreen","userAgent","ALLOW_KEYBOARD_INPUT","exitFullscreen","isFullscreen","onchange","raw","defineProperties","fullscreenElement","fullscreenEnabled","keysoundCache","_assets","_keysoundCache","loadProgress","decodeProgress","ondecode","_loadSample","fromPairs","_getFile","_decode","Judgment","UNJUDGED","MISSED","Missed","NORMAL_TIMEGATES","timegate","endTimegate","TRANSITIONAL_BEGINNER_LV5_TIMEGATES","TRANSITIONAL_BEGINNER_LV4_TIMEGATES","TRANSITIONAL_BEGINNER_LV3_TIMEGATES","ABSOLUTE_BEGINNER_TIMEGATES","FixedTimegatesJudge","timegates","getTimegates","_noteTime","TutorialJudge","noteTime","NORMAL_JUDGE","getJudgeForNotechart","insane","judgeTimeWith","judge","judgeTime","judgeEndTime","isBad","breaksCombo","weight","BYTES_FORMATTER","PERCENTAGE_FORMATTER","EXTRA_FORMATTER","_slice","Bacon","Exception","nop","former","assert","condition","assertObservableIsProperty","_isObservable","_isProperty","assertFunction","isFunction","isObservable","assertNoArguments","extend","inherit","ctor","symbol","indexWhere","always","negate","empty","filtered","toArray","without","remove","fold","seed","ys","cached","None","_isNone","me","recursionDepth","UpdateBarrier","rootEvent","waiterObs","waiters","aftersStack","aftersStackHeight","flushed","ensureStackHeight","afterTransaction","obs","stackIndexForThisObs","containsObs","processAfters","aftersList","stackSizeAtStart","topOfStack","topAfters","_topAfters$index","callSuccess","flushWaiters","obsId","obsWaiters","flushDepsOf","dep","internalDeps","whenDoneWith","hasWaiters","inTransaction","flush","currentEventId","wrappedSubscribe","unsubd","shouldUnsub","doUnsub","unsub","dispatcher","subscribe","noMore","Source","sync","lazy","ConsumingSource","BufferingSource","Desc","_isSource","markEnded","ended","consume","mayHave","hasAtLeast","flatten","isTrigger","_isEventStream","fromObservable","_isDesc","findDeps","describe","_len","_key","withDesc","withMethodCallSupport","_len2","_key2","makeFunctionArgs","makeFunction_","partiallyApplied","applied","_len3","_key3","toFieldExtractor","partFuncs","fieldValue","toSimpleExtractor","isFieldKey","_len4","_key4","makeFunction","convertArgsToFunction","sampled","sampledBy","_ref","_ref2","toCombinator","toFieldKey","left","right","Some","_isSome","getOrElse","isDefined","inspect","toOption","more","eventIdCounter","valueF","eager","_isNext","valueInternal","Initial","End","_isEvent","isEvent","isEnd","isInitial","isNext","hasValue","fmap","_isInitial","toNext","initialEvent","nextEvent","endEvent","toEvent","idCounter","registerObs","Observable","initialDesc","CompositeUnsubscribe","ss","unsubscribed","subscriptions","starting","Dispatcher","_subscribe","_handleEvent","handleEvent","pushing","prevError","unsubSrc","EventStream","subscribeInternal","onValues","onEnd","withDescription","subscription","_this2","iterable","hasSubscribers","removeSub","pushIt","pushToSubscriptions","tmp","sub","unsubscribeFromSource","toProperty","initValue_","initValue","disp","Property","initSent","subbed","reply","sendInit","toEventStream","withHandler","usage","sources","pats","patterns","patSources","constantToFunction","pat","ixs","triggerFound","ix","needsBarrier","containsDuplicateDeps","resultStream","triggers","ends","i1","cannotSync","cannotMatch","nonFlattened","trigger","unsubAll","flushLater","flushWhileTriggers","events","i2","_p","observables","checkObservable","PropertyDispatcher","property","currentValueRootId","propertyEnded","groupSimultaneous","_len5","streams","_key5","_len6","_key6","maybeSubSource","_this3","dispatchingId","valId","_this4","_this5","constant","eventTransformer","unbound","shouldUnbind","unbind","unbinder","_len7","_key7","_len8","_key8","argumentsToObservables","argumentsToObservablesAndFunction","combineAsArray","stream","_len9","_key9","combineWith","_argumentsToObservablesAndFunction","other","combinator","withStateMachine","initState","fromF","newState","equals","isNone","skipDuplicates","isEqual","awaiting","not","and","or","scheduler","bufferWithTime","bufferWithTimeOrCount","MAX_VALUE","bufferWithCount","flushOrSchedule","onInput","onFlush","scheduled","valuesToPush","_this6","delayMs","_this7","_len10","_key10","unsubRight","unsubLeft","addPropertyInitValueToStream","concatAll","justInitValue","flatMap_","makeSpawner","flatMapFirst","makeObservable","firstOnly","rootDep","childDeps","composite","unsubMe","checkQueue","checkEnd","unsubRoot","Bus","subscribeAll","guardedSink","flatMapWithConcurrencyLimit","_len11","_key11","flatMapConcat","later","bufferingThrottle","minimumInterval","newSink","subscribeInput","_this8","unsubscribeInput","plug","_this9","assertObservable","rootPush","pushQueue","liftCallback","_len12","_key12","_len13","_key13","fromNodeCallback","_len14","_key14","combineTemplate","template","setValue","ctxStack","mkContext","containsObservables","funcs","applyStreamValue","newContext","pushContext","compileTemplate","constantValue","resultProperty","rootContext","mapEnd","skipErrors","takeUntil","stopper","endMarker","_event$value","flatMapLatest","delayChanges","debounce","debounceImmediate","cases","scan","_this10","acc","initHandled","prevTuple","tuple","doAction","doEnd","doError","_len15","_key15","endOnError","_len16","_key16","take","first","mapError","flatScan","updated","sampler","thisSource","samplerSource","_len17","_key17","eventMethods","valueAndEnd","fromEventTarget","_findHandlerMethods","pair","methodPair","addListener","findHandlerMethods","fromPoll","poll","abort","bound","keyF","limitF","similar","limited","assertArray","pushNeeded","holdWhen","valve","onHold","bufferedValues","srcIsEnded","subscribed","endIfBothEnded","toSend","$","asEventStream","selector","_this11","jQuery","Zepto","lastEvent","_len18","_key18","merge","assertEventStream","mergeAll","sinks","unsubBoth","repeatedly","repeat","subscribeNext","retry","retries","retriesDone","isRetryable","valueStream","pause","sequentially","skip","skipUntil","starter","skipWhile","ok","_len19","_key19","slidingWindow","minValues","spies","spy","ESObservable","observable","startWith","takeWhile","_len20","_key20","throttle","firstToPromise","PromiseCtr","_this12","toPromise","initial","lateBindFirst","_len22","_key22","_len21","_key21","zipAsArray","_len23","_key23","zipWith","_len24","_key24","_len25","_key25","observablesAndFunction","zip","observerOrOnNext","onComplete","observer","complete","closed","toESObservable","fromESObservable","readAsArrayBuffer","lodash_uniq_1","lodash_map_1","lodash_values_1","lodash_assign_1"],"mappings":"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","file":"build/game-ab83bf828664b663d844.js","sourcesContent":["import { BYTES_FORMATTER } from 'bemuse/progress/formatters'\nimport { Progress } from './Progress'\n\n/**\n * Returns a callback that, when called,\n * update the progress with increasing `current` value,\n * out of a fixed `total`.\n */\nexport function fixed(total: number, progress: Progress) {\n  if (!progress) return () => {}\n  let loaded = 0\n  progress.report(0, total)\n  return (extra: any) => progress.report(++loaded, total, extra)\n}\n\n/**\n * Updates the progress with the result of an atomic operation.\n */\nexport function atomic<T>(\n  progress: Progress,\n  promise: PromiseLike<T>\n): PromiseLike<T> {\n  if (!progress) return promise\n  return Promise.resolve(promise).tap((data) => {\n    if (hasByteLength(data)) {\n      progress.formatter = BYTES_FORMATTER\n      progress.report(data.byteLength, data.byteLength)\n    } else {\n      progress.report(1, 1)\n    }\n  })\n}\nfunction hasByteLength(data: any): data is { byteLength: number } {\n  return data && data.byteLength\n}\n\n/**\n * Wraps an async function that may be called multiple times.\n * Each call adds to the total, and each async resolution adds to current.\n */\nexport function wrapPromise<A extends any[], R>(\n  progress: Progress,\n  f: (...args: A) => PromiseLike<R>\n): (...args: A) => PromiseLike<R> {\n  let current = 0\n  let total = 0\n  return function (this: any, ...args: A) {\n    progress.report(current, ++total)\n    return Promise.resolve(f.apply(this, args)).tap(() =>\n      progress.report(++current, total)\n    )\n  }\n}\n\nexport function bind(from: Progress, to: Progress) {\n  return from.watch(() => to.report(from.current!, from.total!, from.extra))\n}\n\n/**\n * Updates the `target` with progress data from multiple sources.\n */\nexport function simultaneous(target: Progress) {\n  let queue: Progress[] = []\n  let current: Progress | undefined\n  let unsubscribe: (() => void) | null = null\n  function update() {\n    if (current) {\n      target.report(current.current!, current.total!, current.extra)\n    }\n    if (queue.length > 0 && (!current || current.progress! >= 1)) {\n      bind(queue.shift()!)\n    }\n  }\n  function bind(progress: Progress) {\n    if (current === progress) {\n      return\n    }\n    if (unsubscribe) {\n      unsubscribe()\n      unsubscribe = null\n    }\n    current = progress\n    if (current) {\n      unsubscribe = current.watch(update)\n    }\n  }\n  return {\n    add(progress: Progress) {\n      queue.push(progress)\n      update()\n    },\n  }\n}\n","\"use strict\";\n/**\n * Public: The `bms` package is a library for working with rhythm game data.\n *\n * Although this librarys name suggests that it is for BMS file format,\n * almost every part can be used standalone.\n *\n * This package contains:\n *\n * - __Modules that reads and parses BMS files:__\n *\n *   - {Reader} reads the BMS file from a {Buffer}, detects the character set\n *     and decodes the buffer using that character set into a {String}.\n *   - {Compiler} reads the BMS source from a {String}, and converts into\n *     {BMSChart}, an internal representation of a BMS notechart.\n *\n * - __Classes for representing a BMS notechart.__\n *   These module stores the data as close to the BMS file format as possible.\n *\n *   Almost no musical interpretation is made.\n *   For example, a BPM change is simply represented using a\n *   BMSObject with `channel` = `03` or `08`.\n *\n *   - {BMSChart} is composed of {BMSHeaders}, {BMSObjects}, and {TimeSignatures}.\n *   - {BMSHeaders} represents the header sentences in a BMS file.\n *   - {BMSObjects} represents the objects in a BMS file.\n *   - {BMSObject} represents a single object.\n *\n * - __Classes that represent different aspects of a notechart.__\n *   Instance of these classes may be created from a {BMSChart},\n *   but they can be used in a standalone manner as well.\n *\n *   This makes this library very flexible,\n *   and able to accommodate different formats of notechart.\n *   For example, see the [bmson](https: *github.com/bemusic/bmson) package.\n *\n *   Its also possible to use these classes in context other than music gaming,\n *   for example, you can use these classes to help building a music player\n *   that requires precise synchronization between beats.\n *\n *   - {TimeSignatures} represents a collection of time signatures\n *     in a musical score, and lets you convert the measure number and fraction\n *     into beat number.\n *   - {Timing} represents the timing information in a musical score,\n *     and provides methods to convert between musical time (beats) and\n *     metric time (seconds).\n *   - {SongInfo} represents the basic song information,\n *     such as title, artist, and genre.\n *   - {Notes} represents the sound objects inside your notechart.\n *   - {Keysounds} represents a mapping between keysound ID and filename.\n *   - {Positioning} represents a mapping between beat and in-game position.\n *     Some rhythm game lets chart author control the amount of scrolling\n *     per beat. In StepMania 5, this is called the scroll segments.\n *   - {Spacing} represents a mapping between beat and note spacing.\n *     Some rhythm game lets chart author change the note spacing (HI-SPEED)\n *     dynamically. In StepMania 5, this is called the speed segments.\n *\n * - __Low-level utility classes:__\n *\n *   - {Speedcore} represents a linear animation.\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Compiler = exports.Reader = void 0;\nvar Reader = __importStar(require(\"./reader\"));\nexports.Reader = Reader;\nvar Compiler = __importStar(require(\"./compiler\"));\nexports.Compiler = Compiler;\n__exportStar(require(\"./reader/types\"), exports);\n__exportStar(require(\"./bms/chart\"), exports);\n__exportStar(require(\"./bms/headers\"), exports);\n__exportStar(require(\"./bms/objects\"), exports);\n__exportStar(require(\"./speedcore\"), exports);\n__exportStar(require(\"./time-signatures\"), exports);\n__exportStar(require(\"./notes\"), exports);\n__exportStar(require(\"./timing\"), exports);\n__exportStar(require(\"./song-info\"), exports);\n__exportStar(require(\"./keysounds\"), exports);\n__exportStar(require(\"./positioning\"), exports);\n__exportStar(require(\"./spacing\"), exports);\n//# sourceMappingURL=index.js.map","module.exports = __webpack_public_path__ + \"build/7d6d69a86d70e4e52079c5ce873435c6.jpg\";","export default document.querySelector('#scene-root')\n","import $ from 'jquery'\n\nexport default function GameScene(display) {\n  return function (container) {\n    let handler = () => false\n    $(window).on('touchstart', handler)\n    showCanvas(display, container)\n    return {\n      teardown() {\n        $(window).off('touchstart', handler)\n      },\n    }\n  }\n}\n\nfunction showCanvas(display, container) {\n  var { view, wrapper } = display\n  var { width, height } = view\n  container.appendChild(wrapper)\n  container.addEventListener('touchstart', disableContextMenu)\n  function disableContextMenu() {\n    container.removeEventListener('touchstart', disableContextMenu)\n    container.addEventListener('contextmenu', (e) => {\n      e.preventDefault()\n    })\n  }\n\n  resize()\n  $(window).on('resize', resize)\n\n  function resize() {\n    var scale = Math.min(window.innerWidth / width, window.innerHeight / height)\n    view.style.width = Math.round(width * scale) + 'px'\n    view.style.height = Math.round(height * scale) + 'px'\n    wrapper.style.width = Math.round(width * scale) + 'px'\n    wrapper.style.height = Math.round(height * scale) + 'px'\n    var yOffset = (window.innerHeight - height * scale) / 2\n    wrapper.style.marginTop = Math.round(yOffset) + 'px'\n  }\n\n  return wrapper\n}\n","\nvar content = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingScene.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingScene.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingScene.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","var escape = require(\"../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/url/escape.js\");\nexports = module.exports = require(\"../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@charset \\\"UTF-8\\\";\\n.LoadingScene {\\n  background: url(\" + escape(require(\"bemuse/ui/images/bg/a.jpg\")) + \") center no-repeat;\\n  background-size: cover;\\n}\\n.LoadingSceneinfo {\\n  position: absolute;\\n  top: 40%;\\n  left: 0;\\n  right: 0;\\n  -webkit-transform: translateY(-50%);\\n          transform: translateY(-50%);\\n}\\n.LoadingScene .LoadingSceneSongInfo {\\n  -webkit-animation: loading-scene--loading-scene-song-info--animation 1s ease;\\n          animation: loading-scene--loading-scene-song-info--animation 1s ease;\\n}\\n.LoadingScene .LoadingSceneProgress {\\n  position: absolute;\\n  bottom: 10px;\\n  left: 10px;\\n}\\n.LoadingSceneimage {\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n}\\n.LoadingSceneimage img {\\n  width: 100%;\\n  height: 100%;\\n  display: block;\\n  object-fit: cover;\\n  -webkit-animation: loading-scene--eyecatch-fade 0.8s;\\n          animation: loading-scene--eyecatch-fade 0.8s;\\n}\\n.LoadingSceneflash {\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  opacity: 0;\\n  pointer-events: none;\\n  background: white;\\n  -webkit-animation: loading-scene--flash-animation 0.8s ease-out;\\n          animation: loading-scene--flash-animation 0.8s ease-out;\\n}\\n.LoadingScenecover {\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  opacity: 0;\\n  pointer-events: none;\\n  background: black;\\n}\\n.Scene.is-exiting .LoadingSceneinfo {\\n  -webkit-animation: loading-scene--info-exit 0.3s linear;\\n          animation: loading-scene--info-exit 0.3s linear;\\n}\\n.Scene.is-exiting .LoadingSceneflash {\\n  -webkit-animation: loading-scene--flash-exit 0.3s ease;\\n          animation: loading-scene--flash-exit 0.3s ease;\\n}\\n.Scene.is-exiting .LoadingScenecover {\\n  -webkit-animation: loading-scene--cover-exit 0.3s linear;\\n          animation: loading-scene--cover-exit 0.3s linear;\\n  opacity: 1;\\n}\\n\\n@-webkit-keyframes loading-scene--eyecatch-fade {\\n  0% {\\n    opacity: 0;\\n  }\\n  100% {\\n    opacity: 1;\\n  }\\n}\\n\\n@keyframes loading-scene--eyecatch-fade {\\n  0% {\\n    opacity: 0;\\n  }\\n  100% {\\n    opacity: 1;\\n  }\\n}\\n@-webkit-keyframes loading-scene--loading-scene-song-info--animation {\\n  0% {\\n    -webkit-transform: scale(1.5, 0.02);\\n            transform: scale(1.5, 0.02);\\n  }\\n  100% {\\n    -webkit-transform: scale(1, 1);\\n            transform: scale(1, 1);\\n  }\\n}\\n@keyframes loading-scene--loading-scene-song-info--animation {\\n  0% {\\n    -webkit-transform: scale(1.5, 0.02);\\n            transform: scale(1.5, 0.02);\\n  }\\n  100% {\\n    -webkit-transform: scale(1, 1);\\n            transform: scale(1, 1);\\n  }\\n}\\n@-webkit-keyframes loading-scene--info-exit {\\n  0% {\\n    -webkit-transform: translateY(-50%) scale(1, 1);\\n            transform: translateY(-50%) scale(1, 1);\\n  }\\n  100% {\\n    -webkit-transform: translateY(-50%) scale(2, 2);\\n            transform: translateY(-50%) scale(2, 2);\\n  }\\n}\\n@keyframes loading-scene--info-exit {\\n  0% {\\n    -webkit-transform: translateY(-50%) scale(1, 1);\\n            transform: translateY(-50%) scale(1, 1);\\n  }\\n  100% {\\n    -webkit-transform: translateY(-50%) scale(2, 2);\\n            transform: translateY(-50%) scale(2, 2);\\n  }\\n}\\n@-webkit-keyframes loading-scene--cover-exit {\\n  0% {\\n    opacity: 0;\\n  }\\n  100% {\\n    opacity: 1;\\n  }\\n}\\n@keyframes loading-scene--cover-exit {\\n  0% {\\n    opacity: 0;\\n  }\\n  100% {\\n    opacity: 1;\\n  }\\n}\\n@-webkit-keyframes loading-scene--flash-animation {\\n  0% {\\n    opacity: 1;\\n  }\\n  100% {\\n    opacity: 0;\\n  }\\n}\\n@keyframes loading-scene--flash-animation {\\n  0% {\\n    opacity: 1;\\n  }\\n  100% {\\n    opacity: 0;\\n  }\\n}\\n@-webkit-keyframes loading-scene--flash-exit {\\n  0% {\\n    opacity: 0.5;\\n  }\\n  100% {\\n    opacity: 0;\\n  }\\n}\\n@keyframes loading-scene--flash-exit {\\n  0% {\\n    opacity: 0.5;\\n  }\\n  100% {\\n    opacity: 0;\\n  }\\n}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingSceneSongInfo.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingSceneSongInfo.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingSceneSongInfo.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@charset \\\"UTF-8\\\";\\n.LoadingSceneSongInfo {\\n  background: rgba(255, 255, 255, 0.96);\\n  color: #191817;\\n  text-align: center;\\n  padding: 25px 0px;\\n  box-shadow: 0 2px 18px rgba(0, 0, 0, 0.2);\\n}\\n.LoadingSceneSongInfogenre {\\n  font-size: 1.2rem;\\n}\\n.LoadingSceneSongInfotitle {\\n  font-size: 3.2rem;\\n  font-weight: bold;\\n}\\n.LoadingSceneSongInfosubtitle {\\n  font-size: 2.4rem;\\n}\\n.LoadingSceneSongInfoartist {\\n  font-size: 1.6rem;\\n  margin-top: 0.8ex;\\n}\\n.LoadingSceneSongInfosubartist {\\n  font-size: 1rem;\\n}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingSceneProgress.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingSceneProgress.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingSceneProgress.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@charset \\\"UTF-8\\\";\\n.LoadingSceneProgress {\\n  color: #333;\\n  font-size: 11px;\\n}\\n.LoadingSceneProgress .LoadingSceneProgressBar {\\n  display: inline-block;\\n  vertical-align: middle;\\n  width: 48px;\\n  margin-right: 4px;\\n  position: relative;\\n  top: -1px;\\n}\\n.LoadingSceneProgressextra {\\n  font-size: 83%;\\n  opacity: 0.7;\\n}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingSceneProgressBar.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingSceneProgressBar.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./LoadingSceneProgressBar.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@charset \\\"UTF-8\\\";\\n.LoadingSceneProgressBar {\\n  border: 1px solid rgba(0, 0, 0, 0.6);\\n  padding: 1px;\\n}\\n.LoadingSceneProgressBarbar {\\n  height: 8px;\\n  background: rgba(0, 0, 0, 0.6);\\n  width: 0%;\\n}\", \"\"]);\n\n// exports\n","import Progress from 'bemuse/progress'\nimport download from 'bemuse/utils/download'\nimport { basename } from 'path'\nimport { IResource, IResources } from './types'\n\nexport class URLResource implements IResource {\n  constructor(private url: string) {}\n  read(progress: Progress) {\n    return download(this.url).as('arraybuffer', progress)\n  }\n  async resolveUrl() {\n    return Promise.resolve(this.url)\n  }\n  get name() {\n    return basename(this.url)\n  }\n}\n\nexport class URLResources implements IResources {\n  constructor(public base: URL) {}\n  async file(name: string): Promise<IResource> {\n    const path = name\n      .split('/')\n      .map((part) => encodeURIComponent(part))\n      .join('/')\n    return new URLResource(new URL(path, this.base).href)\n  }\n}\n\nexport default URLResource\n","import { BYTES_FORMATTER } from 'bemuse/progress/formatters'\n\n// Downloads the file from the URL.\n// The download will not actually be started unless the ``as()`` method\n// is called.\n//\n// .. js:function:: as(type)\n//\n//    Initiates the download as ``type``. The ``type`` is a string such as\n//    \"arraybuffer\" or \"blob\".\nexport function download(\n  url,\n  { getRetryDelay = () => 1000 + Math.random() * 4000 } = {}\n) {\n  return {\n    async as(type, progress) {\n      let shouldGiveUp = false\n      for (let i = 1; ; i++) {\n        try {\n          return await attempt()\n        } catch (error) {\n          console.error(`Unable to download ${url} [attempt ${i}]`, error)\n          if (i >= 3 || shouldGiveUp) throw error\n          const waitMs = getRetryDelay()\n          await new Promise((resolve) => setTimeout(resolve, waitMs))\n        }\n      }\n      function attempt() {\n        return new Promise((resolve, reject) => {\n          var xh = new XMLHttpRequest()\n          xh.open('GET', url, true)\n          xh.responseType = type\n          xh.onload = () => {\n            if (+xh.status === 200) {\n              resolve(xh.response)\n            } else {\n              if (+xh.status === 403 || +xh.status === 404) {\n                shouldGiveUp = true\n              }\n              reject(new Error(`Unable to download ${url}: HTTP ${xh.status}`))\n            }\n          }\n          xh.onerror = () => reject(new Error(`Unable to download ${url}`))\n          if (progress) {\n            progress.formatter = BYTES_FORMATTER\n            xh.onprogress = (e) => progress.report(e.loaded, e.total)\n          }\n          xh.send(null)\n        })\n      }\n    },\n  }\n}\n\nexport default download\n","// !! avoid external dependencies since this is used in boot script!\n\nimport { Progress } from './Progress'\nexport default Progress\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.match = void 0;\nfunction match(text) {\n    var matched = false;\n    return {\n        when: function (pattern, callback) {\n            if (matched)\n                return this;\n            var match = text.match(pattern);\n            if (match) {\n                matched = true;\n                callback(match);\n            }\n            return this;\n        },\n        else: function (callback) {\n            if (matched)\n                return this;\n            callback();\n        },\n    };\n}\nexports.match = match;\n//# sourceMappingURL=match.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BMSHeaders = void 0;\n/**\n * A BMSHeader holds the header information in a BMS file, such as\n * `#TITLE`, `#ARTIST`, or `#BPM`.\n *\n * You get retrieve a header using the `get()` method:\n *\n * ```js\n * chart.headers.get('title')\n * ```\n *\n * For some header fields that may contain multiple values, such as `#SUBTITLE`,\n * you can get them all using `getAll()`:\n *\n * ```js\n * chart.headers.getAll()\n * ```\n */\nvar BMSHeaders = /** @class */ (function () {\n    function BMSHeaders() {\n        this._data = {};\n        this._dataAll = {};\n    }\n    /**\n     * Iterates through each header field using a callback function.\n     * @param callback will be called for each header field\n     */\n    BMSHeaders.prototype.each = function (callback) {\n        for (var i in this._data) {\n            callback(i, this._data[i]);\n        }\n    };\n    /**\n     * Retrieves the header fields latest value.\n     * @param name fields name\n     * @return the fields latest value\n     */\n    BMSHeaders.prototype.get = function (name) {\n        return this._data[name.toLowerCase()];\n    };\n    /**\n     * Retrieves the header fields values.\n     * This is useful when a header field is specified multiple times.\n     * @param name fields name\n     */\n    BMSHeaders.prototype.getAll = function (name) {\n        return this._dataAll[name.toLowerCase()];\n    };\n    /**\n     * Sets the header fields value.\n     * @param name fields name\n     * @param value fields value\n     */\n    BMSHeaders.prototype.set = function (name, value) {\n        var key = name.toLowerCase();\n        this._data[key] = value;\n        (this._dataAll[key] || (this._dataAll[key] = [])).push(value);\n    };\n    return BMSHeaders;\n}());\nexports.BMSHeaders = BMSHeaders;\n//# sourceMappingURL=headers.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BMSObjects = void 0;\n/**\n * BMSObjects holds a collection of objects inside a BMS notechart.\n */\nvar BMSObjects = /** @class */ (function () {\n    function BMSObjects() {\n        this._objects = [];\n    }\n    /**\n     * Adds a new object to this collection.\n     * If an object already exists on the same channel and position,\n     * the object is replaced (except for autokeysound tracks).\n     * @param object the object to add\n     */\n    BMSObjects.prototype.add = function (object) {\n        if (object.channel !== '01') {\n            for (var i = 0; i < this._objects.length; i++) {\n                var test = this._objects[i];\n                if (test.channel === object.channel &&\n                    test.measure === object.measure &&\n                    test.fraction === object.fraction) {\n                    this._objects[i] = object;\n                    return;\n                }\n            }\n        }\n        this._objects.push(object);\n    };\n    /**\n     * Returns an array of all objects.\n     */\n    BMSObjects.prototype.all = function () {\n        return this._objects.slice();\n    };\n    /**\n     * Returns a sorted array of all objects.\n     */\n    BMSObjects.prototype.allSorted = function () {\n        var list = this.all();\n        list.sort(function (a, b) {\n            return a.measure + a.fraction - (b.measure + b.fraction);\n        });\n        return list;\n    };\n    return BMSObjects;\n}());\nexports.BMSObjects = BMSObjects;\n//# sourceMappingURL=objects.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TimeSignatures = void 0;\n/**\n * A TimeSignatures is a collection of time signature values\n * index by measure number.\n *\n * The measure number starts from 0.\n * By default, each measure has a measure size of 1\n * (which represents the common 4/4 time signature)\n *\n * ## Example\n *\n * If you have a BMS like this:\n *\n * ```\n * #00102:0.75\n * #00103:1.25\n * ```\n *\n * Having parsed it using a {Compiler} into a {BMSChart},\n * you can access the {TimeSignatures} object:\n *\n * ```js\n * var timeSignatures = bmsChart.timeSignatures\n * ```\n *\n * Note that you can also use the constructor\n * to create a {TimeSignatures} from scratch.\n *\n * One of the most useful use case of this class\n * is to convert the measure and fraction into beat number.\n *\n * ```js\n * timeSignatures.measureToBeat(0, 0.000) // =>  0.0\n * timeSignatures.measureToBeat(0, 0.500) // =>  2.0\n * timeSignatures.measureToBeat(1, 0.000) // =>  4.0\n * timeSignatures.measureToBeat(1, 0.500) // =>  5.5\n * timeSignatures.measureToBeat(2, 0.000) // =>  7.0\n * timeSignatures.measureToBeat(2, 0.500) // =>  9.5\n * timeSignatures.measureToBeat(3, 0.000) // => 12.0\n * ```\n */\nvar TimeSignatures = /** @class */ (function () {\n    function TimeSignatures() {\n        this._values = {};\n    }\n    /**\n     * Sets the size of a specified measure.\n     * @param measure the measure number, starting from 0\n     * @param value the measure size.\n     *  For example, a size of 1.0 represents a common 4/4 time signature,\n     *  whereas a size of 0.75 represents the 3/4 or 6/8 time signature.\n     */\n    TimeSignatures.prototype.set = function (measure, value) {\n        this._values[measure] = value;\n    };\n    /**\n     * Retrieves the size of a specified measure.\n     * @param measure representing the measure number.\n     * @returns the size of the measure.\n     *  By default, a measure has a size of 1.\n     */\n    TimeSignatures.prototype.get = function (measure) {\n        return this._values[measure] || 1;\n    };\n    /**\n     * Retrieves the number of beats in a specified measure.\n     *\n     * Since one beat is equivalent to a quarter note in 4/4 time signature,\n     * this is equivalent to `(timeSignatures.get(measure) * 4)`.\n     * @param measure representing the measure number.\n     * @returns the size of the measure in beats.\n     */\n    TimeSignatures.prototype.getBeats = function (measure) {\n        return this.get(measure) * 4;\n    };\n    /**\n     * Converts a measure number and a fraction inside that measure\n     * into the beat number.\n     *\n     * @param measure the measure number.\n     * @param fraction the fraction of a measure,\n     * @returns the number of beats since measure 0.\n     */\n    TimeSignatures.prototype.measureToBeat = function (measure, fraction) {\n        var sum = 0;\n        for (var i = 0; i < measure; i++)\n            sum += this.getBeats(i);\n        return sum + this.getBeats(measure) * fraction;\n    };\n    return TimeSignatures;\n}());\nexports.TimeSignatures = TimeSignatures;\n//# sourceMappingURL=index.js.map","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","import query from 'bemuse/utils/query'\n\nexport function shouldShowOptions() {\n  return query.BEMUSE_SHOW_OPTIONS === '1'\n}\n\nexport function shouldEnableBenchmark() {\n  return query.BEMUSE_BENCHMARK === '1'\n}\n\nexport function shouldDisableFullScreen() {\n  return query.BEMUSE_NO_FULLSCREEN === '1'\n}\n\nexport function shouldShowAbout() {\n  return query.BEMUSE_SHOW_ABOUT === '1'\n}\n\nexport function shouldShowModeSelect() {\n  return query.BEMUSE_SHOW_MODE_SELECT === '1'\n}\n\nexport function isTitleDisplayMode() {\n  return query.BEMUSE_TITLE_DISPLAY === '1'\n}\n","import PlayerAudio from './player-audio'\n\nexport class GameAudio {\n  constructor({ game, samples, master }) {\n    const volume = game.options.soundVolume\n    this._master = master\n    this._context = master.audioContext\n    this._players = new Map(\n      game.players.map((player) => [\n        player,\n        new PlayerAudio({ player, samples, master, volume }),\n      ])\n    )\n  }\n  destroy() {\n    this._master.destroy()\n  }\n  unmute() {\n    this._master.unmute()\n  }\n  get context() {\n    return this._context\n  }\n  update(t, state) {\n    for (let [player, playerAudio] of this._players) {\n      playerAudio.update(t, state.player(player))\n    }\n  }\n}\n\nexport default GameAudio\n","import now from 'bemuse/utils/now'\n\n// The game clock provides a high-accuracy time source for the game.\n//\n// We want our timing to be based on audio. If the audio lags, the time\n// clock should lag with the audio as well, in order to keep the game\n// time in sync with the background audio.\n//\n// But there is a problem on some browsers (Android):\n// ``AudioContext.currentTime`` is not precise. Therefore, we take the\n// average of the offset between system time (which is more precise)\n// and the audio time to compute a high-precision-and-accuracy time.\n//\nexport class Clock {\n  constructor(audio) {\n    audio.unmute() // kick start the currentTime of audio context\n\n    this._context = audio.context\n    this._offset = []\n    this._sum = 0\n    this.update()\n  }\n\n  // Updates the clock. This method should be called every frame.\n  update() {\n    let realTime = now() / 1000\n    let delta = realTime - this._context.currentTime\n    this._offset.push(delta)\n    this._sum += delta\n    while (this._offset.length > 60) {\n      this._sum -= this._offset.shift()\n    }\n\n    // The clock's time value, in seconds.\n    this.time = realTime - this._sum / this._offset.length\n  }\n}\n\nexport default Clock\n","import now from 'bemuse/utils/now'\n\n// The game timer keeps track of song progression in-game.\n// This class should be tied to the AudioContext.\n//\nexport class GameTimer {\n  constructor(clock, input) {\n    this._clock = clock\n    this._input = input\n    this._now = now.synchronized()\n    this._lastRecordedTimeSinceStart = 0\n    this.startTime = null\n    this._pauseAtTimerValue = Infinity\n    this._unpausedTimeSinceStart = 0\n    this._unpausedTimerValue = 0\n    this.readyFraction = 0\n    this.gettingStarted = false\n  }\n\n  // True if the game is started, false otherwise.\n  get started() {\n    return this.startTime !== null\n  }\n\n  // Updates the timer. This method should be called once in the game loop.\n  update() {\n    this._checkStartGame()\n    // The time, in seconds, since the start of the game.\n    this.time = this._calculateTime()\n  }\n\n  _checkStartGame() {\n    if (this.started) return\n    if (this._input.get('start').value) {\n      this.gettingStarted = true\n    }\n    if (this.gettingStarted && !this._input.get('start').value) {\n      this.startTime = this._clock.time + this._getWait()\n    }\n    if (!this.started) {\n      // The number in range 0...1 representing the progression in this second.\n      // When player presses the \"Start\" button, the game will wait for the\n      // next second before actually starting the game.\n      // Since the clock is synchronized globally, if player presses start\n      // in the same second, the game will start at the same time.\n      //\n      this.readyFraction = 1 - this._getWait()\n    }\n  }\n  _getWait() {\n    let t = this._now() / 1000\n    return Math.ceil(t) - t\n  }\n\n  _calculateTime() {\n    // When initializing the game, we suspend the timer at -0.333 seconds.\n    // Then, when the player starts the game, we slowly accelerate such that\n    // after 1 second, the timer approaches 0 seconds at normal speed.\n    // This is accomplished using some magic formula ;).\n    //\n    var delta = this.startTime === null ? 0 : this._clock.time - this.startTime\n    if (delta < 0) delta = 0\n    if (delta < 1) {\n      return (Math.pow(delta, 6) - 1) / 6 - 1 / 30\n    } else {\n      const timeSinceStart = delta - 31 / 30\n      this._lastRecordedTimeSinceStart = timeSinceStart\n      const projectedTimerValue =\n        this._unpausedTimerValue +\n        (timeSinceStart - this._unpausedTimeSinceStart)\n      return Math.min(projectedTimerValue, this._pauseAtTimerValue)\n    }\n  }\n  pauseAt(timerValueToPause) {\n    if (\n      this._unpausedTimerValue +\n        (this._lastRecordedTimeSinceStart - this._unpausedTimeSinceStart) >=\n      this._pauseAtTimerValue\n    ) {\n      this._unpausedTimerValue = this._pauseAtTimerValue\n      this._unpausedTimeSinceStart = this._lastRecordedTimeSinceStart\n    }\n    this._pauseAtTimerValue = timerValueToPause\n  }\n}\n\nexport default GameTimer\n","export class DualInput {\n  /*\n    A helper class for mapping two boolean inputs to a single integer output.\n    This provide robust and responsive output when quickly firing two inputs alternatively.\n  */\n\n  // input states -1: up, 0: off, 1: down, 2: hold\n  private input = [0, 0]\n  private last = 0\n  private output = 0\n\n  public combine(...input: [boolean, boolean]) {\n    for (let i = 0; i < 2; ++i) {\n      if (input[i] && this.input[i] <= 0) {\n        this.input[i] = 1\n        this.last = i\n      } else if (!input[i] && this.input[i] > 0) {\n        this.input[i] = -1\n      } else if (this.input[i] % 2 !== 0) {\n        this.input[i] += 1\n      }\n    }\n\n    if (this.input[0] === 1 || this.input[1] === 1) {\n      this.output = this.last === 0 ? 1 : -1\n    }\n\n    if (this.input[this.last] <= 0) {\n      this.output = 0\n    }\n\n    return this.output\n  }\n}\n","import { OmniInput } from 'bemuse/omni-input'\nimport { DualInput } from './dual-input'\n\nfunction OmniInputPlugin(game) {\n  const input = new OmniInput(window, {\n    exclusive: true,\n    continuous: game.players[0].options.input.continuous,\n    sensitivity: game.players[0].options.input.sensitivity,\n  })\n  let kbm = game.players[0].options.input.keyboard\n  const scratch = new DualInput()\n\n  // Don't use Btn8 or Btn9 if they are binded\n  // TODO: make start and select button bindable\n  const isBtn8Free = Object.values(kbm).indexOf('gamepad.0.button.8') < 0\n  const isBtn9Free = Object.values(kbm).indexOf('gamepad.0.button.9') < 0\n\n  return {\n    name: 'GameKBPlugin',\n    get() {\n      const data = input.update()\n\n      const result = {\n        p1_1: data[kbm['1'] || '83'],\n        p1_2: data[kbm['2'] || '68'],\n        p1_3: data[kbm['3'] || '70'],\n        p1_4: data[kbm['4'] || '32'],\n        p1_5: data[kbm['5'] || '74'],\n        p1_6: data[kbm['6'] || '75'],\n        p1_7: data[kbm['7'] || '76'],\n        p1_SC: scratch.combine(\n          data[kbm['SC'] || '65'],\n          data[kbm['SC2'] || '16']\n        ),\n        p1_speedup: data[38],\n        p1_speeddown: data[40],\n        start: data[13] || (isBtn9Free && data['gamepad.0.button.9']),\n        select: data[18] || (isBtn8Free && data['gamepad.0.button.8']),\n      }\n      if (result['start'] || result['select']) {\n        if (\n          result['p1_1'] ||\n          result['p1_3'] ||\n          result['p1_5'] ||\n          result['p1_7']\n        ) {\n          result['p1_speeddown'] = true\n        }\n        if (result['p1_2'] || result['p1_4'] || result['p1_6']) {\n          result['p1_speedup'] = true\n        }\n      }\n      return result\n    },\n    destroy() {\n      input.dispose()\n    },\n  }\n}\n\nexport default OmniInputPlugin\n","import bench from 'bemuse/devtools/benchmark'\n\nimport Clock from './clock'\nimport GameInput from './input'\nimport GameState from './state'\nimport GameTimer from './game-timer'\nimport OmniInputPlugin from './input/omni-input-plugin'\nimport TouchPlugin from './input/touch-plugin'\nimport * as BemuseTestMode from 'bemuse/devtools/BemuseTestMode'\n\n// The GameController takes care of communications between each game\n// component, and takes care of the Game loop.\nexport class GameController {\n  constructor({ game, display, audio }) {\n    this._audioInputLatency = game.options.audioInputLatency\n    this._game = game\n    this._display = display\n    this._audio = audio\n    this._clock = new Clock(this._audio)\n    this._input = new GameInput()\n    this._timer = new GameTimer(this._clock, this._input)\n    this._state = new GameState(game)\n    this._promise = new Promise((resolve) => (this._resolvePromise = resolve))\n    this._display.setEscapeHandler(() => this._quitGame())\n    this._display.setReplayHandler(() => this._replayGame())\n    this.initializeBenchmark()\n    this.initializeTestModeHooks()\n  }\n  get game() {\n    return this._game\n  }\n  get display() {\n    return this._display\n  }\n  get audio() {\n    return this._audio\n  }\n  get promise() {\n    return this._promise\n  }\n  get state() {\n    return this._state\n  }\n  get latestGameTime() {\n    return this._latestGameTime\n  }\n\n  // Initializes the game components and kickstarts the game loop.\n  start() {\n    this._handleEscape()\n    this._display.start()\n    this._input.use(new OmniInputPlugin(this._game))\n    this._input.use(new TouchPlugin(this._display.context))\n    let stopped = false\n    let frame = () => {\n      if (stopped) return\n      this._update()\n      requestAnimationFrame(frame)\n    }\n    requestAnimationFrame(frame)\n    this._endGameLoop = () => (stopped = true)\n  }\n\n  // Exits the game when escape is pressed.\n  _handleEscape() {\n    let onKeyDown = (e) => {\n      const ESCAPE_KEY = 27\n      const F1_KEY = 112\n      if (e.keyCode === ESCAPE_KEY) {\n        e.preventDefault()\n        e.stopPropagation()\n        this._quitGame()\n      } else if (e.keyCode === F1_KEY) {\n        e.preventDefault()\n        e.stopPropagation()\n        this._replayGame()\n      }\n    }\n    window.addEventListener('keydown', onKeyDown, true)\n    this._promise\n      .finally(function () {\n        window.removeEventListener('keydown', onKeyDown, true)\n      })\n      .done()\n  }\n\n  _quitGame() {\n    this._resolvePromise({ finished: false, replay: false })\n  }\n  _replayGame() {\n    this._resolvePromise({ finished: false, replay: true })\n  }\n\n  // Destroy the game.\n  destroy() {\n    this._endGameLoop()\n    this._audio.destroy()\n    this._input.destroy()\n    this._display.destroy()\n  }\n\n  _update() {\n    // >> game/loop\n    //\n    // Turn-Based Update Cycle\n    // -----------------------\n    // At each iteration of the game loop, each game component takes turn and\n    // update itself.  Each game component involved in this game loop should\n    // have a ``update(...)`` method, which takes care of updating itself.\n    // This is the only time the component will be mutable.\n    //\n    // Outside of the ``update`` method, a component should behave like an\n    // immutable object.  This allows us to have some sense of immutability\n    // without having to create new objects. See `the case for immutability`_.\n    //\n    // .. _the case for immutability: https://github.com/facebook/immutable-js/blob/d8d189ae7ea8965fee2ecc7320ebdc55e83eb6a1/README.md#the-case-for-immutability\n    //\n    // At each cycle, the following happens:\n    //\n    // - the Clock is updated to get the high-accuracy time\n    // - the Timer is updated to get the in-game time\n    // - the Input is updated to get button presses\n    // - the State is updated to react to button presses -- judging notes and\n    //   updating scores\n    // - the Audio is updated to emit sound based on the updated state\n    // - the Display is updated to render the game display based on the updated\n    //   state\n    //\n    this._clock.update()\n    this._input.update()\n    this._timer.update()\n    let t = this._timer.time\n    let A = this._audioInputLatency\n    this._latestGameTime = t\n    this._state.update(t - A, this._input, this._timer)\n    this._audio.update(t, this._state)\n    this._display.update(t - A, this._state)\n    if (this._state.finished && this._resolvePromise) {\n      this._resolvePromise({ finished: true })\n      this._resolvePromise = null\n    }\n  }\n\n  initializeBenchmark() {\n    if (!bench.enabled) return\n    bench.benchmark('update', this, '_update')\n    bench.benchmark('input_update', this._input, 'update')\n    bench.benchmark('state_update', this._state, 'update')\n    bench.benchmark('audio_update', this._audio, 'update')\n    bench.benchmark('display_update', this._display, 'update')\n    bench.benchmark('display_compute', this._display, '_getData')\n    bench.benchmark('display_push', this._display._context._instance, 'push')\n    bench.benchmark(\n      'display_render',\n      this._display._context._renderer,\n      'render'\n    )\n  }\n  initializeTestModeHooks() {\n    if (!BemuseTestMode.isTestModeEnabled()) return\n    BemuseTestMode.setGameLifecycleHandler({\n      pauseAt: (t) => {\n        this._timer.pauseAt(t)\n        return new Promise((resolve) => {\n          const interval = setInterval(() => {\n            if (this._timer.time >= t) {\n              clearInterval(interval)\n              resolve()\n            }\n          })\n        })\n      },\n      unpause: () => {\n        this._timer.pauseAt(Infinity)\n      },\n      getScore: () => {\n        const state = this._state\n        const playerState = state.player(state.game.players[0])\n        return playerState.stats.score\n      },\n    })\n  }\n}\n\nexport default GameController\n","export function loadImage(assets, filename) {\n  return assets\n    .file(filename)\n    .then((asset) => asset.read())\n    .then((arrayBuffer) => new Blob([arrayBuffer]))\n    .then((blob) => URL.createObjectURL(blob))\n    .then(\n      (src) =>\n        new Promise((resolve, reject) => {\n          const image = new Image()\n          image.onload = () => resolve(image)\n          image.onerror = reject\n          image.src = src\n        })\n    )\n}\n\nexport default loadImage\n","import NotechartLoader from 'bemuse-notechart/lib/loader'\nimport Progress from 'bemuse/progress'\nimport { atomic } from 'bemuse/progress/utils'\nimport SamplingMaster from 'bemuse/sampling-master'\nimport keysoundCache from 'bemuse/keysound-cache'\n\nimport * as Multitasker from './multitasker'\nimport Game, { GamePlayerOptionsInput } from '../game'\nimport GameAudio from '../audio'\nimport GameController from '../game-controller'\nimport GameDisplay from '../display'\nimport SamplesLoader from './samples-loader'\nimport loadImage from './loadImage'\nimport Notechart from 'bemuse-notechart'\nimport { IResources } from 'bemuse/resources/types'\nimport { resolveRelativeResources } from 'bemuse/resources/resolveRelativeResource'\n\ntype Tasks = {\n  Scintillator: TODO\n  Skin: TODO\n  SkinContext: TODO\n  Notechart: Notechart\n  EyecatchImage: HTMLImageElement\n  BackgroundImage: HTMLImageElement\n  SamplingMaster: SamplingMaster\n  Video: { element: HTMLVideoElement; offset: number } | null\n  Game: Game\n  GameDisplay: GameDisplay\n  Samples: TODO\n  GameAudio: GameAudio\n  GameController: GameController\n}\n\ntype Assets = IResources & {\n  progress?: {\n    current?: Progress\n    all?: Progress\n  }\n}\n\nexport type LoadSpec = {\n  assets: Assets\n  bms: TODO\n  songId: string\n  displayMode?: 'touch3d' | 'normal'\n  backImageUrl?: string\n  eyecatchImageUrl?: string\n  videoUrl?: string\n  videoOffset?: number\n  options: GamePlayerOptionsInput\n}\n\nexport function load(spec: LoadSpec) {\n  const assets = spec.assets\n  const bms = spec.bms\n  const songId = spec.songId\n\n  return Multitasker.start<Tasks, GameController>(function (task, run) {\n    task('Scintillator', 'Loading game engine', [], function (progress) {\n      return atomic(\n        progress,\n        import(/* webpackChunkName: 'gameEngine' */ 'bemuse/scintillator')\n      )\n    })\n\n    task(\n      'Skin',\n      'Loading skin',\n      ['Scintillator'],\n      function (Scintillator, progress) {\n        return Scintillator.load(\n          Scintillator.getSkinUrl({\n            displayMode: spec.displayMode,\n          }),\n          progress\n        )\n      }\n    )\n\n    task(\n      'SkinContext',\n      null,\n      ['Scintillator', 'Skin'],\n      function (Scintillator, skin) {\n        return new Scintillator.Context(skin, { touchEventTarget: window })\n      }\n    )\n\n    if (assets.progress) {\n      if (assets.progress.current) {\n        task.bar('Loading package', assets.progress.current)\n      }\n      if (assets.progress.all) {\n        task.bar('Loading song packages', assets.progress.all)\n      }\n    }\n\n    task('Notechart', 'Loading ' + spec.bms.name, [], async (progress) => {\n      let loader = new NotechartLoader()\n      let arraybuffer = await bms.read(progress)\n      return loader.load(arraybuffer, spec.bms, spec.options.players[0])\n    })\n\n    task('EyecatchImage', null, ['Notechart'], function (notechart) {\n      if (spec.eyecatchImageUrl) {\n        const [base, filename] = resolveRelativeResources(\n          assets,\n          spec.eyecatchImageUrl\n        )\n        return loadImage(base, filename)\n      }\n      return loadImage(assets, notechart.eyecatchImage)\n    })\n\n    task('BackgroundImage', null, ['Notechart'], function (notechart) {\n      if (spec.backImageUrl) {\n        const [base, filename] = resolveRelativeResources(\n          assets,\n          spec.backImageUrl\n        )\n        return loadImage(base, filename)\n      }\n      return loadImage(assets, notechart.backgroundImage)\n    })\n\n    let audioLoadProgress = new Progress()\n    let audioDecodeProgress = new Progress()\n\n    task.bar('Loading audio', audioLoadProgress)\n    task.bar('Decoding audio', audioDecodeProgress)\n\n    task('SamplingMaster', null, [], async () => {\n      return new SamplingMaster()\n    })\n\n    task(\n      'Video',\n      spec.videoUrl ? 'Loading video' : null,\n      ['Notechart'],\n      async function (notechart, progress) {\n        if (!spec.videoUrl) return Promise.resolve(null)\n        let videoUrl = spec.videoUrl\n        if (!videoUrl.includes('://')) {\n          // This is a relative URL, we need to load from assets.\n          const [base, filename] = resolveRelativeResources(assets, videoUrl)\n          const file = await base.file(filename)\n          videoUrl = await file.resolveUrl()\n        }\n        return new Promise((resolve, reject) => {\n          const video = document.createElement('video')\n          if (!video.canPlayType('video/webm')) return resolve(null)\n          video.src = videoUrl\n          video.preload = 'auto'\n          video.addEventListener('progress', onProgress, true)\n          video.addEventListener('canplaythrough', onCanPlayThrough, true)\n          video.addEventListener('error', onError, true)\n          video.addEventListener('abort', onError, true)\n          video.load()\n\n          function onProgress() {\n            if (video.buffered && video.buffered.length && video.duration) {\n              progress.report(\n                video.buffered.end(0) - video.buffered.start(0),\n                video.duration\n              )\n            }\n          }\n          function finish() {\n            video.removeEventListener('progress', onProgress, true)\n            video.removeEventListener('canplaythrough', onCanPlayThrough, true)\n            video.removeEventListener('error', onError, true)\n            video.removeEventListener('abort', onError, true)\n          }\n          function onCanPlayThrough() {\n            finish()\n            const n = video.duration || 100\n            progress.report(n, n)\n            resolve({ element: video, offset: spec.videoOffset! })\n          }\n          function onError() {\n            finish()\n            console.warn('Cannot load video... Just skip it!')\n            resolve(null)\n          }\n        })\n      }\n    )\n\n    task('Game', null, ['Notechart'], async (notechart) => {\n      return new Game([notechart], spec.options)\n    })\n\n    task(\n      'GameDisplay',\n      null,\n      ['Game', 'SkinContext', 'Video'],\n      async (game, context, video) => {\n        return new GameDisplay({\n          game,\n          context,\n          backgroundImagePromise: run('BackgroundImage'),\n          video,\n        })\n      }\n    )\n\n    task('Samples', null, ['SamplingMaster', 'Game'], function (master, game) {\n      keysoundCache.receiveSongId(songId)\n      const samplesLoader = new SamplesLoader(assets, master)\n      return samplesLoader.loadFiles(\n        game.samples,\n        audioLoadProgress,\n        audioDecodeProgress\n      )\n    })\n\n    task(\n      'GameAudio',\n      null,\n      ['Game', 'Samples', 'SamplingMaster'],\n      async (game, samples, master) => {\n        return new GameAudio({ game, samples, master })\n      }\n    )\n\n    task(\n      'GameController',\n      null,\n      ['Game', 'GameDisplay', 'GameAudio'],\n      async (game, display, audio) => {\n        return new GameController({ game, display, audio })\n      }\n    )\n\n    return run('GameController')\n  })\n}\n","import Observable from 'bemuse/utils/observable'\nimport Progress from 'bemuse/progress'\nimport { throttle } from 'lodash'\n\nexport function start(callback) {\n  let tasks = {}\n  let running = {}\n  let taskList = []\n\n  function task(name, text, dependencies, f) {\n    let progress = new Progress()\n    if (text) taskList.push({ text, progress })\n    tasks[name] = function () {\n      return Promise.all(dependencies.map(run)).then((deps) =>\n        f(...deps.concat([progress]))\n      )\n    }\n  }\n\n  function bar(text, progress) {\n    taskList.push({ text, progress })\n  }\n\n  task.bar = bar\n\n  function run(name) {\n    return running[name] || (running[name] = tasks[name]())\n  }\n\n  function getTaskStatuses() {\n    return taskList.map((t) => {\n      return {\n        text: t.text,\n        progress: t.progress.progress,\n        progressText: t.progress.toString(),\n      }\n    })\n  }\n\n  let promise = callback(task, run)\n  let status = new Observable(getTaskStatuses())\n  let update = throttle(function updateTaskStatuses() {\n    status.value = getTaskStatuses()\n  }, 16)\n\n  for (let taskToWatch of taskList) {\n    taskToWatch.progress.watch(update)\n  }\n\n  return { tasks: status, promise: promise, get: run }\n}\n","import './LoadingSceneSongInfo.scss'\n\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport { isTitleDisplayMode } from 'bemuse/devtools/query-flags'\n\nexport default class LoadingSceneSongInfo extends React.Component {\n  static propTypes = {\n    song: PropTypes.shape({\n      title: PropTypes.string,\n      artist: PropTypes.string,\n      genre: PropTypes.string,\n      subtitles: PropTypes.arrayOf(PropTypes.string),\n      subartists: PropTypes.arrayOf(PropTypes.string),\n      difficulty: PropTypes.number,\n      level: PropTypes.number,\n    }).isRequired,\n  }\n\n  render() {\n    const song = this.props.song\n    return (\n      <div className='LoadingSceneSongInfo'>\n        <div className='LoadingSceneSongInfogenre'>{song.genre}</div>\n        <div className='LoadingSceneSongInfotitle'>{song.title}</div>\n        {!isTitleDisplayMode()\n          ? song.subtitles.map((text) => (\n              <div key={text} className='LoadingSceneSongInfosubtitle'>\n                {text}\n              </div>\n            ))\n          : null}\n        <div className='LoadingSceneSongInfoartist'>{song.artist}</div>\n        {song.subartists.map((text) => (\n          <div key={text} className='LoadingSceneSongInfosubartist'>\n            {text}\n          </div>\n        ))}\n      </div>\n    )\n  }\n}\n","import './LoadingSceneProgressBar.scss'\nimport React from 'react'\nimport PropTypes from 'prop-types'\n\nexport default class LoadingSceneProgressBar extends React.Component {\n  static propTypes = {\n    width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  }\n\n  render() {\n    return (\n      <div className='LoadingSceneProgressBar'>\n        <div\n          className='LoadingSceneProgressBarbar'\n          style={{ width: this.props.width }}\n        />\n      </div>\n    )\n  }\n}\n","import './LoadingSceneProgress.scss'\n\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport LoadingSceneProgressBar from './LoadingSceneProgressBar.jsx'\n\nexport default class LoadingSceneProgress extends React.Component {\n  static propTypes = {\n    tasks: PropTypes.object,\n  }\n\n  render() {\n    return (\n      <div className='LoadingSceneProgress'>\n        {this.props.tasks.value.map((task) => this.renderItem(task))}\n      </div>\n    )\n  }\n\n  renderItem = ({ text, progressText, progress }) => {\n    let width = Math.round(progress * 100 || 0).toString() + '%'\n    let extra = progressText ? ` (${progressText})` : ''\n    return (\n      <div key={text} className='LoadingSceneProgressitem'>\n        <LoadingSceneProgressBar width={width} />\n        {text}\n        <span className='LoadingSceneProgressextra'>{extra}</span>\n      </div>\n    )\n  }\n\n  componentDidMount() {\n    this._unsubscribe = this.props.tasks.watch(() => this.forceUpdate())\n  }\n\n  componentWillUnmount() {\n    this._unsubscribe()\n  }\n}\n","import './LoadingScene.scss'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport PropTypes from 'prop-types'\nimport Scene from 'bemuse/ui/Scene.jsx'\n\nimport LoadingSceneSongInfo from './LoadingSceneSongInfo.jsx'\nimport LoadingSceneProgress from './LoadingSceneProgress.jsx'\n\nexport default class LoadingScene extends React.Component {\n  static propTypes = {\n    song: PropTypes.shape({\n      title: PropTypes.string,\n      artist: PropTypes.string,\n      genre: PropTypes.string,\n      subtitles: PropTypes.arrayOf(PropTypes.string),\n      subartists: PropTypes.arrayOf(PropTypes.string),\n      difficulty: PropTypes.number,\n      level: PropTypes.number,\n    }),\n    tasks: PropTypes.object,\n    eyecatchImagePromise: PropTypes.object,\n    registerTeardownCallback: PropTypes.func,\n  }\n\n  render() {\n    return (\n      <Scene className='LoadingScene' ref='scene'>\n        <div className='LoadingSceneimage' ref='eyecatch' />\n        <div className='LoadingSceneinfo'>\n          <LoadingSceneSongInfo song={this.props.song} />\n        </div>\n        <LoadingSceneProgress tasks={this.props.tasks} />\n        <div className='LoadingSceneflash' />\n        <div className='LoadingScenecover' />\n      </Scene>\n    )\n  }\n\n  componentDidMount() {\n    if (this.props.eyecatchImagePromise) {\n      this.props.eyecatchImagePromise.then((image) => {\n        ReactDOM.findDOMNode(this.refs.eyecatch).appendChild(image)\n      })\n    }\n    this.props.registerTeardownCallback(() => {\n      ReactDOM.findDOMNode(this.refs.scene).classList.add('is-exiting')\n      return Promise.delay(500)\n    })\n  }\n}\n","\nvar content = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./GameShellScene.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./GameShellScene.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./GameShellScene.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".GameShellScene {\\n  margin: 20px auto;\\n  background: #353433;\\n  border: 1px solid #555453;\\n  padding: 15px;\\n  max-width: 720px;\\n}\\n.GameShellScene .drop-zone {\\n  border: 2px dashed #555453;\\n  padding: 5px;\\n}\\n.GameShellScene .drop-zone a.is-active {\\n  font-weight: bold;\\n}\\n.GameShellScene .drop-zone-hint {\\n  padding: 10px;\\n  text-align: center;\\n  color: #8b8685;\\n}\\n.GameShellScene form > div {\\n  margin-bottom: 1em;\\n}\\n.GameShellScene form > div.text .label {\\n  display: block;\\n  color: #8b8685;\\n  font-weight: bold;\\n  font-size: 0.8em;\\n  margin: 0;\\n  margin-bottom: 0.5ex;\\n}\\n.GameShellScene form > div.text input {\\n  font: inherit;\\n  display: block;\\n  width: 100%;\\n  box-sizing: border-box;\\n  border: 1px inset #555453;\\n  background: #252423;\\n  color: #bfb;\\n}\\n.GameShellScene form > div.text input:disabled {\\n  opacity: 0.2;\\n}\\n.GameShellScene form > div.checkbox input {\\n  margin-right: 1ex;\\n}\\n.GameShellScene form > div.radio > h3 {\\n  display: block;\\n  color: #8b8685;\\n  font-weight: bold;\\n  font-size: 0.8em;\\n  margin: 0;\\n  margin-bottom: 0.5ex;\\n}\\n.GameShellScene form > div.radio > label {\\n  display: block;\\n}\\n.GameShellScene form > div.radio input {\\n  margin-right: 1ex;\\n}\\n.GameShellScene button {\\n  background: #8b8685;\\n  border: 1px outset #aba6a5;\\n  font: inherit;\\n  font-size: 1.5em;\\n  color: #e9e8e7;\\n  display: block;\\n  width: 100%;\\n  box-sizing: border-box;\\n}\\n.GameShellScene a {\\n  color: #fed;\\n}\", \"\"]);\n\n// exports\n","// :doc:\n//\n// High-accuracy timer, optionally synchronized globally.\n\nimport sync from 'timesynchro'\nconst Log = BemuseLogger.forModule('timesynchro')\n\nlet now\nlet offset = 0\n\nif (window.performance && typeof window.performance.now === 'function') {\n  now = () => window.performance.now()\n} else {\n  now = () => Date.now()\n}\n\nnow.synchronize = function (server) {\n  sync(server, onFinish, onResult)\n  function onResult(result) {\n    // result + Date.now() = real time = now() + offset\n    // result + Date.now() = now() + offset\n    // offset = result + Date.now() - now()\n    offset = result + Date.now() - now()\n  }\n  function onFinish(err, result) {\n    if (err) {\n      Log.error('Cannot synchronize time: ' + err)\n    } else {\n      onResult(result)\n      Log.info('Synchronized time with global server! Offset = ' + offset)\n    }\n  }\n}\n\nnow.synchronized = function () {\n  let o = offset\n  return () => now() + o\n}\n\nexport { now }\nexport default now\n","import './GameShellScene.scss'\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport DndResources from 'bemuse/resources/dnd-resources'\nimport c from 'classnames'\n\nclass CustomChartSelector extends React.Component {\n  static propTypes = {\n    selectedResource: PropTypes.any,\n    onSelect: PropTypes.func,\n  }\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      files: [],\n    }\n  }\n\n  render() {\n    let files = this.state.files\n    return (\n      <div className='drop-zone'>\n        {files.length ? (\n          <ul>\n            {files.map((file) => (\n              <li>\n                <a\n                  href='javascript://'\n                  onClick={this.handleItemClick}\n                  className={c({\n                    'is-active': file.resource === this.props.selectedResource,\n                  })}\n                >\n                  {file.name}\n                </a>\n              </li>\n            ))}\n            {this.props.selectedResource ? (\n              <li>\n                <a href='javascript://' onClick={this.handleClear}>\n                  Clear\n                </a>\n              </li>\n            ) : null}\n          </ul>\n        ) : (\n          <div className='drop-zone-hint'>\n            Drop BMS folder here\n            <br />\n            (only works on Google Chrome)\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  handleDrop = (e) => {\n    e.preventDefault()\n    let event = e.nativeEvent\n    let resources = new DndResources(event)\n    resources.fileList\n      .then((list) => {\n        return list.filter((filename) => /\\.(bms|bme|bml)$/i.test(filename))\n      })\n      .map((name) =>\n        resources.file(name).then((resource) => ({ name, resource }))\n      )\n      .then((bms) => {\n        this.setState({ files: bms, resources: resources })\n      })\n      .catch((err) => {\n        if (err.constructor.name === 'FileError') {\n          throw new Error('File Error code ' + e.code)\n        } else {\n          throw err\n        }\n      })\n      .done()\n  }\n\n  handleItemClick = (file) => {\n    return () => {\n      this.props.onSelect(this.state.resources, file.resource)\n    }\n  }\n\n  handleClear = () => {\n    this.props.onSelect(null, null)\n  }\n}\n\nexport default class GameShellScene extends React.Component {\n  static propTypes = {\n    options: PropTypes.object,\n    play: PropTypes.func,\n  }\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      options: this.props.options,\n    }\n  }\n\n  render() {\n    let options = this.state.options\n    return (\n      <div\n        className='GameShellScene'\n        onDragOver={this.handleDragOver}\n        onDrop={this.handleDrop}\n      >\n        <h1>Bemuse Game Shell</h1>\n        <p>This tool is intended for developers testing the game.</p>\n        <form onSubmit={this.submit}>\n          <div className='text'>\n            <label>\n              <span className='label'>BMS URL:</span>\n              <input\n                type='text'\n                disabled={options.resource}\n                onChange={this.bindOption((o, v) => (o.url = v))}\n                value={options.url}\n              />\n            </label>\n          </div>\n          <div className='text'>\n            <label>\n              <span className='label'>-or- Drop BMS folder here</span>\n              <CustomChartSelector\n                ref='dropzone'\n                selectedResource={options.resource}\n                onSelect={this.handleSelectFile}\n              />\n            </label>\n          </div>\n          <div className='text'>\n            <label>\n              <span className='label'>Audio-Input Latency</span>\n              <input\n                type='text'\n                onChange={this.bindOption(\n                  (o, v) => (o.game.audioInputLatency = v)\n                )}\n                value={options.game.audioInputLatency}\n              />\n            </label>\n          </div>\n          <div className='text'>\n            <label>\n              <span className='label'>HI-SPEED:</span>\n              <input\n                type='text'\n                onChange={this.bindOption((o, v) => (o.players[0].speed = v))}\n                value={options.players[0].speed}\n              />\n            </label>\n          </div>\n          <div className='radio'>\n            <h3>Placement</h3>\n            {['left', 'center', 'right'].map((placement) => (\n              <label>\n                <input\n                  type='radio'\n                  value={placement}\n                  onChange={this.bindOption(\n                    (o, v) => (o.players[0].placement = v)\n                  )}\n                  checked={options.players[0].placement === placement}\n                />\n                <span className='label'>{placement}</span>\n              </label>\n            ))}\n          </div>\n          <button type='submit'>Play</button>\n        </form>\n      </div>\n    )\n  }\n\n  submit = (e) => {\n    e.preventDefault()\n    this.props.play(this.state.options)\n  }\n\n  bindOption = (binder) => {\n    return (event) => {\n      binder(this.state.options, event.target.value)\n      this.forceUpdate()\n    }\n  }\n\n  handleDragOver = (e) => {\n    e.preventDefault()\n  }\n\n  handleDrop = (e) => {\n    e.preventDefault()\n    this.refs.dropzone.handleDrop(e)\n  }\n\n  handleSelectFile = (resources, resource) => {\n    this.setState({\n      options: Object.assign(this.state.options, { resources, resource }),\n    })\n    this.forceUpdate()\n  }\n}\n","import BemusePackageResources from 'bemuse/resources/bemuse-package'\nimport React from 'react'\nimport SCENE_MANAGER from 'bemuse/scene-manager'\nimport URLResource from 'bemuse/resources/url'\nimport audioContext from 'bemuse/audio-context'\nimport query from 'bemuse/utils/query'\nimport { resolveUrl } from 'url'\nimport { unmuteAudio } from 'bemuse/sampling-master'\n\nimport * as GameLoader from './loaders/game-loader'\nimport GameScene from './game-scene'\nimport GameShellScene from './ui/GameShellScene.jsx'\nimport LoadingScene from './ui/LoadingScene.jsx'\n\nexport async function main() {\n  // iOS\n  window.addEventListener('touchstart', function unmute() {\n    unmuteAudio(audioContext)\n    window.removeEventListener('touchstart', unmute)\n  })\n\n  let displayShell = function (options) {\n    return new Promise(function (resolve) {\n      let scene = React.createElement(GameShellScene, {\n        options: options,\n        play: function (data) {\n          resolve(data)\n        },\n      })\n      SCENE_MANAGER.display(scene).done()\n    })\n  }\n\n  let getSong = async function () {\n    let kbm = (query.keyboard || '').split(',').map((x) => +x)\n    let options = {\n      url: query.bms || '/music/[snack]dddd/dddd_sph.bme',\n      game: {\n        audioInputLatency: +query.latency || 0,\n      },\n      players: [\n        {\n          speed: +query.speed || 3,\n          autoplay: !!query.autoplay,\n          placement: 'center',\n          scratch: query.scratch || 'left',\n          input: {\n            keyboard: {\n              1: kbm[0] || 83,\n              2: kbm[1] || 68,\n              3: kbm[2] || 70,\n              4: kbm[3] || 32,\n              5: kbm[4] || 74,\n              6: kbm[5] || 75,\n              7: kbm[6] || 76,\n              SC: kbm[7] || 65,\n              SC2: kbm[8] || 16,\n            },\n          },\n        },\n      ],\n    }\n    options = await displayShell(options)\n    let url = options.url\n    let assetsUrl = resolveUrl(url, 'assets/')\n    let metadata = {\n      title: 'Loading',\n      subtitles: [],\n      artist: '',\n      genre: '',\n      subartists: [],\n    }\n    return {\n      bms: options.resource || new URLResource(url),\n      assets: options.resources || new BemusePackageResources(assetsUrl),\n      metadata: metadata,\n      options: Object.assign({}, options.game, { players: options.players }),\n    }\n  }\n\n  let loadSpec = await getSong()\n  let { tasks, promise } = GameLoader.load(loadSpec)\n  await SCENE_MANAGER.display(\n    React.createElement(LoadingScene, {\n      tasks: tasks,\n      song: loadSpec.metadata,\n    })\n  )\n  let controller = await promise\n  await SCENE_MANAGER.display(new GameScene(controller.display))\n  controller.start()\n}\n","import Observable from 'bemuse/utils/observable'\n\ninterface IProgressFormatter {\n  (progress: Progress): string\n}\n\n/**\n * The Progress class represents the progress of an asynchronous operation.\n * It is inspired by C#'s IProgress interface.\n *\n * See: http://blogs.msdn.com/b/dotnet/archive/2012/06/06/async-in-4-5-enabling-progress-and-cancellation-in-async-apis.aspx\n */\nexport class Progress {\n  /** The current progress (out of `Progress#total`). */\n  public current: number | undefined = undefined\n  /** Total progress value */\n  public total: number | undefined = undefined\n  /** Some arbitrary information associated with this Progress. */\n  public extra: any\n  /**\n   * The formatter of this progress. This formatter will be used to compute\n   * the text representation of this progress (`Progress#toString`).\n   */\n  public formatter?: IProgressFormatter\n  private _observable = new Observable<void>()\n  /**\n   * Updates the progress.\n   */\n  report(current: number, total: number, extra?: any) {\n    this.current = current\n    this.total = total\n    this.extra = extra\n    this._observable.notify()\n  }\n  /**\n   * Attaches a progress listener function to this progress.\n   * The function `f` will be called immediately and synchronously upon watching,\n   * and will be called when the progress value is updated.\n   * @param f\n   * @returns a function that, when called, unsubscribes this listener.\n   */\n  watch(f: (progress: Progress) => void) {\n    f(this)\n    return this._observable.watch(() => f(this))\n  }\n  /**\n   * The current progress as a fraction (out of 1).\n   */\n  get progress() {\n    if (this.total && this.current !== undefined && this.current !== null) {\n      return this.current / this.total\n    } else {\n      return null\n    }\n  }\n  /**\n   * Returns a string representation of this progress instance.\n   * This method is used for displaying the progress as a text.\n   */\n  toString() {\n    if (this.formatter !== undefined) {\n      return this.formatter(this)\n    } else if (this.progress !== null) {\n      return this.current + ' / ' + this.total\n    } else {\n      return ''\n    }\n  }\n}\n","// !! avoid external dependencies since this is used in boot script!\n\nimport Callbacks from 'bemuse/utils/callbacks'\n\nexport class Observable<T> {\n  private _callbacks = new Callbacks<[T]>()\n  private _value?: T\n  constructor(value?: T) {\n    this._value = value\n  }\n  get value() {\n    return this._value\n  }\n  set value(value) {\n    this._value = value\n    this.notify(value!)\n  }\n  notify(value: T) {\n    this._callbacks.call(value)\n  }\n  watch(f: (value: T) => void) {\n    if (this._value !== undefined) f(this._value)\n    return this._callbacks.add(f)\n  }\n}\n\nexport default Observable\n","// !! avoid external dependencies since this is used in boot script!\n\ntype CallbackEffect<T extends any[]> = (...args: T) => void\n\n/**\n * A utility class to hold a collection of callbacks.\n */\nexport class Callbacks<T extends any[]> {\n  private _callbacks: { [id: number]: CallbackEffect<T> } = {}\n  private _nextId = 1\n  constructor(init?: CallbackEffect<T>[] | CallbackEffect<T>) {\n    if (typeof init === 'function') {\n      this.add(init)\n    } else if (typeof init === 'object' && init && init.length) {\n      for (var i = 0; i < init.length; i++) this.add(init[i])\n    }\n  }\n\n  /**\n   * Calls all the callbacks.\n   */\n  call(...args: T) {\n    var callbacks = this._callbacks\n    for (var id in callbacks) {\n      callbacks[id](...args)\n    }\n  }\n\n  /**\n   * Adds a `callback` Function to this Callbacks collection.\n   * Returns a function that, when invoked, removes the inserted `callback` from the collection.\n   */\n  add(callback: CallbackEffect<T>) {\n    var id = this._nextId++\n    this._callbacks[id] = callback\n    return () => delete this._callbacks[id]\n  }\n}\n\nexport default Callbacks\n","import createAudioContext from 'audio-context'\n\nexport default createAudioContext({\n  latencyHint: 'interaction',\n})\n","import './Scene.scss'\n\nimport c from 'classnames'\nimport React from 'react'\nimport PropTypes from 'prop-types'\n\nexport default class Scene extends React.Component {\n  static propTypes = {\n    className: PropTypes.string,\n    children: PropTypes.node,\n    onDragEnter: PropTypes.func,\n  }\n\n  render() {\n    return (\n      <div\n        className={c('Scene', this.props.className)}\n        onDragEnter={this.props.onDragEnter}\n      >\n        {this.props.children}\n      </div>\n    )\n  }\n}\n","/*!\n * bytes\n * Copyright(c) 2012-2014 TJ Holowaychuk\n * Copyright(c) 2015 Jed Watson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = bytes;\nmodule.exports.format = format;\nmodule.exports.parse = parse;\n\n/**\n * Module variables.\n * @private\n */\n\nvar formatThousandsRegExp = /\\B(?=(\\d{3})+(?!\\d))/g;\n\nvar formatDecimalsRegExp = /(?:\\.0*|(\\.[^0]+)0+)$/;\n\nvar map = {\n  b:  1,\n  kb: 1 << 10,\n  mb: 1 << 20,\n  gb: 1 << 30,\n  tb: Math.pow(1024, 4),\n  pb: Math.pow(1024, 5),\n};\n\nvar parseRegExp = /^((-|\\+)?(\\d+(?:\\.\\d+)?)) *(kb|mb|gb|tb|pb)$/i;\n\n/**\n * Convert the given value in bytes into a string or parse to string to an integer in bytes.\n *\n * @param {string|number} value\n * @param {{\n *  case: [string],\n *  decimalPlaces: [number]\n *  fixedDecimals: [boolean]\n *  thousandsSeparator: [string]\n *  unitSeparator: [string]\n *  }} [options] bytes options.\n *\n * @returns {string|number|null}\n */\n\nfunction bytes(value, options) {\n  if (typeof value === 'string') {\n    return parse(value);\n  }\n\n  if (typeof value === 'number') {\n    return format(value, options);\n  }\n\n  return null;\n}\n\n/**\n * Format the given value in bytes into a string.\n *\n * If the value is negative, it is kept as such. If it is a float,\n * it is rounded.\n *\n * @param {number} value\n * @param {object} [options]\n * @param {number} [options.decimalPlaces=2]\n * @param {number} [options.fixedDecimals=false]\n * @param {string} [options.thousandsSeparator=]\n * @param {string} [options.unit=]\n * @param {string} [options.unitSeparator=]\n *\n * @returns {string|null}\n * @public\n */\n\nfunction format(value, options) {\n  if (!Number.isFinite(value)) {\n    return null;\n  }\n\n  var mag = Math.abs(value);\n  var thousandsSeparator = (options && options.thousandsSeparator) || '';\n  var unitSeparator = (options && options.unitSeparator) || '';\n  var decimalPlaces = (options && options.decimalPlaces !== undefined) ? options.decimalPlaces : 2;\n  var fixedDecimals = Boolean(options && options.fixedDecimals);\n  var unit = (options && options.unit) || '';\n\n  if (!unit || !map[unit.toLowerCase()]) {\n    if (mag >= map.pb) {\n      unit = 'PB';\n    } else if (mag >= map.tb) {\n      unit = 'TB';\n    } else if (mag >= map.gb) {\n      unit = 'GB';\n    } else if (mag >= map.mb) {\n      unit = 'MB';\n    } else if (mag >= map.kb) {\n      unit = 'KB';\n    } else {\n      unit = 'B';\n    }\n  }\n\n  var val = value / map[unit.toLowerCase()];\n  var str = val.toFixed(decimalPlaces);\n\n  if (!fixedDecimals) {\n    str = str.replace(formatDecimalsRegExp, '$1');\n  }\n\n  if (thousandsSeparator) {\n    str = str.replace(formatThousandsRegExp, thousandsSeparator);\n  }\n\n  return str + unitSeparator + unit;\n}\n\n/**\n * Parse the string value into an integer in bytes.\n *\n * If no unit is given, it is assumed the value is in bytes.\n *\n * @param {number|string} val\n *\n * @returns {number|null}\n * @public\n */\n\nfunction parse(val) {\n  if (typeof val === 'number' && !isNaN(val)) {\n    return val;\n  }\n\n  if (typeof val !== 'string') {\n    return null;\n  }\n\n  // Test if the string passed is valid\n  var results = parseRegExp.exec(val);\n  var floatValue;\n  var unit = 'b';\n\n  if (!results) {\n    // Nothing could be extracted from the given string\n    floatValue = parseInt(val, 10);\n    unit = 'b'\n  } else {\n    // Retrieve the value and the unit\n    floatValue = parseFloat(results[1]);\n    unit = results[4].toLowerCase();\n  }\n\n  return Math.floor(map[unit] * floatValue);\n}\n","import defaultAudioContext from 'bemuse/audio-context'\nimport readBlob from 'bemuse/utils/read-blob'\nimport { decodeOGG } from './ogg'\n\nexport const FADE_LENGTH = 0.001\n\nlet dummyAudioTag = document.createElement('audio')\n// Checks whether an audio format is supported.\nexport function canPlay(type) {\n  // We have a Vorbis audio decoder!\n  if (type === 'audio/ogg; codecs=\"vorbis\"') return true\n  return dummyAudioTag.canPlayType(type) === 'probably'\n}\n\nconst needsVorbisDecoder = !dummyAudioTag.canPlayType(\n  'audio/ogg; codecs=\"vorbis\"'\n)\n\n// The sampling master is a wrapper class around Web Audio API\n// that takes care of:\n//\n// - Decoding audio from an ArrayBuffer or Blob (resulting in a \"Sample\").\n// - Playing the `Sample` and managing its lifecycle.\nexport class SamplingMaster {\n  constructor(audioContext) {\n    this._audioContext = audioContext || defaultAudioContext\n    this._samples = []\n    this._groups = []\n    this._instances = new Set()\n    this._destination = this._audioContext.destination\n  }\n\n  // Connects a dummy node to the audio, thereby unmuting the audio system on\n  // iOS devices (which keeps the audio muted until a user interacts with the\n  // page).\n  unmute() {\n    unmuteAudio(this._audioContext)\n  }\n\n  // The underlying AudioContext.\n  get audioContext() {\n    return this._audioContext\n  }\n\n  // The audio destination.\n  get destination() {\n    return this._destination\n  }\n\n  // The current time\n  // See: https://webaudio.github.io/web-audio-api/#dom-baseaudiocontext-currenttime\n  get currentTime() {\n    return this._audioContext.currentTime\n  }\n\n  // Destroys this SamplingMaster, make it unusable.\n  destroy() {\n    if (this._destroyed) return\n    this._destroyed = true\n    for (let sample of this._samples) sample.destroy()\n    for (let instance of this._instances) instance.destroy()\n    this._samples = null\n    this._instances = null\n  }\n\n  // Decodes the audio data from a Blob or an ArrayBuffer.\n  // Returns an AudioBuffer which can be re-used in other sampling masters.\n  decode(blobOrArrayBuffer) {\n    return this._coerceToArrayBuffer(blobOrArrayBuffer).then((arrayBuffer) =>\n      this._decodeAudio(arrayBuffer)\n    )\n  }\n\n  // Creates a `Sample` from a Blob or an ArrayBuffer or an AudioBuffer.\n  sample(blobOrArrayBufferOrAudioBuffer) {\n    const audioBufferPromise = (() => {\n      if (blobOrArrayBufferOrAudioBuffer.numberOfChannels) {\n        return Promise.resolve(blobOrArrayBufferOrAudioBuffer)\n      } else {\n        return this.decode(blobOrArrayBufferOrAudioBuffer)\n      }\n    })()\n    return audioBufferPromise.then((audioBuffer) => {\n      if (this._destroyed) throw new Error('SamplingMaster already destroyed!')\n      var sample = new Sample(this, audioBuffer)\n      this._samples.push(sample)\n      return sample\n    })\n  }\n\n  group(options) {\n    const group = new SoundGroup(this, options)\n    this._groups.push(group)\n    return group\n  }\n\n  _coerceToArrayBuffer(blobOrArrayBuffer) {\n    if (blobOrArrayBuffer instanceof ArrayBuffer) {\n      return Promise.resolve(blobOrArrayBuffer)\n    } else {\n      return readBlob(blobOrArrayBuffer).as('arraybuffer')\n    }\n  }\n\n  _decodeAudio(arrayBuffer) {\n    return new Promise((resolve, reject) => {\n      if (needsVorbisDecoder && arrayBuffer.byteLength > 4) {\n        const view = new Uint8Array(arrayBuffer, 0, 4)\n        if (\n          view[0] === 0x4f &&\n          view[1] === 0x67 &&\n          view[2] === 0x67 &&\n          view[3] === 0x53\n        ) {\n          return resolve(decodeOGG(this.audioContext, arrayBuffer))\n        }\n      }\n      this.audioContext.decodeAudioData(\n        arrayBuffer,\n        function decodeAudioDataSuccess(audioBuffer) {\n          resolve(audioBuffer)\n        },\n        function decodeAudioDataFailure(e) {\n          reject(new Error('Unable to decode audio: ' + e))\n        }\n      )\n    })\n  }\n\n  _startPlaying(instance) {\n    this._instances.add(instance)\n  }\n\n  _stoppedPlaying(instance) {\n    this._instances.delete(instance)\n  }\n}\n\n// Sound group\nexport class SoundGroup {\n  constructor(samplingMaster, { volume } = {}) {\n    this._master = samplingMaster\n    this._gain = this._master.audioContext.createGain()\n    if (volume != null) this._gain.gain.value = volume\n    this._gain.connect(this._master.destination)\n  }\n\n  get destination() {\n    return this._gain\n  }\n\n  destroy() {\n    this._gain.disconnect()\n    this._gain = null\n  }\n}\n\n// The Sample is created by and belongs to the `SamplingMaster`.\n//\n// You don't invoke this constructor directly; it is invoked by\n// `SamplingMaster#create`.\nexport class Sample {\n  constructor(samplingMaster, /** @type {AudioBuffer} */ audioBuffer) {\n    this._master = samplingMaster\n    this._buffer = audioBuffer\n  }\n\n  // Plays the sample and returns the new PlayInstance.\n  play(delay, options) {\n    return new PlayInstance(this._master, this._buffer, delay, options)\n  }\n\n  // Destroys this sample, thereby making it unusable.\n  destroy() {\n    this._master = null\n    this._buffer = null\n  }\n\n  get duration() {\n    return this._buffer.duration\n  }\n}\n\n// When a `Sample` is played, a PlayInstance is created.\n// A PlayInstance may not be reused; after the sound finishes playing,\n// you have to invoke `Sample#play` again.\n//\n// You don't invoke this constructor directly; it is invoked by `Sample#play`.\nexport class PlayInstance {\n  constructor(samplingMaster, buffer, delay, options = {}) {\n    delay = delay || 0\n    this._master = samplingMaster\n\n    // Connect all the stuff...\n    let context = samplingMaster.audioContext\n    let source = context.createBufferSource()\n    source.buffer = buffer\n    source.onended = () => this.stop()\n    let gain = context.createGain()\n    source.connect(gain)\n    let destination =\n      options.node ||\n      (options.group && options.group.destination) ||\n      samplingMaster.destination\n    gain.connect(destination)\n    this._source = source\n    this._gain = this.TEST_node = gain\n\n    // Start the sound.\n    let startTime = !delay ? 0 : Math.max(0, context.currentTime + delay)\n    let startOffset = options.start || 0\n    let fadeIn = startOffset > 0\n    let fadeOutAt = false\n    if (fadeIn) {\n      gain.gain.setValueAtTime(0, 0)\n    }\n    if (options.end !== undefined) {\n      let duration = Math.max(options.end - startOffset, 0)\n      source.start(startTime, startOffset, duration + FADE_LENGTH)\n      fadeOutAt = context.currentTime + delay + duration\n    } else {\n      source.start(startTime, startOffset)\n    }\n    if (fadeIn) {\n      gain.gain.setValueAtTime(0, context.currentTime + delay)\n      gain.gain.linearRampToValueAtTime(\n        1,\n        context.currentTime + delay + FADE_LENGTH\n      )\n    }\n    if (fadeOutAt !== false) {\n      gain.gain.setValueAtTime(1, fadeOutAt)\n      gain.gain.linearRampToValueAtTime(0, fadeOutAt + FADE_LENGTH)\n    }\n    this._master._startPlaying(this)\n  }\n\n  // Stops the sample and disconnects the underlying Web Audio nodes.\n  stop() {\n    if (!this._source) return\n    this._source.stop(0)\n    this._source.disconnect()\n    this._gain.disconnect()\n    this._source = null\n    this._gain = null\n    this._master._stoppedPlaying(this)\n    if (this.onstop) this.onstop()\n  }\n\n  // Makes this PlayInstance sound off-pitch, as a result of badly hitting\n  // a note.\n  bad() {\n    if (!this._source) return\n    this._source.playbackRate.value =\n      Math.random() < 0.5 ? Math.pow(2, 1 / 24) : Math.pow(2, -1 / 24)\n  }\n\n  // Destroys this PlayInstance.\n  destroy() {\n    this.stop()\n  }\n}\n\nexport default SamplingMaster\n\n/**\n * Enables Web Audio on iOS. By default, on iOS, audio is disabled.\n * This function must be called before audio will start working. It must be\n * called as a response to some user interaction (e.g. touchstart).\n *\n * Also, theres now Chrome autoplay policy taking effect.\n * https://developers.google.com/web/updates/2017/09/autoplay-policy-changes\n *\n * @param {AudioContext} ctx The AudioContext to be unmuted.\n */\nexport function unmuteAudio(ctx = defaultAudioContext) {\n  // Perform some strange magic to unmute the audio on iOS devices.\n  // This code doesnt make sense at all, you know.\n  let gain = ctx.createGain()\n  let osc = ctx.createOscillator()\n  osc.frequency.value = 440\n  osc.start(ctx.currentTime + 0.1)\n  osc.stop(ctx.currentTime + 0.1)\n  gain.connect(ctx.destination)\n  gain.disconnect()\n\n  resumeContext(ctx).catch((e) => {\n    console.error('[sampling-master] Cannot resume AudioContext', e)\n  })\n}\n\nasync function resumeContext(ctx) {\n  return ctx.resume()\n}\n","export function addUnprefixed(\n  prefix: string,\n  name: string,\n  callback: (path: string) => void\n) {\n  if (name.match(/\\.(?:bms|bme|bml|bmson)/i)) {\n    callback(name)\n    return\n  }\n  const parts = (prefix + name).split('/')\n  for (let i = 0; i < parts.length; i++) {\n    callback(parts.slice(i).join('/'))\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar punycode = require('punycode');\nvar util = require('./util');\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // Special case for a simple path URL\n    simplePathPattern = /^(\\/\\/?(?!\\/)[^\\?\\s]*)(\\?[^\\s]*)?$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = ['{', '}', '|', '\\\\', '^', '`'].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = ['\\''].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),\n    hostEndingChars = ['/', '?', '#'],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    unsafeProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    },\n    querystring = require('querystring');\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && util.isObject(url) && url instanceof Url) return url;\n\n  var u = new Url;\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {\n  if (!util.isString(url)) {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  // Copy chrome, IE, opera backslash-handling behavior.\n  // Back slashes before the query string get converted to forward slashes\n  // See: https://code.google.com/p/chromium/issues/detail?id=25916\n  var queryIndex = url.indexOf('?'),\n      splitter =\n          (queryIndex !== -1 && queryIndex < url.indexOf('#')) ? '?' : '#',\n      uSplit = url.split(splitter),\n      slashRegex = /\\\\/g;\n  uSplit[0] = uSplit[0].replace(slashRegex, '/');\n  url = uSplit.join(splitter);\n\n  var rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.path = rest;\n      this.href = rest;\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n        if (parseQueryString) {\n          this.query = querystring.parse(this.search.substr(1));\n        } else {\n          this.query = this.search.substr(1);\n        }\n      } else if (parseQueryString) {\n        this.search = '';\n        this.query = {};\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1)\n      hostEnd = rest.length;\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) continue;\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      // IDNA Support: Returns a punycoded representation of \"domain\".\n      // It only converts parts of the domain name that\n      // have non-ASCII characters, i.e. it doesn't matter if\n      // you call it with a domain that already is ASCII-only.\n      this.hostname = punycode.toASCII(this.hostname);\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  // now rest is set to the post-host stuff.\n  // chop off any delim chars.\n  if (!unsafeProtocol[lowerProto]) {\n\n    // First, make 100% sure that any \"autoEscape\" chars get\n    // escaped, even if encodeURIComponent doesn't think they\n    // need to be.\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      if (rest.indexOf(ae) === -1)\n        continue;\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) this.pathname = rest;\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  //to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  // ensure it's an object, and not a string url.\n  // If it's an obj, this is a no-op.\n  // this way, you can call url_format() on strings\n  // to clean up potentially wonky urls.\n  if (util.isString(obj)) obj = urlParse(obj);\n  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);\n  return obj.format();\n}\n\nUrl.prototype.format = function() {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n      pathname = this.pathname || '',\n      hash = this.hash || '',\n      host = false,\n      query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ?\n        this.hostname :\n        '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query &&\n      util.isObject(this.query) &&\n      Object.keys(this.query).length) {\n    query = querystring.stringify(this.query);\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':';\n\n  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n  // unless they had them to begin with.\n  if (this.slashes ||\n      (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;\n  if (search && search.charAt(0) !== '?') search = '?' + search;\n\n  pathname = pathname.replace(/[?#]/g, function(match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function(relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) return relative;\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function(relative) {\n  if (util.isString(relative)) {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  var tkeys = Object.keys(this);\n  for (var tk = 0; tk < tkeys.length; tk++) {\n    var tkey = tkeys[tk];\n    result[tkey] = this[tkey];\n  }\n\n  // hash is always overridden, no matter what.\n  // even href=\"\" will remove it.\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    var rkeys = Object.keys(relative);\n    for (var rk = 0; rk < rkeys.length; rk++) {\n      var rkey = rkeys[rk];\n      if (rkey !== 'protocol')\n        result[rkey] = relative[rkey];\n    }\n\n    //urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] &&\n        result.hostname && !result.pathname) {\n      result.path = result.pathname = '/';\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    // if it's a known url protocol, then changing\n    // the protocol does weird things\n    // first, if it's not file:, then we MUST have a host,\n    // and if there was a path\n    // to begin with, then we MUST have a path.\n    // if it is file:, then the host is dropped,\n    // because that's known to be hostless.\n    // anything else is assumed to be absolute.\n    if (!slashedProtocol[relative.protocol]) {\n      var keys = Object.keys(relative);\n      for (var v = 0; v < keys.length; v++) {\n        var k = keys[v];\n        result[k] = relative[k];\n      }\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift()));\n      if (!relative.host) relative.host = '';\n      if (!relative.hostname) relative.hostname = '';\n      if (relPath[0] !== '') relPath.unshift('');\n      if (relPath.length < 2) relPath.unshift('');\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),\n      isRelAbs = (\n          relative.host ||\n          relative.pathname && relative.pathname.charAt(0) === '/'\n      ),\n      mustEndAbs = (isRelAbs || isSourceAbs ||\n                    (result.host && relative.pathname)),\n      removeAllDots = mustEndAbs,\n      srcPath = result.pathname && result.pathname.split('/') || [],\n      relPath = relative.pathname && relative.pathname.split('/') || [],\n      psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  // if the url is a non-slashed url, then relative\n  // links like ../.. should be able\n  // to crawl up to the hostname, as well.  This is strange.\n  // result.protocol has already been set by now.\n  // Later on, put the first path part into the host field.\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') srcPath[0] = result.host;\n      else srcPath.unshift(result.host);\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') relPath[0] = relative.host;\n        else relPath.unshift(relative.host);\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = (relative.host || relative.host === '') ?\n                  relative.host : result.host;\n    result.hostname = (relative.hostname || relative.hostname === '') ?\n                      relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    // it's relative\n    // throw away the existing file, and take the new path instead.\n    if (!srcPath) srcPath = [];\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (!util.isNullOrUndefined(relative.search)) {\n    // just pull out the search.\n    // like href='?foo'.\n    // Put this after the other two cases because it simplifies the booleans\n    if (psychotic) {\n      result.hostname = result.host = srcPath.shift();\n      //occationaly the auth can get stuck only in host\n      //this especially happens in cases like\n      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n      var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                       result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.host = result.hostname = authInHost.shift();\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    //to support http.request\n    if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n      result.path = (result.pathname ? result.pathname : '') +\n                    (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    // no path at all.  easy.\n    // we've already handled the other stuff above.\n    result.pathname = null;\n    //to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  // if a url ENDs in . or .., then it must get a trailing slash.\n  // however, if it ends in anything else non-slashy,\n  // then it must NOT get a trailing slash.\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (\n      (result.host || relative.host || srcPath.length > 1) &&\n      (last === '.' || last === '..') || last === '');\n\n  // strip single dots, resolve double dots to parent dir\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last === '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' &&\n      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' ||\n      (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = result.host = isAbsolute ? '' :\n                                    srcPath.length ? srcPath.shift() : '';\n    //occationaly the auth can get stuck only in host\n    //this especially happens in cases like\n    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n    var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                     result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.host = result.hostname = authInHost.shift();\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (!srcPath.length) {\n    result.pathname = null;\n    result.path = null;\n  } else {\n    result.pathname = srcPath.join('/');\n  }\n\n  //to support request.http\n  if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n    result.path = (result.pathname ? result.pathname : '') +\n                  (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function() {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) this.hostname = host;\n};\n","import { LoggingFunction } from './types'\n\nexport default class ResourceLogging {\n  private buffer: string[] | null = []\n  private loggingFunction: LoggingFunction = (text) => {\n    if (this.buffer) this.buffer.push(text)\n  }\n  public log: LoggingFunction = (text) => {\n    this.loggingFunction(text)\n  }\n  setLoggingFunction = (fn: LoggingFunction) => {\n    this.loggingFunction = fn\n    if (this.buffer) {\n      this.buffer.forEach((text) => fn(text))\n      this.buffer = null\n    }\n  }\n}\n","\r\n/**\r\n * Represents compressed file before extraction\r\n */\r\nexport class CompressedFile{\r\n\r\n    constructor(name,size,path,archiveRef){\r\n        this._name = name;\r\n        this._size = size;\r\n        this._path = path;\r\n        this._archiveRef = archiveRef;\r\n    }\r\n\r\n    /**\r\n     * file name\r\n     */\r\n    get name(){\r\n        return this._name;\r\n    }\r\n    /**\r\n     * file size\r\n     */\r\n    get size(){\r\n        return this._size;\r\n    }\r\n\r\n    /**\r\n     * Extract file from archive\r\n     * @returns {Promise<File>} extracted file\r\n     */\r\n    extract(){\r\n        return this._archiveRef.extractSingleFile(this._path);\r\n    }\r\n\r\n}","import { CompressedFile } from \"./compressed-file.js\";\r\n\r\n\r\nexport class Archive{\r\n\r\n    /**\r\n     * Initialize libarchivejs\r\n     * @param {Object} options \r\n     */\r\n    static init(options = {}){\r\n        Archive._options = {\r\n            workerUrl: '../dist/worker-bundle.js',\r\n            ...options\r\n        };\r\n        return Archive._options;\r\n    }\r\n\r\n    /**\r\n     * Creates new archive instance from browser native File object\r\n     * @param {File} file\r\n     * @param {object} options\r\n     * @returns {Archive}\r\n     */\r\n    static open(file, options = null){\r\n        options =   options || \r\n                    Archive._options || \r\n                    Archive.init() && console.warn('Automatically initializing using options: ', Archive._options);\r\n        const arch = new Archive(file,options);\r\n        return arch.open();\r\n    }\r\n\r\n    /**\r\n     * Create new archive\r\n     * @param {File} file \r\n     * @param {Object} options \r\n     */\r\n    constructor(file,options){\r\n        this._worker = new Worker(options.workerUrl);\r\n        this._worker.addEventListener('message', this._workerMsg.bind(this));\r\n        this._callbacks = [];\r\n        this._content = {};\r\n        this._processed = 0;\r\n        this._file = file;\r\n    }\r\n\r\n    /**\r\n     * Prepares file for reading\r\n     * @returns {Promise<Archive>} archive instance\r\n     */\r\n    async open(){\r\n        await this._postMessage({type: 'HELLO'},(resolve,reject,msg) => {\r\n            if( msg.type === 'READY' ){\r\n                resolve();\r\n            }\r\n        });\r\n        return await this._postMessage({type: 'OPEN', file: this._file}, (resolve,reject,msg) => {\r\n            if(msg.type === 'OPENED'){\r\n                resolve(this);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * detect if archive has encrypted data\r\n     * @returns {boolean|null} null if could not be determined\r\n     */\r\n    hasEncryptedData(){\r\n        return this._postMessage({type: 'CHECK_ENCRYPTION'}, \r\n            (resolve,reject,msg) => {\r\n                if( msg.type === 'ENCRYPTION_STATUS' ){\r\n                    resolve(msg.status);\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    /**\r\n     * set password to be used when reading archive\r\n     */\r\n    usePassword(archivePassword){\r\n        return this._postMessage({type: 'SET_PASSPHRASE', passphrase: archivePassword},\r\n            (resolve,reject,msg) => {\r\n                if( msg.type === 'PASSPHRASE_STATUS' ){\r\n                    resolve(msg.status);\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Returns object containing directory structure and file information \r\n     * @returns {Promise<object>}\r\n     */\r\n    getFilesObject(){\r\n        if( this._processed > 0 ){\r\n            return Promise.resolve().then( () => this._content );\r\n        }\r\n        return this._postMessage({type: 'LIST_FILES'}, (resolve,reject,msg) => {\r\n            if( msg.type === 'ENTRY' ){\r\n                const entry = msg.entry;\r\n                const [ target, prop ] = this._getProp(this._content,entry.path);\r\n                if( entry.type === 'FILE' ){\r\n                    target[prop] = new CompressedFile(entry.fileName,entry.size,entry.path,this);                    \r\n                }\r\n                return true;\r\n            }else if( msg.type === 'END' ){\r\n                this._processed = 1;\r\n                resolve(this._cloneContent(this._content));\r\n            }\r\n        });\r\n    }\r\n\r\n    getFilesArray(){\r\n        return this.getFilesObject().then( (obj) => {\r\n            return this._objectToArray(obj);\r\n        });\r\n    }\r\n\r\n    extractSingleFile(target){\r\n        return this._postMessage({type: 'EXTRACT_SINGLE_FILE', target: target}, \r\n            (resolve,reject,msg) => {\r\n                if( msg.type === 'FILE' ){\r\n                    const file = new File([msg.entry.fileData], msg.entry.fileName, {\r\n                        type: 'application/octet-stream'\r\n                    });\r\n                    resolve(file);\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Returns object containing directory structure and extracted File objects \r\n     * @param {Function} extractCallback\r\n     * \r\n     */\r\n    extractFiles(extractCallback){\r\n        if( this._processed > 1 ){\r\n            return Promise.resolve().then( () => this._content );\r\n        }\r\n        return this._postMessage({type: 'EXTRACT_FILES'}, (resolve,reject,msg) => {\r\n            if( msg.type === 'ENTRY' ){\r\n                const [ target, prop ] = this._getProp(this._content,msg.entry.path);\r\n                if( msg.entry.type === 'FILE' ){\r\n                    target[prop] = new File([msg.entry.fileData], msg.entry.fileName, {\r\n                        type: 'application/octet-stream'\r\n                    });\r\n                    if (extractCallback !== undefined) {\r\n                        setTimeout(extractCallback.bind(null,{\r\n                            file: target[prop],\r\n                            path: msg.entry.path,\r\n                        }));\r\n                    }\r\n                }\r\n                return true;\r\n            }else if( msg.type === 'END' ){\r\n                this._processed = 2;\r\n                this._worker.terminate();\r\n                resolve(this._cloneContent(this._content));\r\n            }\r\n        });\r\n    }\r\n\r\n    _cloneContent(obj){\r\n        if( obj instanceof File || obj instanceof CompressedFile || obj === null ) return obj;\r\n        const o = {};\r\n        for( const prop of Object.keys(obj) ){\r\n            o[prop] = this._cloneContent(obj[prop]);\r\n        }\r\n        return o;\r\n    }\r\n\r\n    _objectToArray(obj,path = ''){\r\n        const files = [];\r\n        for( const key of Object.keys(obj) ){\r\n            if( obj[key] instanceof File || obj[key] instanceof CompressedFile || obj[key] === null ){\r\n                files.push({\r\n                    file: obj[key] || key,\r\n                    path: path\r\n                });\r\n            }else{\r\n                files.push( ...this._objectToArray(obj[key],`${path}${key}/`) );\r\n            }\r\n        }\r\n        return files;\r\n    }\r\n\r\n    _getProp(obj,path){\r\n        const parts = path.split('/');\r\n        if( parts[parts.length -1] === '' ) parts.pop();\r\n        let cur = obj, prev = null;\r\n        for( const part of parts ){\r\n            cur[part] = cur[part] || {};\r\n            prev = cur;\r\n            cur = cur[part];\r\n        }\r\n        return [ prev, parts[parts.length-1] ];\r\n    }\r\n\r\n    _postMessage(msg,callback){\r\n        this._worker.postMessage(msg);\r\n        return new Promise((resolve,reject) => {\r\n            this._callbacks.push( this._msgHandler.bind(this,callback,resolve,reject) );\r\n        });\r\n    }\r\n\r\n    _msgHandler(callback,resolve,reject,msg){\r\n        if( msg.type === 'BUSY' ){\r\n            reject('worker is busy');\r\n        }else if( msg.type === 'ERROR' ){\r\n            reject(msg.error);\r\n        }else{\r\n            return callback(resolve,reject,msg);\r\n        }\r\n    }\r\n\r\n    _workerMsg({data: msg}){\r\n        const callback = this._callbacks[this._callbacks.length -1];\r\n        const next = callback(msg);\r\n        if( !next ){\r\n            this._callbacks.pop();\r\n        }\r\n    }\r\n\r\n}","import { Archive } from 'libarchive.js/main.js'\nimport { addUnprefixed } from './addUnprefixed'\nimport { FileEntry } from './types'\n\nArchive.init({\n  workerUrl: '/vendor/libarchive.js-1.3.0/dist/worker-bundle.js',\n})\n\nexport async function unarchive(file: File): Promise<FileEntry[]> {\n  const out: FileEntry[] = []\n  const archive = await Archive.open(file)\n  const extracted = await archive.extractFiles()\n  const traverse = (tree: any, prefix = '') => {\n    for (const key of Object.keys(tree)) {\n      if (tree[key] instanceof File) {\n        addUnprefixed(prefix, key, (name) => {\n          out.push({ name, file: tree[key] })\n        })\n      } else if (tree[key] && typeof tree[key] === 'object') {\n        traverse(tree[key], prefix + key + '/')\n      }\n    }\n  }\n  traverse(extracted)\n  return out\n}\n","import * as ProgressUtils from 'bemuse/progress/utils'\nimport {\n  FileEntry,\n  LoggingFunction,\n  IResource,\n  ICustomSongResources,\n} from './types'\nimport ResourceLogging from './resource-logging'\nimport { unarchive } from './unarchiver'\nimport readBlob from 'bemuse/utils/read-blob'\nimport Progress from 'bemuse/progress'\nimport download from 'bemuse/utils/download'\n\nexport const ARCHIVE_REGEXP = /\\.(?:zip|rar|7z|tar(?:\\.(?:gz|bz2))?)/i\n\n// http://nekokan.dyndns.info/tool/DropboxReplacer/index.html\nconst DROPBOX_REGEXP =\n  /https?:\\/\\/(?:(?:www|dl)\\.dropbox\\.com|dl\\.dropboxusercontent\\.com)\\/(sh?)\\/([^?]*)(.*)?$/\n\n/**\n * A resource provider for custom songs.\n * It may retrieve the files from, e.g., a drag and drop event or an `?archive` flag.\n */\nexport interface CustomResourceProvider {\n  getFiles(loggingFunction: LoggingFunction): PromiseLike<FileEntry[]>\n}\n\n/**\n * An IResources for songs provided by a CustomResourceProvider.\n */\nexport class CustomSongResources implements ICustomSongResources {\n  private _logging = new ResourceLogging()\n  private _files: PromiseLike<FileEntry[]>\n  public setLoggingFunction = this._logging.setLoggingFunction\n\n  constructor(provider: CustomResourceProvider) {\n    this._files = Promise.resolve(provider.getFiles(this._logging.log)).then(\n      (files) => unarchiveIfNeeded(files, this._logging.log)\n    )\n  }\n  file(name: string) {\n    return this._files.then(function (files) {\n      for (let file of files) {\n        if (file.name.toLowerCase() === name.toLowerCase()) {\n          return new FileResource(file.file)\n        }\n      }\n      throw new Error('unable to find ' + name)\n    })\n  }\n  get fileList(): Promise<string[]> {\n    return Promise.resolve(this._files).then((a) => a.map((f) => f.name))\n  }\n}\n\nexport class FileResource implements IResource {\n  constructor(private _file: File) {}\n  read(progress: Progress) {\n    return ProgressUtils.atomic(\n      progress,\n      readBlob(this._file).as('arraybuffer')\n    )\n  }\n  resolveUrl() {\n    return Promise.resolve(URL.createObjectURL(this._file))\n  }\n  get name() {\n    return this._file.name\n  }\n}\n\n/**\n * If only 1 FileEntry is present and it is an archive file, extract it.\n */\nexport async function unarchiveIfNeeded(\n  files: FileEntry[],\n  log: LoggingFunction\n): Promise<FileEntry[]> {\n  if (files.length !== 1) return files\n  const fileEntry = files[0]\n  if (!fileEntry.name.match(ARCHIVE_REGEXP)) {\n    return files\n  }\n  log('Archive file detected! Now unarchiving')\n  return unarchive(fileEntry.file)\n}\n\n/**\n * Downloads a URL as a FileEntry.\n */\nexport async function downloadFileEntryFromURL(\n  url: string,\n  log: LoggingFunction\n): Promise<FileEntry> {\n  const name = url\n    .replace(/[?#].*/, '')\n    .split('/')\n    .pop()!\n\n  // Try Dropbox URL replacement\n  const match = url.match(DROPBOX_REGEXP)\n  if (match) {\n    url = `https://dl.dropboxusercontent.com/${match[1]}/${match[2]}`\n  }\n\n  const progress = new Progress()\n  let lastTime = 0\n  progress.watch(() => {\n    if (Date.now() < lastTime + 5e3) return\n    log(`Downloading: ${progress}`)\n    lastTime = Date.now()\n  })\n  const blob = await download(url).as('blob', progress)\n  return { name, file: blob }\n}\n","import throat from 'throat'\n\ntype OGGDecodeEvent = {\n  data?: Float32Array[]\n  sampleRate: number\n  error?: any\n  eof?: boolean\n}\n\ntype OGGDecoder = {\n  decode(arrayBuffer: ArrayBuffer, callback: (e: OGGDecodeEvent) => void): void\n}\n\nlet decoderPromise: Promise<OGGDecoder>\n\nconst limit = throat(1)\n\nfunction getDecoder() {\n  if (!decoderPromise) {\n    decoderPromise = import(\n      // @ts-ignore\n      /* webpackChunkName: 'stbvorbis' */ 'raw-loader!./vendor/stbvorbis/stbvorbis-e6da5fe-NDEBUG.js'\n    )\n      .then((ns) => ns.default)\n      .then((src) => {\n        // eslint-disable-next-line no-eval\n        return (0, eval)(src + ';stbvorbis')\n      })\n  }\n  return decoderPromise\n}\n\n/**\n * Decodes an OGG file using stbvorbis.js.\n */\nexport async function decodeOGG(\n  audioContext: AudioContext,\n  arrayBuffer: ArrayBuffer\n) {\n  const stbvorbis = await getDecoder()\n  return limit(() => doDecodeOGG(stbvorbis, audioContext, arrayBuffer))\n}\n\nfunction doDecodeOGG(\n  stbvorbis: OGGDecoder,\n  audioContext: AudioContext,\n  arrayBuffer: ArrayBuffer\n) {\n  return new Promise<AudioBuffer>((resolve, reject) => {\n    const buffers: Float32Array[][] = []\n    let totalLength = 0\n    let sampleRate: number\n    stbvorbis.decode(arrayBuffer, function (e) {\n      if (e.data) {\n        sampleRate = e.sampleRate\n        buffers.push(e.data)\n        totalLength += e.data[0].length\n      }\n      if (e.error) {\n        const error =\n          e.error instanceof Error ? e.error : `stbvorbis.js Error: ${e.error}`\n        reject(error)\n      }\n      if (e.eof) {\n        resolve(createBuffer(audioContext, buffers, totalLength, sampleRate))\n      }\n    })\n  })\n}\n\nasync function createBuffer(\n  audioContext: AudioContext,\n  decodedChunks: Float32Array[][],\n  length: number,\n  sampleRate: number\n) {\n  if (!length) throw new Error(`stbvorbis.js Error: No length`)\n  if (!sampleRate) throw new Error(`stbvorbis.js Error: No sample rate`)\n  const numberOfChannels = decodedChunks[0].length\n  const audioBuffer = audioContext.createBuffer(\n    numberOfChannels,\n    length,\n    sampleRate\n  )\n  const channels: ChannelDataWriter[] = Array(audioBuffer.numberOfChannels)\n    .fill(null)\n    .map((_, ch) => new ChannelDataWriter(audioBuffer.getChannelData(ch)))\n  for (const chunk of decodedChunks) {\n    chunk.forEach((audioSamples, channelIndex) => {\n      channels[channelIndex].write(audioSamples)\n    })\n  }\n  return audioBuffer\n}\n\nclass ChannelDataWriter {\n  private offset = 0\n  constructor(private data: Float32Array) {}\n  write(audioSamples: Float32Array) {\n    // iOS Safari does not support `buf.copyToChannel(a, ch, track[ch])`, so we had to copy audio data sample-by-sample.\n    const { offset, data } = this\n    for (var i = 0; i < audioSamples.length; i++) {\n      data[i + offset] = audioSamples[i]\n    }\n    this.offset += audioSamples.length\n  }\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Notechart = void 0;\nvar lodash_1 = __importDefault(require(\"lodash\"));\nvar invariant_1 = __importDefault(require(\"invariant\"));\n__exportStar(require(\"./types\"), exports);\n/**\n * A notechart holds every info about a single player's note chart that the\n * game will ever need.\n */\nvar Notechart = /** @class */ (function () {\n    function Notechart(data, playerOptions) {\n        var _this = this;\n        if (playerOptions === void 0) { playerOptions = {}; }\n        var bmsNotes = data.notes, timing = data.timing, keysounds = data.keysounds, songInfo = data.songInfo, positioning = data.positioning, spacing = data.spacing, barLines = data.barLines, images = data.images, expertJudgmentWindow = data.expertJudgmentWindow, _a = data.landmineNotes, landmineNotes = _a === void 0 ? [] : _a;\n        (0, invariant_1.default)(bmsNotes, 'Expected \"data.notes\"');\n        (0, invariant_1.default)(timing, 'Expected \"data.timing\"');\n        (0, invariant_1.default)(keysounds, 'Expected \"data.keysounds\"');\n        (0, invariant_1.default)(songInfo, 'Expected \"data.songInfo\"');\n        (0, invariant_1.default)(positioning, 'Expected \"data.positioning\"');\n        (0, invariant_1.default)(spacing, 'Expected \"data.spacing\"');\n        (0, invariant_1.default)(barLines, 'Expected \"data.barLines\"');\n        this.expertJudgmentWindow = expertJudgmentWindow;\n        bmsNotes = this._preTransform(bmsNotes, playerOptions);\n        this._timing = timing;\n        this._positioning = positioning;\n        this._spacing = spacing;\n        this._keysounds = keysounds;\n        this._duration = 0;\n        this._notes = this._generatePlayableNotesFromBMS(bmsNotes);\n        this._landmines = this._generatePlayableNotesFromBMS(landmineNotes);\n        this._autos = this._generateAutoKeysoundEventsFromBMS(bmsNotes);\n        this._barLines = this._generateBarLineEvents(barLines);\n        this._samples = this._generateKeysoundFiles(keysounds);\n        this._infos = new Map(this._notes.map(function (note) { return [note, _this._getNoteInfo(note)]; }));\n        this._songInfo = songInfo;\n        this._images = images;\n    }\n    Object.defineProperty(Notechart.prototype, \"notes\", {\n        /**\n         * An Array of note events.\n         */\n        get: function () {\n            return this._notes;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"landmines\", {\n        /**\n         * An Array of landmines events.\n         */\n        get: function () {\n            return this._landmines;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"autos\", {\n        /**\n         * An Array of auto-keysound events.\n         */\n        get: function () {\n            return this._autos;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"samples\", {\n        /**\n         * An Array of all the sample files to use.\n         */\n        get: function () {\n            return this._samples;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"keysounds\", {\n        /**\n         * An Object containing the mapping from keysound ID to keysound filename.\n         */\n        get: function () {\n            return this._keysounds.all();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"barLines\", {\n        /**\n         * An Object representing the bar line events.\n         */\n        get: function () {\n            return this._barLines;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"columns\", {\n        /**\n         * An Array of all column names in this notechart.\n         */\n        get: function () {\n            return ['SC', '1', '2', '3', '4', '5', '6', '7'];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"duration\", {\n        /**\n         * Notechart's duration (time of last event)\n         */\n        get: function () {\n            return this._duration;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"songInfo\", {\n        /**\n         * Notechart's song info\n         */\n        get: function () {\n            return this._songInfo;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"eyecatchImage\", {\n        /**\n         * Eyecatch image\n         */\n        get: function () {\n            return (this._images && this._images.eyecatch) || 'eyecatch_image.png';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Notechart.prototype, \"backgroundImage\", {\n        /**\n         * Background image\n         */\n        get: function () {\n            return (this._images && this._images.background) || 'back_image.png';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Returns the characteristic of the note as an Object.\n     */\n    Notechart.prototype.info = function (note) {\n        return this._infos.get(note);\n    };\n    /**\n     * Converts the beat number to in-song position (seconds)\n     */\n    Notechart.prototype.beatToSeconds = function (beat) {\n        return this._timing.beatToSeconds(beat);\n    };\n    /**\n     * Converts the beat number to in-game position.\n     */\n    Notechart.prototype.beatToPosition = function (beat) {\n        return this._positioning.position(beat);\n    };\n    /**\n     * Converts measure number to beat.\n     */\n    Notechart.prototype.measureToBeat = function (measure) {\n        return (this._barLines[measure] || this._barLines[this._barLines.length - 1]).beat;\n    };\n    /**\n     * Converts the in-song position to beat number.\n     */\n    Notechart.prototype.secondsToBeat = function (seconds) {\n        return this._timing.secondsToBeat(seconds);\n    };\n    /**\n     * Converts the in-song position to in-game position.\n     */\n    Notechart.prototype.secondsToPosition = function (seconds) {\n        return this.beatToPosition(this.secondsToBeat(seconds));\n    };\n    /**\n     * Finds BPM at the specified beat.\n     */\n    Notechart.prototype.bpmAtBeat = function (beat) {\n        return this._timing.bpmAtBeat(beat);\n    };\n    /**\n     * Finds the scrolling speed at the specified beat.\n     */\n    Notechart.prototype.scrollSpeedAtBeat = function (beat) {\n        return this._positioning.speed(beat);\n    };\n    /**\n     * Calculates the note spacing factor at the specified beat.\n     */\n    Notechart.prototype.spacingAtBeat = function (beat) {\n        return this._spacing.factor(beat);\n    };\n    /**\n     * Gets the keyMode from scratch\n     * @param scratch\n     * @returns {string}\n     */\n    Notechart.prototype.getKeyMode = function (scratch) {\n        var e_1, _a;\n        var usedColumns = {};\n        try {\n            for (var _b = __values(this.notes), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var note = _c.value;\n                usedColumns[note.column] = true;\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        if (scratch === 'off' && !usedColumns['1'] && !usedColumns['7'])\n            return '5K';\n        if (scratch === 'left' && !usedColumns['6'] && !usedColumns['7'])\n            return '5K';\n        if (scratch === 'right' && !usedColumns['1'] && !usedColumns['2'])\n            return '5K';\n        return '7K';\n    };\n    Notechart.prototype._preTransform = function (bmsNotes, playerOptions) {\n        var chain = lodash_1.default.chain(bmsNotes);\n        var keys = getKeys(bmsNotes);\n        if (playerOptions.scratch === 'off') {\n            chain = chain.map(function (note) {\n                if (note.column && note.column === 'SC') {\n                    return Object.assign({}, note, { column: null });\n                }\n                else {\n                    return note;\n                }\n            });\n        }\n        if (keys === '5K') {\n            var columnsToShift_1 = ['1', '2', '3', '4', '5', '6', '7'];\n            var shiftNote = function (amount) { return function (note) {\n                if (note.column) {\n                    var index = columnsToShift_1.indexOf(note.column);\n                    if (index > -1) {\n                        var newIndex = index + amount;\n                        (0, invariant_1.default)(newIndex < columnsToShift_1.length, 'Weird. Columns must not shift beyond available column');\n                        var newColumn = columnsToShift_1[newIndex];\n                        return Object.assign({}, note, { column: newColumn });\n                    }\n                }\n                return note;\n            }; };\n            if (playerOptions.scratch === 'off') {\n                chain = chain.map(shiftNote(1));\n            }\n            else if (playerOptions.scratch === 'right') {\n                chain = chain.map(shiftNote(2));\n            }\n        }\n        return chain.value();\n    };\n    Notechart.prototype._generatePlayableNotesFromBMS = function (bmsNotes) {\n        var _this = this;\n        var nextId = 1;\n        return bmsNotes\n            .filter(function (note) { return note.column; })\n            .map(function (note) {\n            var spec = _this._generateEvent(note.beat);\n            spec.id = nextId++;\n            spec.column = note.column;\n            spec.keysound = note.keysound;\n            spec.keysoundStart = note.keysoundStart;\n            spec.keysoundEnd = note.keysoundEnd;\n            _this._updateDuration(spec);\n            if (note.endBeat !== undefined) {\n                spec.end = _this._generateEvent(note.endBeat);\n                _this._updateDuration(spec.end);\n            }\n            else {\n                spec.end = undefined;\n            }\n            return spec;\n        });\n    };\n    Notechart.prototype._generateLandminesFromBMS = function (bmsNotes) {\n        var _this = this;\n        var nextId = 1;\n        return bmsNotes\n            .filter(function (note) { return note.column; })\n            .map(function (note) {\n            var spec = _this._generateEvent(note.beat);\n            spec.id = nextId++;\n            spec.column = note.column;\n            _this._updateDuration(spec);\n            return spec;\n        });\n    };\n    Notechart.prototype._updateDuration = function (event) {\n        if (event.time > this._duration)\n            this._duration = event.time;\n    };\n    Notechart.prototype._generateAutoKeysoundEventsFromBMS = function (bmsNotes) {\n        var _this = this;\n        return bmsNotes\n            .filter(function (note) { return !note.column; })\n            .map(function (note) {\n            var spec = _this._generateEvent(note.beat);\n            spec.keysound = note.keysound;\n            spec.keysoundStart = note.keysoundStart;\n            spec.keysoundEnd = note.keysoundEnd;\n            return spec;\n        });\n    };\n    Notechart.prototype._generateKeysoundFiles = function (keysounds) {\n        var e_2, _a, e_3, _b;\n        var set = new Set();\n        try {\n            for (var _c = __values([this.notes, this.autos]), _d = _c.next(); !_d.done; _d = _c.next()) {\n                var array = _d.value;\n                try {\n                    for (var array_1 = (e_3 = void 0, __values(array)), array_1_1 = array_1.next(); !array_1_1.done; array_1_1 = array_1.next()) {\n                        var event_ = array_1_1.value;\n                        var file = keysounds.get(event_.keysound);\n                        if (file)\n                            set.add(file);\n                    }\n                }\n                catch (e_3_1) { e_3 = { error: e_3_1 }; }\n                finally {\n                    try {\n                        if (array_1_1 && !array_1_1.done && (_b = array_1.return)) _b.call(array_1);\n                    }\n                    finally { if (e_3) throw e_3.error; }\n                }\n            }\n        }\n        catch (e_2_1) { e_2 = { error: e_2_1 }; }\n        finally {\n            try {\n                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n            }\n            finally { if (e_2) throw e_2.error; }\n        }\n        return Array.from(set);\n    };\n    Notechart.prototype._generateBarLineEvents = function (beats) {\n        var _this = this;\n        return beats.map(function (beat) { return _this._generateEvent(beat); });\n    };\n    Notechart.prototype._generateEvent = function (beat) {\n        return {\n            beat: beat,\n            time: this.beatToSeconds(beat),\n            position: this.beatToPosition(beat),\n        };\n    };\n    Notechart.prototype._getNoteInfo = function (note) {\n        return { combos: note.end ? 2 : 1 };\n    };\n    return Notechart;\n}());\nexports.Notechart = Notechart;\nexports.default = Notechart;\nfunction getKeys(bmsNotes) {\n    var e_4, _a;\n    try {\n        for (var bmsNotes_1 = __values(bmsNotes), bmsNotes_1_1 = bmsNotes_1.next(); !bmsNotes_1_1.done; bmsNotes_1_1 = bmsNotes_1.next()) {\n            var note = bmsNotes_1_1.value;\n            if (note.column === '6' || note.column === '7') {\n                return '7K';\n            }\n        }\n    }\n    catch (e_4_1) { e_4 = { error: e_4_1 }; }\n    finally {\n        try {\n            if (bmsNotes_1_1 && !bmsNotes_1_1.done && (_a = bmsNotes_1.return)) _a.call(bmsNotes_1);\n        }\n        finally { if (e_4) throw e_4.error; }\n    }\n    return '5K';\n}\n//# sourceMappingURL=index.js.map","// Touch3D mode -- inspired by Thapster.\n// Notes are arranged on a 3D arc that moves towards the screen.\n// Example: https://twitter.com/bemusegame/status/950505986409709569\n\n/** Parameters to the algorithm. These values are obtained by trial-and-error. */\nconst config = {\n  /** Centre point of the arc (X-coordinate) */\n  cx: 1024,\n  /** Centre point of the arc (Y-coordinate) */\n  cy: -975,\n  /** Radius of the arc */\n  r: 1024,\n  /** Beginning angle of the arc */\n  t0: 3.922,\n  /** Ending angle of the arc */\n  t1: 4.555,\n  /**\n   * Perspective value (field of view).\n   * Camera is placed at (p, 0, 0), facing towards (0, 0, 0).\n   * See: https://developer.mozilla.org/en-US/docs/Web/CSS/perspective\n   */\n  p: 960,\n  /** Width of the play area */\n  w: 60,\n}\n\n/**\n * Given the display position (0 representing top and 1 representing bottom),\n * calculates the onscreen position to display it.\n *\n * Screen size is hardcoded as 1280x720.\n *\n * @param position The display position (0 representing top and 1 representing bottom)\n * @return An object with\n *   - `y` A number represeting the onscreen position to display the note.\n *   - `projection` The projected scale. If an object is closer to the screen,\n *     it will appear bigger. This value represents that scale.\n */\nexport function getRow(position) {\n  let excess = Math.max(0, position - 1)\n  if (position < 0) position = 0\n  if (position > 1) position = 1\n  let theta = config.t0 + (config.t1 - config.t0) * position\n  let pointX = config.cx + Math.cos(theta) * config.r\n  let pointY = config.cy - Math.sin(theta) * config.r\n  let projection = config.p / (config.p - pointX)\n  let screenY = pointY * projection + 720 / 2\n  return { y: screenY + excess * 2048, projection }\n}\n\n/**\n * The world width of the play area.\n * Multiply this with the projection number to get the onscreen width.\n */\nexport const PLAY_AREA_WIDTH = config.w\n\n/**\n * Finds the touched column based on screen coordinate.\n *\n * @param {number} x The x onscreen coordinate (0~1280)\n * @param {number} y The y onscreen coordinate (0~1280)\n * @return Column name ('1'~'7') or `null` if no column should be triggered.\n */\nexport function getTouchedColumn(x, y) {\n  let min = 0.75\n  let max = 1\n  let mid\n  let row\n  for (let i = 0; i < 8; i++) {\n    mid = (min + max) / 2\n    row = getRow(mid)\n    if (row.y > y) {\n      max = mid\n    } else {\n      min = mid\n    }\n  }\n  if (mid < 0.8) return null\n  let x0 = 1280 / 2 + row.projection * -config.w\n  let x1 = 1280 / 2 + row.projection * config.w\n  let pos = Math.floor(((x - x0) / (x1 - x0)) * 7)\n  if (pos >= -1 && pos <= 7) {\n    if (pos < 0) pos = 0\n    if (pos > 6) pos = 6\n    return String(pos + 1)\n  }\n  return null\n}\n","import './BenchmarkPanel.scss'\nimport React from 'react'\nimport PropTypes from 'prop-types'\n\nexport default class BenchmarkPanel extends React.Component {\n  static propTypes = {\n    bench: PropTypes.object,\n  }\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      show: false,\n      text: 'wow',\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className='BenchmarkPanel'\n        onClick={this.handleInteraction}\n        onTouchStart={this.handleInteraction}\n      >\n        {this.state.show ? (\n          <article>\n            <b>Benchmark Stats</b>\n            <br />\n            {this.renderTable()}\n          </article>\n        ) : (\n          'Show Benchmark Stats'\n        )}\n      </div>\n    )\n  }\n\n  componentDidMount() {\n    setInterval(() => this.forceUpdate(), 1000)\n  }\n\n  renderTable = () => {\n    let stats = this.props.bench.stats\n    return (\n      <table>\n        <tbody>\n          {Object.keys(stats).map((key) => {\n            let stat = stats[key]\n            return (\n              <tr>\n                <td>\n                  <strong>{key}</strong>\n                </td>\n                <td align='right'>{'' + stat}</td>\n              </tr>\n            )\n          })}\n        </tbody>\n      </table>\n    )\n  }\n\n  handleInteraction = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n    this.setState({ show: !this.state.show })\n  }\n}\n","import now from 'bemuse/utils/now'\nimport { shouldEnableBenchmark } from './query-flags'\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport BenchmarkPanel from './ui/BenchmarkPanel'\n\nfunction Stat() {\n  let sum = 0\n  let count = 0\n  let average = 0\n  let hist = []\n  let lastSec = 0\n  let secAvg = 0\n  return {\n    push: function (delta) {\n      let t = now()\n      sum += delta\n      count += 1\n      average = sum / count\n      lastSec += delta\n      hist.push({ delta, time: t })\n      while (hist[0] && hist[0].time < t - 1000) {\n        lastSec -= hist.shift().delta\n      }\n      secAvg = lastSec / hist.length\n    },\n    toString() {\n      return format(average) + ' / ' + format(secAvg)\n    },\n  }\n}\n\nfunction format(x) {\n  return x.toFixed(2) + 'ms'\n}\n\nfunction Benchmarker() {\n  var stats = {}\n  let bench = {\n    enabled: true,\n    stats,\n    wrap(title, f) {\n      return function () {\n        try {\n          var start = now()\n          return f.apply(this, arguments)\n        } finally {\n          var finish = now()\n          var stat = stats[title] || (stats[title] = new Stat(title))\n          stat.push(finish - start)\n        }\n      }\n    },\n    benchmark(title, obj, name) {\n      obj[name] = this.wrap(title, obj[name])\n    },\n    toString() {\n      var lines = []\n      Object.keys(stats).forEach(function (key) {\n        lines.push('- ' + key + ': ' + stats[key])\n      })\n      return lines.join('\\n')\n    },\n  }\n  let div = document.createElement('div')\n  div.setAttribute('style', 'position:fixed;top:10px;right:10px;z-index:99999')\n  document.body.appendChild(div)\n  ReactDOM.render(<BenchmarkPanel bench={bench} />, div)\n  return bench\n}\n\nfunction FakeBenchmarker() {\n  return {\n    enabled: false,\n    wrap: (title, f) => f,\n  }\n}\n\nexport default window.BEMUSE_BENCHMARK = shouldEnableBenchmark()\n  ? new Benchmarker()\n  : new FakeBenchmarker()\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 68\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport MAIN from 'bemuse/utils/main-element'\n\n// The SceneManager takes care of managing the scenes in this game.\n// Only a single scene may be displayed at any given time, but a scene may\n// contain any number of UI elements.\n//\n// A scene is a React component that renders a ``<Scene>``::\n//\n//    export default React.createClass({\n//      render() {\n//        return <Scene>contents</Scene>\n//      }\n//    })\n//\n// Behind the scene, are using some advanced techniques which requires\n// the scene class to be declared using ``React.createClass`` (not by extending\n// ``React.Component``)\n//\n// To use the SceneManager, get the instance and use it::\n//\n//    import SCENE_MANAGER from 'bemuse/scene-manager'\n//    import TitleScene from './TitleScene'\n//    SCENE_MANAGER.display(<TitleScene />)\n//\n// Non-React Scene\n//   You can also use a scene that is not React-based. Define your scene\n//   as a function that accepts an HTMLElement and returns an object with a\n//   ``teardown()`` method.\n//\nexport class SceneManager {\n  constructor() {\n    this._transitioning = false\n    this._stack = []\n  }\n\n  // Displays the scene and returns a promise that resolves when the old\n  // scene finishes exiting.\n  display(scene) {\n    return this._transitionTo(() => {\n      return scene\n    })\n  }\n\n  // Displays the scene, while remembering the previous scene.\n  push(scene) {\n    let previousScene = this.currentScene\n    return this._transitionTo(() => {\n      this._stack.push(previousScene)\n      return scene\n    })\n  }\n\n  // Displays the previous scene.\n  pop() {\n    return this._transitionTo(() => {\n      return this._stack.pop()\n    })\n  }\n\n  async _transitionTo(getNextScene) {\n    if (this._transitioning) throw new Error('Scene is transitioning!')\n    try {\n      this._transitioning = true\n\n      // detach the previous scene\n      if (this.currentSceneInstance) {\n        await Promise.resolve(this.currentSceneInstance.teardown())\n        detach(this.currentElement)\n      }\n\n      // obtain the next scene\n      let scene = getNextScene()\n\n      // coerce react elements\n      if (typeof scene !== 'function') {\n        scene = new ReactScene(scene, this.ReactSceneContainer)\n      }\n\n      // set up the next scene\n      var element = document.createElement('div')\n      element.className = 'scene-manager--scene'\n      MAIN.appendChild(element)\n      this.currentElement = element\n      this.currentScene = scene\n      this.currentSceneInstance = scene(element)\n    } finally {\n      this._transitioning = false\n    }\n  }\n}\n\nfunction detach(element) {\n  if (element && element.parentNode === MAIN) {\n    MAIN.removeChild(element)\n  }\n}\n\n// The shared SceneManager instance.\nexport let instance = new SceneManager()\n\nexport default instance\n\nfunction ReactScene(element, ReactSceneContainer) {\n  return function instantiate(container) {\n    let teardown = () => {}\n    const clonedElement = React.cloneElement(element, {\n      scene: element,\n      registerTeardownCallback: (callback) => {\n        teardown = callback\n      },\n    })\n    const elementToDisplay = ReactSceneContainer ? (\n      <ReactSceneContainer>{clonedElement}</ReactSceneContainer>\n    ) : (\n      clonedElement\n    )\n    ReactDOM.render(elementToDisplay, container)\n    return {\n      teardown() {\n        return Promise.try(() => {\n          return teardown()\n        }).finally(() => {\n          ReactDOM.unmountComponentAtNode(container)\n        })\n      },\n    }\n  }\n}\n","'use strict'\r\n\r\nvar cache = {}\r\n\r\nmodule.exports = function getContext (options) {\r\n\tif (typeof window === 'undefined') return null\r\n\t\r\n\tvar OfflineContext = window.OfflineAudioContext || window.webkitOfflineAudioContext\r\n\tvar Context = window.AudioContext || window.webkitAudioContext\r\n\t\r\n\tif (!Context) return null\r\n\r\n\tif (typeof options === 'number') {\r\n\t\toptions = {sampleRate: options}\r\n\t}\r\n\r\n\tvar sampleRate = options && options.sampleRate\r\n\r\n\r\n\tif (options && options.offline) {\r\n\t\tif (!OfflineContext) return null\r\n\r\n\t\treturn new OfflineContext(options.channels || 2, options.length, sampleRate || 44100)\r\n\t}\r\n\r\n\r\n\t//cache by sampleRate, rather strong guess\r\n\tvar ctx = cache[sampleRate]\r\n\r\n\tif (ctx) return ctx\r\n\r\n\t//several versions of firefox have issues with the\r\n\t//constructor argument\r\n\t//see: https://bugzilla.mozilla.org/show_bug.cgi?id=1361475\r\n\ttry {\r\n\t\tctx = new Context(options)\r\n\t}\r\n\tcatch (err) {\r\n\t\tctx = new Context()\r\n\t}\r\n\tcache[ctx.sampleRate] = cache[sampleRate] = ctx\r\n\r\n\treturn ctx\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getReaderOptionsFromFilename = exports.readAsync = exports.read = void 0;\nvar chardet = require(\"bemuse-chardet/bemuse-chardet\");\nfunction read(buffer) {\n    throw new Error('Synchronous read unsupported in browser!');\n}\nexports.read = read;\nfunction readAsync() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var buffer = args[0];\n    var options = args[1];\n    var callback = args[2];\n    if (callback) {\n        options = args[1];\n        callback = args[2];\n    }\n    else {\n        options = null;\n        callback = args[1];\n    }\n    var charset = (options && options.forceEncoding) || chardet.detect(buffer);\n    var reader = new FileReader();\n    reader.onload = function () {\n        callback(null, reader.result);\n    };\n    reader.onerror = function () {\n        callback(new Error('cannot read it'));\n    };\n    reader.readAsText(new Blob([buffer]), charset);\n}\nexports.readAsync = readAsync;\nvar getReaderOptionsFromFilename_1 = require(\"./getReaderOptionsFromFilename\");\nObject.defineProperty(exports, \"getReaderOptionsFromFilename\", { enumerable: true, get: function () { return getReaderOptionsFromFilename_1.getReaderOptionsFromFilename; } });\n//# sourceMappingURL=index.web.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getReaderOptionsFromFilename = void 0;\n/**\n * Given the filename, returns the reader options.\n * @param {string} filename\n */\nfunction getReaderOptionsFromFilename(filename) {\n    var forceEncoding;\n    if (filename.match(/\\.sjis\\.\\w+$/i)) {\n        forceEncoding = 'Shift-JIS';\n    }\n    if (filename.match(/\\.euc_kr\\.\\w+$/i)) {\n        forceEncoding = 'EUC-KR';\n    }\n    if (filename.match(/\\.utf8\\.\\w+$/i)) {\n        forceEncoding = 'UTF-8';\n    }\n    return { forceEncoding: forceEncoding };\n}\nexports.getReaderOptionsFromFilename = getReaderOptionsFromFilename;\n//# sourceMappingURL=getReaderOptionsFromFilename.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.compile = void 0;\n// Public: A module that takes a string representing the BMS notechart,\n// parses it, and compiles into a {BMSChart}.\n/* module */\nvar match_1 = require(\"../util/match\");\nvar chart_1 = require(\"../bms/chart\");\nvar matchers = {\n    bms: {\n        random: /^#RANDOM\\s+(\\d+)$/i,\n        if: /^#IF\\s+(\\d+)$/i,\n        endif: /^#ENDIF$/i,\n        timeSignature: /^#(\\d\\d\\d)02:(\\S*)$/,\n        channel: /^#(?:EXT\\s+#)?(\\d\\d\\d)(\\S\\S):(\\S*)$/,\n        header: /^#(\\w+)(?:\\s+(\\S.*))?$/,\n    },\n    dtx: {\n        random: /^#RANDOM\\s+(\\d+)$/i,\n        if: /^#IF\\s+(\\d+)$/i,\n        endif: /^#ENDIF$/i,\n        timeSignature: /^#(\\d\\d\\d)02:\\s*(\\S*)$/,\n        channel: /^#(?:EXT\\s+#)?(\\d\\d\\d)(\\S\\S):\\s*(\\S*)$/,\n        header: /^#(\\w+):(?:\\s+(\\S.*))?$/,\n    },\n};\n/**\n * Reads the string representing the BMS notechart, parses it,\n * and compiles into a {BMSChart}.\n * @param text the BMS notechart\n * @param options additional parser options\n */\nfunction compile(text, options) {\n    options = options || {};\n    var chart = new chart_1.BMSChart();\n    var rng = options.rng ||\n        function (max) {\n            return 1 + Math.floor(Math.random() * max);\n        };\n    var matcher = (options.format && matchers[options.format]) || matchers.bms;\n    var randomStack = [];\n    var skipStack = [false];\n    var result = {\n        headerSentences: 0,\n        channelSentences: 0,\n        controlSentences: 0,\n        skippedSentences: 0,\n        malformedSentences: 0,\n        /**\n         * The resulting chart\n         */\n        chart: chart,\n        /**\n         * Warnings found during compilation\n         */\n        warnings: [],\n    };\n    eachLine(text, function (text, lineNumber) {\n        var flow = true;\n        if (text.charAt(0) !== '#')\n            return;\n        (0, match_1.match)(text)\n            .when(matcher.random, function (m) {\n            result.controlSentences += 1;\n            randomStack.push(rng(+m[1]));\n        })\n            .when(matcher.if, function (m) {\n            result.controlSentences += 1;\n            skipStack.push(randomStack[randomStack.length - 1] !== +m[1]);\n        })\n            .when(matcher.endif, function (m) {\n            result.controlSentences += 1;\n            skipStack.pop();\n        })\n            .else(function () {\n            flow = false;\n        });\n        if (flow)\n            return;\n        var skipped = skipStack[skipStack.length - 1];\n        (0, match_1.match)(text)\n            .when(matcher.timeSignature, function (m) {\n            result.channelSentences += 1;\n            if (!skipped)\n                chart.timeSignatures.set(+m[1], +m[2]);\n        })\n            .when(matcher.channel, function (m) {\n            result.channelSentences += 1;\n            if (!skipped)\n                handleChannelSentence(+m[1], m[2], m[3], lineNumber);\n        })\n            .when(matcher.header, function (m) {\n            result.headerSentences += 1;\n            if (!skipped)\n                chart.headers.set(m[1], m[2]);\n        })\n            .else(function () {\n            warn(lineNumber, 'Invalid command');\n        });\n    });\n    return result;\n    function handleChannelSentence(measure, channel, string, lineNumber) {\n        var items = Math.floor(string.length / 2);\n        if (items === 0)\n            return;\n        for (var i = 0; i < items; i++) {\n            var value = string.substr(i * 2, 2);\n            var fraction = i / items;\n            if (value === '00')\n                continue;\n            chart.objects.add({\n                measure: measure,\n                fraction: fraction,\n                value: value,\n                channel: channel,\n                lineNumber: lineNumber,\n            });\n        }\n    }\n    function warn(lineNumber, message) {\n        result.warnings.push({\n            lineNumber: lineNumber,\n            message: message,\n        });\n    }\n}\nexports.compile = compile;\nfunction eachLine(text, callback) {\n    text\n        .split(/\\r\\n|\\r|\\n/)\n        .map(function (line) {\n        return line.trim();\n    })\n        .forEach(function (line, index) {\n        callback(line, index + 1);\n    });\n}\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=types.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Segment = void 0;\nvar data_structure_1 = __importDefault(require(\"data-structure\"));\nexports.Segment = (0, data_structure_1.default)({\n    t: 'number',\n    x: 'number',\n    dx: 'number',\n});\n//# sourceMappingURL=segment.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Notes = void 0;\nvar note_1 = require(\"./note\");\nvar invariant_1 = __importDefault(require(\"invariant\"));\nvar ChannelMapping = __importStar(require(\"./channels\"));\nvar chart_1 = require(\"../bms/chart\");\n/**\n * A Notes holds the {Note} objects in the game.\n * A note object may or may not be playable.\n *\n * ## Example\n *\n * If you have a BMS like this:\n *\n * ```\n * #00111:AA\n * ```\n *\n * Having parsed it using a {Compiler} into a {BMSChart},\n * you can create a {Notes} using `fromBMSChart()`:\n *\n * ```js\n * var notes = Notes.fromBMSChart(bmsChart)\n * ```\n *\n * Then you can get all notes using `.all()` method\n *\n * ```js\n * notes.all()\n * ```\n */\nvar Notes = /** @class */ (function () {\n    /**\n     * @param {BMSNote[]} notes An array of Note objects\n     */\n    function Notes(notes) {\n        notes.forEach(note_1.Note);\n        this._notes = notes;\n    }\n    /**\n     * Returns the number of notes in this object,\n     * counting both playable and non-playable notes.\n     */\n    Notes.prototype.count = function () {\n        return this._notes.length;\n    };\n    /**\n     * Returns an Array of all notes.\n     */\n    Notes.prototype.all = function () {\n        return this._notes.slice();\n    };\n    /**\n     * Creates a Notes object from a BMSChart.\n     * @param chart the chart to process\n     * @param options options\n     */\n    Notes.fromBMSChart = function (chart, options) {\n        void chart_1.BMSChart;\n        options = options || {};\n        var mapping = options.mapping || Notes.CHANNEL_MAPPING.IIDX_P1;\n        var builder = new BMSNoteBuilder(chart, { mapping: mapping });\n        return builder.build();\n    };\n    Notes.CHANNEL_MAPPING = ChannelMapping;\n    return Notes;\n}());\nexports.Notes = Notes;\nvar BMSNoteBuilder = /** @class */ (function () {\n    function BMSNoteBuilder(chart, options) {\n        this._chart = chart;\n        (0, invariant_1.default)(options.mapping, 'Expected options.mapping');\n        (0, invariant_1.default)(typeof options.mapping === 'object', 'options.mapping must be object');\n        this._mapping = options.mapping;\n        this._notes = [];\n        this._activeLN = {};\n        this._lastNote = {};\n        this._lnObj = (this._chart.headers.get('lnobj') || '').toLowerCase();\n        this._channelMapping = this._mapping;\n        this._objects = this._chart.objects.allSorted();\n    }\n    BMSNoteBuilder.prototype.build = function () {\n        var _this = this;\n        this._objects.forEach(function (object) {\n            _this._handle(object);\n        });\n        return new Notes(this._notes);\n    };\n    BMSNoteBuilder.prototype._handle = function (object) {\n        if (object.channel === '01') {\n            this._handleNormalNote(object);\n        }\n        else {\n            switch (object.channel.charAt(0).toUpperCase()) {\n                case '1':\n                case '2':\n                case 'D':\n                case 'E':\n                    this._handleNormalNote(object);\n                    break;\n                case '5':\n                case '6':\n                    this._handleLongNote(object);\n                    break;\n            }\n        }\n    };\n    BMSNoteBuilder.prototype._handleNormalNote = function (object) {\n        var channel = this._normalizeChannel(object.channel);\n        var beat = this._getBeat(object);\n        if (object.value.toLowerCase() === this._lnObj) {\n            if (this._lastNote[channel]) {\n                this._lastNote[channel].endBeat = beat;\n            }\n        }\n        else {\n            var note = {\n                beat: beat,\n                endBeat: undefined,\n                keysound: object.value,\n                column: this._getColumn(channel),\n            };\n            this._lastNote[channel] = note;\n            this._notes.push(note);\n        }\n    };\n    BMSNoteBuilder.prototype._handleLongNote = function (object) {\n        var channel = this._normalizeChannel(object.channel);\n        var beat = this._getBeat(object);\n        if (this._activeLN[channel]) {\n            var note = this._activeLN[channel];\n            note.endBeat = beat;\n            this._notes.push(note);\n            delete this._activeLN[channel];\n        }\n        else {\n            this._activeLN[channel] = {\n                beat: beat,\n                keysound: object.value,\n                column: this._getColumn(channel),\n            };\n        }\n    };\n    BMSNoteBuilder.prototype._getBeat = function (object) {\n        return this._chart.measureToBeat(object.measure, object.fraction);\n    };\n    BMSNoteBuilder.prototype._getColumn = function (channel) {\n        return this._channelMapping[channel];\n    };\n    BMSNoteBuilder.prototype._normalizeChannel = function (channel) {\n        return channel.replace(/^5/, '1').replace(/^6/, '2');\n    };\n    return BMSNoteBuilder;\n}());\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Note = void 0;\nvar data_structure_1 = __importDefault(require(\"data-structure\"));\nexports.Note = (0, data_structure_1.default)({\n    beat: 'number',\n    endBeat: data_structure_1.default.maybe('number'),\n    column: data_structure_1.default.maybe('string'),\n    keysound: 'string',\n});\n//# sourceMappingURL=note.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IIDX_DP_LANDMINE = exports.IIDX_P1_LANDMINE = exports.IIDX_DP = exports.IIDX_P1 = void 0;\nexports.IIDX_P1 = {\n    '11': '1',\n    '12': '2',\n    '13': '3',\n    '14': '4',\n    '15': '5',\n    '18': '6',\n    '19': '7',\n    '16': 'SC',\n};\nexports.IIDX_DP = {\n    '11': '1',\n    '12': '2',\n    '13': '3',\n    '14': '4',\n    '15': '5',\n    '18': '6',\n    '19': '7',\n    '16': 'SC',\n    '21': '8',\n    '22': '9',\n    '23': '10',\n    '24': '11',\n    '25': '12',\n    '28': '13',\n    '29': '14',\n    '26': 'SC2',\n};\nexports.IIDX_P1_LANDMINE = {\n    D1: '1',\n    D2: '2',\n    D3: '3',\n    D4: '4',\n    D5: '5',\n    D8: '6',\n    D9: '7',\n    D6: 'SC',\n};\nexports.IIDX_DP_LANDMINE = {\n    D1: '1',\n    D2: '2',\n    D3: '3',\n    D4: '4',\n    D5: '5',\n    D8: '6',\n    D9: '7',\n    D6: 'SC',\n    E1: '8',\n    E2: '9',\n    E3: '10',\n    E4: '11',\n    E5: '12',\n    E8: '13',\n    E9: '14',\n    E6: 'SC2',\n};\n//# sourceMappingURL=channels.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Timing = void 0;\nvar speedcore_1 = require(\"../speedcore\");\nvar lodash_1 = require(\"../util/lodash\");\nvar chart_1 = require(\"../bms/chart\");\nvar precedence = { bpm: 1, stop: 2 };\n/**\n * A Timing represents the timing information of a musical score.\n * A Timing object provides facilities to synchronize between\n * metric time (seconds) and musical time (beats).\n *\n * A Timing are created from a series of actions:\n *\n * - BPM changes.\n * - STOP action.\n */\nvar Timing = /** @class */ (function () {\n    /**\n     * Constructs a Timing with an initial BPM and specified actions.\n     *\n     * Generally, you would use `Timing.fromBMSChart` to create an instance\n     * from a BMSChart, but the constructor may also be used in other situations\n     * unrelated to the BMS file format. (e.g. bmson package)\n     */\n    function Timing(initialBPM, actions) {\n        var state = { bpm: initialBPM, beat: 0, seconds: 0 };\n        var segments = [];\n        segments.push({\n            t: 0,\n            x: 0,\n            dx: state.bpm / 60,\n            bpm: state.bpm,\n            inclusive: true,\n        });\n        actions = actions.slice();\n        actions.sort(function (a, b) {\n            return a.beat - b.beat || precedence[a.type] - precedence[b.type];\n        });\n        actions.forEach(function (action) {\n            var beat = action.beat;\n            var seconds = state.seconds + ((beat - state.beat) * 60) / state.bpm;\n            switch (action.type) {\n                case 'bpm':\n                    state.bpm = action.bpm;\n                    segments.push({\n                        t: seconds,\n                        x: beat,\n                        dx: state.bpm / 60,\n                        bpm: state.bpm,\n                        inclusive: true,\n                    });\n                    break;\n                case 'stop':\n                    segments.push({\n                        t: seconds,\n                        x: beat,\n                        dx: 0,\n                        bpm: state.bpm,\n                        inclusive: true,\n                    });\n                    seconds += ((action.stopBeats || 0) * 60) / state.bpm;\n                    segments.push({\n                        t: seconds,\n                        x: beat,\n                        dx: state.bpm / 60,\n                        bpm: state.bpm,\n                        inclusive: false,\n                    });\n                    break;\n                default:\n                    throw new Error('Unrecognized segment object!');\n            }\n            state.beat = beat;\n            state.seconds = seconds;\n        });\n        this._speedcore = new speedcore_1.Speedcore(segments);\n        this._eventBeats = (0, lodash_1.uniq)((0, lodash_1.map)(actions, function (action) { return action.beat; }));\n    }\n    /**\n     * Convert the given beat into seconds.\n     * @param {number} beat\n     */\n    Timing.prototype.beatToSeconds = function (beat) {\n        return this._speedcore.t(beat);\n    };\n    /**\n     * Convert the given second into beats.\n     * @param {number} seconds\n     */\n    Timing.prototype.secondsToBeat = function (seconds) {\n        return this._speedcore.x(seconds);\n    };\n    /**\n     * Returns the BPM at the specified beat.\n     * @param {number} beat\n     */\n    Timing.prototype.bpmAtBeat = function (beat) {\n        return this._speedcore.segmentAtX(beat).bpm;\n    };\n    /**\n     * Returns an array representing the beats where there are events.\n     */\n    Timing.prototype.getEventBeats = function () {\n        return this._eventBeats;\n    };\n    /**\n     * Creates a Timing instance from a BMSChart.\n     * @param {BMSChart} chart\n     */\n    Timing.fromBMSChart = function (chart) {\n        void chart_1.BMSChart;\n        var actions = [];\n        chart.objects.all().forEach(function (object) {\n            var bpm;\n            var beat = chart.measureToBeat(object.measure, object.fraction);\n            if (object.channel === '03') {\n                bpm = parseInt(object.value, 16);\n                actions.push({ type: 'bpm', beat: beat, bpm: bpm });\n            }\n            else if (object.channel === '08') {\n                bpm = +chart.headers.get('bpm' + object.value);\n                if (!isNaN(bpm))\n                    actions.push({ type: 'bpm', beat: beat, bpm: bpm });\n            }\n            else if (object.channel === '09') {\n                var stopBeats = +chart.headers.get('stop' + object.value) / 48;\n                actions.push({ type: 'stop', beat: beat, stopBeats: stopBeats });\n            }\n        });\n        return new Timing(+chart.headers.get('bpm') || 60, actions);\n    };\n    return Timing;\n}());\nexports.Timing = Timing;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SongInfo = void 0;\nvar match_1 = require(\"../util/match\");\nvar lodash_1 = require(\"../util/lodash\");\nvar chart_1 = require(\"../bms/chart\");\n/**\n * A SongInfo represents the song info, such as title, artist, genre.\n *\n * ## Example\n *\n * If you have a BMS like this:\n *\n * ```\n * #TITLE Exargon [HYPER]\n * ```\n *\n * Having parsed it using a {Compiler} into a {BMSChart},\n * you can create a {SongInfo} using `fromBMSChart()`:\n *\n * ```js\n * var info = SongInfo.fromBMSChart(bmsChart)\n * ```\n *\n * Then you can query the song information by accessing its properties.\n *\n * ```js\n * info.title     // => 'Exargon'\n * info.subtitles // => ['HYPER']\n * ```\n */\nvar SongInfo = /** @class */ (function () {\n    /**\n     * Constructs a SongInfo with given data\n     * @param info the properties to set on this new instance\n     */\n    function SongInfo(info) {\n        /** the song title */\n        this.title = 'NO TITLE';\n        /** the song artist */\n        this.artist = 'NO ARTIST';\n        /** the song genre */\n        this.genre = 'NO GENRE';\n        /**\n         * the song's subtitles, one line per element.\n         * The subtitle may be used to represent the difficulty name,\n         * such as NORMAL, HYPER, ANOTHER.\n         * @type {string[]}\n         */\n        this.subtitles = [];\n        /**\n         * the song's other artists, one artist per element.\n         * @type {string[]}\n         */\n        this.subartists = [];\n        /**\n         * the difficulty.\n         * Meaning of the number is same as BMS's [`#DIFFICULTY`](http:*hitkey.nekokan.dyndns.info/cmds.htm#DIFFICULTY) header.\n         *\n         * | difficulty | meaning  |\n         * | ----------:|:--------:|\n         * |          1 | BEGINNER |\n         * |          2 | NORMAL   |\n         * |          3 | HYPER    |\n         * |          4 | ANOTHER  |\n         * |          5 | INSANE   |\n         */\n        this.difficulty = 0;\n        /**\n         * the level of the song.\n         * When converted from a BMS chart, this is the value of `#PLAYLEVEL` header.\n         */\n        this.level = 0;\n        if (info)\n            (0, lodash_1.assign)(this, info);\n    }\n    /**\n     * Constructs a new {SongInfo} object from a {BMSChart}.\n     * @param chart A {BMSChart} to construct a {SongInfo} from\n     */\n    SongInfo.fromBMSChart = function (chart) {\n        void chart_1.BMSChart;\n        var info = {};\n        var title = chart.headers.get('title');\n        var artist = chart.headers.get('artist');\n        var genre = chart.headers.get('genre');\n        var difficulty = +chart.headers.get('difficulty') || 0;\n        var level = +chart.headers.get('playlevel') || 0;\n        var subtitles = chart.headers.getAll('subtitle');\n        var subartists = chart.headers.getAll('subartist');\n        if (typeof title === 'string' && !subtitles) {\n            var extractSubtitle = function (m) {\n                title = m[1];\n                subtitles = [m[2]];\n            };\n            (0, match_1.match)(title)\n                .when(/^(.*\\S)\\s*-(.+?)-$/, extractSubtitle)\n                .when(/^(.*\\S)\\s*(.+?)$/, extractSubtitle)\n                .when(/^(.*\\S)\\s*\\((.+?)\\)$/, extractSubtitle)\n                .when(/^(.*\\S)\\s*\\[(.+?)\\]$/, extractSubtitle)\n                .when(/^(.*\\S)\\s*<(.+?)>$/, extractSubtitle);\n        }\n        if (title)\n            info.title = title;\n        if (artist)\n            info.artist = artist;\n        if (genre)\n            info.genre = genre;\n        if (subtitles)\n            info.subtitles = subtitles;\n        if (subartists)\n            info.subartists = subartists;\n        if (difficulty)\n            info.difficulty = difficulty;\n        if (level)\n            info.level = level;\n        return new SongInfo(info);\n    };\n    return SongInfo;\n}());\nexports.SongInfo = SongInfo;\n//# sourceMappingURL=index.js.map","\"use strict\";\n// Public: A module that exposes {Keysounds}\n/* module */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Keysounds = void 0;\nvar lodash_1 = require(\"../util/lodash\");\nvar chart_1 = require(\"../bms/chart\");\n/**\n * A simple mapping between keysounds ID and the file name.\n * ## Example\n *\n * If you have a BMS like this:\n *\n * ```\n * #WAVAA cat.wav\n * ```\n *\n * Having parsed it using a {Compiler} into a {BMSChart},\n * you can create a {Keysounds} using `fromBMSChart()`:\n *\n * ```js\n * var keysounds = Keysounds.fromBMSChart(bmsChart)\n * ```\n *\n * Then you can retrieve the filename using `.get()`:\n *\n * ```js\n * keysounds.get('aa') // => 'cat.wav'\n * ```\n */\nvar Keysounds = /** @class */ (function () {\n    function Keysounds(map) {\n        this._map = map;\n    }\n    /**\n     * Returns the keysound file at the specified ID.\n     * @param id the two-character keysound ID\n     * @returns the sound filename\n     */\n    Keysounds.prototype.get = function (id) {\n        return this._map[id.toLowerCase()];\n    };\n    /**\n     * Returns an array of unique filenames in this Keysounds object.\n     * @returns filenames array\n     */\n    Keysounds.prototype.files = function () {\n        return (0, lodash_1.uniq)((0, lodash_1.values)(this._map));\n    };\n    /**\n     * Returns a mapping from keysound ID to keysound filename.\n     *\n     * **Warning:** This method returns the internal data structure used\n     * in this Keysounds object. Do not mutate!\n     */\n    Keysounds.prototype.all = function () {\n        return this._map;\n    };\n    /**\n     * Constructs a new {Keysounds} object from a {BMSChart}.\n     * @param chart\n     */\n    Keysounds.fromBMSChart = function (chart) {\n        void chart_1.BMSChart;\n        var map = {};\n        chart.headers.each(function (name, value) {\n            var match = name.match(/^wav(\\S\\S)$/i);\n            if (!match)\n                return;\n            map[match[1].toLowerCase()] = value;\n        });\n        return new Keysounds(map);\n    };\n    return Keysounds;\n}());\nexports.Keysounds = Keysounds;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Positioning = void 0;\nvar speedcore_1 = require(\"../speedcore\");\nvar chart_1 = require(\"../bms/chart\");\n/**\n * A Positioning represents the relation between song beats and\n * display position, and provides a way to convert between them.\n *\n * In some rhythm games, the amount of scrolling per beat may be different.\n * StepManias `#SCROLL` segments is an example.\n */\nvar Positioning = /** @class */ (function () {\n    /**\n     * Constructs a Positioning from the given `segments`.\n     * @param segments\n     */\n    function Positioning(segments) {\n        this._speedcore = new speedcore_1.Speedcore(segments);\n    }\n    /**\n     * Returns the scrolling speed at specified beat.\n     * @param beat the beat number\n     */\n    Positioning.prototype.speed = function (beat) {\n        return this._speedcore.dx(beat);\n    };\n    /**\n     * Returns the total elapsed scrolling amount at specified beat.\n     * @param beat the beat number\n     */\n    Positioning.prototype.position = function (beat) {\n        return this._speedcore.x(beat);\n    };\n    /**\n     * Creates a {Positioning} object from the {BMSChart}.\n     * @param {BMSChart} chart A {BMSChart} to construct a {Positioning} from\n     */\n    Positioning.fromBMSChart = function (chart) {\n        void chart_1.BMSChart;\n        var segments = [];\n        var x = 0;\n        segments.push({\n            t: 0,\n            x: x,\n            dx: 1,\n            inclusive: true,\n        });\n        chart.objects.allSorted().forEach(function (object) {\n            if (object.channel === 'SC') {\n                var beat = chart.measureToBeat(object.measure, object.fraction);\n                var dx = +chart.headers.get('scroll' + object.value);\n                if (isNaN(dx))\n                    return;\n                var previous = segments[segments.length - 1];\n                x += (beat - previous.t) * previous.dx;\n                if (beat === 0 && segments.length === 1) {\n                    segments[0].dx = dx;\n                }\n                else {\n                    segments.push({\n                        t: beat,\n                        x: x,\n                        dx: dx,\n                        inclusive: true,\n                    });\n                }\n            }\n        });\n        return new Positioning(segments);\n    };\n    return Positioning;\n}());\nexports.Positioning = Positioning;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Spacing = void 0;\nvar speedcore_1 = require(\"../speedcore\");\nvar chart_1 = require(\"../bms/chart\");\n/**\n * Public: A Spacing represents the relation between song beats and\n * notes spacing.\n *\n * In some rhythm games, such as Pump It Up!,\n * the speed (note spacing factor) may be adjusted by the notechart.\n * StepManias `#SPEED` segments is an example.\n */\nvar Spacing = /** @class */ (function () {\n    /**\n     * Constructs a Spacing from the given `segments`.\n     */\n    function Spacing(segments) {\n        if (segments.length > 0) {\n            this._speedcore = new speedcore_1.Speedcore(segments);\n        }\n    }\n    /**\n     * Returns the note spacing factor at the specified beat.\n     * @param beat the beat\n     */\n    Spacing.prototype.factor = function (beat) {\n        if (this._speedcore) {\n            return this._speedcore.x(beat);\n        }\n        else {\n            return 1;\n        }\n    };\n    /**\n     * Creates a {Spacing} object from the {BMSChart}.\n     *\n     * ## `#SPEED` and `#xxxSP`\n     *\n     * Speed is defined as keyframes. These keyframes will be linearly interpolated.\n     *\n     * ```\n     * #SPEED01 1.0\n     * #SPEED02 2.0\n     *\n     * #001SP:01010202\n     * ```\n     *\n     * In this example, the note spacing factor will gradually change\n     * from 1.0x at beat 1 to 2.0x at beat 2.\n     *\n     * Returns a {Spacing} object\n     *\n     * @param {BMSChart} chart the chart\n     */\n    Spacing.fromBMSChart = function (chart) {\n        void chart_1.BMSChart;\n        var segments = [];\n        chart.objects.allSorted().forEach(function (object) {\n            if (object.channel === 'SP') {\n                var beat = chart.measureToBeat(object.measure, object.fraction);\n                var factor = +chart.headers.get('speed' + object.value);\n                if (isNaN(factor))\n                    return;\n                if (segments.length > 0) {\n                    var previous = segments[segments.length - 1];\n                    previous.dx = (factor - previous.x) / (beat - previous.t);\n                }\n                segments.push({\n                    t: beat,\n                    x: factor,\n                    dx: 0,\n                    inclusive: true,\n                });\n            }\n        });\n        if (segments.length > 0) {\n            segments.unshift({\n                t: 0,\n                x: segments[0].x,\n                dx: 0,\n                inclusive: true,\n            });\n        }\n        return new Spacing(segments);\n    };\n    return Spacing;\n}());\nexports.Spacing = Spacing;\n//# sourceMappingURL=index.js.map","let _enabled = false\n\nlet _lifecycleHandler = {\n  /** @returns {Promise<void>} */\n  pauseAt(t) {\n    throw new Error('Cannot pause: No lifecycle handler registered!')\n  },\n  /** @returns {void} */\n  unpause() {\n    throw new Error('Cannot unpause: No lifecycle handler registered!')\n  },\n  /** @returns {number} */\n  getScore() {\n    throw new Error('Cannot get score: No lifecycle handler registered!')\n  },\n}\n\n/**\n * Activates the test mode. In this mode,\n *\n * - An overlay will be displayed indicating the test mode.\n * - The following APIs will be available to facilitate automated testing:\n *     - `BemuseTestMode.pauseAt(t)` will make the game pause at time `t`.\n *     - `BemuseTestMode.unpause()` will unpause the game.\n * - Score submission is disabled.\n *\n * Note: Once test mode is activated, it cannot be deactivated for the rest of the game session.\n */\nexport function enableTestMode() {\n  if (!_enabled) {\n    _enabled = true\n    console.log('[Bemuse test mode enabled]')\n    const overlay = document.createElement('div')\n    overlay.setAttribute(\n      'style',\n      `\n        position: fixed;\n        top: 20px;\n        left: 20px;\n        font: 20px Comic Sans MS, sans-serif;\n        z-index: 99999;\n        background: rgba(0,0,0,0.5);\n        color: #0f0;\n        border: 2px solid #0f0;\n        padding: 4px;\n        pointer-events: none;\n      `\n    )\n    overlay.innerHTML = `\n      <strong>Test mode:</strong>\n      Bemuse is being controlled by automated test software.\n    `\n    document.body.appendChild(overlay)\n  }\n}\n\n/**\n * Registers a pause handler.\n * This allows the `pauseAt` and `unpause` APIs to be used.\n *\n * @param {typeof _lifecycleHandler} handler\n */\nexport function setGameLifecycleHandler(handler) {\n  console.log('[Bemuse test mode] A pause handler has been registered.')\n  _lifecycleHandler = handler\n}\n\n/**\n * Returns `true` if test mode is enabled, `false` otherwise.\n */\nexport function isTestModeEnabled() {\n  return !!_enabled\n}\n\n/**\n * Will schedule the game to pause at time `t`.\n *\n * @param {number} t The song time to pause in seconds\n * @returns {Promise<void>} A promise that will be resolved when the time is reached and game is paused.\n */\nexport function pauseAt(t) {\n  return _lifecycleHandler.pauseAt(t)\n}\n\n/**\n * Unpauses the game.\n */\nexport function unpause() {\n  return _lifecycleHandler.unpause()\n}\n\n/**\n * Returns the current score.\n */\nexport function getScore() {\n  return _lifecycleHandler.getScore()\n}\n","module.exports = function() {\n\tthrow new Error(\"define cannot be used indirect\");\n};\n","/* globals __webpack_amd_options__ */\nmodule.exports = __webpack_amd_options__;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fromBMSChart = void 0;\nvar BMS = __importStar(require(\"bms\"));\nvar lodash_1 = __importDefault(require(\"lodash\"));\nvar __1 = __importDefault(require(\"../\"));\n// Returns a new Notechart from a BMSChart.\nfunction fromBMSChart(bms, playerOptions) {\n    var notes = BMS.Notes.fromBMSChart(bms, {\n        mapping: playerOptions.double\n            ? BMS.Notes.CHANNEL_MAPPING.IIDX_DP\n            : BMS.Notes.CHANNEL_MAPPING.IIDX_P1,\n    }).all();\n    var landmineNotes = BMS.Notes.fromBMSChart(bms, {\n        mapping: playerOptions.double\n            ? BMS.Notes.CHANNEL_MAPPING.IIDX_DP_LANDMINE\n            : BMS.Notes.CHANNEL_MAPPING.IIDX_P1_LANDMINE,\n    }).all();\n    var timing = BMS.Timing.fromBMSChart(bms);\n    var keysounds = BMS.Keysounds.fromBMSChart(bms);\n    var songInfo = BMS.SongInfo.fromBMSChart(bms);\n    var positioning = BMS.Positioning.fromBMSChart(bms);\n    var spacing = BMS.Spacing.fromBMSChart(bms);\n    var data = {\n        notes: notes,\n        landmineNotes: landmineNotes,\n        timing: timing,\n        keysounds: keysounds,\n        songInfo: songInfo,\n        positioning: positioning,\n        spacing: spacing,\n        barLines: generateBarLinesFromBMS(notes, bms),\n        expertJudgmentWindow: getJudgmentWindowFromBMS(bms),\n    };\n    return new __1.default(data, playerOptions);\n}\nexports.fromBMSChart = fromBMSChart;\nfunction getJudgmentWindowFromBMS(bms) {\n    // http://hitkey.nekokan.dyndns.info/diary1501.php\n    var rank = +bms.headers.get('rank') || 2;\n    if (rank === 0)\n        return [8, 24]; // Very Hard\n    if (rank === 1)\n        return [15, 30]; // Hard\n    if (rank === 3)\n        return [21, 60]; // Easy\n    return [18, 40]; // Normal\n}\nfunction generateBarLinesFromBMS(bmsNotes, bms) {\n    var max = lodash_1.default.max(bmsNotes.map(function (note) { return note.endBeat || note.beat; })) || 0;\n    var barLines = [0];\n    var currentBeat = 0;\n    var currentMeasure = 0;\n    do {\n        currentBeat += bms.timeSignatures.getBeats(currentMeasure);\n        currentMeasure += 1;\n        barLines.push(currentBeat);\n    } while (currentBeat <= max);\n    return barLines;\n}\n//# sourceMappingURL=BMSNotechartLoader.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=types.js.map","export function forModule(moduleName: string) {\n  return {\n    info: bindLogger(moduleName, 'info'),\n    warn: bindLogger(moduleName, 'warn'),\n    error: bindLogger(moduleName, 'error'),\n  }\n}\n\nfunction bindLogger(moduleName: string, level: 'info' | 'warn' | 'error') {\n  return (...args: any[]) => {\n    console.log(\n      `[${new Date().toJSON()}] [${moduleName}] [${level}] ${require('util').format(\n        ...args\n      )}`\n    )\n  }\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._slicesForNotesAndTiming = exports.beatForLoc = exports.timingInfoForBmson = exports.barLinesForBmson = void 0;\nvar lodash_1 = __importDefault(require(\"lodash\"));\nvar utils = __importStar(require(\"./utils\"));\nfunction barLinesForBmson(bmson) {\n    var lines = bmson.lines;\n    return (0, lodash_1.default)(lines)\n        .map(function (_a) {\n        var y = _a.y;\n        return beatForLoc(y);\n    })\n        .sortBy()\n        .value();\n}\nexports.barLinesForBmson = barLinesForBmson;\nfunction timingInfoForBmson(bmson) {\n    return {\n        initialBPM: bmson.info.initBPM,\n        actions: __spreadArray(__spreadArray([], __read((bmson.bpmNotes || []).map(function (_a) {\n            var y = _a.y, v = _a.v;\n            return ({\n                type: 'bpm',\n                beat: beatForLoc(y),\n                bpm: v,\n            });\n        })), false), __read((bmson.stopNotes || []).map(function (_a) {\n            var y = _a.y, v = _a.v;\n            return ({\n                type: 'stop',\n                beat: beatForLoc(y),\n                stopBeats: beatForLoc(Math.floor(v)),\n            });\n        })), false),\n    };\n}\nexports.timingInfoForBmson = timingInfoForBmson;\nfunction beatForLoc(y) {\n    return y / 240;\n}\nexports.beatForLoc = beatForLoc;\nfunction slicesForNotesAndTiming(notes, timing) {\n    return utils.slicesForNotesAndTiming(notes, timing, {\n        beatForPulse: beatForLoc,\n    });\n}\nexports._slicesForNotesAndTiming = slicesForNotesAndTiming;\n//# sourceMappingURL=legacy.js.map","\"use strict\";\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.slicesForNotesAndTiming = void 0;\nvar lodash_1 = __importDefault(require(\"lodash\"));\n/**\n * Takes the notes for a certain `soundChannel` and returns instructions\n * on how to slice the keysound file, given the `y` position of a note.\n *\n * @param notes An {Array} of `notes` inside `bmson.soundChannel[i]`\n * @param timing The {BMS.Timing} object that corresponds to the bmson\n * @param options An {Object} of options with the following keys:\n *  * `beatForPulse` A {Function} used to resolve beat for a given pulse number\n * @returns an ES6 {Map} that maps `y` position of the note to an SoundSlice\n */\nfunction slicesForNotesAndTiming(notes, timing, options) {\n    var e_1, _a, e_2, _b;\n    var beatForPulse = options.beatForPulse;\n    var all = new Set();\n    var play = new Set();\n    var restart = new Set();\n    try {\n        for (var notes_1 = __values(notes), notes_1_1 = notes_1.next(); !notes_1_1.done; notes_1_1 = notes_1.next()) {\n            var _c = notes_1_1.value, x = _c.x, y = _c.y, c = _c.c;\n            all.add(y);\n            if (x) {\n                play.add(y);\n            }\n            if (!c) {\n                restart.add(y);\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (notes_1_1 && !notes_1_1.done && (_a = notes_1.return)) _a.call(notes_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    var result = new Map();\n    var soundTime = null;\n    var mustAdd = true;\n    var t;\n    var lastAdded;\n    try {\n        for (var _d = __values(lodash_1.default.sortBy(__spreadArray([], __read(all), false))), _e = _d.next(); !_e.done; _e = _d.next()) {\n            var y = _e.value;\n            var t = timing.beatToSeconds(beatForPulse(y));\n            if (soundTime === null || restart.has(y)) {\n                soundTime = 0;\n            }\n            else {\n                soundTime += t - t;\n            }\n            var shouldAdd = mustAdd || play.has(y) || restart.has(y);\n            if (shouldAdd) {\n                if (lastAdded && !restart.has(y)) {\n                    lastAdded.keysoundEnd = soundTime;\n                }\n                var obj = { keysoundStart: soundTime, keysoundEnd: undefined };\n                result.set(y, obj);\n                lastAdded = obj;\n            }\n            mustAdd = play.has(y);\n            t = t;\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (_e && !_e.done && (_b = _d.return)) _b.call(_d);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    return result;\n}\nexports.slicesForNotesAndTiming = slicesForNotesAndTiming;\n//# sourceMappingURL=utils.js.map","import Notechart from 'bemuse-notechart'\nimport { PlayerOptions } from 'bemuse-notechart/lib/types'\n\nexport type PlayerControlKeys =\n  | '1'\n  | '2'\n  | '3'\n  | '4'\n  | '5'\n  | '6'\n  | '7'\n  | 'SC'\n  | 'SC2'\n\nexport type PlayerOptionsPlacement = 'left' | 'center' | 'right' | '3d'\n\nexport type PlayerOptionsScratch = 'left' | 'right' | 'off'\n\nexport type PlayerOptionsGauge = 'off' | 'hope'\n\ntype PlayerOptionsInputMapping = {\n  keyboard: { [control in PlayerControlKeys]: string }\n  continuous: boolean\n  sensitivity: number\n}\n\ntype PlayerOptionsInternal = {\n  autoplayEnabled: boolean\n  autosound: boolean\n  speed: number\n  placement: PlayerOptionsPlacement\n  scratch: PlayerOptionsScratch\n  laneCover: number\n  gauge: PlayerOptionsGauge\n  input: PlayerOptionsInputMapping\n  tutorial: boolean\n}\n\nexport type PlayerOptionsInput = PlayerOptions & {\n  autoplayEnabled?: boolean\n  autosound?: boolean\n  speed: number\n  placement?: PlayerOptionsPlacement\n  laneCover?: number\n  gauge: PlayerOptionsGauge\n  input: PlayerOptionsInputMapping\n  tutorial?: boolean\n}\n\n/** The object representing the player's information, notechart and options. */\nexport class Player {\n  public readonly options: PlayerOptionsInternal\n  constructor(\n    public readonly notechart: Notechart,\n    public readonly number: number,\n    options: PlayerOptionsInput\n  ) {\n    this.options = {\n      autoplayEnabled: !!options.autoplayEnabled,\n      autosound: !!options.autosound,\n      speed: +options.speed,\n      placement: options.placement || 'center',\n      scratch: options.scratch || 'left',\n      input: options.input,\n      laneCover: +(options.laneCover || 0),\n      gauge: options.gauge,\n      tutorial: !!options.tutorial,\n    }\n  }\n\n  // An array of column names for this Notechart.\n  get columns() {\n    return this.notechart.columns\n  }\n}\n\nexport default Player\n","import * as Judgments from '../judgments'\n\nimport _ from 'lodash'\nimport Notechart from 'bemuse-notechart'\n\nconst getAccuracyScore = (accuracy: number) => Math.floor(accuracy * 500000)\nconst getComboScore = (sum: number, total: number) =>\n  Math.floor((sum * 55555) / total)\n\nexport class PlayerStats {\n  public totalCombo: number\n  public totalNotes: number\n  public combo: number\n  public maxCombo: number\n  public rawSumJudgmentWeight: number\n  public rawTotalComboScore: number\n  public rawSumComboScore: number\n  public counts: { [k in Judgments.JudgedJudgment]: number }\n  public numJudgments: number\n  public poor: boolean\n  public deltas: number[]\n\n  private _remainingMaxPossibleRawComboScore: number\n  private _log: { character: string; count: number }[]\n\n  constructor(notechart: Notechart) {\n    this.totalCombo = _(notechart.notes)\n      .map((note) => notechart.info(note)!.combos)\n      .sum()\n    this.totalNotes = notechart.notes.length\n    this.combo = 0\n    this.maxCombo = 0\n    this.rawSumJudgmentWeight = 0\n    this.rawTotalComboScore = this._calculateRawTotalComboScore(this.totalCombo)\n    this._remainingMaxPossibleRawComboScore = this.rawTotalComboScore\n    this.rawSumComboScore = 0\n    this.counts = { [Judgments.MISSED]: 0, '1': 0, '2': 0, '3': 0, '4': 0 }\n    this.numJudgments = 0\n    this.poor = false\n    this._log = []\n    this.deltas = []\n  }\n  get score() {\n    // #region score\n    return this.accuracyScore + this.comboScore\n    // #endregion\n  }\n  get accuracyScore() {\n    return getAccuracyScore(this.accuracy)\n  }\n  get comboScore() {\n    return getComboScore(this.rawSumComboScore, this.rawTotalComboScore)\n  }\n  get maxPossibleScore() {\n    return this.maxPossibleAccuracyScore + this.maxPossibleComboScore\n  }\n  get maxPossibleAccuracyScore() {\n    const remainingJudgments = this.totalCombo - this.numJudgments\n    const maxPossibleRawWeight =\n      this.rawSumJudgmentWeight + Judgments.weight(1) * remainingJudgments\n    const maxPossibleAccuracy =\n      maxPossibleRawWeight / (Judgments.weight(1) * this.totalCombo)\n    return getAccuracyScore(maxPossibleAccuracy)\n  }\n  get maxPossibleComboScore() {\n    const maxPossibleRawComboScore =\n      this.rawSumComboScore + this._remainingMaxPossibleRawComboScore\n    return getComboScore(maxPossibleRawComboScore, this.rawTotalComboScore)\n  }\n  get accuracy() {\n    return this.rawSumJudgmentWeight / (Judgments.weight(1) * this.totalCombo)\n  }\n  get currentAccuracy() {\n    return (\n      this.rawSumJudgmentWeight / (Judgments.weight(1) * this.numJudgments || 1)\n    )\n  }\n  get log() {\n    return this._log\n      .map(({ character, count }) => `${count > 1 ? count : ''}${character}`)\n      .join('')\n  }\n  handleJudgment(judgment: Judgments.JudgedJudgment) {\n    this.counts[judgment] += 1\n    this.numJudgments += 1\n    if (Judgments.breaksCombo(judgment)) {\n      const remainingJudgments = this.totalCombo - this.numJudgments\n      this.combo = 0\n      this.poor = true\n      this._remainingMaxPossibleRawComboScore =\n        this._calculateRawTotalComboScore(remainingJudgments)\n    } else {\n      this.combo += 1\n      const rawComboScore = this._calculateRawComboScore(this.combo)\n      this.rawSumComboScore += rawComboScore\n      this._remainingMaxPossibleRawComboScore -= rawComboScore\n      this.poor = false\n    }\n    this.rawSumJudgmentWeight += Judgments.weight(judgment)\n    if (this.combo > this.maxCombo) {\n      this.maxCombo = this.combo\n    }\n    this._recordLog(judgment)\n  }\n  handleDelta(delta: number) {\n    this.deltas.push(delta)\n  }\n  private _calculateRawTotalComboScore(total: number) {\n    let sum = 0\n    for (let i = 1; i <= total; i++) {\n      sum += this._calculateRawComboScore(i)\n    }\n    return sum\n  }\n  private _calculateRawComboScore(i: number) {\n    // #region combo\n    if (i === 0) return 0\n    if (i < 23) return 1\n    if (i < 51) return 2\n    if (i < 92) return 3\n    if (i < 161) return 4\n    return 5\n    // #endregion\n  }\n  private _recordLog(judgment: Judgments.JudgedJudgment) {\n    let character = this._getLogCharacter(judgment)\n    if (character) {\n      if (\n        this._log.length === 0 ||\n        this._log[this._log.length - 1].character !== character\n      ) {\n        this._log.push({ character, count: 1 })\n      } else {\n        this._log[this._log.length - 1].count += 1\n      }\n    }\n  }\n  private _getLogCharacter(judgment: Judgments.JudgedJudgment) {\n    switch (judgment) {\n      case 1:\n        return 'A'\n      case 2:\n        return 'B'\n      case 3:\n        return 'C'\n      case 4:\n        return 'D'\n      case Judgments.MISSED:\n        return 'M'\n    }\n  }\n}\n\nexport default PlayerStats\n","import _ from 'lodash'\n\nexport class NoteArea {\n  constructor(notes, barLines) {\n    this._notes = _.sortBy(notes, position)\n    this._barLines = _(barLines).map('position').sortBy().value()\n  }\n  getVisibleNotes(lower, upper, headroom) {\n    let out = []\n    let notes = this._notes\n    if (!headroom) headroom = 0\n    for (let i = 0; i < notes.length; i++) {\n      let note = notes[i]\n      let visible = note.end\n        ? !(note.position > upper || note.end.position < lower - headroom)\n        : !(note.position > upper || note.position < lower - headroom)\n      if (visible) {\n        let entity = { note: note }\n        if (!note.end) {\n          entity.y = y(lower, upper, note.position)\n        } else {\n          let head = y(lower, upper, note.position)\n          let tail = y(lower, upper, note.end.position)\n          entity.y = Math.min(head, tail)\n          entity.height = Math.abs(head - tail)\n        }\n        out.push(entity)\n      }\n    }\n    return out\n  }\n  getVisibleBarLines(lower, upper, headroom) {\n    if (!headroom) headroom = 0\n    return this._barLines\n      .filter((pos) => lower - headroom <= pos && pos <= upper)\n      .map((pos) => ({ id: pos, y: y(lower, upper, pos) }))\n  }\n}\n\nexport default NoteArea\n\nfunction y(lower, upper, pos) {\n  return 1 - (pos - lower) / (upper - lower)\n}\n\nfunction position(event) {\n  return event.position\n}\n","export function getGauge(gaugeType) {\n  if (gaugeType === 'hope') {\n    return hopeGauge()\n  }\n  return nullGauge()\n}\n\nfunction nullGauge() {\n  return {\n    update() {},\n    shouldDisplay() {\n      return false\n    },\n    getPrimary() {\n      return 0\n    },\n    getSecondary() {\n      return 0\n    },\n    getExtra() {\n      return 0\n    },\n  }\n}\n\nfunction hopeGauge() {\n  let primary\n  let secondary\n  let extra\n  return {\n    update(playerState) {\n      const stats = playerState.stats\n      const progress = stats.numJudgments / stats.totalCombo\n      const getHope = (min, max1, max2) => {\n        const max = max1 + (max2 - max1) * progress\n        const maxPossibleScore = stats.maxPossibleScore\n        return Math.max(0, (maxPossibleScore - min) / (max - min))\n      }\n      const hopeS = getHope(500000, 555555, 510000) * 0.5\n      primary = Math.min(1, hopeS)\n      extra = Math.max(0, Math.min(1, hopeS - 1))\n      if (hopeS > 0) {\n        secondary = 0\n      } else {\n        const hopeA = getHope(450000, 500000, 500000)\n        secondary = hopeA\n      }\n    },\n    shouldDisplay() {\n      return primary > 0 || secondary > 0\n    },\n    getPrimary() {\n      return primary\n    },\n    getSecondary() {\n      return secondary\n    },\n    getExtra() {\n      return extra\n    },\n  }\n}\n","export function formatTime(seconds) {\n  let s = Math.floor(seconds % 60)\n  return Math.floor(seconds / 60) + ':' + (s < 10 ? '0' : '') + s\n}\n\nexport default formatTime\n","/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BMSChart = void 0;\nvar headers_1 = require(\"./headers\");\nvar objects_1 = require(\"./objects\");\nvar time_signatures_1 = require(\"../time-signatures\");\n/**\n * A BMSChart holds information about a particular BMS notechart.\n * Note that a BMSChart does not contain any information about `#RANDOM`,\n * as they are already processed after compilation.\n *\n * There is not many useful things you can do with a BMSChart other than\n * accessing the header fields and objects inside it.\n *\n * To extract information from a BMSChart,\n * please look at the documentation of higher-level classes,\n * such as {Keysounds}, {Notes}, and {Timing}.\n */\nvar BMSChart = /** @class */ (function () {\n    function BMSChart() {\n        /**\n         * {BMSHeaders} representing the BMS-specific headers of this notechart\n         */\n        this.headers = new headers_1.BMSHeaders();\n        /**\n         * {BMSObjects} representing all objects of this notechart\n         */\n        this.objects = new objects_1.BMSObjects();\n        /**\n         * {TimeSignatures} representing the time signature information in this chart\n         */\n        this.timeSignatures = new time_signatures_1.TimeSignatures();\n    }\n    /**\n     * Public: Converts measure number and fraction into beat.\n     * A single beat is equivalent to a quarter note in common time signature.\n     *\n     * @param {number} measure representing the measure number, starting from 0\n     * @param {number} fraction representing the fraction inside that measure, from 0 to 1\n     */\n    BMSChart.prototype.measureToBeat = function (measure, fraction) {\n        return this.timeSignatures.measureToBeat(measure, fraction);\n    };\n    return BMSChart;\n}());\nexports.BMSChart = BMSChart;\n//# sourceMappingURL=chart.js.map","import Bacon from 'baconjs'\n\nfunction observeMidiAccess(access) {\n  return Bacon.fromBinder((sink) => {\n    for (let port of access.inputs.values()) {\n      sink(new Bacon.Next(port))\n    }\n    for (let port of access.outputs.values()) {\n      sink(new Bacon.Next(port))\n    }\n    access.onstatechange = (e) => {\n      sink(new Bacon.Next(e.port))\n    }\n  })\n}\n\nfunction requestMIDIAccess() {\n  if (!navigator.requestMIDIAccess) {\n    return Promise.reject(new Error('MIDI is not supported'))\n  }\n  return navigator.requestMIDIAccess()\n}\n\nexport function getMidi() {\n  return Bacon.fromPromise(requestMIDIAccess())\n    .flatMap(observeMidiAccess)\n    .flatMapError((e) => (console.warn('MIDI Error:', e.stack), Bacon.never()))\n    .flatMap(messageForPort)\n    .doLog('messageforport')\n}\n\nfunction messageForPort(port) {\n  if (port.type !== 'input') return Bacon.never()\n  return Bacon.fromEvent(port, 'midimessage')\n}\n\nexport default getMidi\n","export class AxisLogic {\n  private stop = 1\n  private charge = 0\n  private previous: false | number = false\n  private active = false\n  private positive = false\n\n  public update(axis: number, threshold: number = 3) {\n    if (this.previous === false) {\n      this.previous = axis\n      return 0\n    }\n\n    if (this.previous !== axis) {\n      let delta = axis - this.previous\n      if (delta > 1) {\n        delta -= 2 + 0.005\n      } else if (delta < -1) {\n        delta += 2 + 0.005\n      }\n\n      let immediateOutput = delta > 0\n\n      if (this.active && this.positive !== immediateOutput) {\n        this.positive = immediateOutput\n        this.active = false\n        this.charge = 0\n      } else if (!this.active) {\n        if (this.charge === 0 || this.stop <= threshold) {\n          this.charge += Math.ceil(Math.abs(delta) / 0.01)\n        }\n\n        if (this.charge >= 2) {\n          this.active = true\n          this.positive = immediateOutput\n        }\n      }\n\n      this.stop = 0\n      this.previous = axis\n    }\n\n    if (this.stop > threshold * 2) {\n      this.active = false\n      this.charge = 0\n      this.stop = 0\n    }\n\n    this.stop += 1\n\n    return this.active ? (this.positive ? 1 : -1) : 0\n  }\n}\n","import keycode from 'keycode'\nimport _ from 'lodash'\nimport Bacon from 'baconjs'\nimport getMidi from './midi'\nimport { AxisLogic } from './axis-logic'\n\n// Public: OmniInput is a poll-based class that handles the key-pressed state of\n// multiple inputs.\n//\n// Each call to `update()` returns a mapping of active inputs. This object may\n// be reused and mutated by OmniInput for performance reasons, and thus the\n// caller SHOULD NOT hold on to or mutate it.\n//\n// ## Keys\n//\n// The key is a string that identifies some key on each input.\n// It follows the following convention:\n//\n// - `65` A keyboard keycode.\n// - `gamepad.0.button.3` A gamepad button.\n// - `gamepad.0.axis.3.positive` A gamepad axis (positive value).\n// - `gamepad.0.axis.3.negative` A gamepad axis (negative value).\n// - `midi.[id].[channel].note.[note]` A MIDI note.\n// - `midi.[id].[channel].sustain` Sustain pedal.\n// - `midi.[id].[channel].mod` Modulation level.\n// - `midi.[id].[channel].pitch.up` Pitch bend (up).\n// - `midi.[id].[channel].pitch.down` Pitch bend (down).\n//\nexport class OmniInput {\n  constructor(win = window, options = {}) {\n    const midi = (options.getMidi || getMidi)()\n    this._window = win\n    this._exclusive = !!options.exclusive\n    this._continuousAxis = !!options.continuous\n    this.setGamepadSensitivity(options.sensitivity || 3)\n\n    this._disposables = [\n      listen(win, 'keydown', (e) => this._handleKeyDown(e)),\n      listen(win, 'keyup', (e) => this._handleKeyUp(e)),\n      midi.onValue((e) => this._handleMIDIMessage(e)),\n    ]\n    this._status = {}\n    this._axis = {}\n  }\n  _handleKeyDown(e) {\n    this._status[`${e.which}`] = true\n    if (this._exclusive) e.preventDefault()\n  }\n  _handleKeyUp(e) {\n    this._status[`${e.which}`] = false\n  }\n  _handleMIDIMessage(e) {\n    if (!e || !e.data) return\n    const data = e.data\n    const prefix = `midi.${e.target.id}.${e.data[0] & 0x0f}`\n    const handleNote = (state) => {\n      this._status[`${prefix}.note.${data[1]}`] = state\n    }\n    if ((data[0] & 0xf0) === 0x80) {\n      // NoteOff\n      handleNote(false)\n    } else if ((data[0] & 0xf0) === 0x90) {\n      // NoteOn\n      if (data[2] > 0x0) {\n        // NoteOn (really)\n        handleNote(true)\n      } else {\n        // NoteOff disguised as NoteOn\n        handleNote(false)\n      }\n    } else if ((data[0] & 0xf0) === 0xb0) {\n      // CC\n      if (data[1] === 0x40) {\n        // Sustain\n        this._status[`${prefix}.sustain`] = data[2] >= 64\n      } else if (data[1] === 0x01) {\n        // Modulation\n        this._status[`${prefix}.mod`] = data[2] >= 16\n      }\n    } else if ((data[0] & 0xf0) === 0xe0) {\n      // Pitch Bend\n      const bend = data[1] | (data[2] << 7)\n      this._status[`${prefix}.pitch.up`] = bend >= 0x2100\n      this._status[`${prefix}.pitch.down`] = bend < 0x1f00\n    }\n  }\n  _updateGamepads() {\n    const nav = this._window.navigator\n    const gamepads = nav.getGamepads\n      ? nav.getGamepads()\n      : nav.webkitGetGamepads\n      ? nav.webkitGetGamepads()\n      : []\n    if (!gamepads) return\n    for (let i = 0; i < gamepads.length; i++) {\n      const gamepad = gamepads[i]\n      if (gamepad) {\n        this._updateGamepad(gamepad)\n      }\n    }\n  }\n  _updateGamepad(gamepad) {\n    const prefix = `gamepad.${gamepad.index}`\n    for (let i = 0; i < gamepad.buttons.length; i++) {\n      const button = gamepad.buttons[i]\n      this._status[`${prefix}.button.${i}`] = button && button.value >= 0.5\n    }\n    for (let i = 0; i < gamepad.axes.length; i++) {\n      const axisName = `${prefix}.axis.${i}`\n      let axis = gamepad.axes[i]\n\n      if (this._continuousAxis) {\n        if (this._axis[axisName] == null) {\n          this._axis[axisName] = new AxisLogic()\n        }\n        axis = this._axis[axisName].update(axis)\n      }\n\n      this._status[`${axisName}.positive`] = axis >= this._deadzone\n      this._status[`${axisName}.negative`] = axis <= -this._deadzone\n    }\n  }\n  update() {\n    this._updateGamepads()\n    return this._status\n  }\n\n  setGamepadSensitivity(sensitivity) {\n    this._sensitivity = sensitivity\n    this._deadzone = (9 - this._sensitivity) * 0.05\n    if (this._deadzone < 0.01) this._deadzone = 0.01\n    this._analogThreshold = 18 - this._sensitivity * 2\n  }\n\n  setGamepadContinuousAxisEnabled(enabled) {\n    this._continuousAxis = enabled\n  }\n\n  dispose() {\n    for (let dispose of this._disposables) {\n      dispose()\n    }\n  }\n}\n\n// Public: Returns a Bacon EventStream of keys pressed.\n//\nexport function key(input = new OmniInput(), win = window) {\n  return _keyForUpdate(\n    Bacon.fromBinder((sink) => {\n      const handle = win.setInterval(() => {\n        sink(new Bacon.Next(input.update()))\n      }, 16)\n      return () => win.clearInterval(handle)\n    })\n  )\n}\n\nexport function _keyForUpdate(update) {\n  return update\n    .map((update) => Object.keys(update).filter((key) => update[key]))\n    .diff([], (previous, current) => _.difference(current, previous))\n    .flatMap((array) => Bacon.fromArray(array))\n}\n\nexport default OmniInput\n\nconst knownMidiIds = {}\n\nexport function getName(key) {\n  if (+key) {\n    return _.capitalize(keycode(+key))\n  }\n  {\n    const match = key.match(/^gamepad\\.(\\d+)\\.axis\\.(\\d+)\\.(\\w+)/)\n    if (match) {\n      return `Joy${match[1]} Axis${match[2]} (${\n        match[3] === 'positive' ? '+' : '-'\n      })`\n    }\n  }\n  {\n    const match = key.match(/^gamepad\\.(\\d+)\\.button\\.(\\d+)/)\n    if (match) {\n      return `Joy${match[1]} Btn${match[2]}`\n    }\n  }\n  {\n    const match = key.match(/^midi\\.(.+)\\.(\\d+)\\.(.+)$/)\n    if (match) {\n      const rest = match[3].split('.')\n      const id = match[1]\n      const midiDeviceNumber =\n        knownMidiIds[id] ||\n        (knownMidiIds[id] = Object.keys(knownMidiIds).length + 1)\n      const prefix = `MIDI${midiDeviceNumber} Ch${+match[2] + 1}`\n      if (rest[0] === 'note') {\n        const midiNote = +rest[1]\n        const lookup = [\n          'C',\n          'C#',\n          'D',\n          'D#',\n          'E',\n          'F',\n          'F#',\n          'G',\n          'G#',\n          'A',\n          'A#',\n          'B',\n        ]\n        const noteName = lookup[midiNote % 12]\n        const octave = Math.floor(midiNote / 12) - 1\n        return `${prefix} ${noteName}${octave}`\n      }\n      if (rest[0] === 'pitch') {\n        return `${prefix} Pitch${rest[1] === 'up' ? '+' : '-'}`\n      }\n      if (rest[0] === 'sustain') return 'Sustain'\n      if (rest[0] === 'mod') return 'Mod'\n    }\n  }\n  return `${String(key).replace(/\\./g, ' ')}?`\n}\n\nfunction listen(subject, eventName, listener) {\n  subject.addEventListener(eventName, listener)\n  return function dispose() {\n    subject.removeEventListener(eventName, listener)\n  }\n}\n","export class Control {\n  public value = 0\n  public changed = false\n  get justPressed() {\n    return this.changed && this.value\n  }\n}\n\nexport default Control\n","import Control from './control'\nimport _ from 'lodash'\nimport bench from 'bemuse/devtools/benchmark'\n\ntype GameInputPluginInternalInstance = {\n  get(): [string, number][]\n  destroy(): void\n}\n\ninterface IGameInputPlugin {\n  name: string\n  get(): { [key: string]: number }\n  destroy?(): void\n}\n\nexport class GameInput {\n  private _controls = new Map<string, Control>()\n  private _plugins: GameInputPluginInternalInstance[] = []\n  update() {\n    let changes = new Map()\n    for (let [name, control] of this._controls) {\n      void name\n      control.changed = false\n    }\n    for (let plugin of this._plugins) {\n      for (let [name, value] of plugin.get()) {\n        changes.set(name, value)\n      }\n    }\n    for (let [name, value] of changes) {\n      let control = this.get(name)!\n      if (control.value !== value) {\n        control.changed = true\n        control.value = value\n      }\n    }\n  }\n  destroy() {\n    for (let plugin of this._plugins) {\n      plugin.destroy()\n    }\n  }\n  get(controlName: string) {\n    if (!this._controls.has(controlName)) {\n      this._controls.set(controlName, new Control())\n    }\n    return this._controls.get(controlName)!\n  }\n  use(plugin: IGameInputPlugin) {\n    let state: { [key: string]: number } = {}\n    let name = 'input:' + plugin.name\n    this._plugins.push({\n      get: bench.wrap(name, function () {\n        let out = plugin.get()\n        let diff = []\n        for (let key of _.union(_.keys(out), _.keys(state))) {\n          let last = +state[key] || 0\n          let current = +out[key] || 0\n          if (last !== current) diff.push([key, current])\n          state[key] = current\n        }\n        return diff\n      }),\n      destroy() {\n        if (typeof plugin.destroy === 'function') {\n          return plugin.destroy()\n        } else {\n          return true\n        }\n      },\n    })\n  }\n}\n\nexport default GameInput\n","\nvar timesync = require('./timesync')\nmodule.exports = sync\n\nfunction sync(url, callback, callback2) {\n  var ws = new WebSocket(url)\n  var clocks = []\n  ws.onmessage = function(e) {\n    if (e.data == 'k') {\n      emit()\n    }\n    if (e.data.indexOf(',') >= 0) {\n      process(e.data)\n      emit()\n    }\n  }\n  ws.onclose = function() {\n    if (clocks.length < 1) return callback(new Error('no offset received'))\n    return callback(null, timesync.offset(clocks))\n  }\n  function emit() {\n    try {\n      ws.send('' + new Date().getTime())\n    } catch (e) {\n      // do nuffink\n    }\n  }\n  function process(text) {\n    var fields = text.split(',')\n    var a = +fields[0]\n    var b = +fields[1]\n    var c = new Date().getTime()\n    if (a <= c) clocks.push(timesync.convert([a, b, b, c]))\n    if (clocks.length >= 8) {\n      if (callback2) callback2(timesync.offset(clocks))\n    }\n  }\n}\n","\nexports.convert = function convert(array) {\n  var t1 = array[0]\n  var t2 = array[1]\n  var t3 = array[2]\n  var t4 = array[3]\n  return {\n    offset: ((t2 - t1) + (t3 - t4)) / 2,\n    delay:  (t4 - t1) - (t3 - t2)\n  }\n}\n\nexports.offset = function offset(clocks) {\n  clocks = clocks.slice()\n  clocks.sort(function(a, b) {\n    return a.offset - b.offset\n  })\n  clocks = clocks.slice(1, clocks.length - 1)\n  clocks.sort(function(a, b) {\n    return a.delay - b.delay\n  })\n  var sum = 0, count = 0\n  var hp = Math.ceil(clocks.length / 8)\n  for (var i = 0; i < clocks.length; i++) {\n    if (clocks[i].delay > clocks[0].delay) hp--\n    if (hp === 0) break\n    sum += clocks[i].offset\n    count += 1\n  }\n  return sum / count\n}\n","// .dirname, .basename, and .extname methods are extracted from Node.js v8.11.1,\n// backported and transplited with Babel, with backwards-compat fixes\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  if (path.length === 0) return '.';\n  var code = path.charCodeAt(0);\n  var hasRoot = code === 47 /*/*/;\n  var end = -1;\n  var matchedSlash = true;\n  for (var i = path.length - 1; i >= 1; --i) {\n    code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n      // We saw the first non-path separator\n      matchedSlash = false;\n    }\n  }\n\n  if (end === -1) return hasRoot ? '/' : '.';\n  if (hasRoot && end === 1) {\n    // return '//';\n    // Backwards-compat fix:\n    return '/';\n  }\n  return path.slice(0, end);\n};\n\nfunction basename(path) {\n  if (typeof path !== 'string') path = path + '';\n\n  var start = 0;\n  var end = -1;\n  var matchedSlash = true;\n  var i;\n\n  for (i = path.length - 1; i >= 0; --i) {\n    if (path.charCodeAt(i) === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // path component\n      matchedSlash = false;\n      end = i + 1;\n    }\n  }\n\n  if (end === -1) return '';\n  return path.slice(start, end);\n}\n\n// Uses a mixed approach for backwards-compatibility, as ext behavior changed\n// in new Node.js versions, so only basename() above is backported here\nexports.basename = function (path, ext) {\n  var f = basename(path);\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\nexports.extname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  var startDot = -1;\n  var startPart = 0;\n  var end = -1;\n  var matchedSlash = true;\n  // Track the state of characters (if any) we see before our first dot and\n  // after any path separator we find\n  var preDotState = 0;\n  for (var i = path.length - 1; i >= 0; --i) {\n    var code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n    if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // extension\n      matchedSlash = false;\n      end = i + 1;\n    }\n    if (code === 46 /*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n    } else if (startDot !== -1) {\n      // We saw a non-dot and non-path separator before our dot, so we should\n      // have a good chance at having a non-empty extension\n      preDotState = -1;\n    }\n  }\n\n  if (startDot === -1 || end === -1 ||\n      // We saw a non-dot character immediately before the dot\n      preDotState === 0 ||\n      // The (right-most) trimmed path component is exactly '..'\n      preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n    return '';\n  }\n  return path.slice(startDot, end);\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","/*!\n  Copyright (c) 2018 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames() {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tif (arg.length) {\n\t\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\t\tif (inner) {\n\t\t\t\t\t\tclasses.push(inner);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tif (arg.toString === Object.prototype.toString) {\n\t\t\t\t\tfor (var key in arg) {\n\t\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclasses.push(arg.toString());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","import Progress from 'bemuse/progress'\nimport * as ProgressUtils from 'bemuse/progress/utils'\nimport readBlob from 'bemuse/utils/read-blob'\nimport _ from 'lodash'\nimport throat from 'throat'\nimport { IResource, IResources } from './types'\nimport { URLResources } from './url'\n\ntype MetadataFileJSON = {\n  files: BemusePackFileEntry[]\n  refs: BemusePackRefEntry[]\n}\ntype BemusePackRefEntry = { path: string; hash: string }\ntype BemusePackFileEntry = { name: string; ref: BemusePackContentRef }\ntype BemusePackContentRef = [number, number, number]\n\nexport class BemusePackageResources implements IResources {\n  private _base: IResources\n  private _fallback: IResources | undefined\n  private _fallbackPattern: RegExp | undefined\n  private _metadataFilename: string\n  public loadPayload: (\n    resourcePromise: PromiseLike<IResource>\n  ) => PromiseLike<Blob>\n\n  public progress = {\n    all: new Progress(),\n    current: new Progress(),\n  }\n\n  constructor(\n    base: string | IResources,\n    options: {\n      metadataFilename?: string\n      fallback?: string | IResources\n      fallbackPattern?: RegExp\n    } = {}\n  ) {\n    if (typeof base === 'string') {\n      base = new URLResources(new URL(base, location.href))\n    }\n\n    const fallback =\n      typeof options.fallback === 'string'\n        ? new URLResources(new URL(options.fallback, location.href))\n        : options.fallback\n\n    this._base = base\n    this._fallback = fallback\n    this._fallbackPattern = options.fallbackPattern\n    this._metadataFilename = options.metadataFilename || 'metadata.json'\n\n    let simultaneous = ProgressUtils.simultaneous(this.progress.current)\n    let nextProgress = () => {\n      let progress = new Progress()\n      simultaneous.add(progress)\n      return progress\n    }\n    this.loadPayload = ProgressUtils.wrapPromise(\n      this.progress.all,\n      throat(2, (resourcePromise) =>\n        resourcePromise\n          .then((resource) => resource.read(nextProgress()))\n          .then((arrayBuffer) => new Blob([arrayBuffer]))\n          .then(getPayload)\n      )\n    )\n  }\n\n  private _getMetadata = _.once(async () => {\n    const file = await this._base.file(this._metadataFilename)\n    const data = await file.read()\n    const text = await new Blob([data]).text()\n    return JSON.parse(text) as MetadataFileJSON\n  })\n  private _getRefs = _.once(async () => {\n    const metadata = await this._getMetadata()\n    return metadata.refs.map((spec) => new Ref(this, spec))\n  })\n  private _getFileMap = _.once(async () => {\n    const metadata = await this._getMetadata()\n    let files = new Map<string, BemusePackFileEntry>()\n    for (let file of metadata.files) {\n      files.set(file.name.toLowerCase(), file)\n    }\n    return files\n  })\n\n  get base() {\n    return this._base\n  }\n  async file(name: string): Promise<IResource> {\n    const fileMap = await this._getFileMap()\n    let file = fileMap.get(name.toLowerCase())\n    if (file) {\n      return new BemusePackageFileResource(this, file.ref, file.name)\n    } else if (\n      this._fallback &&\n      this._fallbackPattern &&\n      this._fallbackPattern.test(name)\n    ) {\n      return this._fallback.file(name)\n    } else {\n      throw new Error('Unable to find: ' + name)\n    }\n  }\n  async getBlob([index, start, end]: [number, number, number]) {\n    const refs = await this._getRefs()\n    const ref = refs[index]\n    const payload = await ref.load()\n    return payload.slice(start, end)\n  }\n}\n\nclass BemusePackageFileResource implements IResource {\n  constructor(\n    private resources: BemusePackageResources,\n    private ref: BemusePackContentRef,\n    public readonly name: string\n  ) {}\n  read(progress: Progress): PromiseLike<ArrayBuffer> {\n    return ProgressUtils.atomic(\n      progress,\n      this.resources\n        .getBlob(this.ref)\n        .then((blob) => readBlob(blob).as('arraybuffer'))\n    )\n  }\n  async resolveUrl() {\n    const blob = await this.resources.getBlob(this.ref)\n    return URL.createObjectURL(blob)\n  }\n}\n\nclass Ref {\n  private _basePromise: PromiseLike<IResource>\n  private _promise: PromiseLike<Blob> | undefined\n  constructor(\n    private resources: BemusePackageResources,\n    spec: BemusePackRefEntry\n  ) {\n    this._basePromise = resources.base.file(spec.path)\n  }\n  load() {\n    return (\n      this._promise ||\n      (this._promise = this.resources.loadPayload(this._basePromise))\n    )\n  }\n}\n\nexport default BemusePackageResources\n\nasync function getPayload(blob: Blob) {\n  const magic = await readBlob(blob.slice(0, 10)).as('text')\n  if (magic !== 'BEMUSEPACK') {\n    throw new Error('Invalid magic number')\n  }\n  const buffer = await readBlob(blob.slice(10, 14)).as('arraybuffer')\n  let array = new Uint8Array(buffer)\n  let length = array[0] + (array[1] << 8) + (array[2] << 16) + (array[3] << 24)\n  const metadataLength = length\n  return blob.slice(14 + metadataLength)\n}\n","import createKeysoundCache from './createKeysoundCache'\n\nexport default createKeysoundCache()\n","\nvar content = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./BenchmarkPanel.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./BenchmarkPanel.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./BenchmarkPanel.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".BenchmarkPanel {\\n  background: #449;\\n  border: 2px solid #66e;\\n  padding: 4px;\\n}\\n.BenchmarkPanel table {\\n  font-size: 10px;\\n}\", \"\"]);\n\n// exports\n","import _ from 'lodash'\n\nimport PlayerStats from './player-stats'\nimport {\n  MISSED,\n  getJudgeForNotechart,\n  isBad,\n  judgeEndTime,\n  judgeTime,\n  IJudge,\n  Judgment,\n  JudgedJudgment,\n} from '../judgments'\nimport Player from '../player'\nimport { GameNote } from 'bemuse-notechart/lib/types'\nimport GameInput from '../input'\nimport Control from '../input/control'\nimport invariant from 'invariant'\n\ntype NoteResult = {\n  judgment: Judgment\n  status: NoteStatus\n  delta: number\n}\n\nenum NoteStatus {\n  /** For long notes -- when the player is holding the note but not yet release it. */\n  Active = 'active',\n  /** This not is not yet judged. */\n  Unjudged = 'unjudged',\n  /** This note is fully-judged. */\n  Judged = 'judged',\n}\n\ntype Notifications = {\n  sounds: (\n    | { type: 'hit'; note: GameNote; judgment: Judgment }\n    | { type: 'free'; note: GameNote }\n    | { type: 'break'; note: GameNote }\n  )[]\n  judgments: {}[]\n}\n\nfunction initializeNotifications(): Notifications {\n  return { sounds: [], judgments: [] }\n}\n\n// The PlayerState class holds a single player's state, including the stats\n// (score, current combo, maximum combo).\nexport class PlayerState {\n  /** The PlayerStats object. */\n  public stats: PlayerStats\n\n  /** The notifications from the previous update. */\n  public notifications = initializeNotifications()\n  /** The current note scrolling speed. */\n  public speed: number\n  /** `true` if finished playing, `false` otherwise. */\n  public finished = false\n  /** `true` if score is invalid due to autoplay being activated. `false` otherwise. */\n  public tainted = false\n  public input: Map<string, Control> = new Map()\n\n  private _columns: string[]\n  private _noteBufferByColumn: _.Dictionary<NoteBuffer>\n  private _noteResult: Map<GameNote, NoteResult>\n  private _duration: number\n  private _judge: IJudge\n  private _gameTime = 0\n  private _rawInput?: GameInput\n  private _pinching: null | { start: number; speed: number } = null\n\n  constructor(public readonly player: Player) {\n    this._columns = player.columns\n    this._noteBufferByColumn = _(player.notechart.notes)\n      .sortBy((n) => n.time)\n      .groupBy((n) => n.column)\n      .mapValues(noteBuffer(this))\n      .value()\n    this._noteResult = new Map()\n    this._duration = player.notechart.duration\n    this._judge = getJudgeForNotechart(player.notechart, {\n      tutorial: player.options.tutorial,\n    })\n    this.stats = new PlayerStats(player.notechart)\n    this.speed = player.options.speed\n  }\n\n  /**\n   * Updates the state. Judge the notes and emit notifications.\n   */\n  update(gameTime: number, input: GameInput) {\n    this._gameTime = gameTime\n    this._rawInput = input\n    this.notifications = initializeNotifications()\n    this._updateInputColumnMap()\n    this._judgeNotes()\n    this._updateSpeed()\n    if (gameTime > this._duration + 3) this.finished = true\n  }\n\n  getNoteStatus(note: GameNote): NoteStatus {\n    let result = this._noteResult.get(note)\n    if (!result) return NoteStatus.Unjudged\n    return result.status\n  }\n  getNoteJudgment(note: GameNote) {\n    let result = this._noteResult.get(note)\n    if (!result) return Judgment.Unjudged\n    return result.judgment\n  }\n  getPlayerInput(control: string) {\n    return this._rawInput!.get(`p${this.player.number}_${control}`)!\n  }\n  _updateInputColumnMap() {\n    this.input = new Map(\n      this._columns.map((column) => [column, this.getPlayerInput(column)])\n    )\n  }\n  _judgeNotes() {\n    for (let column of this._columns) {\n      let buffer = this._noteBufferByColumn[column]\n      if (buffer) {\n        let control = this.input.get(column)!\n        this._judgeColumn(buffer, control, column)\n        buffer.update()\n      }\n    }\n  }\n  _updateSpeed() {\n    if (this.getPlayerInput('speedup').justPressed) {\n      this._modifySpeed(+1)\n    }\n    if (this.getPlayerInput('speeddown').justPressed) {\n      this._modifySpeed(-1)\n    }\n    let pinch = this.getPlayerInput('pinch').value\n    if (pinch && !this._pinching) {\n      this._pinching = { start: pinch, speed: this.speed }\n    } else if (!pinch) {\n      this._pinching = null\n    }\n    if (pinch && this._pinching) {\n      let pinching = this._pinching\n      let speed = (pinching.speed * pinch) / pinching.start\n      this.speed = Math.max(0.2, Math.round(speed * 10) / 10)\n    }\n  }\n  _modifySpeed(direction: 1 | -1) {\n    let amount = this._rawInput!.get('select').value\n      ? 0.1\n      : this.speed < 0.5\n      ? 0.3\n      : 0.5\n    this.speed += direction * amount\n    if (this.speed < 0.2) this.speed = 0.2\n  }\n  _shouldAutoplay() {\n    return this.player.options.autoplayEnabled || isAutoplayEnabled()\n  }\n  _judgeColumn(buffer: NoteBuffer, control: Control, column: string) {\n    let judgedNote\n    let judgment\n    let notes = buffer.notes\n    let autoPlayed = false\n    for (let i = buffer.startIndex; i < notes.length; i++) {\n      let note = notes[i]\n      if (this._shouldJudge(note, control, buffer)) {\n        let shouldBreak = this.getNoteStatus(note) !== 'active'\n        judgedNote = note\n        judgment = this._judgeNote(note)\n        if (this._shouldAutoplay()) {\n          autoPlayed = true\n        }\n        if (shouldBreak) break\n      }\n    }\n    if (control.justPressed || autoPlayed) {\n      if (judgedNote && judgment != null) {\n        this.notifications.sounds!.push({\n          note: judgedNote,\n          type: 'hit',\n          judgment: judgment,\n        })\n      } else {\n        let freestyleNote = this._getFreestyleNote(notes)\n        if (freestyleNote) {\n          const shouldPlayFreestyleNote =\n            this.player.options.placement !== '3d' ||\n            !this._isSandwiched(column)\n          if (shouldPlayFreestyleNote) {\n            this.notifications.sounds!.push({\n              note: freestyleNote,\n              type: 'free',\n            })\n          }\n        }\n      }\n    }\n  }\n  _getClosestNote(notes: GameNote[]) {\n    return _.minBy(notes, (note) => Math.abs(this._gameTime - note.time))\n  }\n  _getFreestyleNote(notes: GameNote[]) {\n    return _.minBy(notes, (note) => {\n      let distance = Math.abs(this._gameTime - note.time)\n      let penalty = this._gameTime < note.time - 1 ? 1000000 : 0\n      return distance + penalty\n    })\n  }\n  _isSandwiched(column: string) {\n    const mapping: { [col: string]: string[] } = {\n      '2': ['1', '3'],\n      '3': ['2', '4'],\n      '4': ['3', '5'],\n      '5': ['4', '6'],\n      '6': ['5', '7'],\n    }\n    if (!mapping[column]) return false\n    return mapping[column].every((adjacentColumn) => {\n      const buffer = this._noteBufferByColumn[adjacentColumn]\n      if (!buffer) return false\n      return buffer.notes.some(\n        (note) => Math.abs(this._gameTime - note.time) < 0.1\n      )\n    })\n  }\n  _shouldJudge(note: GameNote, control: Control, buffer: NoteBuffer) {\n    let status = this.getNoteStatus(note)\n    if (status === 'unjudged') {\n      if (this._shouldAutoplay() && this._gameTime >= note.time) {\n        this.tainted = true\n        return true\n      }\n      let judgment = judgeTime(this._gameTime, note.time, this._judge)\n      let missed = judgment === MISSED\n      let hit = judgment > 0 && control.changed && control.value\n      if (isBad(judgment) && this._getClosestNote(buffer.notes) !== note) {\n        hit = false\n      }\n      return missed || hit\n    } else if (status === 'active') {\n      const noteEnd = note.end || invariant(false, 'note.end must exist')\n      if (this._shouldAutoplay() && this._gameTime >= noteEnd.time) {\n        this.tainted = true\n        return true\n      }\n      let judgment = judgeEndTime(this._gameTime, noteEnd.time, this._judge)\n      let missed = judgment === MISSED\n      let lifted = control.changed\n      let scratch = note.column === 'SC'\n      let passed = this._gameTime >= noteEnd.time\n      return missed || lifted || (scratch && passed)\n    } else {\n      return false\n    }\n  }\n  _judgeNote(note: GameNote) {\n    let delta = this._gameTime - note.time\n    let judgment = judgeTime(this._gameTime, note.time, this._judge)\n    let result = this._noteResult.get(note)\n    let isDown = !result || result.status === 'unjudged'\n    let isUp = result && result.status === 'active'\n    if (this._shouldAutoplay() && judgment >= 1) {\n      judgment = 1\n    }\n    if (note.end) {\n      if (isDown) {\n        let status = judgment === MISSED ? NoteStatus.Judged : NoteStatus.Active\n        if (judgment === MISSED) {\n          // judge missed long note twice\n          this._setJudgment(judgment, delta, note.column)\n        }\n        result = { status, judgment, delta }\n      } else if (isUp) {\n        let scratch = note.column === 'SC'\n        delta = this._gameTime - note.end.time\n        judgment =\n          judgeEndTime(this._gameTime, note.end.time, this._judge) || MISSED\n        if (scratch && delta > 0) judgment = 1\n        result = { status: NoteStatus.Judged, judgment, delta }\n      }\n    } else {\n      result = { status: NoteStatus.Judged, judgment, delta }\n    }\n    if (judgment === MISSED) {\n      this.notifications.sounds.push({ note, type: 'break' })\n    }\n    if (isDown && judgment !== MISSED) {\n      this.stats.handleDelta(delta)\n    }\n    if (!result) {\n      throw new Error('Invariant violation: result must not be undefined')\n    }\n    if (!judgment) {\n      throw new Error(\n        'Invariant violation: note should be judged by this point'\n      )\n    }\n    this._noteResult.set(note, result)\n    this._setJudgment(judgment, delta, note.column)\n    return judgment\n  }\n  _setJudgment(judgment: JudgedJudgment, delta: number, column: string) {\n    this.stats.handleJudgment(judgment)\n    let info = { judgment, combo: this.stats.combo, delta, column }\n    this.notifications.judgments.push(info)\n  }\n}\n\ntype NoteBuffer = {\n  notes: GameNote[]\n  startIndex: number\n  update: () => void\n}\n\nfunction isAutoplayEnabled() {\n  return !!(window as any).BEMUSE_AUTOPLAY\n}\n\nfunction noteBuffer(state: PlayerState) {\n  return function bufferNotes(notes: GameNote[]): NoteBuffer {\n    let startIndex = 0\n    return {\n      notes,\n      get startIndex() {\n        return startIndex\n      },\n      update() {\n        while (\n          startIndex < notes.length &&\n          state.getNoteStatus(notes[startIndex]) === 'judged'\n        ) {\n          startIndex += 1\n        }\n      },\n    }\n  }\n}\n\nexport default PlayerState\n","// Source: http://jsfiddle.net/vWx8V/\n// http://stackoverflow.com/questions/5603195/full-list-of-javascript-keycodes\n\n/**\n * Conenience method returns corresponding value for given keyName or keyCode.\n *\n * @param {Mixed} keyCode {Number} or keyName {String}\n * @return {Mixed}\n * @api public\n */\n\nfunction keyCode(searchInput) {\n  // Keyboard Events\n  if (searchInput && 'object' === typeof searchInput) {\n    var hasKeyCode = searchInput.which || searchInput.keyCode || searchInput.charCode\n    if (hasKeyCode) searchInput = hasKeyCode\n  }\n\n  // Numbers\n  if ('number' === typeof searchInput) return names[searchInput]\n\n  // Everything else (cast to string)\n  var search = String(searchInput)\n\n  // check codes\n  var foundNamedKey = codes[search.toLowerCase()]\n  if (foundNamedKey) return foundNamedKey\n\n  // check aliases\n  var foundNamedKey = aliases[search.toLowerCase()]\n  if (foundNamedKey) return foundNamedKey\n\n  // weird character?\n  if (search.length === 1) return search.charCodeAt(0)\n\n  return undefined\n}\n\n/**\n * Compares a keyboard event with a given keyCode or keyName.\n *\n * @param {Event} event Keyboard event that should be tested\n * @param {Mixed} keyCode {Number} or keyName {String}\n * @return {Boolean}\n * @api public\n */\nkeyCode.isEventKey = function isEventKey(event, nameOrCode) {\n  if (event && 'object' === typeof event) {\n    var keyCode = event.which || event.keyCode || event.charCode\n    if (keyCode === null || keyCode === undefined) { return false; }\n    if (typeof nameOrCode === 'string') {\n      // check codes\n      var foundNamedKey = codes[nameOrCode.toLowerCase()]\n      if (foundNamedKey) { return foundNamedKey === keyCode; }\n    \n      // check aliases\n      var foundNamedKey = aliases[nameOrCode.toLowerCase()]\n      if (foundNamedKey) { return foundNamedKey === keyCode; }\n    } else if (typeof nameOrCode === 'number') {\n      return nameOrCode === keyCode;\n    }\n    return false;\n  }\n}\n\nexports = module.exports = keyCode;\n\n/**\n * Get by name\n *\n *   exports.code['enter'] // => 13\n */\n\nvar codes = exports.code = exports.codes = {\n  'backspace': 8,\n  'tab': 9,\n  'enter': 13,\n  'shift': 16,\n  'ctrl': 17,\n  'alt': 18,\n  'pause/break': 19,\n  'caps lock': 20,\n  'esc': 27,\n  'space': 32,\n  'page up': 33,\n  'page down': 34,\n  'end': 35,\n  'home': 36,\n  'left': 37,\n  'up': 38,\n  'right': 39,\n  'down': 40,\n  'insert': 45,\n  'delete': 46,\n  'command': 91,\n  'left command': 91,\n  'right command': 93,\n  'numpad *': 106,\n  'numpad +': 107,\n  'numpad -': 109,\n  'numpad .': 110,\n  'numpad /': 111,\n  'num lock': 144,\n  'scroll lock': 145,\n  'my computer': 182,\n  'my calculator': 183,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  \"'\": 222\n}\n\n// Helper aliases\n\nvar aliases = exports.aliases = {\n  'windows': 91,\n  '': 16,\n  '': 18,\n  '': 17,\n  '': 91,\n  'ctl': 17,\n  'control': 17,\n  'option': 18,\n  'pause': 19,\n  'break': 19,\n  'caps': 20,\n  'return': 13,\n  'escape': 27,\n  'spc': 32,\n  'spacebar': 32,\n  'pgup': 33,\n  'pgdn': 34,\n  'ins': 45,\n  'del': 46,\n  'cmd': 91\n}\n\n/*!\n * Programatically add the following\n */\n\n// lower case chars\nfor (i = 97; i < 123; i++) codes[String.fromCharCode(i)] = i - 32\n\n// numbers\nfor (var i = 48; i < 58; i++) codes[i - 48] = i\n\n// function keys\nfor (i = 1; i < 13; i++) codes['f'+i] = i + 111\n\n// numpad keys\nfor (i = 0; i < 10; i++) codes['numpad '+i] = i + 96\n\n/**\n * Get by code\n *\n *   exports.name[13] // => 'Enter'\n */\n\nvar names = exports.names = exports.title = {} // title for backward compat\n\n// Create reverse mapping\nfor (i in codes) names[codes[i]] = i\n\n// Add aliases\nfor (var alias in aliases) {\n  codes[alias] = aliases[alias]\n}\n","import * as touch3d from './touch3d'\nimport NoteArea from './note-area'\nimport { MISSED, breaksCombo } from '../judgments'\nimport { getGauge } from './Gauge'\n\nexport class PlayerDisplay {\n  constructor(player, skinData) {\n    this._currentSpeed = 1\n    this._player = player\n    this._noteArea = new NoteArea(\n      player.notechart.notes,\n      player.notechart.barLines\n    )\n    this._stateful = {}\n    this._defaultData = {\n      placement: player.options.placement,\n      scratch: player.options.scratch,\n      key_mode: player.notechart.getKeyMode(player.options.scratch),\n      lane_lift: Math.max(0, -player.options.laneCover),\n      lane_press: Math.max(0, player.options.laneCover),\n    }\n    this._gauge = getGauge(player.options.gauge)\n    this._touch3dMode = skinData.displayMode === 'touch3d'\n  }\n  update(time, gameTime, playerState) {\n    const touch3dMode = this._touch3dMode\n    let player = this._player\n    let noteArea = this._noteArea\n    let stateful = this._stateful\n    let beat = player.notechart.secondsToBeat(gameTime)\n    let position = player.notechart.beatToPosition(beat)\n    let spacing = player.notechart.spacingAtBeat(beat)\n    let data = Object.assign({}, this._defaultData)\n    let push = (key, value) => (data[key] || (data[key] = [])).push(value)\n    let gauge = this._gauge\n\n    this._currentSpeed += (playerState.speed - this._currentSpeed) / 3\n    let speed = this._currentSpeed * spacing\n\n    updateBeat()\n    updateVisibleNotes()\n    updateBarLines()\n    updateInput()\n    updateJudgment()\n    updateGauge()\n    updateExplode()\n\n    data['speed'] = playerState.speed.toFixed(1) + 'x'\n    data['stat_1'] = getCount(1)\n    data['stat_2'] = getCount(2)\n    data['stat_3'] = getCount(3)\n    data['stat_4'] = getCount(4)\n    data['stat_missed'] = getCount(MISSED)\n    data['stat_acc'] = getAccuracy()\n    const bpm = player.notechart.bpmAtBeat(beat)\n    data['bpm'] = bpm < 1 ? '' : Math.round(bpm) % 10000 || ''\n\n    Object.assign(data, stateful)\n    return data\n\n    function updateBeat() {\n      data.beat = beat\n    }\n\n    function getCount(judgment) {\n      return playerState.stats.counts && playerState.stats.counts[judgment]\n    }\n\n    function getAccuracy() {\n      return ((playerState.stats.currentAccuracy || 0) * 100).toFixed(2) + '%'\n    }\n\n    function updateVisibleNotes() {\n      let entities = noteArea.getVisibleNotes(position, getUpperBound(), 1)\n      if (touch3dMode) {\n        const putNote = (id, noteY, column, scale = 1) => {\n          const row = touch3d.getRow(noteY - 0.01)\n          const columnIndex = +column || -1\n          const areaWidth = touch3d.PLAY_AREA_WIDTH\n          const xOffset =\n            row.projection * areaWidth * ((2 * (columnIndex - 0.5)) / 7 - 1)\n          const desiredWidth = (row.projection * scale * areaWidth * 2) / 7\n          push(`note3d_${column}`, {\n            key: id,\n            y: row.y,\n            x: xOffset + 1280 / 2,\n            width: desiredWidth,\n          })\n        }\n        let longNoteStep = 3 / 128\n        for (let entity of entities) {\n          let note = entity.note\n          let column = note.column\n          if (entity.height) {\n            let c = 0\n            let start = entity.y + entity.height\n            for (\n              let i =\n                start -\n                Math.max(\n                  0,\n                  Math.floor((start - 1) / longNoteStep) * longNoteStep\n                );\n              i >= 0 && i >= entity.y;\n              i -= longNoteStep\n            ) {\n              putNote(note.id + 'x' + c++, i, column, 0.8)\n            }\n            putNote(note.id, entity.y + entity.height, column)\n          } else {\n            if (playerState.getNoteStatus(note) !== 'judged') {\n              putNote(note.id, entity.y, column)\n            }\n          }\n        }\n      } else {\n        for (let entity of entities) {\n          let note = entity.note\n          let column = note.column\n          if (entity.height) {\n            let judgment = playerState.getNoteJudgment(note)\n            let status = playerState.getNoteStatus(note)\n            push(`longnote_${column}`, {\n              key: note.id,\n              y: entity.y,\n              height: entity.height,\n              active: judgment !== 0 && judgment !== MISSED,\n              missed: status === 'judged' && judgment === MISSED,\n            })\n          } else {\n            if (playerState.getNoteStatus(note) !== 'judged') {\n              push(`note_${column}`, {\n                key: note.id,\n                y: entity.y,\n              })\n            }\n          }\n        }\n      }\n    }\n\n    function updateBarLines() {\n      let entities = noteArea.getVisibleBarLines(position, getUpperBound(), 1)\n      for (let entity of entities) {\n        if (touch3dMode) {\n          const row = touch3d.getRow(entity.y - 0.01)\n          push('barlines3d', {\n            key: entity.id,\n            y: row.y,\n            x: row.projection * -touch3d.PLAY_AREA_WIDTH + 1280 / 2,\n            width: row.projection * touch3d.PLAY_AREA_WIDTH * 2,\n          })\n        } else {\n          push('barlines', { key: entity.id, y: entity.y })\n        }\n      }\n    }\n\n    function updateInput() {\n      let input = playerState.input\n      for (let column of player.columns) {\n        let control = input.get(column)\n        data[`${column}_active`] = control.value !== 0 ? 1 : 0\n        if (control.changed) {\n          if (control.value !== 0) {\n            stateful[`${column}_down`] = time\n          } else {\n            stateful[`${column}_up`] = time\n          }\n        }\n      }\n    }\n\n    function updateJudgment() {\n      let notifications = playerState.notifications.judgments\n      let notification = notifications[notifications.length - 1]\n      if (notification) {\n        let name =\n          notification.judgment === -1 ? 'missed' : `${notification.judgment}`\n        stateful[`judge_${name}`] = time\n        let deviationMode =\n          notification.judgment === -1 || notification.judgment === 1\n            ? 'none'\n            : notification.delta > 0\n            ? 'late'\n            : notification.delta < 0\n            ? 'early'\n            : 'none'\n        stateful[`judge_deviation_${deviationMode}`] = time\n        stateful['combo'] = notification.combo\n      }\n      data['score'] = playerState.stats.score\n    }\n\n    function updateGauge() {\n      gauge.update(playerState)\n      if (gauge.shouldDisplay()) {\n        if (!stateful['gauge_enter']) stateful['gauge_enter'] = time\n      } else {\n        if (stateful['gauge_enter']) {\n          if (!stateful['gauge_exit']) stateful['gauge_exit'] = time\n        }\n      }\n      data['gauge_primary'] = gauge.getPrimary()\n      data['gauge_secondary'] = gauge.getSecondary()\n      data['gauge_extra'] = gauge.getExtra()\n    }\n\n    function updateExplode() {\n      let notifications = playerState.notifications.judgments\n      for (let i = 0; i < notifications.length; i++) {\n        let notification = notifications[i]\n        if (!breaksCombo(notification.judgment)) {\n          stateful[`${notification.column}_explode`] = time\n        }\n      }\n    }\n\n    function getUpperBound() {\n      return position + 5 / speed\n    }\n  }\n}\n\nexport default PlayerDisplay\n","import { FileEntry, LoggingFunction, ICustomSongResources } from './types'\nimport {\n  CustomSongResources,\n  ARCHIVE_REGEXP,\n  downloadFileEntryFromURL,\n} from './custom-song-resources'\nimport { addUnprefixed } from './addUnprefixed'\n\n// TODO [#634]: Remove the `DndResources` class and have users of this class create a `CustomSongResources` directly.\n//\n// The original implementation of DndResources class has been extracted\n// into a CustomSongResources superclass in commit cc6a6e70586487ef476890f5a7911837186a7a32,\n// so that part of its logic can be re-used in other contexts, such as in commit ba9e15bab72fec17a144e40433cb3a4ffd31db5b.\n//\n// Now this `DndResources` class is really dumb and we want to prefer composition over inheritance.\n// This class should be removed.\nexport class DndResources\n  extends CustomSongResources\n  implements ICustomSongResources\n{\n  constructor(event: DragEvent) {\n    super({\n      getFiles: (log) => getFilesFromEvent(event, log),\n    })\n  }\n}\n\nexport default DndResources\n\nasync function getFilesFromEvent(\n  event: DragEvent,\n  log: LoggingFunction\n): Promise<FileEntry[]> {\n  let out: FileEntry[] = []\n  const dataTransfer = event.dataTransfer\n  if (!dataTransfer) {\n    throw new Error('Expect event.dataTransfer to be present')\n  }\n  if (dataTransfer.types.indexOf('text/uri-list') > -1) {\n    let url = dataTransfer\n      .getData('text/uri-list')\n      .split(/\\r\\n|\\r|\\n/)\n      .filter((t) => t && !t.startsWith('#'))[0]\n    if (ARCHIVE_REGEXP.test(url && url.replace(/[?#].*/, ''))) {\n      log('Link to archive file detected. Trying to download')\n      return [await downloadFileEntryFromURL(url, log)]\n    }\n  } else if (dataTransfer.items) {\n    for (let item of Array.from(dataTransfer.items)) {\n      await readItem(item)\n    }\n  } else if (dataTransfer.files) {\n    for (let file of Array.from(dataTransfer.files)) {\n      addFile(file)\n    }\n  }\n  return out\n\n  async function readItem(item: DataTransferItem) {\n    let entry = item.webkitGetAsEntry && item.webkitGetAsEntry()\n    if (entry) {\n      await readEntry(entry)\n    } else {\n      let file = item.getAsFile && item.getAsFile()\n      if (file) addFile(file)\n    }\n  }\n\n  function readEntry(entry: any, prefix = '') {\n    if (entry.isFile) {\n      return readFile(entry, prefix)\n    } else if (entry.isDirectory) {\n      return readDirectory(entry, prefix)\n    }\n  }\n\n  function readFile(entry: any, prefix = '') {\n    return new Promise<File>((resolve, reject) => {\n      entry.file(resolve, reject)\n    }).tap((file) => {\n      addFile(file, prefix)\n    })\n  }\n\n  async function readDirectory(dir: any, prefix = '') {\n    let entries: any[] = []\n    let reader = dir.createReader()\n    let readMore = () =>\n      new Promise<any>((resolve, reject) => {\n        reader.readEntries(resolve, reject)\n      })\n    for (;;) {\n      let results = await readMore()\n      if (!results || results.length === 0) break\n      entries.push(...Array.from(results))\n    }\n    for (let entry of entries) {\n      await readEntry(entry, prefix + dir.name + '/')\n    }\n  }\n\n  function addFile(file: File, prefix = '') {\n    if (file) {\n      addUnprefixed(prefix, file.name, (name) => {\n        out.push({ name, file })\n      })\n    }\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Speedcore = void 0;\nvar segment_1 = require(\"./segment\");\n/**\n * Speedcore is a small internally-used library.\n * A Speedcore represents a single dimensional keyframed linear motion\n * (as in equation x = f(t)), and is useful when working\n * with BPM changes ({Timing}), note spacing factor ({Spacing}), or scrolling\n * segments ({Positioning}).\n * A Speedcore is constructed from an array of Segments.\n *\n * A {Segment} is defined as `{ t, x, dx }`, such that:\n *\n * * speedcore.x(segment.t) = segment.x\n * * speedcore.t(segment.x) = segment.t\n * * speedcore.x(segment.t + dt) = segment.x + (segment.dx / dt)\n *\n *\n * ## Explanation\n *\n * One way to think of these segments is to think about tempo changes, where:\n *\n * * `t` is the elapsed time (in seconds) since song start.\n * * `x` is the elapsed beat since song start.\n * * `dx` is the amount of `x` increase per `t`. In this case, it has the\n *   unit of beats per second.\n *\n * For example, consider a song that starts at 140 BPM.\n * 32 beats later, the tempo changes to 160 BPM.\n * 128 beats later (at beat 160), the tempo reverts to 140 BPM.\n *\n * We can derive three segments:\n *\n * 1. At time 0, we are at beat 0, and moving at 2.333 beats per second.\n * 2. At 13.714s, we are at beat 32, moving at 2.667 beats per second.\n * 3. At 61.714s, we are at beat 160, moving at 2.333 beats per second.\n *\n * This maps out to this data structure:\n *\n * ```js\n * [ [0]: { t:  0.000,  x:   0,  dx: 2.333,  inclusive: true },\n *   [1]: { t: 13.714,  x:  32,  dx: 2.667,  inclusive: true },\n *   [2]: { t: 61.714,  x: 160,  dx: 2.333,  inclusive: true } ]\n * ```\n *\n * With this data, it is possible to find out the value of `x` at any given `t`.\n *\n * For example, to answer the question, what is the beat number at 30s?\n * First, we find the segment with maximum value of `t < 30`, and we get\n * the segment `[1]`.\n *\n * We calculate `segment.x + (t - segment.t) * segment.dx`.\n * The result beat number is (32 + (30 - 13.714) * 2.667) = 75.435.\n *\n * We can also perform the reverse calculation in a similar way, by reversing\n * the equation.\n *\n * Interestingly, we can use these segments to represent the effect of\n * both BPM changes and STOP segments in the same array.\n * For example, a 150-BPM song with a 2-beat stop in the 32nd beat\n * can be represented like this:\n *\n * ```js\n * [ [0]: { t:  0.0,  x:  0,  dx: 2.5,  inclusive: true  },\n *   [1]: { t: 12.8,  x: 32,  dx: 0,    inclusive: true  },\n *   [2]: { t: 13.6,  x: 32,  dx: 2.5,  inclusive: false } ]\n * ```\n */\nvar Speedcore = /** @class */ (function () {\n    /**\n     * Constructs a new `Speedcore` from given segments.\n     */\n    function Speedcore(segments) {\n        segments.forEach(segment_1.Segment);\n        this._segments = segments;\n    }\n    Speedcore.prototype._reached = function (index, targetFn, position) {\n        if (index >= this._segments.length)\n            return false;\n        var segment = this._segments[index];\n        var target = targetFn(segment);\n        return segment.inclusive ? position >= target : position > target;\n    };\n    Speedcore.prototype._segmentAt = function (targetFn, position) {\n        for (var i = 0; i < this._segments.length; i++) {\n            if (!this._reached(i + 1, targetFn, position))\n                return this._segments[i];\n        }\n        throw new Error('Unable to find a segment matching a criteria (this should never happen)!');\n    };\n    Speedcore.prototype.segmentAtX = function (x) {\n        return this._segmentAt(X, x);\n    };\n    Speedcore.prototype.segmentAtT = function (t) {\n        return this._segmentAt(T, t);\n    };\n    /**\n     * Calculates the _t_, given _x_.\n     */\n    Speedcore.prototype.t = function (x) {\n        var segment = this.segmentAtX(x);\n        return segment.t + (x - segment.x) / (segment.dx || 1);\n    };\n    /**\n     * Calculates the _x_, given _t_.\n     * @param {number} t\n     */\n    Speedcore.prototype.x = function (t) {\n        var segment = this.segmentAtT(t);\n        return segment.x + (t - segment.t) * segment.dx;\n    };\n    /**\n     * Finds the _dx_, given _t_.\n     * @param {number} t\n     */\n    Speedcore.prototype.dx = function (t) {\n        var segment = this.segmentAtT(t);\n        return segment.dx;\n    };\n    return Speedcore;\n}());\nexports.Speedcore = Speedcore;\nvar T = function (segment) { return segment.t; };\nvar X = function (segment) { return segment.x; };\n//# sourceMappingURL=index.js.map","'use strict';\n\nmodule.exports = {\n  isString: function(arg) {\n    return typeof(arg) === 'string';\n  },\n  isObject: function(arg) {\n    return typeof(arg) === 'object' && arg !== null;\n  },\n  isNull: function(arg) {\n    return arg === null;\n  },\n  isNullOrUndefined: function(arg) {\n    return arg == null;\n  }\n};\n","/* @preserve\n * The MIT License (MIT)\n * \n * Copyright (c) 2013-2018 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n/**\n * bluebird build version 3.7.2\n * Features enabled: core, race, call_get, generators, map, nodeify, promisify, props, reduce, settle, some, using, timers, filter, any, each\n*/\n!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.Promise=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof _dereq_==\"function\"&&_dereq_;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof _dereq_==\"function\"&&_dereq_;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nvar SomePromiseArray = Promise._SomePromiseArray;\nfunction any(promises) {\n    var ret = new SomePromiseArray(promises);\n    var promise = ret.promise();\n    ret.setHowMany(1);\n    ret.setUnwrap();\n    ret.init();\n    return promise;\n}\n\nPromise.any = function (promises) {\n    return any(promises);\n};\n\nPromise.prototype.any = function () {\n    return any(this);\n};\n\n};\n\n},{}],2:[function(_dereq_,module,exports){\n\"use strict\";\nvar firstLineError;\ntry {throw new Error(); } catch (e) {firstLineError = e;}\nvar schedule = _dereq_(\"./schedule\");\nvar Queue = _dereq_(\"./queue\");\n\nfunction Async() {\n    this._customScheduler = false;\n    this._isTickUsed = false;\n    this._lateQueue = new Queue(16);\n    this._normalQueue = new Queue(16);\n    this._haveDrainedQueues = false;\n    var self = this;\n    this.drainQueues = function () {\n        self._drainQueues();\n    };\n    this._schedule = schedule;\n}\n\nAsync.prototype.setScheduler = function(fn) {\n    var prev = this._schedule;\n    this._schedule = fn;\n    this._customScheduler = true;\n    return prev;\n};\n\nAsync.prototype.hasCustomScheduler = function() {\n    return this._customScheduler;\n};\n\nAsync.prototype.haveItemsQueued = function () {\n    return this._isTickUsed || this._haveDrainedQueues;\n};\n\n\nAsync.prototype.fatalError = function(e, isNode) {\n    if (isNode) {\n        process.stderr.write(\"Fatal \" + (e instanceof Error ? e.stack : e) +\n            \"\\n\");\n        process.exit(2);\n    } else {\n        this.throwLater(e);\n    }\n};\n\nAsync.prototype.throwLater = function(fn, arg) {\n    if (arguments.length === 1) {\n        arg = fn;\n        fn = function () { throw arg; };\n    }\n    if (typeof setTimeout !== \"undefined\") {\n        setTimeout(function() {\n            fn(arg);\n        }, 0);\n    } else try {\n        this._schedule(function() {\n            fn(arg);\n        });\n    } catch (e) {\n        throw new Error(\"No async scheduler available\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n};\n\nfunction AsyncInvokeLater(fn, receiver, arg) {\n    this._lateQueue.push(fn, receiver, arg);\n    this._queueTick();\n}\n\nfunction AsyncInvoke(fn, receiver, arg) {\n    this._normalQueue.push(fn, receiver, arg);\n    this._queueTick();\n}\n\nfunction AsyncSettlePromises(promise) {\n    this._normalQueue._pushOne(promise);\n    this._queueTick();\n}\n\nAsync.prototype.invokeLater = AsyncInvokeLater;\nAsync.prototype.invoke = AsyncInvoke;\nAsync.prototype.settlePromises = AsyncSettlePromises;\n\n\nfunction _drainQueue(queue) {\n    while (queue.length() > 0) {\n        _drainQueueStep(queue);\n    }\n}\n\nfunction _drainQueueStep(queue) {\n    var fn = queue.shift();\n    if (typeof fn !== \"function\") {\n        fn._settlePromises();\n    } else {\n        var receiver = queue.shift();\n        var arg = queue.shift();\n        fn.call(receiver, arg);\n    }\n}\n\nAsync.prototype._drainQueues = function () {\n    _drainQueue(this._normalQueue);\n    this._reset();\n    this._haveDrainedQueues = true;\n    _drainQueue(this._lateQueue);\n};\n\nAsync.prototype._queueTick = function () {\n    if (!this._isTickUsed) {\n        this._isTickUsed = true;\n        this._schedule(this.drainQueues);\n    }\n};\n\nAsync.prototype._reset = function () {\n    this._isTickUsed = false;\n};\n\nmodule.exports = Async;\nmodule.exports.firstLineError = firstLineError;\n\n},{\"./queue\":26,\"./schedule\":29}],3:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, tryConvertToPromise, debug) {\nvar calledBind = false;\nvar rejectThis = function(_, e) {\n    this._reject(e);\n};\n\nvar targetRejected = function(e, context) {\n    context.promiseRejectionQueued = true;\n    context.bindingPromise._then(rejectThis, rejectThis, null, this, e);\n};\n\nvar bindingResolved = function(thisArg, context) {\n    if (((this._bitField & 50397184) === 0)) {\n        this._resolveCallback(context.target);\n    }\n};\n\nvar bindingRejected = function(e, context) {\n    if (!context.promiseRejectionQueued) this._reject(e);\n};\n\nPromise.prototype.bind = function (thisArg) {\n    if (!calledBind) {\n        calledBind = true;\n        Promise.prototype._propagateFrom = debug.propagateFromFunction();\n        Promise.prototype._boundValue = debug.boundValueFunction();\n    }\n    var maybePromise = tryConvertToPromise(thisArg);\n    var ret = new Promise(INTERNAL);\n    ret._propagateFrom(this, 1);\n    var target = this._target();\n    ret._setBoundTo(maybePromise);\n    if (maybePromise instanceof Promise) {\n        var context = {\n            promiseRejectionQueued: false,\n            promise: ret,\n            target: target,\n            bindingPromise: maybePromise\n        };\n        target._then(INTERNAL, targetRejected, undefined, ret, context);\n        maybePromise._then(\n            bindingResolved, bindingRejected, undefined, ret, context);\n        ret._setOnCancel(maybePromise);\n    } else {\n        ret._resolveCallback(target);\n    }\n    return ret;\n};\n\nPromise.prototype._setBoundTo = function (obj) {\n    if (obj !== undefined) {\n        this._bitField = this._bitField | 2097152;\n        this._boundTo = obj;\n    } else {\n        this._bitField = this._bitField & (~2097152);\n    }\n};\n\nPromise.prototype._isBound = function () {\n    return (this._bitField & 2097152) === 2097152;\n};\n\nPromise.bind = function (thisArg, value) {\n    return Promise.resolve(value).bind(thisArg);\n};\n};\n\n},{}],4:[function(_dereq_,module,exports){\n\"use strict\";\nvar old;\nif (typeof Promise !== \"undefined\") old = Promise;\nfunction noConflict() {\n    try { if (Promise === bluebird) Promise = old; }\n    catch (e) {}\n    return bluebird;\n}\nvar bluebird = _dereq_(\"./promise\")();\nbluebird.noConflict = noConflict;\nmodule.exports = bluebird;\n\n},{\"./promise\":22}],5:[function(_dereq_,module,exports){\n\"use strict\";\nvar cr = Object.create;\nif (cr) {\n    var callerCache = cr(null);\n    var getterCache = cr(null);\n    callerCache[\" size\"] = getterCache[\" size\"] = 0;\n}\n\nmodule.exports = function(Promise) {\nvar util = _dereq_(\"./util\");\nvar canEvaluate = util.canEvaluate;\nvar isIdentifier = util.isIdentifier;\n\nvar getMethodCaller;\nvar getGetter;\nif (!true) {\nvar makeMethodCaller = function (methodName) {\n    return new Function(\"ensureMethod\", \"                                    \\n\\\n        return function(obj) {                                               \\n\\\n            'use strict'                                                     \\n\\\n            var len = this.length;                                           \\n\\\n            ensureMethod(obj, 'methodName');                                 \\n\\\n            switch(len) {                                                    \\n\\\n                case 1: return obj.methodName(this[0]);                      \\n\\\n                case 2: return obj.methodName(this[0], this[1]);             \\n\\\n                case 3: return obj.methodName(this[0], this[1], this[2]);    \\n\\\n                case 0: return obj.methodName();                             \\n\\\n                default:                                                     \\n\\\n                    return obj.methodName.apply(obj, this);                  \\n\\\n            }                                                                \\n\\\n        };                                                                   \\n\\\n        \".replace(/methodName/g, methodName))(ensureMethod);\n};\n\nvar makeGetter = function (propertyName) {\n    return new Function(\"obj\", \"                                             \\n\\\n        'use strict';                                                        \\n\\\n        return obj.propertyName;                                             \\n\\\n        \".replace(\"propertyName\", propertyName));\n};\n\nvar getCompiled = function(name, compiler, cache) {\n    var ret = cache[name];\n    if (typeof ret !== \"function\") {\n        if (!isIdentifier(name)) {\n            return null;\n        }\n        ret = compiler(name);\n        cache[name] = ret;\n        cache[\" size\"]++;\n        if (cache[\" size\"] > 512) {\n            var keys = Object.keys(cache);\n            for (var i = 0; i < 256; ++i) delete cache[keys[i]];\n            cache[\" size\"] = keys.length - 256;\n        }\n    }\n    return ret;\n};\n\ngetMethodCaller = function(name) {\n    return getCompiled(name, makeMethodCaller, callerCache);\n};\n\ngetGetter = function(name) {\n    return getCompiled(name, makeGetter, getterCache);\n};\n}\n\nfunction ensureMethod(obj, methodName) {\n    var fn;\n    if (obj != null) fn = obj[methodName];\n    if (typeof fn !== \"function\") {\n        var message = \"Object \" + util.classString(obj) + \" has no method '\" +\n            util.toString(methodName) + \"'\";\n        throw new Promise.TypeError(message);\n    }\n    return fn;\n}\n\nfunction caller(obj) {\n    var methodName = this.pop();\n    var fn = ensureMethod(obj, methodName);\n    return fn.apply(obj, this);\n}\nPromise.prototype.call = function (methodName) {\n    var args = [].slice.call(arguments, 1);;\n    if (!true) {\n        if (canEvaluate) {\n            var maybeCaller = getMethodCaller(methodName);\n            if (maybeCaller !== null) {\n                return this._then(\n                    maybeCaller, undefined, undefined, args, undefined);\n            }\n        }\n    }\n    args.push(methodName);\n    return this._then(caller, undefined, undefined, args, undefined);\n};\n\nfunction namedGetter(obj) {\n    return obj[this];\n}\nfunction indexedGetter(obj) {\n    var index = +this;\n    if (index < 0) index = Math.max(0, index + obj.length);\n    return obj[index];\n}\nPromise.prototype.get = function (propertyName) {\n    var isIndex = (typeof propertyName === \"number\");\n    var getter;\n    if (!isIndex) {\n        if (canEvaluate) {\n            var maybeGetter = getGetter(propertyName);\n            getter = maybeGetter !== null ? maybeGetter : namedGetter;\n        } else {\n            getter = namedGetter;\n        }\n    } else {\n        getter = indexedGetter;\n    }\n    return this._then(getter, undefined, undefined, propertyName, undefined);\n};\n};\n\n},{\"./util\":36}],6:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, PromiseArray, apiRejection, debug) {\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar async = Promise._async;\n\nPromise.prototype[\"break\"] = Promise.prototype.cancel = function() {\n    if (!debug.cancellation()) return this._warn(\"cancellation is disabled\");\n\n    var promise = this;\n    var child = promise;\n    while (promise._isCancellable()) {\n        if (!promise._cancelBy(child)) {\n            if (child._isFollowing()) {\n                child._followee().cancel();\n            } else {\n                child._cancelBranched();\n            }\n            break;\n        }\n\n        var parent = promise._cancellationParent;\n        if (parent == null || !parent._isCancellable()) {\n            if (promise._isFollowing()) {\n                promise._followee().cancel();\n            } else {\n                promise._cancelBranched();\n            }\n            break;\n        } else {\n            if (promise._isFollowing()) promise._followee().cancel();\n            promise._setWillBeCancelled();\n            child = promise;\n            promise = parent;\n        }\n    }\n};\n\nPromise.prototype._branchHasCancelled = function() {\n    this._branchesRemainingToCancel--;\n};\n\nPromise.prototype._enoughBranchesHaveCancelled = function() {\n    return this._branchesRemainingToCancel === undefined ||\n           this._branchesRemainingToCancel <= 0;\n};\n\nPromise.prototype._cancelBy = function(canceller) {\n    if (canceller === this) {\n        this._branchesRemainingToCancel = 0;\n        this._invokeOnCancel();\n        return true;\n    } else {\n        this._branchHasCancelled();\n        if (this._enoughBranchesHaveCancelled()) {\n            this._invokeOnCancel();\n            return true;\n        }\n    }\n    return false;\n};\n\nPromise.prototype._cancelBranched = function() {\n    if (this._enoughBranchesHaveCancelled()) {\n        this._cancel();\n    }\n};\n\nPromise.prototype._cancel = function() {\n    if (!this._isCancellable()) return;\n    this._setCancelled();\n    async.invoke(this._cancelPromises, this, undefined);\n};\n\nPromise.prototype._cancelPromises = function() {\n    if (this._length() > 0) this._settlePromises();\n};\n\nPromise.prototype._unsetOnCancel = function() {\n    this._onCancelField = undefined;\n};\n\nPromise.prototype._isCancellable = function() {\n    return this.isPending() && !this._isCancelled();\n};\n\nPromise.prototype.isCancellable = function() {\n    return this.isPending() && !this.isCancelled();\n};\n\nPromise.prototype._doInvokeOnCancel = function(onCancelCallback, internalOnly) {\n    if (util.isArray(onCancelCallback)) {\n        for (var i = 0; i < onCancelCallback.length; ++i) {\n            this._doInvokeOnCancel(onCancelCallback[i], internalOnly);\n        }\n    } else if (onCancelCallback !== undefined) {\n        if (typeof onCancelCallback === \"function\") {\n            if (!internalOnly) {\n                var e = tryCatch(onCancelCallback).call(this._boundValue());\n                if (e === errorObj) {\n                    this._attachExtraTrace(e.e);\n                    async.throwLater(e.e);\n                }\n            }\n        } else {\n            onCancelCallback._resultCancelled(this);\n        }\n    }\n};\n\nPromise.prototype._invokeOnCancel = function() {\n    var onCancelCallback = this._onCancel();\n    this._unsetOnCancel();\n    async.invoke(this._doInvokeOnCancel, this, onCancelCallback);\n};\n\nPromise.prototype._invokeInternalOnCancel = function() {\n    if (this._isCancellable()) {\n        this._doInvokeOnCancel(this._onCancel(), true);\n        this._unsetOnCancel();\n    }\n};\n\nPromise.prototype._resultCancelled = function() {\n    this.cancel();\n};\n\n};\n\n},{\"./util\":36}],7:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(NEXT_FILTER) {\nvar util = _dereq_(\"./util\");\nvar getKeys = _dereq_(\"./es5\").keys;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\n\nfunction catchFilter(instances, cb, promise) {\n    return function(e) {\n        var boundTo = promise._boundValue();\n        predicateLoop: for (var i = 0; i < instances.length; ++i) {\n            var item = instances[i];\n\n            if (item === Error ||\n                (item != null && item.prototype instanceof Error)) {\n                if (e instanceof item) {\n                    return tryCatch(cb).call(boundTo, e);\n                }\n            } else if (typeof item === \"function\") {\n                var matchesPredicate = tryCatch(item).call(boundTo, e);\n                if (matchesPredicate === errorObj) {\n                    return matchesPredicate;\n                } else if (matchesPredicate) {\n                    return tryCatch(cb).call(boundTo, e);\n                }\n            } else if (util.isObject(e)) {\n                var keys = getKeys(item);\n                for (var j = 0; j < keys.length; ++j) {\n                    var key = keys[j];\n                    if (item[key] != e[key]) {\n                        continue predicateLoop;\n                    }\n                }\n                return tryCatch(cb).call(boundTo, e);\n            }\n        }\n        return NEXT_FILTER;\n    };\n}\n\nreturn catchFilter;\n};\n\n},{\"./es5\":13,\"./util\":36}],8:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nvar longStackTraces = false;\nvar contextStack = [];\n\nPromise.prototype._promiseCreated = function() {};\nPromise.prototype._pushContext = function() {};\nPromise.prototype._popContext = function() {return null;};\nPromise._peekContext = Promise.prototype._peekContext = function() {};\n\nfunction Context() {\n    this._trace = new Context.CapturedTrace(peekContext());\n}\nContext.prototype._pushContext = function () {\n    if (this._trace !== undefined) {\n        this._trace._promiseCreated = null;\n        contextStack.push(this._trace);\n    }\n};\n\nContext.prototype._popContext = function () {\n    if (this._trace !== undefined) {\n        var trace = contextStack.pop();\n        var ret = trace._promiseCreated;\n        trace._promiseCreated = null;\n        return ret;\n    }\n    return null;\n};\n\nfunction createContext() {\n    if (longStackTraces) return new Context();\n}\n\nfunction peekContext() {\n    var lastIndex = contextStack.length - 1;\n    if (lastIndex >= 0) {\n        return contextStack[lastIndex];\n    }\n    return undefined;\n}\nContext.CapturedTrace = null;\nContext.create = createContext;\nContext.deactivateLongStackTraces = function() {};\nContext.activateLongStackTraces = function() {\n    var Promise_pushContext = Promise.prototype._pushContext;\n    var Promise_popContext = Promise.prototype._popContext;\n    var Promise_PeekContext = Promise._peekContext;\n    var Promise_peekContext = Promise.prototype._peekContext;\n    var Promise_promiseCreated = Promise.prototype._promiseCreated;\n    Context.deactivateLongStackTraces = function() {\n        Promise.prototype._pushContext = Promise_pushContext;\n        Promise.prototype._popContext = Promise_popContext;\n        Promise._peekContext = Promise_PeekContext;\n        Promise.prototype._peekContext = Promise_peekContext;\n        Promise.prototype._promiseCreated = Promise_promiseCreated;\n        longStackTraces = false;\n    };\n    longStackTraces = true;\n    Promise.prototype._pushContext = Context.prototype._pushContext;\n    Promise.prototype._popContext = Context.prototype._popContext;\n    Promise._peekContext = Promise.prototype._peekContext = peekContext;\n    Promise.prototype._promiseCreated = function() {\n        var ctx = this._peekContext();\n        if (ctx && ctx._promiseCreated == null) ctx._promiseCreated = this;\n    };\n};\nreturn Context;\n};\n\n},{}],9:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, Context,\n    enableAsyncHooks, disableAsyncHooks) {\nvar async = Promise._async;\nvar Warning = _dereq_(\"./errors\").Warning;\nvar util = _dereq_(\"./util\");\nvar es5 = _dereq_(\"./es5\");\nvar canAttachTrace = util.canAttachTrace;\nvar unhandledRejectionHandled;\nvar possiblyUnhandledRejection;\nvar bluebirdFramePattern =\n    /[\\\\\\/]bluebird[\\\\\\/]js[\\\\\\/](release|debug|instrumented)/;\nvar nodeFramePattern = /\\((?:timers\\.js):\\d+:\\d+\\)/;\nvar parseLinePattern = /[\\/<\\(](.+?):(\\d+):(\\d+)\\)?\\s*$/;\nvar stackFramePattern = null;\nvar formatStack = null;\nvar indentStackFrames = false;\nvar printWarning;\nvar debugging = !!(util.env(\"BLUEBIRD_DEBUG\") != 0 &&\n                        (true ||\n                         util.env(\"BLUEBIRD_DEBUG\") ||\n                         util.env(\"NODE_ENV\") === \"development\"));\n\nvar warnings = !!(util.env(\"BLUEBIRD_WARNINGS\") != 0 &&\n    (debugging || util.env(\"BLUEBIRD_WARNINGS\")));\n\nvar longStackTraces = !!(util.env(\"BLUEBIRD_LONG_STACK_TRACES\") != 0 &&\n    (debugging || util.env(\"BLUEBIRD_LONG_STACK_TRACES\")));\n\nvar wForgottenReturn = util.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\") != 0 &&\n    (warnings || !!util.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\"));\n\nvar deferUnhandledRejectionCheck;\n(function() {\n    var promises = [];\n\n    function unhandledRejectionCheck() {\n        for (var i = 0; i < promises.length; ++i) {\n            promises[i]._notifyUnhandledRejection();\n        }\n        unhandledRejectionClear();\n    }\n\n    function unhandledRejectionClear() {\n        promises.length = 0;\n    }\n\n    deferUnhandledRejectionCheck = function(promise) {\n        promises.push(promise);\n        setTimeout(unhandledRejectionCheck, 1);\n    };\n\n    es5.defineProperty(Promise, \"_unhandledRejectionCheck\", {\n        value: unhandledRejectionCheck\n    });\n    es5.defineProperty(Promise, \"_unhandledRejectionClear\", {\n        value: unhandledRejectionClear\n    });\n})();\n\nPromise.prototype.suppressUnhandledRejections = function() {\n    var target = this._target();\n    target._bitField = ((target._bitField & (~1048576)) |\n                      524288);\n};\n\nPromise.prototype._ensurePossibleRejectionHandled = function () {\n    if ((this._bitField & 524288) !== 0) return;\n    this._setRejectionIsUnhandled();\n    deferUnhandledRejectionCheck(this);\n};\n\nPromise.prototype._notifyUnhandledRejectionIsHandled = function () {\n    fireRejectionEvent(\"rejectionHandled\",\n                                  unhandledRejectionHandled, undefined, this);\n};\n\nPromise.prototype._setReturnedNonUndefined = function() {\n    this._bitField = this._bitField | 268435456;\n};\n\nPromise.prototype._returnedNonUndefined = function() {\n    return (this._bitField & 268435456) !== 0;\n};\n\nPromise.prototype._notifyUnhandledRejection = function () {\n    if (this._isRejectionUnhandled()) {\n        var reason = this._settledValue();\n        this._setUnhandledRejectionIsNotified();\n        fireRejectionEvent(\"unhandledRejection\",\n                                      possiblyUnhandledRejection, reason, this);\n    }\n};\n\nPromise.prototype._setUnhandledRejectionIsNotified = function () {\n    this._bitField = this._bitField | 262144;\n};\n\nPromise.prototype._unsetUnhandledRejectionIsNotified = function () {\n    this._bitField = this._bitField & (~262144);\n};\n\nPromise.prototype._isUnhandledRejectionNotified = function () {\n    return (this._bitField & 262144) > 0;\n};\n\nPromise.prototype._setRejectionIsUnhandled = function () {\n    this._bitField = this._bitField | 1048576;\n};\n\nPromise.prototype._unsetRejectionIsUnhandled = function () {\n    this._bitField = this._bitField & (~1048576);\n    if (this._isUnhandledRejectionNotified()) {\n        this._unsetUnhandledRejectionIsNotified();\n        this._notifyUnhandledRejectionIsHandled();\n    }\n};\n\nPromise.prototype._isRejectionUnhandled = function () {\n    return (this._bitField & 1048576) > 0;\n};\n\nPromise.prototype._warn = function(message, shouldUseOwnTrace, promise) {\n    return warn(message, shouldUseOwnTrace, promise || this);\n};\n\nPromise.onPossiblyUnhandledRejection = function (fn) {\n    var context = Promise._getContext();\n    possiblyUnhandledRejection = util.contextBind(context, fn);\n};\n\nPromise.onUnhandledRejectionHandled = function (fn) {\n    var context = Promise._getContext();\n    unhandledRejectionHandled = util.contextBind(context, fn);\n};\n\nvar disableLongStackTraces = function() {};\nPromise.longStackTraces = function () {\n    if (async.haveItemsQueued() && !config.longStackTraces) {\n        throw new Error(\"cannot enable long stack traces after promises have been created\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    if (!config.longStackTraces && longStackTracesIsSupported()) {\n        var Promise_captureStackTrace = Promise.prototype._captureStackTrace;\n        var Promise_attachExtraTrace = Promise.prototype._attachExtraTrace;\n        var Promise_dereferenceTrace = Promise.prototype._dereferenceTrace;\n        config.longStackTraces = true;\n        disableLongStackTraces = function() {\n            if (async.haveItemsQueued() && !config.longStackTraces) {\n                throw new Error(\"cannot enable long stack traces after promises have been created\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n            }\n            Promise.prototype._captureStackTrace = Promise_captureStackTrace;\n            Promise.prototype._attachExtraTrace = Promise_attachExtraTrace;\n            Promise.prototype._dereferenceTrace = Promise_dereferenceTrace;\n            Context.deactivateLongStackTraces();\n            config.longStackTraces = false;\n        };\n        Promise.prototype._captureStackTrace = longStackTracesCaptureStackTrace;\n        Promise.prototype._attachExtraTrace = longStackTracesAttachExtraTrace;\n        Promise.prototype._dereferenceTrace = longStackTracesDereferenceTrace;\n        Context.activateLongStackTraces();\n    }\n};\n\nPromise.hasLongStackTraces = function () {\n    return config.longStackTraces && longStackTracesIsSupported();\n};\n\n\nvar legacyHandlers = {\n    unhandledrejection: {\n        before: function() {\n            var ret = util.global.onunhandledrejection;\n            util.global.onunhandledrejection = null;\n            return ret;\n        },\n        after: function(fn) {\n            util.global.onunhandledrejection = fn;\n        }\n    },\n    rejectionhandled: {\n        before: function() {\n            var ret = util.global.onrejectionhandled;\n            util.global.onrejectionhandled = null;\n            return ret;\n        },\n        after: function(fn) {\n            util.global.onrejectionhandled = fn;\n        }\n    }\n};\n\nvar fireDomEvent = (function() {\n    var dispatch = function(legacy, e) {\n        if (legacy) {\n            var fn;\n            try {\n                fn = legacy.before();\n                return !util.global.dispatchEvent(e);\n            } finally {\n                legacy.after(fn);\n            }\n        } else {\n            return !util.global.dispatchEvent(e);\n        }\n    };\n    try {\n        if (typeof CustomEvent === \"function\") {\n            var event = new CustomEvent(\"CustomEvent\");\n            util.global.dispatchEvent(event);\n            return function(name, event) {\n                name = name.toLowerCase();\n                var eventData = {\n                    detail: event,\n                    cancelable: true\n                };\n                var domEvent = new CustomEvent(name, eventData);\n                es5.defineProperty(\n                    domEvent, \"promise\", {value: event.promise});\n                es5.defineProperty(\n                    domEvent, \"reason\", {value: event.reason});\n\n                return dispatch(legacyHandlers[name], domEvent);\n            };\n        } else if (typeof Event === \"function\") {\n            var event = new Event(\"CustomEvent\");\n            util.global.dispatchEvent(event);\n            return function(name, event) {\n                name = name.toLowerCase();\n                var domEvent = new Event(name, {\n                    cancelable: true\n                });\n                domEvent.detail = event;\n                es5.defineProperty(domEvent, \"promise\", {value: event.promise});\n                es5.defineProperty(domEvent, \"reason\", {value: event.reason});\n                return dispatch(legacyHandlers[name], domEvent);\n            };\n        } else {\n            var event = document.createEvent(\"CustomEvent\");\n            event.initCustomEvent(\"testingtheevent\", false, true, {});\n            util.global.dispatchEvent(event);\n            return function(name, event) {\n                name = name.toLowerCase();\n                var domEvent = document.createEvent(\"CustomEvent\");\n                domEvent.initCustomEvent(name, false, true,\n                    event);\n                return dispatch(legacyHandlers[name], domEvent);\n            };\n        }\n    } catch (e) {}\n    return function() {\n        return false;\n    };\n})();\n\nvar fireGlobalEvent = (function() {\n    if (util.isNode) {\n        return function() {\n            return process.emit.apply(process, arguments);\n        };\n    } else {\n        if (!util.global) {\n            return function() {\n                return false;\n            };\n        }\n        return function(name) {\n            var methodName = \"on\" + name.toLowerCase();\n            var method = util.global[methodName];\n            if (!method) return false;\n            method.apply(util.global, [].slice.call(arguments, 1));\n            return true;\n        };\n    }\n})();\n\nfunction generatePromiseLifecycleEventObject(name, promise) {\n    return {promise: promise};\n}\n\nvar eventToObjectGenerator = {\n    promiseCreated: generatePromiseLifecycleEventObject,\n    promiseFulfilled: generatePromiseLifecycleEventObject,\n    promiseRejected: generatePromiseLifecycleEventObject,\n    promiseResolved: generatePromiseLifecycleEventObject,\n    promiseCancelled: generatePromiseLifecycleEventObject,\n    promiseChained: function(name, promise, child) {\n        return {promise: promise, child: child};\n    },\n    warning: function(name, warning) {\n        return {warning: warning};\n    },\n    unhandledRejection: function (name, reason, promise) {\n        return {reason: reason, promise: promise};\n    },\n    rejectionHandled: generatePromiseLifecycleEventObject\n};\n\nvar activeFireEvent = function (name) {\n    var globalEventFired = false;\n    try {\n        globalEventFired = fireGlobalEvent.apply(null, arguments);\n    } catch (e) {\n        async.throwLater(e);\n        globalEventFired = true;\n    }\n\n    var domEventFired = false;\n    try {\n        domEventFired = fireDomEvent(name,\n                    eventToObjectGenerator[name].apply(null, arguments));\n    } catch (e) {\n        async.throwLater(e);\n        domEventFired = true;\n    }\n\n    return domEventFired || globalEventFired;\n};\n\nPromise.config = function(opts) {\n    opts = Object(opts);\n    if (\"longStackTraces\" in opts) {\n        if (opts.longStackTraces) {\n            Promise.longStackTraces();\n        } else if (!opts.longStackTraces && Promise.hasLongStackTraces()) {\n            disableLongStackTraces();\n        }\n    }\n    if (\"warnings\" in opts) {\n        var warningsOption = opts.warnings;\n        config.warnings = !!warningsOption;\n        wForgottenReturn = config.warnings;\n\n        if (util.isObject(warningsOption)) {\n            if (\"wForgottenReturn\" in warningsOption) {\n                wForgottenReturn = !!warningsOption.wForgottenReturn;\n            }\n        }\n    }\n    if (\"cancellation\" in opts && opts.cancellation && !config.cancellation) {\n        if (async.haveItemsQueued()) {\n            throw new Error(\n                \"cannot enable cancellation after promises are in use\");\n        }\n        Promise.prototype._clearCancellationData =\n            cancellationClearCancellationData;\n        Promise.prototype._propagateFrom = cancellationPropagateFrom;\n        Promise.prototype._onCancel = cancellationOnCancel;\n        Promise.prototype._setOnCancel = cancellationSetOnCancel;\n        Promise.prototype._attachCancellationCallback =\n            cancellationAttachCancellationCallback;\n        Promise.prototype._execute = cancellationExecute;\n        propagateFromFunction = cancellationPropagateFrom;\n        config.cancellation = true;\n    }\n    if (\"monitoring\" in opts) {\n        if (opts.monitoring && !config.monitoring) {\n            config.monitoring = true;\n            Promise.prototype._fireEvent = activeFireEvent;\n        } else if (!opts.monitoring && config.monitoring) {\n            config.monitoring = false;\n            Promise.prototype._fireEvent = defaultFireEvent;\n        }\n    }\n    if (\"asyncHooks\" in opts && util.nodeSupportsAsyncResource) {\n        var prev = config.asyncHooks;\n        var cur = !!opts.asyncHooks;\n        if (prev !== cur) {\n            config.asyncHooks = cur;\n            if (cur) {\n                enableAsyncHooks();\n            } else {\n                disableAsyncHooks();\n            }\n        }\n    }\n    return Promise;\n};\n\nfunction defaultFireEvent() { return false; }\n\nPromise.prototype._fireEvent = defaultFireEvent;\nPromise.prototype._execute = function(executor, resolve, reject) {\n    try {\n        executor(resolve, reject);\n    } catch (e) {\n        return e;\n    }\n};\nPromise.prototype._onCancel = function () {};\nPromise.prototype._setOnCancel = function (handler) { ; };\nPromise.prototype._attachCancellationCallback = function(onCancel) {\n    ;\n};\nPromise.prototype._captureStackTrace = function () {};\nPromise.prototype._attachExtraTrace = function () {};\nPromise.prototype._dereferenceTrace = function () {};\nPromise.prototype._clearCancellationData = function() {};\nPromise.prototype._propagateFrom = function (parent, flags) {\n    ;\n    ;\n};\n\nfunction cancellationExecute(executor, resolve, reject) {\n    var promise = this;\n    try {\n        executor(resolve, reject, function(onCancel) {\n            if (typeof onCancel !== \"function\") {\n                throw new TypeError(\"onCancel must be a function, got: \" +\n                                    util.toString(onCancel));\n            }\n            promise._attachCancellationCallback(onCancel);\n        });\n    } catch (e) {\n        return e;\n    }\n}\n\nfunction cancellationAttachCancellationCallback(onCancel) {\n    if (!this._isCancellable()) return this;\n\n    var previousOnCancel = this._onCancel();\n    if (previousOnCancel !== undefined) {\n        if (util.isArray(previousOnCancel)) {\n            previousOnCancel.push(onCancel);\n        } else {\n            this._setOnCancel([previousOnCancel, onCancel]);\n        }\n    } else {\n        this._setOnCancel(onCancel);\n    }\n}\n\nfunction cancellationOnCancel() {\n    return this._onCancelField;\n}\n\nfunction cancellationSetOnCancel(onCancel) {\n    this._onCancelField = onCancel;\n}\n\nfunction cancellationClearCancellationData() {\n    this._cancellationParent = undefined;\n    this._onCancelField = undefined;\n}\n\nfunction cancellationPropagateFrom(parent, flags) {\n    if ((flags & 1) !== 0) {\n        this._cancellationParent = parent;\n        var branchesRemainingToCancel = parent._branchesRemainingToCancel;\n        if (branchesRemainingToCancel === undefined) {\n            branchesRemainingToCancel = 0;\n        }\n        parent._branchesRemainingToCancel = branchesRemainingToCancel + 1;\n    }\n    if ((flags & 2) !== 0 && parent._isBound()) {\n        this._setBoundTo(parent._boundTo);\n    }\n}\n\nfunction bindingPropagateFrom(parent, flags) {\n    if ((flags & 2) !== 0 && parent._isBound()) {\n        this._setBoundTo(parent._boundTo);\n    }\n}\nvar propagateFromFunction = bindingPropagateFrom;\n\nfunction boundValueFunction() {\n    var ret = this._boundTo;\n    if (ret !== undefined) {\n        if (ret instanceof Promise) {\n            if (ret.isFulfilled()) {\n                return ret.value();\n            } else {\n                return undefined;\n            }\n        }\n    }\n    return ret;\n}\n\nfunction longStackTracesCaptureStackTrace() {\n    this._trace = new CapturedTrace(this._peekContext());\n}\n\nfunction longStackTracesAttachExtraTrace(error, ignoreSelf) {\n    if (canAttachTrace(error)) {\n        var trace = this._trace;\n        if (trace !== undefined) {\n            if (ignoreSelf) trace = trace._parent;\n        }\n        if (trace !== undefined) {\n            trace.attachExtraTrace(error);\n        } else if (!error.__stackCleaned__) {\n            var parsed = parseStackAndMessage(error);\n            util.notEnumerableProp(error, \"stack\",\n                parsed.message + \"\\n\" + parsed.stack.join(\"\\n\"));\n            util.notEnumerableProp(error, \"__stackCleaned__\", true);\n        }\n    }\n}\n\nfunction longStackTracesDereferenceTrace() {\n    this._trace = undefined;\n}\n\nfunction checkForgottenReturns(returnValue, promiseCreated, name, promise,\n                               parent) {\n    if (returnValue === undefined && promiseCreated !== null &&\n        wForgottenReturn) {\n        if (parent !== undefined && parent._returnedNonUndefined()) return;\n        if ((promise._bitField & 65535) === 0) return;\n\n        if (name) name = name + \" \";\n        var handlerLine = \"\";\n        var creatorLine = \"\";\n        if (promiseCreated._trace) {\n            var traceLines = promiseCreated._trace.stack.split(\"\\n\");\n            var stack = cleanStack(traceLines);\n            for (var i = stack.length - 1; i >= 0; --i) {\n                var line = stack[i];\n                if (!nodeFramePattern.test(line)) {\n                    var lineMatches = line.match(parseLinePattern);\n                    if (lineMatches) {\n                        handlerLine  = \"at \" + lineMatches[1] +\n                            \":\" + lineMatches[2] + \":\" + lineMatches[3] + \" \";\n                    }\n                    break;\n                }\n            }\n\n            if (stack.length > 0) {\n                var firstUserLine = stack[0];\n                for (var i = 0; i < traceLines.length; ++i) {\n\n                    if (traceLines[i] === firstUserLine) {\n                        if (i > 0) {\n                            creatorLine = \"\\n\" + traceLines[i - 1];\n                        }\n                        break;\n                    }\n                }\n\n            }\n        }\n        var msg = \"a promise was created in a \" + name +\n            \"handler \" + handlerLine + \"but was not returned from it, \" +\n            \"see http://goo.gl/rRqMUw\" +\n            creatorLine;\n        promise._warn(msg, true, promiseCreated);\n    }\n}\n\nfunction deprecated(name, replacement) {\n    var message = name +\n        \" is deprecated and will be removed in a future version.\";\n    if (replacement) message += \" Use \" + replacement + \" instead.\";\n    return warn(message);\n}\n\nfunction warn(message, shouldUseOwnTrace, promise) {\n    if (!config.warnings) return;\n    var warning = new Warning(message);\n    var ctx;\n    if (shouldUseOwnTrace) {\n        promise._attachExtraTrace(warning);\n    } else if (config.longStackTraces && (ctx = Promise._peekContext())) {\n        ctx.attachExtraTrace(warning);\n    } else {\n        var parsed = parseStackAndMessage(warning);\n        warning.stack = parsed.message + \"\\n\" + parsed.stack.join(\"\\n\");\n    }\n\n    if (!activeFireEvent(\"warning\", warning)) {\n        formatAndLogError(warning, \"\", true);\n    }\n}\n\nfunction reconstructStack(message, stacks) {\n    for (var i = 0; i < stacks.length - 1; ++i) {\n        stacks[i].push(\"From previous event:\");\n        stacks[i] = stacks[i].join(\"\\n\");\n    }\n    if (i < stacks.length) {\n        stacks[i] = stacks[i].join(\"\\n\");\n    }\n    return message + \"\\n\" + stacks.join(\"\\n\");\n}\n\nfunction removeDuplicateOrEmptyJumps(stacks) {\n    for (var i = 0; i < stacks.length; ++i) {\n        if (stacks[i].length === 0 ||\n            ((i + 1 < stacks.length) && stacks[i][0] === stacks[i+1][0])) {\n            stacks.splice(i, 1);\n            i--;\n        }\n    }\n}\n\nfunction removeCommonRoots(stacks) {\n    var current = stacks[0];\n    for (var i = 1; i < stacks.length; ++i) {\n        var prev = stacks[i];\n        var currentLastIndex = current.length - 1;\n        var currentLastLine = current[currentLastIndex];\n        var commonRootMeetPoint = -1;\n\n        for (var j = prev.length - 1; j >= 0; --j) {\n            if (prev[j] === currentLastLine) {\n                commonRootMeetPoint = j;\n                break;\n            }\n        }\n\n        for (var j = commonRootMeetPoint; j >= 0; --j) {\n            var line = prev[j];\n            if (current[currentLastIndex] === line) {\n                current.pop();\n                currentLastIndex--;\n            } else {\n                break;\n            }\n        }\n        current = prev;\n    }\n}\n\nfunction cleanStack(stack) {\n    var ret = [];\n    for (var i = 0; i < stack.length; ++i) {\n        var line = stack[i];\n        var isTraceLine = \"    (No stack trace)\" === line ||\n            stackFramePattern.test(line);\n        var isInternalFrame = isTraceLine && shouldIgnore(line);\n        if (isTraceLine && !isInternalFrame) {\n            if (indentStackFrames && line.charAt(0) !== \" \") {\n                line = \"    \" + line;\n            }\n            ret.push(line);\n        }\n    }\n    return ret;\n}\n\nfunction stackFramesAsArray(error) {\n    var stack = error.stack.replace(/\\s+$/g, \"\").split(\"\\n\");\n    for (var i = 0; i < stack.length; ++i) {\n        var line = stack[i];\n        if (\"    (No stack trace)\" === line || stackFramePattern.test(line)) {\n            break;\n        }\n    }\n    if (i > 0 && error.name != \"SyntaxError\") {\n        stack = stack.slice(i);\n    }\n    return stack;\n}\n\nfunction parseStackAndMessage(error) {\n    var stack = error.stack;\n    var message = error.toString();\n    stack = typeof stack === \"string\" && stack.length > 0\n                ? stackFramesAsArray(error) : [\"    (No stack trace)\"];\n    return {\n        message: message,\n        stack: error.name == \"SyntaxError\" ? stack : cleanStack(stack)\n    };\n}\n\nfunction formatAndLogError(error, title, isSoft) {\n    if (typeof console !== \"undefined\") {\n        var message;\n        if (util.isObject(error)) {\n            var stack = error.stack;\n            message = title + formatStack(stack, error);\n        } else {\n            message = title + String(error);\n        }\n        if (typeof printWarning === \"function\") {\n            printWarning(message, isSoft);\n        } else if (typeof console.log === \"function\" ||\n            typeof console.log === \"object\") {\n            console.log(message);\n        }\n    }\n}\n\nfunction fireRejectionEvent(name, localHandler, reason, promise) {\n    var localEventFired = false;\n    try {\n        if (typeof localHandler === \"function\") {\n            localEventFired = true;\n            if (name === \"rejectionHandled\") {\n                localHandler(promise);\n            } else {\n                localHandler(reason, promise);\n            }\n        }\n    } catch (e) {\n        async.throwLater(e);\n    }\n\n    if (name === \"unhandledRejection\") {\n        if (!activeFireEvent(name, reason, promise) && !localEventFired) {\n            formatAndLogError(reason, \"Unhandled rejection \");\n        }\n    } else {\n        activeFireEvent(name, promise);\n    }\n}\n\nfunction formatNonError(obj) {\n    var str;\n    if (typeof obj === \"function\") {\n        str = \"[function \" +\n            (obj.name || \"anonymous\") +\n            \"]\";\n    } else {\n        str = obj && typeof obj.toString === \"function\"\n            ? obj.toString() : util.toString(obj);\n        var ruselessToString = /\\[object [a-zA-Z0-9$_]+\\]/;\n        if (ruselessToString.test(str)) {\n            try {\n                var newStr = JSON.stringify(obj);\n                str = newStr;\n            }\n            catch(e) {\n\n            }\n        }\n        if (str.length === 0) {\n            str = \"(empty array)\";\n        }\n    }\n    return (\"(<\" + snip(str) + \">, no stack trace)\");\n}\n\nfunction snip(str) {\n    var maxChars = 41;\n    if (str.length < maxChars) {\n        return str;\n    }\n    return str.substr(0, maxChars - 3) + \"...\";\n}\n\nfunction longStackTracesIsSupported() {\n    return typeof captureStackTrace === \"function\";\n}\n\nvar shouldIgnore = function() { return false; };\nvar parseLineInfoRegex = /[\\/<\\(]([^:\\/]+):(\\d+):(?:\\d+)\\)?\\s*$/;\nfunction parseLineInfo(line) {\n    var matches = line.match(parseLineInfoRegex);\n    if (matches) {\n        return {\n            fileName: matches[1],\n            line: parseInt(matches[2], 10)\n        };\n    }\n}\n\nfunction setBounds(firstLineError, lastLineError) {\n    if (!longStackTracesIsSupported()) return;\n    var firstStackLines = (firstLineError.stack || \"\").split(\"\\n\");\n    var lastStackLines = (lastLineError.stack || \"\").split(\"\\n\");\n    var firstIndex = -1;\n    var lastIndex = -1;\n    var firstFileName;\n    var lastFileName;\n    for (var i = 0; i < firstStackLines.length; ++i) {\n        var result = parseLineInfo(firstStackLines[i]);\n        if (result) {\n            firstFileName = result.fileName;\n            firstIndex = result.line;\n            break;\n        }\n    }\n    for (var i = 0; i < lastStackLines.length; ++i) {\n        var result = parseLineInfo(lastStackLines[i]);\n        if (result) {\n            lastFileName = result.fileName;\n            lastIndex = result.line;\n            break;\n        }\n    }\n    if (firstIndex < 0 || lastIndex < 0 || !firstFileName || !lastFileName ||\n        firstFileName !== lastFileName || firstIndex >= lastIndex) {\n        return;\n    }\n\n    shouldIgnore = function(line) {\n        if (bluebirdFramePattern.test(line)) return true;\n        var info = parseLineInfo(line);\n        if (info) {\n            if (info.fileName === firstFileName &&\n                (firstIndex <= info.line && info.line <= lastIndex)) {\n                return true;\n            }\n        }\n        return false;\n    };\n}\n\nfunction CapturedTrace(parent) {\n    this._parent = parent;\n    this._promisesCreated = 0;\n    var length = this._length = 1 + (parent === undefined ? 0 : parent._length);\n    captureStackTrace(this, CapturedTrace);\n    if (length > 32) this.uncycle();\n}\nutil.inherits(CapturedTrace, Error);\nContext.CapturedTrace = CapturedTrace;\n\nCapturedTrace.prototype.uncycle = function() {\n    var length = this._length;\n    if (length < 2) return;\n    var nodes = [];\n    var stackToIndex = {};\n\n    for (var i = 0, node = this; node !== undefined; ++i) {\n        nodes.push(node);\n        node = node._parent;\n    }\n    length = this._length = i;\n    for (var i = length - 1; i >= 0; --i) {\n        var stack = nodes[i].stack;\n        if (stackToIndex[stack] === undefined) {\n            stackToIndex[stack] = i;\n        }\n    }\n    for (var i = 0; i < length; ++i) {\n        var currentStack = nodes[i].stack;\n        var index = stackToIndex[currentStack];\n        if (index !== undefined && index !== i) {\n            if (index > 0) {\n                nodes[index - 1]._parent = undefined;\n                nodes[index - 1]._length = 1;\n            }\n            nodes[i]._parent = undefined;\n            nodes[i]._length = 1;\n            var cycleEdgeNode = i > 0 ? nodes[i - 1] : this;\n\n            if (index < length - 1) {\n                cycleEdgeNode._parent = nodes[index + 1];\n                cycleEdgeNode._parent.uncycle();\n                cycleEdgeNode._length =\n                    cycleEdgeNode._parent._length + 1;\n            } else {\n                cycleEdgeNode._parent = undefined;\n                cycleEdgeNode._length = 1;\n            }\n            var currentChildLength = cycleEdgeNode._length + 1;\n            for (var j = i - 2; j >= 0; --j) {\n                nodes[j]._length = currentChildLength;\n                currentChildLength++;\n            }\n            return;\n        }\n    }\n};\n\nCapturedTrace.prototype.attachExtraTrace = function(error) {\n    if (error.__stackCleaned__) return;\n    this.uncycle();\n    var parsed = parseStackAndMessage(error);\n    var message = parsed.message;\n    var stacks = [parsed.stack];\n\n    var trace = this;\n    while (trace !== undefined) {\n        stacks.push(cleanStack(trace.stack.split(\"\\n\")));\n        trace = trace._parent;\n    }\n    removeCommonRoots(stacks);\n    removeDuplicateOrEmptyJumps(stacks);\n    util.notEnumerableProp(error, \"stack\", reconstructStack(message, stacks));\n    util.notEnumerableProp(error, \"__stackCleaned__\", true);\n};\n\nvar captureStackTrace = (function stackDetection() {\n    var v8stackFramePattern = /^\\s*at\\s*/;\n    var v8stackFormatter = function(stack, error) {\n        if (typeof stack === \"string\") return stack;\n\n        if (error.name !== undefined &&\n            error.message !== undefined) {\n            return error.toString();\n        }\n        return formatNonError(error);\n    };\n\n    if (typeof Error.stackTraceLimit === \"number\" &&\n        typeof Error.captureStackTrace === \"function\") {\n        Error.stackTraceLimit += 6;\n        stackFramePattern = v8stackFramePattern;\n        formatStack = v8stackFormatter;\n        var captureStackTrace = Error.captureStackTrace;\n\n        shouldIgnore = function(line) {\n            return bluebirdFramePattern.test(line);\n        };\n        return function(receiver, ignoreUntil) {\n            Error.stackTraceLimit += 6;\n            captureStackTrace(receiver, ignoreUntil);\n            Error.stackTraceLimit -= 6;\n        };\n    }\n    var err = new Error();\n\n    if (typeof err.stack === \"string\" &&\n        err.stack.split(\"\\n\")[0].indexOf(\"stackDetection@\") >= 0) {\n        stackFramePattern = /@/;\n        formatStack = v8stackFormatter;\n        indentStackFrames = true;\n        return function captureStackTrace(o) {\n            o.stack = new Error().stack;\n        };\n    }\n\n    var hasStackAfterThrow;\n    try { throw new Error(); }\n    catch(e) {\n        hasStackAfterThrow = (\"stack\" in e);\n    }\n    if (!(\"stack\" in err) && hasStackAfterThrow &&\n        typeof Error.stackTraceLimit === \"number\") {\n        stackFramePattern = v8stackFramePattern;\n        formatStack = v8stackFormatter;\n        return function captureStackTrace(o) {\n            Error.stackTraceLimit += 6;\n            try { throw new Error(); }\n            catch(e) { o.stack = e.stack; }\n            Error.stackTraceLimit -= 6;\n        };\n    }\n\n    formatStack = function(stack, error) {\n        if (typeof stack === \"string\") return stack;\n\n        if ((typeof error === \"object\" ||\n            typeof error === \"function\") &&\n            error.name !== undefined &&\n            error.message !== undefined) {\n            return error.toString();\n        }\n        return formatNonError(error);\n    };\n\n    return null;\n\n})([]);\n\nif (typeof console !== \"undefined\" && typeof console.warn !== \"undefined\") {\n    printWarning = function (message) {\n        console.warn(message);\n    };\n    if (util.isNode && process.stderr.isTTY) {\n        printWarning = function(message, isSoft) {\n            var color = isSoft ? \"\\u001b[33m\" : \"\\u001b[31m\";\n            console.warn(color + message + \"\\u001b[0m\\n\");\n        };\n    } else if (!util.isNode && typeof (new Error().stack) === \"string\") {\n        printWarning = function(message, isSoft) {\n            console.warn(\"%c\" + message,\n                        isSoft ? \"color: darkorange\" : \"color: red\");\n        };\n    }\n}\n\nvar config = {\n    warnings: warnings,\n    longStackTraces: false,\n    cancellation: false,\n    monitoring: false,\n    asyncHooks: false\n};\n\nif (longStackTraces) Promise.longStackTraces();\n\nreturn {\n    asyncHooks: function() {\n        return config.asyncHooks;\n    },\n    longStackTraces: function() {\n        return config.longStackTraces;\n    },\n    warnings: function() {\n        return config.warnings;\n    },\n    cancellation: function() {\n        return config.cancellation;\n    },\n    monitoring: function() {\n        return config.monitoring;\n    },\n    propagateFromFunction: function() {\n        return propagateFromFunction;\n    },\n    boundValueFunction: function() {\n        return boundValueFunction;\n    },\n    checkForgottenReturns: checkForgottenReturns,\n    setBounds: setBounds,\n    warn: warn,\n    deprecated: deprecated,\n    CapturedTrace: CapturedTrace,\n    fireDomEvent: fireDomEvent,\n    fireGlobalEvent: fireGlobalEvent\n};\n};\n\n},{\"./errors\":12,\"./es5\":13,\"./util\":36}],10:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nfunction returner() {\n    return this.value;\n}\nfunction thrower() {\n    throw this.reason;\n}\n\nPromise.prototype[\"return\"] =\nPromise.prototype.thenReturn = function (value) {\n    if (value instanceof Promise) value.suppressUnhandledRejections();\n    return this._then(\n        returner, undefined, undefined, {value: value}, undefined);\n};\n\nPromise.prototype[\"throw\"] =\nPromise.prototype.thenThrow = function (reason) {\n    return this._then(\n        thrower, undefined, undefined, {reason: reason}, undefined);\n};\n\nPromise.prototype.catchThrow = function (reason) {\n    if (arguments.length <= 1) {\n        return this._then(\n            undefined, thrower, undefined, {reason: reason}, undefined);\n    } else {\n        var _reason = arguments[1];\n        var handler = function() {throw _reason;};\n        return this.caught(reason, handler);\n    }\n};\n\nPromise.prototype.catchReturn = function (value) {\n    if (arguments.length <= 1) {\n        if (value instanceof Promise) value.suppressUnhandledRejections();\n        return this._then(\n            undefined, returner, undefined, {value: value}, undefined);\n    } else {\n        var _value = arguments[1];\n        if (_value instanceof Promise) _value.suppressUnhandledRejections();\n        var handler = function() {return _value;};\n        return this.caught(value, handler);\n    }\n};\n};\n\n},{}],11:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar PromiseReduce = Promise.reduce;\nvar PromiseAll = Promise.all;\n\nfunction promiseAllThis() {\n    return PromiseAll(this);\n}\n\nfunction PromiseMapSeries(promises, fn) {\n    return PromiseReduce(promises, fn, INTERNAL, INTERNAL);\n}\n\nPromise.prototype.each = function (fn) {\n    return PromiseReduce(this, fn, INTERNAL, 0)\n              ._then(promiseAllThis, undefined, undefined, this, undefined);\n};\n\nPromise.prototype.mapSeries = function (fn) {\n    return PromiseReduce(this, fn, INTERNAL, INTERNAL);\n};\n\nPromise.each = function (promises, fn) {\n    return PromiseReduce(promises, fn, INTERNAL, 0)\n              ._then(promiseAllThis, undefined, undefined, promises, undefined);\n};\n\nPromise.mapSeries = PromiseMapSeries;\n};\n\n\n},{}],12:[function(_dereq_,module,exports){\n\"use strict\";\nvar es5 = _dereq_(\"./es5\");\nvar Objectfreeze = es5.freeze;\nvar util = _dereq_(\"./util\");\nvar inherits = util.inherits;\nvar notEnumerableProp = util.notEnumerableProp;\n\nfunction subError(nameProperty, defaultMessage) {\n    function SubError(message) {\n        if (!(this instanceof SubError)) return new SubError(message);\n        notEnumerableProp(this, \"message\",\n            typeof message === \"string\" ? message : defaultMessage);\n        notEnumerableProp(this, \"name\", nameProperty);\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, this.constructor);\n        } else {\n            Error.call(this);\n        }\n    }\n    inherits(SubError, Error);\n    return SubError;\n}\n\nvar _TypeError, _RangeError;\nvar Warning = subError(\"Warning\", \"warning\");\nvar CancellationError = subError(\"CancellationError\", \"cancellation error\");\nvar TimeoutError = subError(\"TimeoutError\", \"timeout error\");\nvar AggregateError = subError(\"AggregateError\", \"aggregate error\");\ntry {\n    _TypeError = TypeError;\n    _RangeError = RangeError;\n} catch(e) {\n    _TypeError = subError(\"TypeError\", \"type error\");\n    _RangeError = subError(\"RangeError\", \"range error\");\n}\n\nvar methods = (\"join pop push shift unshift slice filter forEach some \" +\n    \"every map indexOf lastIndexOf reduce reduceRight sort reverse\").split(\" \");\n\nfor (var i = 0; i < methods.length; ++i) {\n    if (typeof Array.prototype[methods[i]] === \"function\") {\n        AggregateError.prototype[methods[i]] = Array.prototype[methods[i]];\n    }\n}\n\nes5.defineProperty(AggregateError.prototype, \"length\", {\n    value: 0,\n    configurable: false,\n    writable: true,\n    enumerable: true\n});\nAggregateError.prototype[\"isOperational\"] = true;\nvar level = 0;\nAggregateError.prototype.toString = function() {\n    var indent = Array(level * 4 + 1).join(\" \");\n    var ret = \"\\n\" + indent + \"AggregateError of:\" + \"\\n\";\n    level++;\n    indent = Array(level * 4 + 1).join(\" \");\n    for (var i = 0; i < this.length; ++i) {\n        var str = this[i] === this ? \"[Circular AggregateError]\" : this[i] + \"\";\n        var lines = str.split(\"\\n\");\n        for (var j = 0; j < lines.length; ++j) {\n            lines[j] = indent + lines[j];\n        }\n        str = lines.join(\"\\n\");\n        ret += str + \"\\n\";\n    }\n    level--;\n    return ret;\n};\n\nfunction OperationalError(message) {\n    if (!(this instanceof OperationalError))\n        return new OperationalError(message);\n    notEnumerableProp(this, \"name\", \"OperationalError\");\n    notEnumerableProp(this, \"message\", message);\n    this.cause = message;\n    this[\"isOperational\"] = true;\n\n    if (message instanceof Error) {\n        notEnumerableProp(this, \"message\", message.message);\n        notEnumerableProp(this, \"stack\", message.stack);\n    } else if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, this.constructor);\n    }\n\n}\ninherits(OperationalError, Error);\n\nvar errorTypes = Error[\"__BluebirdErrorTypes__\"];\nif (!errorTypes) {\n    errorTypes = Objectfreeze({\n        CancellationError: CancellationError,\n        TimeoutError: TimeoutError,\n        OperationalError: OperationalError,\n        RejectionError: OperationalError,\n        AggregateError: AggregateError\n    });\n    es5.defineProperty(Error, \"__BluebirdErrorTypes__\", {\n        value: errorTypes,\n        writable: false,\n        enumerable: false,\n        configurable: false\n    });\n}\n\nmodule.exports = {\n    Error: Error,\n    TypeError: _TypeError,\n    RangeError: _RangeError,\n    CancellationError: errorTypes.CancellationError,\n    OperationalError: errorTypes.OperationalError,\n    TimeoutError: errorTypes.TimeoutError,\n    AggregateError: errorTypes.AggregateError,\n    Warning: Warning\n};\n\n},{\"./es5\":13,\"./util\":36}],13:[function(_dereq_,module,exports){\nvar isES5 = (function(){\n    \"use strict\";\n    return this === undefined;\n})();\n\nif (isES5) {\n    module.exports = {\n        freeze: Object.freeze,\n        defineProperty: Object.defineProperty,\n        getDescriptor: Object.getOwnPropertyDescriptor,\n        keys: Object.keys,\n        names: Object.getOwnPropertyNames,\n        getPrototypeOf: Object.getPrototypeOf,\n        isArray: Array.isArray,\n        isES5: isES5,\n        propertyIsWritable: function(obj, prop) {\n            var descriptor = Object.getOwnPropertyDescriptor(obj, prop);\n            return !!(!descriptor || descriptor.writable || descriptor.set);\n        }\n    };\n} else {\n    var has = {}.hasOwnProperty;\n    var str = {}.toString;\n    var proto = {}.constructor.prototype;\n\n    var ObjectKeys = function (o) {\n        var ret = [];\n        for (var key in o) {\n            if (has.call(o, key)) {\n                ret.push(key);\n            }\n        }\n        return ret;\n    };\n\n    var ObjectGetDescriptor = function(o, key) {\n        return {value: o[key]};\n    };\n\n    var ObjectDefineProperty = function (o, key, desc) {\n        o[key] = desc.value;\n        return o;\n    };\n\n    var ObjectFreeze = function (obj) {\n        return obj;\n    };\n\n    var ObjectGetPrototypeOf = function (obj) {\n        try {\n            return Object(obj).constructor.prototype;\n        }\n        catch (e) {\n            return proto;\n        }\n    };\n\n    var ArrayIsArray = function (obj) {\n        try {\n            return str.call(obj) === \"[object Array]\";\n        }\n        catch(e) {\n            return false;\n        }\n    };\n\n    module.exports = {\n        isArray: ArrayIsArray,\n        keys: ObjectKeys,\n        names: ObjectKeys,\n        defineProperty: ObjectDefineProperty,\n        getDescriptor: ObjectGetDescriptor,\n        freeze: ObjectFreeze,\n        getPrototypeOf: ObjectGetPrototypeOf,\n        isES5: isES5,\n        propertyIsWritable: function() {\n            return true;\n        }\n    };\n}\n\n},{}],14:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar PromiseMap = Promise.map;\n\nPromise.prototype.filter = function (fn, options) {\n    return PromiseMap(this, fn, options, INTERNAL);\n};\n\nPromise.filter = function (promises, fn, options) {\n    return PromiseMap(promises, fn, options, INTERNAL);\n};\n};\n\n},{}],15:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, tryConvertToPromise, NEXT_FILTER) {\nvar util = _dereq_(\"./util\");\nvar CancellationError = Promise.CancellationError;\nvar errorObj = util.errorObj;\nvar catchFilter = _dereq_(\"./catch_filter\")(NEXT_FILTER);\n\nfunction PassThroughHandlerContext(promise, type, handler) {\n    this.promise = promise;\n    this.type = type;\n    this.handler = handler;\n    this.called = false;\n    this.cancelPromise = null;\n}\n\nPassThroughHandlerContext.prototype.isFinallyHandler = function() {\n    return this.type === 0;\n};\n\nfunction FinallyHandlerCancelReaction(finallyHandler) {\n    this.finallyHandler = finallyHandler;\n}\n\nFinallyHandlerCancelReaction.prototype._resultCancelled = function() {\n    checkCancel(this.finallyHandler);\n};\n\nfunction checkCancel(ctx, reason) {\n    if (ctx.cancelPromise != null) {\n        if (arguments.length > 1) {\n            ctx.cancelPromise._reject(reason);\n        } else {\n            ctx.cancelPromise._cancel();\n        }\n        ctx.cancelPromise = null;\n        return true;\n    }\n    return false;\n}\n\nfunction succeed() {\n    return finallyHandler.call(this, this.promise._target()._settledValue());\n}\nfunction fail(reason) {\n    if (checkCancel(this, reason)) return;\n    errorObj.e = reason;\n    return errorObj;\n}\nfunction finallyHandler(reasonOrValue) {\n    var promise = this.promise;\n    var handler = this.handler;\n\n    if (!this.called) {\n        this.called = true;\n        var ret = this.isFinallyHandler()\n            ? handler.call(promise._boundValue())\n            : handler.call(promise._boundValue(), reasonOrValue);\n        if (ret === NEXT_FILTER) {\n            return ret;\n        } else if (ret !== undefined) {\n            promise._setReturnedNonUndefined();\n            var maybePromise = tryConvertToPromise(ret, promise);\n            if (maybePromise instanceof Promise) {\n                if (this.cancelPromise != null) {\n                    if (maybePromise._isCancelled()) {\n                        var reason =\n                            new CancellationError(\"late cancellation observer\");\n                        promise._attachExtraTrace(reason);\n                        errorObj.e = reason;\n                        return errorObj;\n                    } else if (maybePromise.isPending()) {\n                        maybePromise._attachCancellationCallback(\n                            new FinallyHandlerCancelReaction(this));\n                    }\n                }\n                return maybePromise._then(\n                    succeed, fail, undefined, this, undefined);\n            }\n        }\n    }\n\n    if (promise.isRejected()) {\n        checkCancel(this);\n        errorObj.e = reasonOrValue;\n        return errorObj;\n    } else {\n        checkCancel(this);\n        return reasonOrValue;\n    }\n}\n\nPromise.prototype._passThrough = function(handler, type, success, fail) {\n    if (typeof handler !== \"function\") return this.then();\n    return this._then(success,\n                      fail,\n                      undefined,\n                      new PassThroughHandlerContext(this, type, handler),\n                      undefined);\n};\n\nPromise.prototype.lastly =\nPromise.prototype[\"finally\"] = function (handler) {\n    return this._passThrough(handler,\n                             0,\n                             finallyHandler,\n                             finallyHandler);\n};\n\n\nPromise.prototype.tap = function (handler) {\n    return this._passThrough(handler, 1, finallyHandler);\n};\n\nPromise.prototype.tapCatch = function (handlerOrPredicate) {\n    var len = arguments.length;\n    if(len === 1) {\n        return this._passThrough(handlerOrPredicate,\n                                 1,\n                                 undefined,\n                                 finallyHandler);\n    } else {\n         var catchInstances = new Array(len - 1),\n            j = 0, i;\n        for (i = 0; i < len - 1; ++i) {\n            var item = arguments[i];\n            if (util.isObject(item)) {\n                catchInstances[j++] = item;\n            } else {\n                return Promise.reject(new TypeError(\n                    \"tapCatch statement predicate: \"\n                    + \"expecting an object but got \" + util.classString(item)\n                ));\n            }\n        }\n        catchInstances.length = j;\n        var handler = arguments[i];\n        return this._passThrough(catchFilter(catchInstances, handler, this),\n                                 1,\n                                 undefined,\n                                 finallyHandler);\n    }\n\n};\n\nreturn PassThroughHandlerContext;\n};\n\n},{\"./catch_filter\":7,\"./util\":36}],16:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise,\n                          apiRejection,\n                          INTERNAL,\n                          tryConvertToPromise,\n                          Proxyable,\n                          debug) {\nvar errors = _dereq_(\"./errors\");\nvar TypeError = errors.TypeError;\nvar util = _dereq_(\"./util\");\nvar errorObj = util.errorObj;\nvar tryCatch = util.tryCatch;\nvar yieldHandlers = [];\n\nfunction promiseFromYieldHandler(value, yieldHandlers, traceParent) {\n    for (var i = 0; i < yieldHandlers.length; ++i) {\n        traceParent._pushContext();\n        var result = tryCatch(yieldHandlers[i])(value);\n        traceParent._popContext();\n        if (result === errorObj) {\n            traceParent._pushContext();\n            var ret = Promise.reject(errorObj.e);\n            traceParent._popContext();\n            return ret;\n        }\n        var maybePromise = tryConvertToPromise(result, traceParent);\n        if (maybePromise instanceof Promise) return maybePromise;\n    }\n    return null;\n}\n\nfunction PromiseSpawn(generatorFunction, receiver, yieldHandler, stack) {\n    if (debug.cancellation()) {\n        var internal = new Promise(INTERNAL);\n        var _finallyPromise = this._finallyPromise = new Promise(INTERNAL);\n        this._promise = internal.lastly(function() {\n            return _finallyPromise;\n        });\n        internal._captureStackTrace();\n        internal._setOnCancel(this);\n    } else {\n        var promise = this._promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n    }\n    this._stack = stack;\n    this._generatorFunction = generatorFunction;\n    this._receiver = receiver;\n    this._generator = undefined;\n    this._yieldHandlers = typeof yieldHandler === \"function\"\n        ? [yieldHandler].concat(yieldHandlers)\n        : yieldHandlers;\n    this._yieldedPromise = null;\n    this._cancellationPhase = false;\n}\nutil.inherits(PromiseSpawn, Proxyable);\n\nPromiseSpawn.prototype._isResolved = function() {\n    return this._promise === null;\n};\n\nPromiseSpawn.prototype._cleanup = function() {\n    this._promise = this._generator = null;\n    if (debug.cancellation() && this._finallyPromise !== null) {\n        this._finallyPromise._fulfill();\n        this._finallyPromise = null;\n    }\n};\n\nPromiseSpawn.prototype._promiseCancelled = function() {\n    if (this._isResolved()) return;\n    var implementsReturn = typeof this._generator[\"return\"] !== \"undefined\";\n\n    var result;\n    if (!implementsReturn) {\n        var reason = new Promise.CancellationError(\n            \"generator .return() sentinel\");\n        Promise.coroutine.returnSentinel = reason;\n        this._promise._attachExtraTrace(reason);\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"throw\"]).call(this._generator,\n                                                         reason);\n        this._promise._popContext();\n    } else {\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"return\"]).call(this._generator,\n                                                          undefined);\n        this._promise._popContext();\n    }\n    this._cancellationPhase = true;\n    this._yieldedPromise = null;\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseFulfilled = function(value) {\n    this._yieldedPromise = null;\n    this._promise._pushContext();\n    var result = tryCatch(this._generator.next).call(this._generator, value);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseRejected = function(reason) {\n    this._yieldedPromise = null;\n    this._promise._attachExtraTrace(reason);\n    this._promise._pushContext();\n    var result = tryCatch(this._generator[\"throw\"])\n        .call(this._generator, reason);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._resultCancelled = function() {\n    if (this._yieldedPromise instanceof Promise) {\n        var promise = this._yieldedPromise;\n        this._yieldedPromise = null;\n        promise.cancel();\n    }\n};\n\nPromiseSpawn.prototype.promise = function () {\n    return this._promise;\n};\n\nPromiseSpawn.prototype._run = function () {\n    this._generator = this._generatorFunction.call(this._receiver);\n    this._receiver =\n        this._generatorFunction = undefined;\n    this._promiseFulfilled(undefined);\n};\n\nPromiseSpawn.prototype._continue = function (result) {\n    var promise = this._promise;\n    if (result === errorObj) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._rejectCallback(result.e, false);\n        }\n    }\n\n    var value = result.value;\n    if (result.done === true) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._resolveCallback(value);\n        }\n    } else {\n        var maybePromise = tryConvertToPromise(value, this._promise);\n        if (!(maybePromise instanceof Promise)) {\n            maybePromise =\n                promiseFromYieldHandler(maybePromise,\n                                        this._yieldHandlers,\n                                        this._promise);\n            if (maybePromise === null) {\n                this._promiseRejected(\n                    new TypeError(\n                        \"A value %s was yielded that could not be treated as a promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\\u000a\".replace(\"%s\", String(value)) +\n                        \"From coroutine:\\u000a\" +\n                        this._stack.split(\"\\n\").slice(1, -7).join(\"\\n\")\n                    )\n                );\n                return;\n            }\n        }\n        maybePromise = maybePromise._target();\n        var bitField = maybePromise._bitField;\n        ;\n        if (((bitField & 50397184) === 0)) {\n            this._yieldedPromise = maybePromise;\n            maybePromise._proxy(this, null);\n        } else if (((bitField & 33554432) !== 0)) {\n            Promise._async.invoke(\n                this._promiseFulfilled, this, maybePromise._value()\n            );\n        } else if (((bitField & 16777216) !== 0)) {\n            Promise._async.invoke(\n                this._promiseRejected, this, maybePromise._reason()\n            );\n        } else {\n            this._promiseCancelled();\n        }\n    }\n};\n\nPromise.coroutine = function (generatorFunction, options) {\n    if (typeof generatorFunction !== \"function\") {\n        throw new TypeError(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var yieldHandler = Object(options).yieldHandler;\n    var PromiseSpawn$ = PromiseSpawn;\n    var stack = new Error().stack;\n    return function () {\n        var generator = generatorFunction.apply(this, arguments);\n        var spawn = new PromiseSpawn$(undefined, undefined, yieldHandler,\n                                      stack);\n        var ret = spawn.promise();\n        spawn._generator = generator;\n        spawn._promiseFulfilled(undefined);\n        return ret;\n    };\n};\n\nPromise.coroutine.addYieldHandler = function(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    yieldHandlers.push(fn);\n};\n\nPromise.spawn = function (generatorFunction) {\n    debug.deprecated(\"Promise.spawn()\", \"Promise.coroutine()\");\n    if (typeof generatorFunction !== \"function\") {\n        return apiRejection(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var spawn = new PromiseSpawn(generatorFunction, this);\n    var ret = spawn.promise();\n    spawn._run(Promise.spawn);\n    return ret;\n};\n};\n\n},{\"./errors\":12,\"./util\":36}],17:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\nfunction(Promise, PromiseArray, tryConvertToPromise, INTERNAL, async) {\nvar util = _dereq_(\"./util\");\nvar canEvaluate = util.canEvaluate;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar reject;\n\nif (!true) {\nif (canEvaluate) {\n    var thenCallback = function(i) {\n        return new Function(\"value\", \"holder\", \"                             \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = value;                                           \\n\\\n            holder.checkFulfillment(this);                                   \\n\\\n            \".replace(/Index/g, i));\n    };\n\n    var promiseSetter = function(i) {\n        return new Function(\"promise\", \"holder\", \"                           \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = promise;                                         \\n\\\n            \".replace(/Index/g, i));\n    };\n\n    var generateHolderClass = function(total) {\n        var props = new Array(total);\n        for (var i = 0; i < props.length; ++i) {\n            props[i] = \"this.p\" + (i+1);\n        }\n        var assignment = props.join(\" = \") + \" = null;\";\n        var cancellationCode= \"var promise;\\n\" + props.map(function(prop) {\n            return \"                                                         \\n\\\n                promise = \" + prop + \";                                      \\n\\\n                if (promise instanceof Promise) {                            \\n\\\n                    promise.cancel();                                        \\n\\\n                }                                                            \\n\\\n            \";\n        }).join(\"\\n\");\n        var passedArguments = props.join(\", \");\n        var name = \"Holder$\" + total;\n\n\n        var code = \"return function(tryCatch, errorObj, Promise, async) {    \\n\\\n            'use strict';                                                    \\n\\\n            function [TheName](fn) {                                         \\n\\\n                [TheProperties]                                              \\n\\\n                this.fn = fn;                                                \\n\\\n                this.asyncNeeded = true;                                     \\n\\\n                this.now = 0;                                                \\n\\\n            }                                                                \\n\\\n                                                                             \\n\\\n            [TheName].prototype._callFunction = function(promise) {          \\n\\\n                promise._pushContext();                                      \\n\\\n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \\n\\\n                promise._popContext();                                       \\n\\\n                if (ret === errorObj) {                                      \\n\\\n                    promise._rejectCallback(ret.e, false);                   \\n\\\n                } else {                                                     \\n\\\n                    promise._resolveCallback(ret);                           \\n\\\n                }                                                            \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            [TheName].prototype.checkFulfillment = function(promise) {       \\n\\\n                var now = ++this.now;                                        \\n\\\n                if (now === [TheTotal]) {                                    \\n\\\n                    if (this.asyncNeeded) {                                  \\n\\\n                        async.invoke(this._callFunction, this, promise);     \\n\\\n                    } else {                                                 \\n\\\n                        this._callFunction(promise);                         \\n\\\n                    }                                                        \\n\\\n                                                                             \\n\\\n                }                                                            \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            [TheName].prototype._resultCancelled = function() {              \\n\\\n                [CancellationCode]                                           \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            return [TheName];                                                \\n\\\n        }(tryCatch, errorObj, Promise, async);                               \\n\\\n        \";\n\n        code = code.replace(/\\[TheName\\]/g, name)\n            .replace(/\\[TheTotal\\]/g, total)\n            .replace(/\\[ThePassedArguments\\]/g, passedArguments)\n            .replace(/\\[TheProperties\\]/g, assignment)\n            .replace(/\\[CancellationCode\\]/g, cancellationCode);\n\n        return new Function(\"tryCatch\", \"errorObj\", \"Promise\", \"async\", code)\n                           (tryCatch, errorObj, Promise, async);\n    };\n\n    var holderClasses = [];\n    var thenCallbacks = [];\n    var promiseSetters = [];\n\n    for (var i = 0; i < 8; ++i) {\n        holderClasses.push(generateHolderClass(i + 1));\n        thenCallbacks.push(thenCallback(i + 1));\n        promiseSetters.push(promiseSetter(i + 1));\n    }\n\n    reject = function (reason) {\n        this._reject(reason);\n    };\n}}\n\nPromise.join = function () {\n    var last = arguments.length - 1;\n    var fn;\n    if (last > 0 && typeof arguments[last] === \"function\") {\n        fn = arguments[last];\n        if (!true) {\n            if (last <= 8 && canEvaluate) {\n                var ret = new Promise(INTERNAL);\n                ret._captureStackTrace();\n                var HolderClass = holderClasses[last - 1];\n                var holder = new HolderClass(fn);\n                var callbacks = thenCallbacks;\n\n                for (var i = 0; i < last; ++i) {\n                    var maybePromise = tryConvertToPromise(arguments[i], ret);\n                    if (maybePromise instanceof Promise) {\n                        maybePromise = maybePromise._target();\n                        var bitField = maybePromise._bitField;\n                        ;\n                        if (((bitField & 50397184) === 0)) {\n                            maybePromise._then(callbacks[i], reject,\n                                               undefined, ret, holder);\n                            promiseSetters[i](maybePromise, holder);\n                            holder.asyncNeeded = false;\n                        } else if (((bitField & 33554432) !== 0)) {\n                            callbacks[i].call(ret,\n                                              maybePromise._value(), holder);\n                        } else if (((bitField & 16777216) !== 0)) {\n                            ret._reject(maybePromise._reason());\n                        } else {\n                            ret._cancel();\n                        }\n                    } else {\n                        callbacks[i].call(ret, maybePromise, holder);\n                    }\n                }\n\n                if (!ret._isFateSealed()) {\n                    if (holder.asyncNeeded) {\n                        var context = Promise._getContext();\n                        holder.fn = util.contextBind(context, holder.fn);\n                    }\n                    ret._setAsyncGuaranteed();\n                    ret._setOnCancel(holder);\n                }\n                return ret;\n            }\n        }\n    }\n    var args = [].slice.call(arguments);;\n    if (fn) args.pop();\n    var ret = new PromiseArray(args).promise();\n    return fn !== undefined ? ret.spread(fn) : ret;\n};\n\n};\n\n},{\"./util\":36}],18:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise,\n                          PromiseArray,\n                          apiRejection,\n                          tryConvertToPromise,\n                          INTERNAL,\n                          debug) {\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar async = Promise._async;\n\nfunction MappingPromiseArray(promises, fn, limit, _filter) {\n    this.constructor$(promises);\n    this._promise._captureStackTrace();\n    var context = Promise._getContext();\n    this._callback = util.contextBind(context, fn);\n    this._preservedValues = _filter === INTERNAL\n        ? new Array(this.length())\n        : null;\n    this._limit = limit;\n    this._inFlight = 0;\n    this._queue = [];\n    async.invoke(this._asyncInit, this, undefined);\n    if (util.isArray(promises)) {\n        for (var i = 0; i < promises.length; ++i) {\n            var maybePromise = promises[i];\n            if (maybePromise instanceof Promise) {\n                maybePromise.suppressUnhandledRejections();\n            }\n        }\n    }\n}\nutil.inherits(MappingPromiseArray, PromiseArray);\n\nMappingPromiseArray.prototype._asyncInit = function() {\n    this._init$(undefined, -2);\n};\n\nMappingPromiseArray.prototype._init = function () {};\n\nMappingPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    var values = this._values;\n    var length = this.length();\n    var preservedValues = this._preservedValues;\n    var limit = this._limit;\n\n    if (index < 0) {\n        index = (index * -1) - 1;\n        values[index] = value;\n        if (limit >= 1) {\n            this._inFlight--;\n            this._drainQueue();\n            if (this._isResolved()) return true;\n        }\n    } else {\n        if (limit >= 1 && this._inFlight >= limit) {\n            values[index] = value;\n            this._queue.push(index);\n            return false;\n        }\n        if (preservedValues !== null) preservedValues[index] = value;\n\n        var promise = this._promise;\n        var callback = this._callback;\n        var receiver = promise._boundValue();\n        promise._pushContext();\n        var ret = tryCatch(callback).call(receiver, value, index, length);\n        var promiseCreated = promise._popContext();\n        debug.checkForgottenReturns(\n            ret,\n            promiseCreated,\n            preservedValues !== null ? \"Promise.filter\" : \"Promise.map\",\n            promise\n        );\n        if (ret === errorObj) {\n            this._reject(ret.e);\n            return true;\n        }\n\n        var maybePromise = tryConvertToPromise(ret, this._promise);\n        if (maybePromise instanceof Promise) {\n            maybePromise = maybePromise._target();\n            var bitField = maybePromise._bitField;\n            ;\n            if (((bitField & 50397184) === 0)) {\n                if (limit >= 1) this._inFlight++;\n                values[index] = maybePromise;\n                maybePromise._proxy(this, (index + 1) * -1);\n                return false;\n            } else if (((bitField & 33554432) !== 0)) {\n                ret = maybePromise._value();\n            } else if (((bitField & 16777216) !== 0)) {\n                this._reject(maybePromise._reason());\n                return true;\n            } else {\n                this._cancel();\n                return true;\n            }\n        }\n        values[index] = ret;\n    }\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= length) {\n        if (preservedValues !== null) {\n            this._filter(values, preservedValues);\n        } else {\n            this._resolve(values);\n        }\n        return true;\n    }\n    return false;\n};\n\nMappingPromiseArray.prototype._drainQueue = function () {\n    var queue = this._queue;\n    var limit = this._limit;\n    var values = this._values;\n    while (queue.length > 0 && this._inFlight < limit) {\n        if (this._isResolved()) return;\n        var index = queue.pop();\n        this._promiseFulfilled(values[index], index);\n    }\n};\n\nMappingPromiseArray.prototype._filter = function (booleans, values) {\n    var len = values.length;\n    var ret = new Array(len);\n    var j = 0;\n    for (var i = 0; i < len; ++i) {\n        if (booleans[i]) ret[j++] = values[i];\n    }\n    ret.length = j;\n    this._resolve(ret);\n};\n\nMappingPromiseArray.prototype.preservedValues = function () {\n    return this._preservedValues;\n};\n\nfunction map(promises, fn, options, _filter) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n\n    var limit = 0;\n    if (options !== undefined) {\n        if (typeof options === \"object\" && options !== null) {\n            if (typeof options.concurrency !== \"number\") {\n                return Promise.reject(\n                    new TypeError(\"'concurrency' must be a number but it is \" +\n                                    util.classString(options.concurrency)));\n            }\n            limit = options.concurrency;\n        } else {\n            return Promise.reject(new TypeError(\n                            \"options argument must be an object but it is \" +\n                             util.classString(options)));\n        }\n    }\n    limit = typeof limit === \"number\" &&\n        isFinite(limit) && limit >= 1 ? limit : 0;\n    return new MappingPromiseArray(promises, fn, limit, _filter).promise();\n}\n\nPromise.prototype.map = function (fn, options) {\n    return map(this, fn, options, null);\n};\n\nPromise.map = function (promises, fn, options, _filter) {\n    return map(promises, fn, options, _filter);\n};\n\n\n};\n\n},{\"./util\":36}],19:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\nfunction(Promise, INTERNAL, tryConvertToPromise, apiRejection, debug) {\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\n\nPromise.method = function (fn) {\n    if (typeof fn !== \"function\") {\n        throw new Promise.TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    return function () {\n        var ret = new Promise(INTERNAL);\n        ret._captureStackTrace();\n        ret._pushContext();\n        var value = tryCatch(fn).apply(this, arguments);\n        var promiseCreated = ret._popContext();\n        debug.checkForgottenReturns(\n            value, promiseCreated, \"Promise.method\", ret);\n        ret._resolveFromSyncValue(value);\n        return ret;\n    };\n};\n\nPromise.attempt = Promise[\"try\"] = function (fn) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    ret._pushContext();\n    var value;\n    if (arguments.length > 1) {\n        debug.deprecated(\"calling Promise.try with more than 1 argument\");\n        var arg = arguments[1];\n        var ctx = arguments[2];\n        value = util.isArray(arg) ? tryCatch(fn).apply(ctx, arg)\n                                  : tryCatch(fn).call(ctx, arg);\n    } else {\n        value = tryCatch(fn)();\n    }\n    var promiseCreated = ret._popContext();\n    debug.checkForgottenReturns(\n        value, promiseCreated, \"Promise.try\", ret);\n    ret._resolveFromSyncValue(value);\n    return ret;\n};\n\nPromise.prototype._resolveFromSyncValue = function (value) {\n    if (value === util.errorObj) {\n        this._rejectCallback(value.e, false);\n    } else {\n        this._resolveCallback(value, true);\n    }\n};\n};\n\n},{\"./util\":36}],20:[function(_dereq_,module,exports){\n\"use strict\";\nvar util = _dereq_(\"./util\");\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar errors = _dereq_(\"./errors\");\nvar OperationalError = errors.OperationalError;\nvar es5 = _dereq_(\"./es5\");\n\nfunction isUntypedError(obj) {\n    return obj instanceof Error &&\n        es5.getPrototypeOf(obj) === Error.prototype;\n}\n\nvar rErrorKey = /^(?:name|message|stack|cause)$/;\nfunction wrapAsOperationalError(obj) {\n    var ret;\n    if (isUntypedError(obj)) {\n        ret = new OperationalError(obj);\n        ret.name = obj.name;\n        ret.message = obj.message;\n        ret.stack = obj.stack;\n        var keys = es5.keys(obj);\n        for (var i = 0; i < keys.length; ++i) {\n            var key = keys[i];\n            if (!rErrorKey.test(key)) {\n                ret[key] = obj[key];\n            }\n        }\n        return ret;\n    }\n    util.markAsOriginatingFromRejection(obj);\n    return obj;\n}\n\nfunction nodebackForPromise(promise, multiArgs) {\n    return function(err, value) {\n        if (promise === null) return;\n        if (err) {\n            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));\n            promise._attachExtraTrace(wrapped);\n            promise._reject(wrapped);\n        } else if (!multiArgs) {\n            promise._fulfill(value);\n        } else {\n            var args = [].slice.call(arguments, 1);;\n            promise._fulfill(args);\n        }\n        promise = null;\n    };\n}\n\nmodule.exports = nodebackForPromise;\n\n},{\"./errors\":12,\"./es5\":13,\"./util\":36}],21:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nvar util = _dereq_(\"./util\");\nvar async = Promise._async;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\n\nfunction spreadAdapter(val, nodeback) {\n    var promise = this;\n    if (!util.isArray(val)) return successAdapter.call(promise, val, nodeback);\n    var ret =\n        tryCatch(nodeback).apply(promise._boundValue(), [null].concat(val));\n    if (ret === errorObj) {\n        async.throwLater(ret.e);\n    }\n}\n\nfunction successAdapter(val, nodeback) {\n    var promise = this;\n    var receiver = promise._boundValue();\n    var ret = val === undefined\n        ? tryCatch(nodeback).call(receiver, null)\n        : tryCatch(nodeback).call(receiver, null, val);\n    if (ret === errorObj) {\n        async.throwLater(ret.e);\n    }\n}\nfunction errorAdapter(reason, nodeback) {\n    var promise = this;\n    if (!reason) {\n        var newReason = new Error(reason + \"\");\n        newReason.cause = reason;\n        reason = newReason;\n    }\n    var ret = tryCatch(nodeback).call(promise._boundValue(), reason);\n    if (ret === errorObj) {\n        async.throwLater(ret.e);\n    }\n}\n\nPromise.prototype.asCallback = Promise.prototype.nodeify = function (nodeback,\n                                                                     options) {\n    if (typeof nodeback == \"function\") {\n        var adapter = successAdapter;\n        if (options !== undefined && Object(options).spread) {\n            adapter = spreadAdapter;\n        }\n        this._then(\n            adapter,\n            errorAdapter,\n            undefined,\n            this,\n            nodeback\n        );\n    }\n    return this;\n};\n};\n\n},{\"./util\":36}],22:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function() {\nvar makeSelfResolutionError = function () {\n    return new TypeError(\"circular promise resolution chain\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n};\nvar reflectHandler = function() {\n    return new Promise.PromiseInspection(this._target());\n};\nvar apiRejection = function(msg) {\n    return Promise.reject(new TypeError(msg));\n};\nfunction Proxyable() {}\nvar UNDEFINED_BINDING = {};\nvar util = _dereq_(\"./util\");\nutil.setReflectHandler(reflectHandler);\n\nvar getDomain = function() {\n    var domain = process.domain;\n    if (domain === undefined) {\n        return null;\n    }\n    return domain;\n};\nvar getContextDefault = function() {\n    return null;\n};\nvar getContextDomain = function() {\n    return {\n        domain: getDomain(),\n        async: null\n    };\n};\nvar AsyncResource = util.isNode && util.nodeSupportsAsyncResource ?\n    _dereq_(\"async_hooks\").AsyncResource : null;\nvar getContextAsyncHooks = function() {\n    return {\n        domain: getDomain(),\n        async: new AsyncResource(\"Bluebird::Promise\")\n    };\n};\nvar getContext = util.isNode ? getContextDomain : getContextDefault;\nutil.notEnumerableProp(Promise, \"_getContext\", getContext);\nvar enableAsyncHooks = function() {\n    getContext = getContextAsyncHooks;\n    util.notEnumerableProp(Promise, \"_getContext\", getContextAsyncHooks);\n};\nvar disableAsyncHooks = function() {\n    getContext = getContextDomain;\n    util.notEnumerableProp(Promise, \"_getContext\", getContextDomain);\n};\n\nvar es5 = _dereq_(\"./es5\");\nvar Async = _dereq_(\"./async\");\nvar async = new Async();\nes5.defineProperty(Promise, \"_async\", {value: async});\nvar errors = _dereq_(\"./errors\");\nvar TypeError = Promise.TypeError = errors.TypeError;\nPromise.RangeError = errors.RangeError;\nvar CancellationError = Promise.CancellationError = errors.CancellationError;\nPromise.TimeoutError = errors.TimeoutError;\nPromise.OperationalError = errors.OperationalError;\nPromise.RejectionError = errors.OperationalError;\nPromise.AggregateError = errors.AggregateError;\nvar INTERNAL = function(){};\nvar APPLY = {};\nvar NEXT_FILTER = {};\nvar tryConvertToPromise = _dereq_(\"./thenables\")(Promise, INTERNAL);\nvar PromiseArray =\n    _dereq_(\"./promise_array\")(Promise, INTERNAL,\n                               tryConvertToPromise, apiRejection, Proxyable);\nvar Context = _dereq_(\"./context\")(Promise);\n /*jshint unused:false*/\nvar createContext = Context.create;\n\nvar debug = _dereq_(\"./debuggability\")(Promise, Context,\n    enableAsyncHooks, disableAsyncHooks);\nvar CapturedTrace = debug.CapturedTrace;\nvar PassThroughHandlerContext =\n    _dereq_(\"./finally\")(Promise, tryConvertToPromise, NEXT_FILTER);\nvar catchFilter = _dereq_(\"./catch_filter\")(NEXT_FILTER);\nvar nodebackForPromise = _dereq_(\"./nodeback\");\nvar errorObj = util.errorObj;\nvar tryCatch = util.tryCatch;\nfunction check(self, executor) {\n    if (self == null || self.constructor !== Promise) {\n        throw new TypeError(\"the promise constructor cannot be invoked directly\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    if (typeof executor !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(executor));\n    }\n\n}\n\nfunction Promise(executor) {\n    if (executor !== INTERNAL) {\n        check(this, executor);\n    }\n    this._bitField = 0;\n    this._fulfillmentHandler0 = undefined;\n    this._rejectionHandler0 = undefined;\n    this._promise0 = undefined;\n    this._receiver0 = undefined;\n    this._resolveFromExecutor(executor);\n    this._promiseCreated();\n    this._fireEvent(\"promiseCreated\", this);\n}\n\nPromise.prototype.toString = function () {\n    return \"[object Promise]\";\n};\n\nPromise.prototype.caught = Promise.prototype[\"catch\"] = function (fn) {\n    var len = arguments.length;\n    if (len > 1) {\n        var catchInstances = new Array(len - 1),\n            j = 0, i;\n        for (i = 0; i < len - 1; ++i) {\n            var item = arguments[i];\n            if (util.isObject(item)) {\n                catchInstances[j++] = item;\n            } else {\n                return apiRejection(\"Catch statement predicate: \" +\n                    \"expecting an object but got \" + util.classString(item));\n            }\n        }\n        catchInstances.length = j;\n        fn = arguments[i];\n\n        if (typeof fn !== \"function\") {\n            throw new TypeError(\"The last argument to .catch() \" +\n                \"must be a function, got \" + util.toString(fn));\n        }\n        return this.then(undefined, catchFilter(catchInstances, fn, this));\n    }\n    return this.then(undefined, fn);\n};\n\nPromise.prototype.reflect = function () {\n    return this._then(reflectHandler,\n        reflectHandler, undefined, this, undefined);\n};\n\nPromise.prototype.then = function (didFulfill, didReject) {\n    if (debug.warnings() && arguments.length > 0 &&\n        typeof didFulfill !== \"function\" &&\n        typeof didReject !== \"function\") {\n        var msg = \".then() only accepts functions but was passed: \" +\n                util.classString(didFulfill);\n        if (arguments.length > 1) {\n            msg += \", \" + util.classString(didReject);\n        }\n        this._warn(msg);\n    }\n    return this._then(didFulfill, didReject, undefined, undefined, undefined);\n};\n\nPromise.prototype.done = function (didFulfill, didReject) {\n    var promise =\n        this._then(didFulfill, didReject, undefined, undefined, undefined);\n    promise._setIsFinal();\n};\n\nPromise.prototype.spread = function (fn) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n    return this.all()._then(fn, undefined, undefined, APPLY, undefined);\n};\n\nPromise.prototype.toJSON = function () {\n    var ret = {\n        isFulfilled: false,\n        isRejected: false,\n        fulfillmentValue: undefined,\n        rejectionReason: undefined\n    };\n    if (this.isFulfilled()) {\n        ret.fulfillmentValue = this.value();\n        ret.isFulfilled = true;\n    } else if (this.isRejected()) {\n        ret.rejectionReason = this.reason();\n        ret.isRejected = true;\n    }\n    return ret;\n};\n\nPromise.prototype.all = function () {\n    if (arguments.length > 0) {\n        this._warn(\".all() was passed arguments but it does not take any\");\n    }\n    return new PromiseArray(this).promise();\n};\n\nPromise.prototype.error = function (fn) {\n    return this.caught(util.originatesFromRejection, fn);\n};\n\nPromise.getNewLibraryCopy = module.exports;\n\nPromise.is = function (val) {\n    return val instanceof Promise;\n};\n\nPromise.fromNode = Promise.fromCallback = function(fn) {\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    var multiArgs = arguments.length > 1 ? !!Object(arguments[1]).multiArgs\n                                         : false;\n    var result = tryCatch(fn)(nodebackForPromise(ret, multiArgs));\n    if (result === errorObj) {\n        ret._rejectCallback(result.e, true);\n    }\n    if (!ret._isFateSealed()) ret._setAsyncGuaranteed();\n    return ret;\n};\n\nPromise.all = function (promises) {\n    return new PromiseArray(promises).promise();\n};\n\nPromise.cast = function (obj) {\n    var ret = tryConvertToPromise(obj);\n    if (!(ret instanceof Promise)) {\n        ret = new Promise(INTERNAL);\n        ret._captureStackTrace();\n        ret._setFulfilled();\n        ret._rejectionHandler0 = obj;\n    }\n    return ret;\n};\n\nPromise.resolve = Promise.fulfilled = Promise.cast;\n\nPromise.reject = Promise.rejected = function (reason) {\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    ret._rejectCallback(reason, true);\n    return ret;\n};\n\nPromise.setScheduler = function(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    return async.setScheduler(fn);\n};\n\nPromise.prototype._then = function (\n    didFulfill,\n    didReject,\n    _,    receiver,\n    internalData\n) {\n    var haveInternalData = internalData !== undefined;\n    var promise = haveInternalData ? internalData : new Promise(INTERNAL);\n    var target = this._target();\n    var bitField = target._bitField;\n\n    if (!haveInternalData) {\n        promise._propagateFrom(this, 3);\n        promise._captureStackTrace();\n        if (receiver === undefined &&\n            ((this._bitField & 2097152) !== 0)) {\n            if (!((bitField & 50397184) === 0)) {\n                receiver = this._boundValue();\n            } else {\n                receiver = target === this ? undefined : this._boundTo;\n            }\n        }\n        this._fireEvent(\"promiseChained\", this, promise);\n    }\n\n    var context = getContext();\n    if (!((bitField & 50397184) === 0)) {\n        var handler, value, settler = target._settlePromiseCtx;\n        if (((bitField & 33554432) !== 0)) {\n            value = target._rejectionHandler0;\n            handler = didFulfill;\n        } else if (((bitField & 16777216) !== 0)) {\n            value = target._fulfillmentHandler0;\n            handler = didReject;\n            target._unsetRejectionIsUnhandled();\n        } else {\n            settler = target._settlePromiseLateCancellationObserver;\n            value = new CancellationError(\"late cancellation observer\");\n            target._attachExtraTrace(value);\n            handler = didReject;\n        }\n\n        async.invoke(settler, target, {\n            handler: util.contextBind(context, handler),\n            promise: promise,\n            receiver: receiver,\n            value: value\n        });\n    } else {\n        target._addCallbacks(didFulfill, didReject, promise,\n                receiver, context);\n    }\n\n    return promise;\n};\n\nPromise.prototype._length = function () {\n    return this._bitField & 65535;\n};\n\nPromise.prototype._isFateSealed = function () {\n    return (this._bitField & 117506048) !== 0;\n};\n\nPromise.prototype._isFollowing = function () {\n    return (this._bitField & 67108864) === 67108864;\n};\n\nPromise.prototype._setLength = function (len) {\n    this._bitField = (this._bitField & -65536) |\n        (len & 65535);\n};\n\nPromise.prototype._setFulfilled = function () {\n    this._bitField = this._bitField | 33554432;\n    this._fireEvent(\"promiseFulfilled\", this);\n};\n\nPromise.prototype._setRejected = function () {\n    this._bitField = this._bitField | 16777216;\n    this._fireEvent(\"promiseRejected\", this);\n};\n\nPromise.prototype._setFollowing = function () {\n    this._bitField = this._bitField | 67108864;\n    this._fireEvent(\"promiseResolved\", this);\n};\n\nPromise.prototype._setIsFinal = function () {\n    this._bitField = this._bitField | 4194304;\n};\n\nPromise.prototype._isFinal = function () {\n    return (this._bitField & 4194304) > 0;\n};\n\nPromise.prototype._unsetCancelled = function() {\n    this._bitField = this._bitField & (~65536);\n};\n\nPromise.prototype._setCancelled = function() {\n    this._bitField = this._bitField | 65536;\n    this._fireEvent(\"promiseCancelled\", this);\n};\n\nPromise.prototype._setWillBeCancelled = function() {\n    this._bitField = this._bitField | 8388608;\n};\n\nPromise.prototype._setAsyncGuaranteed = function() {\n    if (async.hasCustomScheduler()) return;\n    var bitField = this._bitField;\n    this._bitField = bitField |\n        (((bitField & 536870912) >> 2) ^\n        134217728);\n};\n\nPromise.prototype._setNoAsyncGuarantee = function() {\n    this._bitField = (this._bitField | 536870912) &\n        (~134217728);\n};\n\nPromise.prototype._receiverAt = function (index) {\n    var ret = index === 0 ? this._receiver0 : this[\n            index * 4 - 4 + 3];\n    if (ret === UNDEFINED_BINDING) {\n        return undefined;\n    } else if (ret === undefined && this._isBound()) {\n        return this._boundValue();\n    }\n    return ret;\n};\n\nPromise.prototype._promiseAt = function (index) {\n    return this[\n            index * 4 - 4 + 2];\n};\n\nPromise.prototype._fulfillmentHandlerAt = function (index) {\n    return this[\n            index * 4 - 4 + 0];\n};\n\nPromise.prototype._rejectionHandlerAt = function (index) {\n    return this[\n            index * 4 - 4 + 1];\n};\n\nPromise.prototype._boundValue = function() {};\n\nPromise.prototype._migrateCallback0 = function (follower) {\n    var bitField = follower._bitField;\n    var fulfill = follower._fulfillmentHandler0;\n    var reject = follower._rejectionHandler0;\n    var promise = follower._promise0;\n    var receiver = follower._receiverAt(0);\n    if (receiver === undefined) receiver = UNDEFINED_BINDING;\n    this._addCallbacks(fulfill, reject, promise, receiver, null);\n};\n\nPromise.prototype._migrateCallbackAt = function (follower, index) {\n    var fulfill = follower._fulfillmentHandlerAt(index);\n    var reject = follower._rejectionHandlerAt(index);\n    var promise = follower._promiseAt(index);\n    var receiver = follower._receiverAt(index);\n    if (receiver === undefined) receiver = UNDEFINED_BINDING;\n    this._addCallbacks(fulfill, reject, promise, receiver, null);\n};\n\nPromise.prototype._addCallbacks = function (\n    fulfill,\n    reject,\n    promise,\n    receiver,\n    context\n) {\n    var index = this._length();\n\n    if (index >= 65535 - 4) {\n        index = 0;\n        this._setLength(0);\n    }\n\n    if (index === 0) {\n        this._promise0 = promise;\n        this._receiver0 = receiver;\n        if (typeof fulfill === \"function\") {\n            this._fulfillmentHandler0 = util.contextBind(context, fulfill);\n        }\n        if (typeof reject === \"function\") {\n            this._rejectionHandler0 = util.contextBind(context, reject);\n        }\n    } else {\n        var base = index * 4 - 4;\n        this[base + 2] = promise;\n        this[base + 3] = receiver;\n        if (typeof fulfill === \"function\") {\n            this[base + 0] =\n                util.contextBind(context, fulfill);\n        }\n        if (typeof reject === \"function\") {\n            this[base + 1] =\n                util.contextBind(context, reject);\n        }\n    }\n    this._setLength(index + 1);\n    return index;\n};\n\nPromise.prototype._proxy = function (proxyable, arg) {\n    this._addCallbacks(undefined, undefined, arg, proxyable, null);\n};\n\nPromise.prototype._resolveCallback = function(value, shouldBind) {\n    if (((this._bitField & 117506048) !== 0)) return;\n    if (value === this)\n        return this._rejectCallback(makeSelfResolutionError(), false);\n    var maybePromise = tryConvertToPromise(value, this);\n    if (!(maybePromise instanceof Promise)) return this._fulfill(value);\n\n    if (shouldBind) this._propagateFrom(maybePromise, 2);\n\n\n    var promise = maybePromise._target();\n\n    if (promise === this) {\n        this._reject(makeSelfResolutionError());\n        return;\n    }\n\n    var bitField = promise._bitField;\n    if (((bitField & 50397184) === 0)) {\n        var len = this._length();\n        if (len > 0) promise._migrateCallback0(this);\n        for (var i = 1; i < len; ++i) {\n            promise._migrateCallbackAt(this, i);\n        }\n        this._setFollowing();\n        this._setLength(0);\n        this._setFollowee(maybePromise);\n    } else if (((bitField & 33554432) !== 0)) {\n        this._fulfill(promise._value());\n    } else if (((bitField & 16777216) !== 0)) {\n        this._reject(promise._reason());\n    } else {\n        var reason = new CancellationError(\"late cancellation observer\");\n        promise._attachExtraTrace(reason);\n        this._reject(reason);\n    }\n};\n\nPromise.prototype._rejectCallback =\nfunction(reason, synchronous, ignoreNonErrorWarnings) {\n    var trace = util.ensureErrorObject(reason);\n    var hasStack = trace === reason;\n    if (!hasStack && !ignoreNonErrorWarnings && debug.warnings()) {\n        var message = \"a promise was rejected with a non-error: \" +\n            util.classString(reason);\n        this._warn(message, true);\n    }\n    this._attachExtraTrace(trace, synchronous ? hasStack : false);\n    this._reject(reason);\n};\n\nPromise.prototype._resolveFromExecutor = function (executor) {\n    if (executor === INTERNAL) return;\n    var promise = this;\n    this._captureStackTrace();\n    this._pushContext();\n    var synchronous = true;\n    var r = this._execute(executor, function(value) {\n        promise._resolveCallback(value);\n    }, function (reason) {\n        promise._rejectCallback(reason, synchronous);\n    });\n    synchronous = false;\n    this._popContext();\n\n    if (r !== undefined) {\n        promise._rejectCallback(r, true);\n    }\n};\n\nPromise.prototype._settlePromiseFromHandler = function (\n    handler, receiver, value, promise\n) {\n    var bitField = promise._bitField;\n    if (((bitField & 65536) !== 0)) return;\n    promise._pushContext();\n    var x;\n    if (receiver === APPLY) {\n        if (!value || typeof value.length !== \"number\") {\n            x = errorObj;\n            x.e = new TypeError(\"cannot .spread() a non-array: \" +\n                                    util.classString(value));\n        } else {\n            x = tryCatch(handler).apply(this._boundValue(), value);\n        }\n    } else {\n        x = tryCatch(handler).call(receiver, value);\n    }\n    var promiseCreated = promise._popContext();\n    bitField = promise._bitField;\n    if (((bitField & 65536) !== 0)) return;\n\n    if (x === NEXT_FILTER) {\n        promise._reject(value);\n    } else if (x === errorObj) {\n        promise._rejectCallback(x.e, false);\n    } else {\n        debug.checkForgottenReturns(x, promiseCreated, \"\",  promise, this);\n        promise._resolveCallback(x);\n    }\n};\n\nPromise.prototype._target = function() {\n    var ret = this;\n    while (ret._isFollowing()) ret = ret._followee();\n    return ret;\n};\n\nPromise.prototype._followee = function() {\n    return this._rejectionHandler0;\n};\n\nPromise.prototype._setFollowee = function(promise) {\n    this._rejectionHandler0 = promise;\n};\n\nPromise.prototype._settlePromise = function(promise, handler, receiver, value) {\n    var isPromise = promise instanceof Promise;\n    var bitField = this._bitField;\n    var asyncGuaranteed = ((bitField & 134217728) !== 0);\n    if (((bitField & 65536) !== 0)) {\n        if (isPromise) promise._invokeInternalOnCancel();\n\n        if (receiver instanceof PassThroughHandlerContext &&\n            receiver.isFinallyHandler()) {\n            receiver.cancelPromise = promise;\n            if (tryCatch(handler).call(receiver, value) === errorObj) {\n                promise._reject(errorObj.e);\n            }\n        } else if (handler === reflectHandler) {\n            promise._fulfill(reflectHandler.call(receiver));\n        } else if (receiver instanceof Proxyable) {\n            receiver._promiseCancelled(promise);\n        } else if (isPromise || promise instanceof PromiseArray) {\n            promise._cancel();\n        } else {\n            receiver.cancel();\n        }\n    } else if (typeof handler === \"function\") {\n        if (!isPromise) {\n            handler.call(receiver, value, promise);\n        } else {\n            if (asyncGuaranteed) promise._setAsyncGuaranteed();\n            this._settlePromiseFromHandler(handler, receiver, value, promise);\n        }\n    } else if (receiver instanceof Proxyable) {\n        if (!receiver._isResolved()) {\n            if (((bitField & 33554432) !== 0)) {\n                receiver._promiseFulfilled(value, promise);\n            } else {\n                receiver._promiseRejected(value, promise);\n            }\n        }\n    } else if (isPromise) {\n        if (asyncGuaranteed) promise._setAsyncGuaranteed();\n        if (((bitField & 33554432) !== 0)) {\n            promise._fulfill(value);\n        } else {\n            promise._reject(value);\n        }\n    }\n};\n\nPromise.prototype._settlePromiseLateCancellationObserver = function(ctx) {\n    var handler = ctx.handler;\n    var promise = ctx.promise;\n    var receiver = ctx.receiver;\n    var value = ctx.value;\n    if (typeof handler === \"function\") {\n        if (!(promise instanceof Promise)) {\n            handler.call(receiver, value, promise);\n        } else {\n            this._settlePromiseFromHandler(handler, receiver, value, promise);\n        }\n    } else if (promise instanceof Promise) {\n        promise._reject(value);\n    }\n};\n\nPromise.prototype._settlePromiseCtx = function(ctx) {\n    this._settlePromise(ctx.promise, ctx.handler, ctx.receiver, ctx.value);\n};\n\nPromise.prototype._settlePromise0 = function(handler, value, bitField) {\n    var promise = this._promise0;\n    var receiver = this._receiverAt(0);\n    this._promise0 = undefined;\n    this._receiver0 = undefined;\n    this._settlePromise(promise, handler, receiver, value);\n};\n\nPromise.prototype._clearCallbackDataAtIndex = function(index) {\n    var base = index * 4 - 4;\n    this[base + 2] =\n    this[base + 3] =\n    this[base + 0] =\n    this[base + 1] = undefined;\n};\n\nPromise.prototype._fulfill = function (value) {\n    var bitField = this._bitField;\n    if (((bitField & 117506048) >>> 16)) return;\n    if (value === this) {\n        var err = makeSelfResolutionError();\n        this._attachExtraTrace(err);\n        return this._reject(err);\n    }\n    this._setFulfilled();\n    this._rejectionHandler0 = value;\n\n    if ((bitField & 65535) > 0) {\n        if (((bitField & 134217728) !== 0)) {\n            this._settlePromises();\n        } else {\n            async.settlePromises(this);\n        }\n        this._dereferenceTrace();\n    }\n};\n\nPromise.prototype._reject = function (reason) {\n    var bitField = this._bitField;\n    if (((bitField & 117506048) >>> 16)) return;\n    this._setRejected();\n    this._fulfillmentHandler0 = reason;\n\n    if (this._isFinal()) {\n        return async.fatalError(reason, util.isNode);\n    }\n\n    if ((bitField & 65535) > 0) {\n        async.settlePromises(this);\n    } else {\n        this._ensurePossibleRejectionHandled();\n    }\n};\n\nPromise.prototype._fulfillPromises = function (len, value) {\n    for (var i = 1; i < len; i++) {\n        var handler = this._fulfillmentHandlerAt(i);\n        var promise = this._promiseAt(i);\n        var receiver = this._receiverAt(i);\n        this._clearCallbackDataAtIndex(i);\n        this._settlePromise(promise, handler, receiver, value);\n    }\n};\n\nPromise.prototype._rejectPromises = function (len, reason) {\n    for (var i = 1; i < len; i++) {\n        var handler = this._rejectionHandlerAt(i);\n        var promise = this._promiseAt(i);\n        var receiver = this._receiverAt(i);\n        this._clearCallbackDataAtIndex(i);\n        this._settlePromise(promise, handler, receiver, reason);\n    }\n};\n\nPromise.prototype._settlePromises = function () {\n    var bitField = this._bitField;\n    var len = (bitField & 65535);\n\n    if (len > 0) {\n        if (((bitField & 16842752) !== 0)) {\n            var reason = this._fulfillmentHandler0;\n            this._settlePromise0(this._rejectionHandler0, reason, bitField);\n            this._rejectPromises(len, reason);\n        } else {\n            var value = this._rejectionHandler0;\n            this._settlePromise0(this._fulfillmentHandler0, value, bitField);\n            this._fulfillPromises(len, value);\n        }\n        this._setLength(0);\n    }\n    this._clearCancellationData();\n};\n\nPromise.prototype._settledValue = function() {\n    var bitField = this._bitField;\n    if (((bitField & 33554432) !== 0)) {\n        return this._rejectionHandler0;\n    } else if (((bitField & 16777216) !== 0)) {\n        return this._fulfillmentHandler0;\n    }\n};\n\nif (typeof Symbol !== \"undefined\" && Symbol.toStringTag) {\n    es5.defineProperty(Promise.prototype, Symbol.toStringTag, {\n        get: function () {\n            return \"Object\";\n        }\n    });\n}\n\nfunction deferResolve(v) {this.promise._resolveCallback(v);}\nfunction deferReject(v) {this.promise._rejectCallback(v, false);}\n\nPromise.defer = Promise.pending = function() {\n    debug.deprecated(\"Promise.defer\", \"new Promise\");\n    var promise = new Promise(INTERNAL);\n    return {\n        promise: promise,\n        resolve: deferResolve,\n        reject: deferReject\n    };\n};\n\nutil.notEnumerableProp(Promise,\n                       \"_makeSelfResolutionError\",\n                       makeSelfResolutionError);\n\n_dereq_(\"./method\")(Promise, INTERNAL, tryConvertToPromise, apiRejection,\n    debug);\n_dereq_(\"./bind\")(Promise, INTERNAL, tryConvertToPromise, debug);\n_dereq_(\"./cancel\")(Promise, PromiseArray, apiRejection, debug);\n_dereq_(\"./direct_resolve\")(Promise);\n_dereq_(\"./synchronous_inspection\")(Promise);\n_dereq_(\"./join\")(\n    Promise, PromiseArray, tryConvertToPromise, INTERNAL, async);\nPromise.Promise = Promise;\nPromise.version = \"3.7.2\";\n_dereq_('./call_get.js')(Promise);\n_dereq_('./generators.js')(Promise, apiRejection, INTERNAL, tryConvertToPromise, Proxyable, debug);\n_dereq_('./map.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug);\n_dereq_('./nodeify.js')(Promise);\n_dereq_('./promisify.js')(Promise, INTERNAL);\n_dereq_('./props.js')(Promise, PromiseArray, tryConvertToPromise, apiRejection);\n_dereq_('./race.js')(Promise, INTERNAL, tryConvertToPromise, apiRejection);\n_dereq_('./reduce.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug);\n_dereq_('./settle.js')(Promise, PromiseArray, debug);\n_dereq_('./some.js')(Promise, PromiseArray, apiRejection);\n_dereq_('./timers.js')(Promise, INTERNAL, debug);\n_dereq_('./using.js')(Promise, apiRejection, tryConvertToPromise, createContext, INTERNAL, debug);\n_dereq_('./any.js')(Promise);\n_dereq_('./each.js')(Promise, INTERNAL);\n_dereq_('./filter.js')(Promise, INTERNAL);\n                                                         \n    util.toFastProperties(Promise);                                          \n    util.toFastProperties(Promise.prototype);                                \n    function fillTypes(value) {                                              \n        var p = new Promise(INTERNAL);                                       \n        p._fulfillmentHandler0 = value;                                      \n        p._rejectionHandler0 = value;                                        \n        p._promise0 = value;                                                 \n        p._receiver0 = value;                                                \n    }                                                                        \n    // Complete slack tracking, opt out of field-type tracking and           \n    // stabilize map                                                         \n    fillTypes({a: 1});                                                       \n    fillTypes({b: 2});                                                       \n    fillTypes({c: 3});                                                       \n    fillTypes(1);                                                            \n    fillTypes(function(){});                                                 \n    fillTypes(undefined);                                                    \n    fillTypes(false);                                                        \n    fillTypes(new Promise(INTERNAL));                                        \n    debug.setBounds(Async.firstLineError, util.lastLineError);               \n    return Promise;                                                          \n\n};\n\n},{\"./any.js\":1,\"./async\":2,\"./bind\":3,\"./call_get.js\":5,\"./cancel\":6,\"./catch_filter\":7,\"./context\":8,\"./debuggability\":9,\"./direct_resolve\":10,\"./each.js\":11,\"./errors\":12,\"./es5\":13,\"./filter.js\":14,\"./finally\":15,\"./generators.js\":16,\"./join\":17,\"./map.js\":18,\"./method\":19,\"./nodeback\":20,\"./nodeify.js\":21,\"./promise_array\":23,\"./promisify.js\":24,\"./props.js\":25,\"./race.js\":27,\"./reduce.js\":28,\"./settle.js\":30,\"./some.js\":31,\"./synchronous_inspection\":32,\"./thenables\":33,\"./timers.js\":34,\"./using.js\":35,\"./util\":36,\"async_hooks\":undefined}],23:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, tryConvertToPromise,\n    apiRejection, Proxyable) {\nvar util = _dereq_(\"./util\");\nvar isArray = util.isArray;\n\nfunction toResolutionValue(val) {\n    switch(val) {\n    case -2: return [];\n    case -3: return {};\n    case -6: return new Map();\n    }\n}\n\nfunction PromiseArray(values) {\n    var promise = this._promise = new Promise(INTERNAL);\n    if (values instanceof Promise) {\n        promise._propagateFrom(values, 3);\n        values.suppressUnhandledRejections();\n    }\n    promise._setOnCancel(this);\n    this._values = values;\n    this._length = 0;\n    this._totalResolved = 0;\n    this._init(undefined, -2);\n}\nutil.inherits(PromiseArray, Proxyable);\n\nPromiseArray.prototype.length = function () {\n    return this._length;\n};\n\nPromiseArray.prototype.promise = function () {\n    return this._promise;\n};\n\nPromiseArray.prototype._init = function init(_, resolveValueIfEmpty) {\n    var values = tryConvertToPromise(this._values, this._promise);\n    if (values instanceof Promise) {\n        values = values._target();\n        var bitField = values._bitField;\n        ;\n        this._values = values;\n\n        if (((bitField & 50397184) === 0)) {\n            this._promise._setAsyncGuaranteed();\n            return values._then(\n                init,\n                this._reject,\n                undefined,\n                this,\n                resolveValueIfEmpty\n           );\n        } else if (((bitField & 33554432) !== 0)) {\n            values = values._value();\n        } else if (((bitField & 16777216) !== 0)) {\n            return this._reject(values._reason());\n        } else {\n            return this._cancel();\n        }\n    }\n    values = util.asArray(values);\n    if (values === null) {\n        var err = apiRejection(\n            \"expecting an array or an iterable object but got \" + util.classString(values)).reason();\n        this._promise._rejectCallback(err, false);\n        return;\n    }\n\n    if (values.length === 0) {\n        if (resolveValueIfEmpty === -5) {\n            this._resolveEmptyArray();\n        }\n        else {\n            this._resolve(toResolutionValue(resolveValueIfEmpty));\n        }\n        return;\n    }\n    this._iterate(values);\n};\n\nPromiseArray.prototype._iterate = function(values) {\n    var len = this.getActualLength(values.length);\n    this._length = len;\n    this._values = this.shouldCopyValues() ? new Array(len) : this._values;\n    var result = this._promise;\n    var isResolved = false;\n    var bitField = null;\n    for (var i = 0; i < len; ++i) {\n        var maybePromise = tryConvertToPromise(values[i], result);\n\n        if (maybePromise instanceof Promise) {\n            maybePromise = maybePromise._target();\n            bitField = maybePromise._bitField;\n        } else {\n            bitField = null;\n        }\n\n        if (isResolved) {\n            if (bitField !== null) {\n                maybePromise.suppressUnhandledRejections();\n            }\n        } else if (bitField !== null) {\n            if (((bitField & 50397184) === 0)) {\n                maybePromise._proxy(this, i);\n                this._values[i] = maybePromise;\n            } else if (((bitField & 33554432) !== 0)) {\n                isResolved = this._promiseFulfilled(maybePromise._value(), i);\n            } else if (((bitField & 16777216) !== 0)) {\n                isResolved = this._promiseRejected(maybePromise._reason(), i);\n            } else {\n                isResolved = this._promiseCancelled(i);\n            }\n        } else {\n            isResolved = this._promiseFulfilled(maybePromise, i);\n        }\n    }\n    if (!isResolved) result._setAsyncGuaranteed();\n};\n\nPromiseArray.prototype._isResolved = function () {\n    return this._values === null;\n};\n\nPromiseArray.prototype._resolve = function (value) {\n    this._values = null;\n    this._promise._fulfill(value);\n};\n\nPromiseArray.prototype._cancel = function() {\n    if (this._isResolved() || !this._promise._isCancellable()) return;\n    this._values = null;\n    this._promise._cancel();\n};\n\nPromiseArray.prototype._reject = function (reason) {\n    this._values = null;\n    this._promise._rejectCallback(reason, false);\n};\n\nPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    this._values[index] = value;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        this._resolve(this._values);\n        return true;\n    }\n    return false;\n};\n\nPromiseArray.prototype._promiseCancelled = function() {\n    this._cancel();\n    return true;\n};\n\nPromiseArray.prototype._promiseRejected = function (reason) {\n    this._totalResolved++;\n    this._reject(reason);\n    return true;\n};\n\nPromiseArray.prototype._resultCancelled = function() {\n    if (this._isResolved()) return;\n    var values = this._values;\n    this._cancel();\n    if (values instanceof Promise) {\n        values.cancel();\n    } else {\n        for (var i = 0; i < values.length; ++i) {\n            if (values[i] instanceof Promise) {\n                values[i].cancel();\n            }\n        }\n    }\n};\n\nPromiseArray.prototype.shouldCopyValues = function () {\n    return true;\n};\n\nPromiseArray.prototype.getActualLength = function (len) {\n    return len;\n};\n\nreturn PromiseArray;\n};\n\n},{\"./util\":36}],24:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar THIS = {};\nvar util = _dereq_(\"./util\");\nvar nodebackForPromise = _dereq_(\"./nodeback\");\nvar withAppended = util.withAppended;\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar canEvaluate = util.canEvaluate;\nvar TypeError = _dereq_(\"./errors\").TypeError;\nvar defaultSuffix = \"Async\";\nvar defaultPromisified = {__isPromisified__: true};\nvar noCopyProps = [\n    \"arity\",    \"length\",\n    \"name\",\n    \"arguments\",\n    \"caller\",\n    \"callee\",\n    \"prototype\",\n    \"__isPromisified__\"\n];\nvar noCopyPropsPattern = new RegExp(\"^(?:\" + noCopyProps.join(\"|\") + \")$\");\n\nvar defaultFilter = function(name) {\n    return util.isIdentifier(name) &&\n        name.charAt(0) !== \"_\" &&\n        name !== \"constructor\";\n};\n\nfunction propsFilter(key) {\n    return !noCopyPropsPattern.test(key);\n}\n\nfunction isPromisified(fn) {\n    try {\n        return fn.__isPromisified__ === true;\n    }\n    catch (e) {\n        return false;\n    }\n}\n\nfunction hasPromisified(obj, key, suffix) {\n    var val = util.getDataPropertyOrDefault(obj, key + suffix,\n                                            defaultPromisified);\n    return val ? isPromisified(val) : false;\n}\nfunction checkValid(ret, suffix, suffixRegexp) {\n    for (var i = 0; i < ret.length; i += 2) {\n        var key = ret[i];\n        if (suffixRegexp.test(key)) {\n            var keyWithoutAsyncSuffix = key.replace(suffixRegexp, \"\");\n            for (var j = 0; j < ret.length; j += 2) {\n                if (ret[j] === keyWithoutAsyncSuffix) {\n                    throw new TypeError(\"Cannot promisify an API that has normal methods with '%s'-suffix\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\"\n                        .replace(\"%s\", suffix));\n                }\n            }\n        }\n    }\n}\n\nfunction promisifiableMethods(obj, suffix, suffixRegexp, filter) {\n    var keys = util.inheritedDataKeys(obj);\n    var ret = [];\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var value = obj[key];\n        var passesDefaultFilter = filter === defaultFilter\n            ? true : defaultFilter(key, value, obj);\n        if (typeof value === \"function\" &&\n            !isPromisified(value) &&\n            !hasPromisified(obj, key, suffix) &&\n            filter(key, value, obj, passesDefaultFilter)) {\n            ret.push(key, value);\n        }\n    }\n    checkValid(ret, suffix, suffixRegexp);\n    return ret;\n}\n\nvar escapeIdentRegex = function(str) {\n    return str.replace(/([$])/, \"\\\\$\");\n};\n\nvar makeNodePromisifiedEval;\nif (!true) {\nvar switchCaseArgumentOrder = function(likelyArgumentCount) {\n    var ret = [likelyArgumentCount];\n    var min = Math.max(0, likelyArgumentCount - 1 - 3);\n    for(var i = likelyArgumentCount - 1; i >= min; --i) {\n        ret.push(i);\n    }\n    for(var i = likelyArgumentCount + 1; i <= 3; ++i) {\n        ret.push(i);\n    }\n    return ret;\n};\n\nvar argumentSequence = function(argumentCount) {\n    return util.filledRange(argumentCount, \"_arg\", \"\");\n};\n\nvar parameterDeclaration = function(parameterCount) {\n    return util.filledRange(\n        Math.max(parameterCount, 3), \"_arg\", \"\");\n};\n\nvar parameterCount = function(fn) {\n    if (typeof fn.length === \"number\") {\n        return Math.max(Math.min(fn.length, 1023 + 1), 0);\n    }\n    return 0;\n};\n\nmakeNodePromisifiedEval =\nfunction(callback, receiver, originalName, fn, _, multiArgs) {\n    var newParameterCount = Math.max(0, parameterCount(fn) - 1);\n    var argumentOrder = switchCaseArgumentOrder(newParameterCount);\n    var shouldProxyThis = typeof callback === \"string\" || receiver === THIS;\n\n    function generateCallForArgumentCount(count) {\n        var args = argumentSequence(count).join(\", \");\n        var comma = count > 0 ? \", \" : \"\";\n        var ret;\n        if (shouldProxyThis) {\n            ret = \"ret = callback.call(this, {{args}}, nodeback); break;\\n\";\n        } else {\n            ret = receiver === undefined\n                ? \"ret = callback({{args}}, nodeback); break;\\n\"\n                : \"ret = callback.call(receiver, {{args}}, nodeback); break;\\n\";\n        }\n        return ret.replace(\"{{args}}\", args).replace(\", \", comma);\n    }\n\n    function generateArgumentSwitchCase() {\n        var ret = \"\";\n        for (var i = 0; i < argumentOrder.length; ++i) {\n            ret += \"case \" + argumentOrder[i] +\":\" +\n                generateCallForArgumentCount(argumentOrder[i]);\n        }\n\n        ret += \"                                                             \\n\\\n        default:                                                             \\n\\\n            var args = new Array(len + 1);                                   \\n\\\n            var i = 0;                                                       \\n\\\n            for (var i = 0; i < len; ++i) {                                  \\n\\\n               args[i] = arguments[i];                                       \\n\\\n            }                                                                \\n\\\n            args[i] = nodeback;                                              \\n\\\n            [CodeForCall]                                                    \\n\\\n            break;                                                           \\n\\\n        \".replace(\"[CodeForCall]\", (shouldProxyThis\n                                ? \"ret = callback.apply(this, args);\\n\"\n                                : \"ret = callback.apply(receiver, args);\\n\"));\n        return ret;\n    }\n\n    var getFunctionCode = typeof callback === \"string\"\n                                ? (\"this != null ? this['\"+callback+\"'] : fn\")\n                                : \"fn\";\n    var body = \"'use strict';                                                \\n\\\n        var ret = function (Parameters) {                                    \\n\\\n            'use strict';                                                    \\n\\\n            var len = arguments.length;                                      \\n\\\n            var promise = new Promise(INTERNAL);                             \\n\\\n            promise._captureStackTrace();                                    \\n\\\n            var nodeback = nodebackForPromise(promise, \" + multiArgs + \");   \\n\\\n            var ret;                                                         \\n\\\n            var callback = tryCatch([GetFunctionCode]);                      \\n\\\n            switch(len) {                                                    \\n\\\n                [CodeForSwitchCase]                                          \\n\\\n            }                                                                \\n\\\n            if (ret === errorObj) {                                          \\n\\\n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\\n\\\n            }                                                                \\n\\\n            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \\n\\\n            return promise;                                                  \\n\\\n        };                                                                   \\n\\\n        notEnumerableProp(ret, '__isPromisified__', true);                   \\n\\\n        return ret;                                                          \\n\\\n    \".replace(\"[CodeForSwitchCase]\", generateArgumentSwitchCase())\n        .replace(\"[GetFunctionCode]\", getFunctionCode);\n    body = body.replace(\"Parameters\", parameterDeclaration(newParameterCount));\n    return new Function(\"Promise\",\n                        \"fn\",\n                        \"receiver\",\n                        \"withAppended\",\n                        \"maybeWrapAsError\",\n                        \"nodebackForPromise\",\n                        \"tryCatch\",\n                        \"errorObj\",\n                        \"notEnumerableProp\",\n                        \"INTERNAL\",\n                        body)(\n                    Promise,\n                    fn,\n                    receiver,\n                    withAppended,\n                    maybeWrapAsError,\n                    nodebackForPromise,\n                    util.tryCatch,\n                    util.errorObj,\n                    util.notEnumerableProp,\n                    INTERNAL);\n};\n}\n\nfunction makeNodePromisifiedClosure(callback, receiver, _, fn, __, multiArgs) {\n    var defaultThis = (function() {return this;})();\n    var method = callback;\n    if (typeof method === \"string\") {\n        callback = fn;\n    }\n    function promisified() {\n        var _receiver = receiver;\n        if (receiver === THIS) _receiver = this;\n        var promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n        var cb = typeof method === \"string\" && this !== defaultThis\n            ? this[method] : callback;\n        var fn = nodebackForPromise(promise, multiArgs);\n        try {\n            cb.apply(_receiver, withAppended(arguments, fn));\n        } catch(e) {\n            promise._rejectCallback(maybeWrapAsError(e), true, true);\n        }\n        if (!promise._isFateSealed()) promise._setAsyncGuaranteed();\n        return promise;\n    }\n    util.notEnumerableProp(promisified, \"__isPromisified__\", true);\n    return promisified;\n}\n\nvar makeNodePromisified = canEvaluate\n    ? makeNodePromisifiedEval\n    : makeNodePromisifiedClosure;\n\nfunction promisifyAll(obj, suffix, filter, promisifier, multiArgs) {\n    var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + \"$\");\n    var methods =\n        promisifiableMethods(obj, suffix, suffixRegexp, filter);\n\n    for (var i = 0, len = methods.length; i < len; i+= 2) {\n        var key = methods[i];\n        var fn = methods[i+1];\n        var promisifiedKey = key + suffix;\n        if (promisifier === makeNodePromisified) {\n            obj[promisifiedKey] =\n                makeNodePromisified(key, THIS, key, fn, suffix, multiArgs);\n        } else {\n            var promisified = promisifier(fn, function() {\n                return makeNodePromisified(key, THIS, key,\n                                           fn, suffix, multiArgs);\n            });\n            util.notEnumerableProp(promisified, \"__isPromisified__\", true);\n            obj[promisifiedKey] = promisified;\n        }\n    }\n    util.toFastProperties(obj);\n    return obj;\n}\n\nfunction promisify(callback, receiver, multiArgs) {\n    return makeNodePromisified(callback, receiver, undefined,\n                                callback, null, multiArgs);\n}\n\nPromise.promisify = function (fn, options) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    if (isPromisified(fn)) {\n        return fn;\n    }\n    options = Object(options);\n    var receiver = options.context === undefined ? THIS : options.context;\n    var multiArgs = !!options.multiArgs;\n    var ret = promisify(fn, receiver, multiArgs);\n    util.copyDescriptors(fn, ret, propsFilter);\n    return ret;\n};\n\nPromise.promisifyAll = function (target, options) {\n    if (typeof target !== \"function\" && typeof target !== \"object\") {\n        throw new TypeError(\"the target of promisifyAll must be an object or a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    options = Object(options);\n    var multiArgs = !!options.multiArgs;\n    var suffix = options.suffix;\n    if (typeof suffix !== \"string\") suffix = defaultSuffix;\n    var filter = options.filter;\n    if (typeof filter !== \"function\") filter = defaultFilter;\n    var promisifier = options.promisifier;\n    if (typeof promisifier !== \"function\") promisifier = makeNodePromisified;\n\n    if (!util.isIdentifier(suffix)) {\n        throw new RangeError(\"suffix must be a valid identifier\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n\n    var keys = util.inheritedDataKeys(target);\n    for (var i = 0; i < keys.length; ++i) {\n        var value = target[keys[i]];\n        if (keys[i] !== \"constructor\" &&\n            util.isClass(value)) {\n            promisifyAll(value.prototype, suffix, filter, promisifier,\n                multiArgs);\n            promisifyAll(value, suffix, filter, promisifier, multiArgs);\n        }\n    }\n\n    return promisifyAll(target, suffix, filter, promisifier, multiArgs);\n};\n};\n\n\n},{\"./errors\":12,\"./nodeback\":20,\"./util\":36}],25:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(\n    Promise, PromiseArray, tryConvertToPromise, apiRejection) {\nvar util = _dereq_(\"./util\");\nvar isObject = util.isObject;\nvar es5 = _dereq_(\"./es5\");\nvar Es6Map;\nif (typeof Map === \"function\") Es6Map = Map;\n\nvar mapToEntries = (function() {\n    var index = 0;\n    var size = 0;\n\n    function extractEntry(value, key) {\n        this[index] = value;\n        this[index + size] = key;\n        index++;\n    }\n\n    return function mapToEntries(map) {\n        size = map.size;\n        index = 0;\n        var ret = new Array(map.size * 2);\n        map.forEach(extractEntry, ret);\n        return ret;\n    };\n})();\n\nvar entriesToMap = function(entries) {\n    var ret = new Es6Map();\n    var length = entries.length / 2 | 0;\n    for (var i = 0; i < length; ++i) {\n        var key = entries[length + i];\n        var value = entries[i];\n        ret.set(key, value);\n    }\n    return ret;\n};\n\nfunction PropertiesPromiseArray(obj) {\n    var isMap = false;\n    var entries;\n    if (Es6Map !== undefined && obj instanceof Es6Map) {\n        entries = mapToEntries(obj);\n        isMap = true;\n    } else {\n        var keys = es5.keys(obj);\n        var len = keys.length;\n        entries = new Array(len * 2);\n        for (var i = 0; i < len; ++i) {\n            var key = keys[i];\n            entries[i] = obj[key];\n            entries[i + len] = key;\n        }\n    }\n    this.constructor$(entries);\n    this._isMap = isMap;\n    this._init$(undefined, isMap ? -6 : -3);\n}\nutil.inherits(PropertiesPromiseArray, PromiseArray);\n\nPropertiesPromiseArray.prototype._init = function () {};\n\nPropertiesPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    this._values[index] = value;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        var val;\n        if (this._isMap) {\n            val = entriesToMap(this._values);\n        } else {\n            val = {};\n            var keyOffset = this.length();\n            for (var i = 0, len = this.length(); i < len; ++i) {\n                val[this._values[i + keyOffset]] = this._values[i];\n            }\n        }\n        this._resolve(val);\n        return true;\n    }\n    return false;\n};\n\nPropertiesPromiseArray.prototype.shouldCopyValues = function () {\n    return false;\n};\n\nPropertiesPromiseArray.prototype.getActualLength = function (len) {\n    return len >> 1;\n};\n\nfunction props(promises) {\n    var ret;\n    var castValue = tryConvertToPromise(promises);\n\n    if (!isObject(castValue)) {\n        return apiRejection(\"cannot await properties of a non-object\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    } else if (castValue instanceof Promise) {\n        ret = castValue._then(\n            Promise.props, undefined, undefined, undefined, undefined);\n    } else {\n        ret = new PropertiesPromiseArray(castValue).promise();\n    }\n\n    if (castValue instanceof Promise) {\n        ret._propagateFrom(castValue, 2);\n    }\n    return ret;\n}\n\nPromise.prototype.props = function () {\n    return props(this);\n};\n\nPromise.props = function (promises) {\n    return props(promises);\n};\n};\n\n},{\"./es5\":13,\"./util\":36}],26:[function(_dereq_,module,exports){\n\"use strict\";\nfunction arrayMove(src, srcIndex, dst, dstIndex, len) {\n    for (var j = 0; j < len; ++j) {\n        dst[j + dstIndex] = src[j + srcIndex];\n        src[j + srcIndex] = void 0;\n    }\n}\n\nfunction Queue(capacity) {\n    this._capacity = capacity;\n    this._length = 0;\n    this._front = 0;\n}\n\nQueue.prototype._willBeOverCapacity = function (size) {\n    return this._capacity < size;\n};\n\nQueue.prototype._pushOne = function (arg) {\n    var length = this.length();\n    this._checkCapacity(length + 1);\n    var i = (this._front + length) & (this._capacity - 1);\n    this[i] = arg;\n    this._length = length + 1;\n};\n\nQueue.prototype.push = function (fn, receiver, arg) {\n    var length = this.length() + 3;\n    if (this._willBeOverCapacity(length)) {\n        this._pushOne(fn);\n        this._pushOne(receiver);\n        this._pushOne(arg);\n        return;\n    }\n    var j = this._front + length - 3;\n    this._checkCapacity(length);\n    var wrapMask = this._capacity - 1;\n    this[(j + 0) & wrapMask] = fn;\n    this[(j + 1) & wrapMask] = receiver;\n    this[(j + 2) & wrapMask] = arg;\n    this._length = length;\n};\n\nQueue.prototype.shift = function () {\n    var front = this._front,\n        ret = this[front];\n\n    this[front] = undefined;\n    this._front = (front + 1) & (this._capacity - 1);\n    this._length--;\n    return ret;\n};\n\nQueue.prototype.length = function () {\n    return this._length;\n};\n\nQueue.prototype._checkCapacity = function (size) {\n    if (this._capacity < size) {\n        this._resizeTo(this._capacity << 1);\n    }\n};\n\nQueue.prototype._resizeTo = function (capacity) {\n    var oldCapacity = this._capacity;\n    this._capacity = capacity;\n    var front = this._front;\n    var length = this._length;\n    var moveItemsCount = (front + length) & (oldCapacity - 1);\n    arrayMove(this, 0, this, oldCapacity, moveItemsCount);\n};\n\nmodule.exports = Queue;\n\n},{}],27:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(\n    Promise, INTERNAL, tryConvertToPromise, apiRejection) {\nvar util = _dereq_(\"./util\");\n\nvar raceLater = function (promise) {\n    return promise.then(function(array) {\n        return race(array, promise);\n    });\n};\n\nfunction race(promises, parent) {\n    var maybePromise = tryConvertToPromise(promises);\n\n    if (maybePromise instanceof Promise) {\n        return raceLater(maybePromise);\n    } else {\n        promises = util.asArray(promises);\n        if (promises === null)\n            return apiRejection(\"expecting an array or an iterable object but got \" + util.classString(promises));\n    }\n\n    var ret = new Promise(INTERNAL);\n    if (parent !== undefined) {\n        ret._propagateFrom(parent, 3);\n    }\n    var fulfill = ret._fulfill;\n    var reject = ret._reject;\n    for (var i = 0, len = promises.length; i < len; ++i) {\n        var val = promises[i];\n\n        if (val === undefined && !(i in promises)) {\n            continue;\n        }\n\n        Promise.cast(val)._then(fulfill, reject, undefined, ret, null);\n    }\n    return ret;\n}\n\nPromise.race = function (promises) {\n    return race(promises, undefined);\n};\n\nPromise.prototype.race = function () {\n    return race(this, undefined);\n};\n\n};\n\n},{\"./util\":36}],28:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise,\n                          PromiseArray,\n                          apiRejection,\n                          tryConvertToPromise,\n                          INTERNAL,\n                          debug) {\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\n\nfunction ReductionPromiseArray(promises, fn, initialValue, _each) {\n    this.constructor$(promises);\n    var context = Promise._getContext();\n    this._fn = util.contextBind(context, fn);\n    if (initialValue !== undefined) {\n        initialValue = Promise.resolve(initialValue);\n        initialValue._attachCancellationCallback(this);\n    }\n    this._initialValue = initialValue;\n    this._currentCancellable = null;\n    if(_each === INTERNAL) {\n        this._eachValues = Array(this._length);\n    } else if (_each === 0) {\n        this._eachValues = null;\n    } else {\n        this._eachValues = undefined;\n    }\n    this._promise._captureStackTrace();\n    this._init$(undefined, -5);\n}\nutil.inherits(ReductionPromiseArray, PromiseArray);\n\nReductionPromiseArray.prototype._gotAccum = function(accum) {\n    if (this._eachValues !== undefined &&\n        this._eachValues !== null &&\n        accum !== INTERNAL) {\n        this._eachValues.push(accum);\n    }\n};\n\nReductionPromiseArray.prototype._eachComplete = function(value) {\n    if (this._eachValues !== null) {\n        this._eachValues.push(value);\n    }\n    return this._eachValues;\n};\n\nReductionPromiseArray.prototype._init = function() {};\n\nReductionPromiseArray.prototype._resolveEmptyArray = function() {\n    this._resolve(this._eachValues !== undefined ? this._eachValues\n                                                 : this._initialValue);\n};\n\nReductionPromiseArray.prototype.shouldCopyValues = function () {\n    return false;\n};\n\nReductionPromiseArray.prototype._resolve = function(value) {\n    this._promise._resolveCallback(value);\n    this._values = null;\n};\n\nReductionPromiseArray.prototype._resultCancelled = function(sender) {\n    if (sender === this._initialValue) return this._cancel();\n    if (this._isResolved()) return;\n    this._resultCancelled$();\n    if (this._currentCancellable instanceof Promise) {\n        this._currentCancellable.cancel();\n    }\n    if (this._initialValue instanceof Promise) {\n        this._initialValue.cancel();\n    }\n};\n\nReductionPromiseArray.prototype._iterate = function (values) {\n    this._values = values;\n    var value;\n    var i;\n    var length = values.length;\n    if (this._initialValue !== undefined) {\n        value = this._initialValue;\n        i = 0;\n    } else {\n        value = Promise.resolve(values[0]);\n        i = 1;\n    }\n\n    this._currentCancellable = value;\n\n    for (var j = i; j < length; ++j) {\n        var maybePromise = values[j];\n        if (maybePromise instanceof Promise) {\n            maybePromise.suppressUnhandledRejections();\n        }\n    }\n\n    if (!value.isRejected()) {\n        for (; i < length; ++i) {\n            var ctx = {\n                accum: null,\n                value: values[i],\n                index: i,\n                length: length,\n                array: this\n            };\n\n            value = value._then(gotAccum, undefined, undefined, ctx, undefined);\n\n            if ((i & 127) === 0) {\n                value._setNoAsyncGuarantee();\n            }\n        }\n    }\n\n    if (this._eachValues !== undefined) {\n        value = value\n            ._then(this._eachComplete, undefined, undefined, this, undefined);\n    }\n    value._then(completed, completed, undefined, value, this);\n};\n\nPromise.prototype.reduce = function (fn, initialValue) {\n    return reduce(this, fn, initialValue, null);\n};\n\nPromise.reduce = function (promises, fn, initialValue, _each) {\n    return reduce(promises, fn, initialValue, _each);\n};\n\nfunction completed(valueOrReason, array) {\n    if (this.isFulfilled()) {\n        array._resolve(valueOrReason);\n    } else {\n        array._reject(valueOrReason);\n    }\n}\n\nfunction reduce(promises, fn, initialValue, _each) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n    var array = new ReductionPromiseArray(promises, fn, initialValue, _each);\n    return array.promise();\n}\n\nfunction gotAccum(accum) {\n    this.accum = accum;\n    this.array._gotAccum(accum);\n    var value = tryConvertToPromise(this.value, this.array._promise);\n    if (value instanceof Promise) {\n        this.array._currentCancellable = value;\n        return value._then(gotValue, undefined, undefined, this, undefined);\n    } else {\n        return gotValue.call(this, value);\n    }\n}\n\nfunction gotValue(value) {\n    var array = this.array;\n    var promise = array._promise;\n    var fn = tryCatch(array._fn);\n    promise._pushContext();\n    var ret;\n    if (array._eachValues !== undefined) {\n        ret = fn.call(promise._boundValue(), value, this.index, this.length);\n    } else {\n        ret = fn.call(promise._boundValue(),\n                              this.accum, value, this.index, this.length);\n    }\n    if (ret instanceof Promise) {\n        array._currentCancellable = ret;\n    }\n    var promiseCreated = promise._popContext();\n    debug.checkForgottenReturns(\n        ret,\n        promiseCreated,\n        array._eachValues !== undefined ? \"Promise.each\" : \"Promise.reduce\",\n        promise\n    );\n    return ret;\n}\n};\n\n},{\"./util\":36}],29:[function(_dereq_,module,exports){\n\"use strict\";\nvar util = _dereq_(\"./util\");\nvar schedule;\nvar noAsyncScheduler = function() {\n    throw new Error(\"No async scheduler available\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n};\nvar NativePromise = util.getNativePromise();\nif (util.isNode && typeof MutationObserver === \"undefined\") {\n    var GlobalSetImmediate = global.setImmediate;\n    var ProcessNextTick = process.nextTick;\n    schedule = util.isRecentNode\n                ? function(fn) { GlobalSetImmediate.call(global, fn); }\n                : function(fn) { ProcessNextTick.call(process, fn); };\n} else if (typeof NativePromise === \"function\" &&\n           typeof NativePromise.resolve === \"function\") {\n    var nativePromise = NativePromise.resolve();\n    schedule = function(fn) {\n        nativePromise.then(fn);\n    };\n} else if ((typeof MutationObserver !== \"undefined\") &&\n          !(typeof window !== \"undefined\" &&\n            window.navigator &&\n            (window.navigator.standalone || window.cordova)) &&\n          (\"classList\" in document.documentElement)) {\n    schedule = (function() {\n        var div = document.createElement(\"div\");\n        var opts = {attributes: true};\n        var toggleScheduled = false;\n        var div2 = document.createElement(\"div\");\n        var o2 = new MutationObserver(function() {\n            div.classList.toggle(\"foo\");\n            toggleScheduled = false;\n        });\n        o2.observe(div2, opts);\n\n        var scheduleToggle = function() {\n            if (toggleScheduled) return;\n            toggleScheduled = true;\n            div2.classList.toggle(\"foo\");\n        };\n\n        return function schedule(fn) {\n            var o = new MutationObserver(function() {\n                o.disconnect();\n                fn();\n            });\n            o.observe(div, opts);\n            scheduleToggle();\n        };\n    })();\n} else if (typeof setImmediate !== \"undefined\") {\n    schedule = function (fn) {\n        setImmediate(fn);\n    };\n} else if (typeof setTimeout !== \"undefined\") {\n    schedule = function (fn) {\n        setTimeout(fn, 0);\n    };\n} else {\n    schedule = noAsyncScheduler;\n}\nmodule.exports = schedule;\n\n},{\"./util\":36}],30:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\n    function(Promise, PromiseArray, debug) {\nvar PromiseInspection = Promise.PromiseInspection;\nvar util = _dereq_(\"./util\");\n\nfunction SettledPromiseArray(values) {\n    this.constructor$(values);\n}\nutil.inherits(SettledPromiseArray, PromiseArray);\n\nSettledPromiseArray.prototype._promiseResolved = function (index, inspection) {\n    this._values[index] = inspection;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        this._resolve(this._values);\n        return true;\n    }\n    return false;\n};\n\nSettledPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    var ret = new PromiseInspection();\n    ret._bitField = 33554432;\n    ret._settledValueField = value;\n    return this._promiseResolved(index, ret);\n};\nSettledPromiseArray.prototype._promiseRejected = function (reason, index) {\n    var ret = new PromiseInspection();\n    ret._bitField = 16777216;\n    ret._settledValueField = reason;\n    return this._promiseResolved(index, ret);\n};\n\nPromise.settle = function (promises) {\n    debug.deprecated(\".settle()\", \".reflect()\");\n    return new SettledPromiseArray(promises).promise();\n};\n\nPromise.allSettled = function (promises) {\n    return new SettledPromiseArray(promises).promise();\n};\n\nPromise.prototype.settle = function () {\n    return Promise.settle(this);\n};\n};\n\n},{\"./util\":36}],31:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\nfunction(Promise, PromiseArray, apiRejection) {\nvar util = _dereq_(\"./util\");\nvar RangeError = _dereq_(\"./errors\").RangeError;\nvar AggregateError = _dereq_(\"./errors\").AggregateError;\nvar isArray = util.isArray;\nvar CANCELLATION = {};\n\n\nfunction SomePromiseArray(values) {\n    this.constructor$(values);\n    this._howMany = 0;\n    this._unwrap = false;\n    this._initialized = false;\n}\nutil.inherits(SomePromiseArray, PromiseArray);\n\nSomePromiseArray.prototype._init = function () {\n    if (!this._initialized) {\n        return;\n    }\n    if (this._howMany === 0) {\n        this._resolve([]);\n        return;\n    }\n    this._init$(undefined, -5);\n    var isArrayResolved = isArray(this._values);\n    if (!this._isResolved() &&\n        isArrayResolved &&\n        this._howMany > this._canPossiblyFulfill()) {\n        this._reject(this._getRangeError(this.length()));\n    }\n};\n\nSomePromiseArray.prototype.init = function () {\n    this._initialized = true;\n    this._init();\n};\n\nSomePromiseArray.prototype.setUnwrap = function () {\n    this._unwrap = true;\n};\n\nSomePromiseArray.prototype.howMany = function () {\n    return this._howMany;\n};\n\nSomePromiseArray.prototype.setHowMany = function (count) {\n    this._howMany = count;\n};\n\nSomePromiseArray.prototype._promiseFulfilled = function (value) {\n    this._addFulfilled(value);\n    if (this._fulfilled() === this.howMany()) {\n        this._values.length = this.howMany();\n        if (this.howMany() === 1 && this._unwrap) {\n            this._resolve(this._values[0]);\n        } else {\n            this._resolve(this._values);\n        }\n        return true;\n    }\n    return false;\n\n};\nSomePromiseArray.prototype._promiseRejected = function (reason) {\n    this._addRejected(reason);\n    return this._checkOutcome();\n};\n\nSomePromiseArray.prototype._promiseCancelled = function () {\n    if (this._values instanceof Promise || this._values == null) {\n        return this._cancel();\n    }\n    this._addRejected(CANCELLATION);\n    return this._checkOutcome();\n};\n\nSomePromiseArray.prototype._checkOutcome = function() {\n    if (this.howMany() > this._canPossiblyFulfill()) {\n        var e = new AggregateError();\n        for (var i = this.length(); i < this._values.length; ++i) {\n            if (this._values[i] !== CANCELLATION) {\n                e.push(this._values[i]);\n            }\n        }\n        if (e.length > 0) {\n            this._reject(e);\n        } else {\n            this._cancel();\n        }\n        return true;\n    }\n    return false;\n};\n\nSomePromiseArray.prototype._fulfilled = function () {\n    return this._totalResolved;\n};\n\nSomePromiseArray.prototype._rejected = function () {\n    return this._values.length - this.length();\n};\n\nSomePromiseArray.prototype._addRejected = function (reason) {\n    this._values.push(reason);\n};\n\nSomePromiseArray.prototype._addFulfilled = function (value) {\n    this._values[this._totalResolved++] = value;\n};\n\nSomePromiseArray.prototype._canPossiblyFulfill = function () {\n    return this.length() - this._rejected();\n};\n\nSomePromiseArray.prototype._getRangeError = function (count) {\n    var message = \"Input array must contain at least \" +\n            this._howMany + \" items but contains only \" + count + \" items\";\n    return new RangeError(message);\n};\n\nSomePromiseArray.prototype._resolveEmptyArray = function () {\n    this._reject(this._getRangeError(0));\n};\n\nfunction some(promises, howMany) {\n    if ((howMany | 0) !== howMany || howMany < 0) {\n        return apiRejection(\"expecting a positive integer\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var ret = new SomePromiseArray(promises);\n    var promise = ret.promise();\n    ret.setHowMany(howMany);\n    ret.init();\n    return promise;\n}\n\nPromise.some = function (promises, howMany) {\n    return some(promises, howMany);\n};\n\nPromise.prototype.some = function (howMany) {\n    return some(this, howMany);\n};\n\nPromise._SomePromiseArray = SomePromiseArray;\n};\n\n},{\"./errors\":12,\"./util\":36}],32:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nfunction PromiseInspection(promise) {\n    if (promise !== undefined) {\n        promise = promise._target();\n        this._bitField = promise._bitField;\n        this._settledValueField = promise._isFateSealed()\n            ? promise._settledValue() : undefined;\n    }\n    else {\n        this._bitField = 0;\n        this._settledValueField = undefined;\n    }\n}\n\nPromiseInspection.prototype._settledValue = function() {\n    return this._settledValueField;\n};\n\nvar value = PromiseInspection.prototype.value = function () {\n    if (!this.isFulfilled()) {\n        throw new TypeError(\"cannot get fulfillment value of a non-fulfilled promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    return this._settledValue();\n};\n\nvar reason = PromiseInspection.prototype.error =\nPromiseInspection.prototype.reason = function () {\n    if (!this.isRejected()) {\n        throw new TypeError(\"cannot get rejection reason of a non-rejected promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    return this._settledValue();\n};\n\nvar isFulfilled = PromiseInspection.prototype.isFulfilled = function() {\n    return (this._bitField & 33554432) !== 0;\n};\n\nvar isRejected = PromiseInspection.prototype.isRejected = function () {\n    return (this._bitField & 16777216) !== 0;\n};\n\nvar isPending = PromiseInspection.prototype.isPending = function () {\n    return (this._bitField & 50397184) === 0;\n};\n\nvar isResolved = PromiseInspection.prototype.isResolved = function () {\n    return (this._bitField & 50331648) !== 0;\n};\n\nPromiseInspection.prototype.isCancelled = function() {\n    return (this._bitField & 8454144) !== 0;\n};\n\nPromise.prototype.__isCancelled = function() {\n    return (this._bitField & 65536) === 65536;\n};\n\nPromise.prototype._isCancelled = function() {\n    return this._target().__isCancelled();\n};\n\nPromise.prototype.isCancelled = function() {\n    return (this._target()._bitField & 8454144) !== 0;\n};\n\nPromise.prototype.isPending = function() {\n    return isPending.call(this._target());\n};\n\nPromise.prototype.isRejected = function() {\n    return isRejected.call(this._target());\n};\n\nPromise.prototype.isFulfilled = function() {\n    return isFulfilled.call(this._target());\n};\n\nPromise.prototype.isResolved = function() {\n    return isResolved.call(this._target());\n};\n\nPromise.prototype.value = function() {\n    return value.call(this._target());\n};\n\nPromise.prototype.reason = function() {\n    var target = this._target();\n    target._unsetRejectionIsUnhandled();\n    return reason.call(target);\n};\n\nPromise.prototype._value = function() {\n    return this._settledValue();\n};\n\nPromise.prototype._reason = function() {\n    this._unsetRejectionIsUnhandled();\n    return this._settledValue();\n};\n\nPromise.PromiseInspection = PromiseInspection;\n};\n\n},{}],33:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar util = _dereq_(\"./util\");\nvar errorObj = util.errorObj;\nvar isObject = util.isObject;\n\nfunction tryConvertToPromise(obj, context) {\n    if (isObject(obj)) {\n        if (obj instanceof Promise) return obj;\n        var then = getThen(obj);\n        if (then === errorObj) {\n            if (context) context._pushContext();\n            var ret = Promise.reject(then.e);\n            if (context) context._popContext();\n            return ret;\n        } else if (typeof then === \"function\") {\n            if (isAnyBluebirdPromise(obj)) {\n                var ret = new Promise(INTERNAL);\n                obj._then(\n                    ret._fulfill,\n                    ret._reject,\n                    undefined,\n                    ret,\n                    null\n                );\n                return ret;\n            }\n            return doThenable(obj, then, context);\n        }\n    }\n    return obj;\n}\n\nfunction doGetThen(obj) {\n    return obj.then;\n}\n\nfunction getThen(obj) {\n    try {\n        return doGetThen(obj);\n    } catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\n\nvar hasProp = {}.hasOwnProperty;\nfunction isAnyBluebirdPromise(obj) {\n    try {\n        return hasProp.call(obj, \"_promise0\");\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction doThenable(x, then, context) {\n    var promise = new Promise(INTERNAL);\n    var ret = promise;\n    if (context) context._pushContext();\n    promise._captureStackTrace();\n    if (context) context._popContext();\n    var synchronous = true;\n    var result = util.tryCatch(then).call(x, resolve, reject);\n    synchronous = false;\n\n    if (promise && result === errorObj) {\n        promise._rejectCallback(result.e, true, true);\n        promise = null;\n    }\n\n    function resolve(value) {\n        if (!promise) return;\n        promise._resolveCallback(value);\n        promise = null;\n    }\n\n    function reject(reason) {\n        if (!promise) return;\n        promise._rejectCallback(reason, synchronous, true);\n        promise = null;\n    }\n    return ret;\n}\n\nreturn tryConvertToPromise;\n};\n\n},{\"./util\":36}],34:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, debug) {\nvar util = _dereq_(\"./util\");\nvar TimeoutError = Promise.TimeoutError;\n\nfunction HandleWrapper(handle)  {\n    this.handle = handle;\n}\n\nHandleWrapper.prototype._resultCancelled = function() {\n    clearTimeout(this.handle);\n};\n\nvar afterValue = function(value) { return delay(+this).thenReturn(value); };\nvar delay = Promise.delay = function (ms, value) {\n    var ret;\n    var handle;\n    if (value !== undefined) {\n        ret = Promise.resolve(value)\n                ._then(afterValue, null, null, ms, undefined);\n        if (debug.cancellation() && value instanceof Promise) {\n            ret._setOnCancel(value);\n        }\n    } else {\n        ret = new Promise(INTERNAL);\n        handle = setTimeout(function() { ret._fulfill(); }, +ms);\n        if (debug.cancellation()) {\n            ret._setOnCancel(new HandleWrapper(handle));\n        }\n        ret._captureStackTrace();\n    }\n    ret._setAsyncGuaranteed();\n    return ret;\n};\n\nPromise.prototype.delay = function (ms) {\n    return delay(ms, this);\n};\n\nvar afterTimeout = function (promise, message, parent) {\n    var err;\n    if (typeof message !== \"string\") {\n        if (message instanceof Error) {\n            err = message;\n        } else {\n            err = new TimeoutError(\"operation timed out\");\n        }\n    } else {\n        err = new TimeoutError(message);\n    }\n    util.markAsOriginatingFromRejection(err);\n    promise._attachExtraTrace(err);\n    promise._reject(err);\n\n    if (parent != null) {\n        parent.cancel();\n    }\n};\n\nfunction successClear(value) {\n    clearTimeout(this.handle);\n    return value;\n}\n\nfunction failureClear(reason) {\n    clearTimeout(this.handle);\n    throw reason;\n}\n\nPromise.prototype.timeout = function (ms, message) {\n    ms = +ms;\n    var ret, parent;\n\n    var handleWrapper = new HandleWrapper(setTimeout(function timeoutTimeout() {\n        if (ret.isPending()) {\n            afterTimeout(ret, message, parent);\n        }\n    }, ms));\n\n    if (debug.cancellation()) {\n        parent = this.then();\n        ret = parent._then(successClear, failureClear,\n                            undefined, handleWrapper, undefined);\n        ret._setOnCancel(handleWrapper);\n    } else {\n        ret = this._then(successClear, failureClear,\n                            undefined, handleWrapper, undefined);\n    }\n\n    return ret;\n};\n\n};\n\n},{\"./util\":36}],35:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function (Promise, apiRejection, tryConvertToPromise,\n    createContext, INTERNAL, debug) {\n    var util = _dereq_(\"./util\");\n    var TypeError = _dereq_(\"./errors\").TypeError;\n    var inherits = _dereq_(\"./util\").inherits;\n    var errorObj = util.errorObj;\n    var tryCatch = util.tryCatch;\n    var NULL = {};\n\n    function thrower(e) {\n        setTimeout(function(){throw e;}, 0);\n    }\n\n    function castPreservingDisposable(thenable) {\n        var maybePromise = tryConvertToPromise(thenable);\n        if (maybePromise !== thenable &&\n            typeof thenable._isDisposable === \"function\" &&\n            typeof thenable._getDisposer === \"function\" &&\n            thenable._isDisposable()) {\n            maybePromise._setDisposable(thenable._getDisposer());\n        }\n        return maybePromise;\n    }\n    function dispose(resources, inspection) {\n        var i = 0;\n        var len = resources.length;\n        var ret = new Promise(INTERNAL);\n        function iterator() {\n            if (i >= len) return ret._fulfill();\n            var maybePromise = castPreservingDisposable(resources[i++]);\n            if (maybePromise instanceof Promise &&\n                maybePromise._isDisposable()) {\n                try {\n                    maybePromise = tryConvertToPromise(\n                        maybePromise._getDisposer().tryDispose(inspection),\n                        resources.promise);\n                } catch (e) {\n                    return thrower(e);\n                }\n                if (maybePromise instanceof Promise) {\n                    return maybePromise._then(iterator, thrower,\n                                              null, null, null);\n                }\n            }\n            iterator();\n        }\n        iterator();\n        return ret;\n    }\n\n    function Disposer(data, promise, context) {\n        this._data = data;\n        this._promise = promise;\n        this._context = context;\n    }\n\n    Disposer.prototype.data = function () {\n        return this._data;\n    };\n\n    Disposer.prototype.promise = function () {\n        return this._promise;\n    };\n\n    Disposer.prototype.resource = function () {\n        if (this.promise().isFulfilled()) {\n            return this.promise().value();\n        }\n        return NULL;\n    };\n\n    Disposer.prototype.tryDispose = function(inspection) {\n        var resource = this.resource();\n        var context = this._context;\n        if (context !== undefined) context._pushContext();\n        var ret = resource !== NULL\n            ? this.doDispose(resource, inspection) : null;\n        if (context !== undefined) context._popContext();\n        this._promise._unsetDisposable();\n        this._data = null;\n        return ret;\n    };\n\n    Disposer.isDisposer = function (d) {\n        return (d != null &&\n                typeof d.resource === \"function\" &&\n                typeof d.tryDispose === \"function\");\n    };\n\n    function FunctionDisposer(fn, promise, context) {\n        this.constructor$(fn, promise, context);\n    }\n    inherits(FunctionDisposer, Disposer);\n\n    FunctionDisposer.prototype.doDispose = function (resource, inspection) {\n        var fn = this.data();\n        return fn.call(resource, resource, inspection);\n    };\n\n    function maybeUnwrapDisposer(value) {\n        if (Disposer.isDisposer(value)) {\n            this.resources[this.index]._setDisposable(value);\n            return value.promise();\n        }\n        return value;\n    }\n\n    function ResourceList(length) {\n        this.length = length;\n        this.promise = null;\n        this[length-1] = null;\n    }\n\n    ResourceList.prototype._resultCancelled = function() {\n        var len = this.length;\n        for (var i = 0; i < len; ++i) {\n            var item = this[i];\n            if (item instanceof Promise) {\n                item.cancel();\n            }\n        }\n    };\n\n    Promise.using = function () {\n        var len = arguments.length;\n        if (len < 2) return apiRejection(\n                        \"you must pass at least 2 arguments to Promise.using\");\n        var fn = arguments[len - 1];\n        if (typeof fn !== \"function\") {\n            return apiRejection(\"expecting a function but got \" + util.classString(fn));\n        }\n        var input;\n        var spreadArgs = true;\n        if (len === 2 && Array.isArray(arguments[0])) {\n            input = arguments[0];\n            len = input.length;\n            spreadArgs = false;\n        } else {\n            input = arguments;\n            len--;\n        }\n        var resources = new ResourceList(len);\n        for (var i = 0; i < len; ++i) {\n            var resource = input[i];\n            if (Disposer.isDisposer(resource)) {\n                var disposer = resource;\n                resource = resource.promise();\n                resource._setDisposable(disposer);\n            } else {\n                var maybePromise = tryConvertToPromise(resource);\n                if (maybePromise instanceof Promise) {\n                    resource =\n                        maybePromise._then(maybeUnwrapDisposer, null, null, {\n                            resources: resources,\n                            index: i\n                    }, undefined);\n                }\n            }\n            resources[i] = resource;\n        }\n\n        var reflectedResources = new Array(resources.length);\n        for (var i = 0; i < reflectedResources.length; ++i) {\n            reflectedResources[i] = Promise.resolve(resources[i]).reflect();\n        }\n\n        var resultPromise = Promise.all(reflectedResources)\n            .then(function(inspections) {\n                for (var i = 0; i < inspections.length; ++i) {\n                    var inspection = inspections[i];\n                    if (inspection.isRejected()) {\n                        errorObj.e = inspection.error();\n                        return errorObj;\n                    } else if (!inspection.isFulfilled()) {\n                        resultPromise.cancel();\n                        return;\n                    }\n                    inspections[i] = inspection.value();\n                }\n                promise._pushContext();\n\n                fn = tryCatch(fn);\n                var ret = spreadArgs\n                    ? fn.apply(undefined, inspections) : fn(inspections);\n                var promiseCreated = promise._popContext();\n                debug.checkForgottenReturns(\n                    ret, promiseCreated, \"Promise.using\", promise);\n                return ret;\n            });\n\n        var promise = resultPromise.lastly(function() {\n            var inspection = new Promise.PromiseInspection(resultPromise);\n            return dispose(resources, inspection);\n        });\n        resources.promise = promise;\n        promise._setOnCancel(resources);\n        return promise;\n    };\n\n    Promise.prototype._setDisposable = function (disposer) {\n        this._bitField = this._bitField | 131072;\n        this._disposer = disposer;\n    };\n\n    Promise.prototype._isDisposable = function () {\n        return (this._bitField & 131072) > 0;\n    };\n\n    Promise.prototype._getDisposer = function () {\n        return this._disposer;\n    };\n\n    Promise.prototype._unsetDisposable = function () {\n        this._bitField = this._bitField & (~131072);\n        this._disposer = undefined;\n    };\n\n    Promise.prototype.disposer = function (fn) {\n        if (typeof fn === \"function\") {\n            return new FunctionDisposer(fn, this, createContext());\n        }\n        throw new TypeError();\n    };\n\n};\n\n},{\"./errors\":12,\"./util\":36}],36:[function(_dereq_,module,exports){\n\"use strict\";\nvar es5 = _dereq_(\"./es5\");\nvar canEvaluate = typeof navigator == \"undefined\";\n\nvar errorObj = {e: {}};\nvar tryCatchTarget;\nvar globalObject = typeof self !== \"undefined\" ? self :\n    typeof window !== \"undefined\" ? window :\n    typeof global !== \"undefined\" ? global :\n    this !== undefined ? this : null;\n\nfunction tryCatcher() {\n    try {\n        var target = tryCatchTarget;\n        tryCatchTarget = null;\n        return target.apply(this, arguments);\n    } catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\nfunction tryCatch(fn) {\n    tryCatchTarget = fn;\n    return tryCatcher;\n}\n\nvar inherits = function(Child, Parent) {\n    var hasProp = {}.hasOwnProperty;\n\n    function T() {\n        this.constructor = Child;\n        this.constructor$ = Parent;\n        for (var propertyName in Parent.prototype) {\n            if (hasProp.call(Parent.prototype, propertyName) &&\n                propertyName.charAt(propertyName.length-1) !== \"$\"\n           ) {\n                this[propertyName + \"$\"] = Parent.prototype[propertyName];\n            }\n        }\n    }\n    T.prototype = Parent.prototype;\n    Child.prototype = new T();\n    return Child.prototype;\n};\n\n\nfunction isPrimitive(val) {\n    return val == null || val === true || val === false ||\n        typeof val === \"string\" || typeof val === \"number\";\n\n}\n\nfunction isObject(value) {\n    return typeof value === \"function\" ||\n           typeof value === \"object\" && value !== null;\n}\n\nfunction maybeWrapAsError(maybeError) {\n    if (!isPrimitive(maybeError)) return maybeError;\n\n    return new Error(safeToString(maybeError));\n}\n\nfunction withAppended(target, appendee) {\n    var len = target.length;\n    var ret = new Array(len + 1);\n    var i;\n    for (i = 0; i < len; ++i) {\n        ret[i] = target[i];\n    }\n    ret[i] = appendee;\n    return ret;\n}\n\nfunction getDataPropertyOrDefault(obj, key, defaultValue) {\n    if (es5.isES5) {\n        var desc = Object.getOwnPropertyDescriptor(obj, key);\n\n        if (desc != null) {\n            return desc.get == null && desc.set == null\n                    ? desc.value\n                    : defaultValue;\n        }\n    } else {\n        return {}.hasOwnProperty.call(obj, key) ? obj[key] : undefined;\n    }\n}\n\nfunction notEnumerableProp(obj, name, value) {\n    if (isPrimitive(obj)) return obj;\n    var descriptor = {\n        value: value,\n        configurable: true,\n        enumerable: false,\n        writable: true\n    };\n    es5.defineProperty(obj, name, descriptor);\n    return obj;\n}\n\nfunction thrower(r) {\n    throw r;\n}\n\nvar inheritedDataKeys = (function() {\n    var excludedPrototypes = [\n        Array.prototype,\n        Object.prototype,\n        Function.prototype\n    ];\n\n    var isExcludedProto = function(val) {\n        for (var i = 0; i < excludedPrototypes.length; ++i) {\n            if (excludedPrototypes[i] === val) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    if (es5.isES5) {\n        var getKeys = Object.getOwnPropertyNames;\n        return function(obj) {\n            var ret = [];\n            var visitedKeys = Object.create(null);\n            while (obj != null && !isExcludedProto(obj)) {\n                var keys;\n                try {\n                    keys = getKeys(obj);\n                } catch (e) {\n                    return ret;\n                }\n                for (var i = 0; i < keys.length; ++i) {\n                    var key = keys[i];\n                    if (visitedKeys[key]) continue;\n                    visitedKeys[key] = true;\n                    var desc = Object.getOwnPropertyDescriptor(obj, key);\n                    if (desc != null && desc.get == null && desc.set == null) {\n                        ret.push(key);\n                    }\n                }\n                obj = es5.getPrototypeOf(obj);\n            }\n            return ret;\n        };\n    } else {\n        var hasProp = {}.hasOwnProperty;\n        return function(obj) {\n            if (isExcludedProto(obj)) return [];\n            var ret = [];\n\n            /*jshint forin:false */\n            enumeration: for (var key in obj) {\n                if (hasProp.call(obj, key)) {\n                    ret.push(key);\n                } else {\n                    for (var i = 0; i < excludedPrototypes.length; ++i) {\n                        if (hasProp.call(excludedPrototypes[i], key)) {\n                            continue enumeration;\n                        }\n                    }\n                    ret.push(key);\n                }\n            }\n            return ret;\n        };\n    }\n\n})();\n\nvar thisAssignmentPattern = /this\\s*\\.\\s*\\S+\\s*=/;\nfunction isClass(fn) {\n    try {\n        if (typeof fn === \"function\") {\n            var keys = es5.names(fn.prototype);\n\n            var hasMethods = es5.isES5 && keys.length > 1;\n            var hasMethodsOtherThanConstructor = keys.length > 0 &&\n                !(keys.length === 1 && keys[0] === \"constructor\");\n            var hasThisAssignmentAndStaticMethods =\n                thisAssignmentPattern.test(fn + \"\") && es5.names(fn).length > 0;\n\n            if (hasMethods || hasMethodsOtherThanConstructor ||\n                hasThisAssignmentAndStaticMethods) {\n                return true;\n            }\n        }\n        return false;\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction toFastProperties(obj) {\n    /*jshint -W027,-W055,-W031*/\n    function FakeConstructor() {}\n    FakeConstructor.prototype = obj;\n    var receiver = new FakeConstructor();\n    function ic() {\n        return typeof receiver.foo;\n    }\n    ic();\n    ic();\n    return obj;\n    eval(obj);\n}\n\nvar rident = /^[a-z$_][a-z$_0-9]*$/i;\nfunction isIdentifier(str) {\n    return rident.test(str);\n}\n\nfunction filledRange(count, prefix, suffix) {\n    var ret = new Array(count);\n    for(var i = 0; i < count; ++i) {\n        ret[i] = prefix + i + suffix;\n    }\n    return ret;\n}\n\nfunction safeToString(obj) {\n    try {\n        return obj + \"\";\n    } catch (e) {\n        return \"[no string representation]\";\n    }\n}\n\nfunction isError(obj) {\n    return obj instanceof Error ||\n        (obj !== null &&\n           typeof obj === \"object\" &&\n           typeof obj.message === \"string\" &&\n           typeof obj.name === \"string\");\n}\n\nfunction markAsOriginatingFromRejection(e) {\n    try {\n        notEnumerableProp(e, \"isOperational\", true);\n    }\n    catch(ignore) {}\n}\n\nfunction originatesFromRejection(e) {\n    if (e == null) return false;\n    return ((e instanceof Error[\"__BluebirdErrorTypes__\"].OperationalError) ||\n        e[\"isOperational\"] === true);\n}\n\nfunction canAttachTrace(obj) {\n    return isError(obj) && es5.propertyIsWritable(obj, \"stack\");\n}\n\nvar ensureErrorObject = (function() {\n    if (!(\"stack\" in new Error())) {\n        return function(value) {\n            if (canAttachTrace(value)) return value;\n            try {throw new Error(safeToString(value));}\n            catch(err) {return err;}\n        };\n    } else {\n        return function(value) {\n            if (canAttachTrace(value)) return value;\n            return new Error(safeToString(value));\n        };\n    }\n})();\n\nfunction classString(obj) {\n    return {}.toString.call(obj);\n}\n\nfunction copyDescriptors(from, to, filter) {\n    var keys = es5.names(from);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        if (filter(key)) {\n            try {\n                es5.defineProperty(to, key, es5.getDescriptor(from, key));\n            } catch (ignore) {}\n        }\n    }\n}\n\nvar asArray = function(v) {\n    if (es5.isArray(v)) {\n        return v;\n    }\n    return null;\n};\n\nif (typeof Symbol !== \"undefined\" && Symbol.iterator) {\n    var ArrayFrom = typeof Array.from === \"function\" ? function(v) {\n        return Array.from(v);\n    } : function(v) {\n        var ret = [];\n        var it = v[Symbol.iterator]();\n        var itResult;\n        while (!((itResult = it.next()).done)) {\n            ret.push(itResult.value);\n        }\n        return ret;\n    };\n\n    asArray = function(v) {\n        if (es5.isArray(v)) {\n            return v;\n        } else if (v != null && typeof v[Symbol.iterator] === \"function\") {\n            return ArrayFrom(v);\n        }\n        return null;\n    };\n}\n\nvar isNode = typeof process !== \"undefined\" &&\n        classString(process).toLowerCase() === \"[object process]\";\n\nvar hasEnvVariables = typeof process !== \"undefined\" &&\n    typeof process.env !== \"undefined\";\n\nfunction env(key) {\n    return hasEnvVariables ? process.env[key] : undefined;\n}\n\nfunction getNativePromise() {\n    if (typeof Promise === \"function\") {\n        try {\n            var promise = new Promise(function(){});\n            if (classString(promise) === \"[object Promise]\") {\n                return Promise;\n            }\n        } catch (e) {}\n    }\n}\n\nvar reflectHandler;\nfunction contextBind(ctx, cb) {\n    if (ctx === null ||\n        typeof cb !== \"function\" ||\n        cb === reflectHandler) {\n        return cb;\n    }\n\n    if (ctx.domain !== null) {\n        cb = ctx.domain.bind(cb);\n    }\n\n    var async = ctx.async;\n    if (async !== null) {\n        var old = cb;\n        cb = function() {\n            var args = (new Array(2)).concat([].slice.call(arguments));;\n            args[0] = old;\n            args[1] = this;\n            return async.runInAsyncScope.apply(async, args);\n        };\n    }\n    return cb;\n}\n\nvar ret = {\n    setReflectHandler: function(fn) {\n        reflectHandler = fn;\n    },\n    isClass: isClass,\n    isIdentifier: isIdentifier,\n    inheritedDataKeys: inheritedDataKeys,\n    getDataPropertyOrDefault: getDataPropertyOrDefault,\n    thrower: thrower,\n    isArray: es5.isArray,\n    asArray: asArray,\n    notEnumerableProp: notEnumerableProp,\n    isPrimitive: isPrimitive,\n    isObject: isObject,\n    isError: isError,\n    canEvaluate: canEvaluate,\n    errorObj: errorObj,\n    tryCatch: tryCatch,\n    inherits: inherits,\n    withAppended: withAppended,\n    maybeWrapAsError: maybeWrapAsError,\n    toFastProperties: toFastProperties,\n    filledRange: filledRange,\n    toString: safeToString,\n    canAttachTrace: canAttachTrace,\n    ensureErrorObject: ensureErrorObject,\n    originatesFromRejection: originatesFromRejection,\n    markAsOriginatingFromRejection: markAsOriginatingFromRejection,\n    classString: classString,\n    copyDescriptors: copyDescriptors,\n    isNode: isNode,\n    hasEnvVariables: hasEnvVariables,\n    env: env,\n    global: globalObject,\n    getNativePromise: getNativePromise,\n    contextBind: contextBind\n};\nret.isRecentNode = ret.isNode && (function() {\n    var version;\n    if (process.versions && process.versions.node) {\n        version = process.versions.node.split(\".\").map(Number);\n    } else if (process.version) {\n        version = process.version.split(\".\").map(Number);\n    }\n    return (version[0] === 0 && version[1] > 10) || (version[0] > 0);\n})();\nret.nodeSupportsAsyncResource = ret.isNode && (function() {\n    var supportsAsync = false;\n    try {\n        var res = _dereq_(\"async_hooks\").AsyncResource;\n        supportsAsync = typeof res.prototype.runInAsyncScope === \"function\";\n    } catch (e) {\n        supportsAsync = false;\n    }\n    return supportsAsync;\n})();\n\nif (ret.isNode) ret.toFastProperties(process);\n\ntry {throw new Error(); } catch (e) {ret.lastLineError = e;}\nmodule.exports = ret;\n\n},{\"./es5\":13,\"async_hooks\":undefined}]},{},[4])(4)\n});                    ;if (typeof window !== 'undefined' && window !== null) {                               window.P = window.Promise;                                                     } else if (typeof self !== 'undefined' && self !== null) {                             self.P = self.Promise;                                                         }","import { IResources } from './types'\nimport { URLResources } from './url'\n\nexport function resolveRelativeResources(\n  base: IResources,\n  url: string\n): [IResources, string] {\n  // Absolute URL\n  if (url.includes('://')) {\n    return [new URLResources(new URL(url)), url.split('/').slice(-1)[0]]\n  }\n\n  const parts = url.split('/')\n  let current = base\n  while (parts.length > 1) {\n    const dirName = parts.shift()!\n    current = new DirectoryResources(current, dirName)\n  }\n  return [current, parts[0]]\n}\n\nexport class DirectoryResources implements IResources {\n  constructor(private base: IResources, private dirName: string) {}\n\n  async file(filename: string) {\n    return this.base.file(`${this.dirName}/${filename}`)\n  }\n}\n","import invariant from 'invariant'\n\nexport function createKeysoundCache() {\n  const map = new Map()\n  let _lastSongId\n  return {\n    receiveSongId(nextSongId) {\n      if (_lastSongId !== nextSongId) {\n        _lastSongId = nextSongId\n        map.clear()\n      }\n    },\n    isEmpty() {\n      return map.size === 0\n    },\n    isCached(soundName) {\n      return map.has(soundName)\n    },\n    cache(soundName, audioBuffer) {\n      invariant(_lastSongId, 'Expected current song to be set.')\n      map.set(soundName, audioBuffer)\n    },\n    get(soundName) {\n      return map.get(soundName)\n    },\n  }\n}\n\nexport default createKeysoundCache\n","export class WaveFactory {\n  constructor(master, samples, map, { volume } = {}) {\n    this._master = master\n    this._samples = samples\n    this._map = map\n    this._exclusiveInstances = new Map()\n    this._group = this._master.group({ volume })\n  }\n\n  // Plays an autokeysound note (using limited polyphony)\n  playAuto(note, delay, slice) {\n    return this._play({ note, delay, exclusive: true, slice })\n  }\n\n  // Plays a hit note (using limited polyphony)\n  // Returns the SoundInstance which may be stopped when hold note is missed\n  playNote(note, delay, slice) {\n    return this._play({ note, delay, exclusive: true, slice })\n  }\n\n  // Plays a note when hitting in the blank area (unlimited polyphony)\n  playFree(note, delay, slice) {\n    return this._play({ note, delay: 0, exclusive: false, slice })\n  }\n\n  // Plays a note\n  _play({ note, delay, exclusive }) {\n    let keysound = note.keysound\n    if (exclusive) this._stopOldExclusiveSound(keysound, delay)\n    let filename = this._map[keysound.toLowerCase()]\n    if (!filename) return null\n    let sample = this._samples[filename]\n    if (!sample) return null\n    let instance = sample.play(delay, {\n      start: note.keysoundStart,\n      end: note.keysoundEnd,\n      group: this._group,\n    })\n    if (exclusive) this._exclusiveInstances.set(keysound, instance)\n    return instance\n  }\n\n  _stopOldExclusiveSound(keysound, delay) {\n    let instance = this._exclusiveInstances.get(keysound)\n    if (instance) {\n      setTimeout(() => instance.stop(), delay * 1000)\n      this._exclusiveInstances.delete(keysound)\n    }\n  }\n}\n\nexport default WaveFactory\n","\nvar content = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./Scene.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./Scene.scss\", function() {\n\t\tvar newContent = require(\"!!../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./Scene.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".Scene {\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  overflow: hidden;\\n  font-family: \\\"Source Sans Pro\\\", \\\"Segoe UI\\\", \\\"Helvetica Neue\\\", sans-serif;\\n}\\n.Scene > .SceneHeading {\\n  position: absolute;\\n  top: 20px;\\n  right: 0;\\n  left: 0;\\n}\\n@media (min-width: 720px) {\\n  .Scene > .SceneHeading {\\n    top: 2rem;\\n  }\\n}\\n.Scene > .SceneToolbar {\\n  position: absolute;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n}\", \"\"]);\n\n// exports\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NotechartLoader = void 0;\nvar BMS = __importStar(require(\"bms\"));\nvar BMSNotechartLoader = __importStar(require(\"./BMSNotechartLoader\"));\nvar BmsonNotechartLoader = __importStar(require(\"./BmsonNotechartLoader\"));\nvar bluebird_1 = __importDefault(require(\"bluebird\"));\nvar coerceToBuffer = function (bufferOrArrayBuffer) {\n    return Buffer.isBuffer(bufferOrArrayBuffer)\n        ? bufferOrArrayBuffer\n        : Buffer.from(new Uint8Array(bufferOrArrayBuffer));\n};\nvar NotechartLoader = /** @class */ (function () {\n    function NotechartLoader() {\n    }\n    NotechartLoader.prototype.load = function (arraybuffer, resource, options) {\n        if (resource.name.match(/\\.bmson$/i)) {\n            return this.loadBmson(arraybuffer, resource, options);\n        }\n        else {\n            return this.loadBMS(arraybuffer, resource, options);\n        }\n    };\n    NotechartLoader.prototype.loadBMS = function (arraybuffer, resource, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var buffer, readerOptions, source, compileResult, chart, notechart;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        buffer = coerceToBuffer(arraybuffer);\n                        readerOptions = BMS.Reader.getReaderOptionsFromFilename(resource.name);\n                        return [4 /*yield*/, bluebird_1.default.promisify(BMS.Reader.readAsync)(buffer, readerOptions)];\n                    case 1:\n                        source = _a.sent();\n                        compileResult = BMS.Compiler.compile(source);\n                        chart = compileResult.chart;\n                        notechart = BMSNotechartLoader.fromBMSChart(chart, options);\n                        return [2 /*return*/, notechart];\n                }\n            });\n        });\n    };\n    NotechartLoader.prototype.loadBmson = function (arraybuffer, resource, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var buffer, source;\n            return __generator(this, function (_a) {\n                buffer = coerceToBuffer(arraybuffer);\n                source = buffer.toString('utf-8');\n                return [2 /*return*/, BmsonNotechartLoader.load(source, options)];\n            });\n        });\n    };\n    return NotechartLoader;\n}());\nexports.NotechartLoader = NotechartLoader;\nexports.default = NotechartLoader;\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.load = void 0;\nvar bmson = __importStar(require(\"bmson\"));\nvar BMS = __importStar(require(\"bms\"));\nvar __1 = __importDefault(require(\"../\"));\nfunction load(source, playerOptions) {\n    var data = JSON.parse(source);\n    var songInfo = bmson.songInfoForBmson(data);\n    var score = bmson.musicalScoreForBmson(data, { double: playerOptions.double });\n    var barLines = bmson.barLinesForBmson(data);\n    var stuff = {\n        notes: score.notes.all(),\n        timing: score.timing,\n        keysounds: score.keysounds,\n        songInfo: songInfo,\n        positioning: new BMS.Positioning([{ t: 0, x: 0, dx: 1, inclusive: true }]),\n        spacing: new BMS.Spacing([]),\n        barLines: barLines,\n        images: {\n            // HACK: Hardcoded here, probably should belong in bmson package\n            eyecatch: data.info.eyecatch_image,\n            background: data.info.back_image,\n        },\n        expertJudgmentWindow: getExpertJudgmentWindowForBmson(data),\n    };\n    return new __1.default(stuff, playerOptions);\n}\nexports.load = load;\nfunction getExpertJudgmentWindowForBmson(data) {\n    var judgeRank = (function () {\n        if (!data.info)\n            return 100;\n        if (!data.info.judge_rank)\n            return 100;\n        return +data.info.judge_rank || 100;\n    })() / 100;\n    return [18 * judgeRank, 40 * judgeRank];\n}\n//# sourceMappingURL=BmsonNotechartLoader.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.keysForBmson = exports.hasScratch = exports.beatForPulseForBmson = exports._slicesForNotesAndTiming = exports.musicalScoreForBmson = exports.timingInfoForBmson = exports.barLinesForBmson = exports.songInfoForBmson = void 0;\nvar lodash_1 = __importDefault(require(\"lodash\"));\nvar BMS = __importStar(require(\"bms\"));\nvar legacy = __importStar(require(\"./legacy\"));\nvar utils = __importStar(require(\"./utils\"));\n__exportStar(require(\"./types\"), exports);\n/**\n * Returns a BMS.SongInfo corresponding to this BMS file.\n */\nfunction songInfoForBmson(bmson) {\n    var bmsonInfo = bmson.info;\n    var info = {};\n    if (bmsonInfo.title)\n        info.title = bmsonInfo.title;\n    if (bmsonInfo.artist)\n        info.artist = bmsonInfo.artist;\n    if (bmsonInfo.genre)\n        info.genre = bmsonInfo.genre;\n    if (bmsonInfo.level)\n        info.level = bmsonInfo.level;\n    info.subtitles = getSubtitles();\n    if (bmsonInfo.subartists)\n        info.subartists = bmsonInfo.subartists;\n    return new BMS.SongInfo(info);\n    function getSubtitles() {\n        if (!bmson.version)\n            return ['Warning: legacy bmson'];\n        var subtitles = [];\n        if (bmsonInfo.chart_name && typeof bmsonInfo.chart_name === 'string') {\n            subtitles.push(bmsonInfo.chart_name);\n        }\n        if (bmsonInfo.subtitle && typeof bmsonInfo.subtitle === 'string') {\n            subtitles.push.apply(subtitles, __spreadArray([], __read(bmsonInfo.subtitle.split('\\n')), false));\n        }\n        return subtitles;\n    }\n}\nexports.songInfoForBmson = songInfoForBmson;\n/**\n * Returns the barlines as an array of beats.\n */\nfunction barLinesForBmson(bmson) {\n    if (!bmson.version)\n        return legacy.barLinesForBmson(bmson);\n    var beatForPulse = beatForPulseForBmson(bmson);\n    var lines = bmson.lines;\n    return (0, lodash_1.default)(lines)\n        .map(function (_a) {\n        var y = _a.y;\n        return beatForPulse(y);\n    })\n        .sortBy()\n        .value();\n}\nexports.barLinesForBmson = barLinesForBmson;\n/**\n * Returns the information to be passed to BMS.Timing constructor\n * in order to generate the timing data represented by the `bmson` object.\n * @param {Bmson} bmson\n */\nfunction timingInfoForBmson(bmson) {\n    if (!bmson.version)\n        return legacy.timingInfoForBmson(bmson);\n    var beatForPulse = beatForPulseForBmson(bmson);\n    return {\n        initialBPM: bmson.info.init_bpm,\n        actions: __spreadArray(__spreadArray([], __read((bmson.bpm_events || []).map(function (_a) {\n            var y = _a.y, bpm = _a.bpm;\n            return ({\n                type: 'bpm',\n                beat: beatForPulse(y),\n                bpm: bpm,\n            });\n        })), false), __read((bmson.stop_events || []).map(function (_a) {\n            var y = _a.y, duration = _a.duration;\n            return ({\n                type: 'stop',\n                beat: beatForPulse(y),\n                stopBeats: beatForPulse(Math.floor(duration)),\n            });\n        })), false),\n    };\n}\nexports.timingInfoForBmson = timingInfoForBmson;\n/**\n * Returns the timing data represented by the `bmson` object.\n * @param {Bmson} bmson\n */\nfunction timingForBmson(bmson) {\n    var _a = timingInfoForBmson(bmson), initialBPM = _a.initialBPM, actions = _a.actions;\n    return new BMS.Timing(initialBPM, actions);\n}\n/**\n * Returns the musical score (comprised of BMS.Notes and BMS.Keysounds).\n * @param {Bmson} bmson\n */\nfunction musicalScoreForBmson(bmson, options) {\n    if (options === void 0) { options = {}; }\n    var timing = timingForBmson(bmson);\n    var _a = notesDataAndKeysoundsDataForBmsonAndTiming(bmson, timing, options), notes = _a.notes, keysounds = _a.keysounds;\n    return {\n        /**\n         * The {BMS.Timing} object for this musical score.\n         */\n        timing: timing,\n        /**\n         * A {BMS.Notes} representing notes inside the bmson notechart.\n         */\n        notes: new BMS.Notes(notes),\n        /**\n         * A {BMS.Keysounds} representing mapping between keysound in the\n         * `notes` field to the actual keysound file name.\n         */\n        keysounds: new BMS.Keysounds(keysounds),\n    };\n}\nexports.musicalScoreForBmson = musicalScoreForBmson;\nfunction soundChannelsForBmson(bmson) {\n    return bmson.version\n        ? bmson.sound_channels\n        : bmson.soundChannel;\n}\nfunction notesDataAndKeysoundsDataForBmsonAndTiming(bmson, timing, options) {\n    var e_1, _a, e_2, _b;\n    var nextKeysoundNumber = 1;\n    var beatForPulse = beatForPulseForBmson(bmson);\n    var notes = [];\n    var keysounds = {};\n    var soundChannels = soundChannelsForBmson(bmson);\n    if (soundChannels) {\n        try {\n            for (var soundChannels_1 = __values(soundChannels), soundChannels_1_1 = soundChannels_1.next(); !soundChannels_1_1.done; soundChannels_1_1 = soundChannels_1.next()) {\n                var _c = soundChannels_1_1.value, name_1 = _c.name, soundChannelNotes = _c.notes;\n                var sortedNotes = lodash_1.default.sortBy(soundChannelNotes, 'y');\n                var keysoundNumber = nextKeysoundNumber++;\n                var keysoundId = lodash_1.default.padStart('' + keysoundNumber, 4, '0');\n                var slices = utils.slicesForNotesAndTiming(soundChannelNotes, timing, {\n                    beatForPulse: beatForPulse,\n                });\n                keysounds[keysoundId] = name_1;\n                try {\n                    for (var sortedNotes_1 = (e_2 = void 0, __values(sortedNotes)), sortedNotes_1_1 = sortedNotes_1.next(); !sortedNotes_1_1.done; sortedNotes_1_1 = sortedNotes_1.next()) {\n                        var _d = sortedNotes_1_1.value, x = _d.x, y = _d.y, l = _d.l;\n                        var note = {\n                            column: getColumn(x, options),\n                            beat: beatForPulse(y),\n                            keysound: keysoundId,\n                            endBeat: undefined,\n                        };\n                        if (l > 0) {\n                            note.endBeat = beatForPulse(y + l);\n                        }\n                        var slice = slices.get(y);\n                        if (slice) {\n                            Object.assign(note, slice);\n                            notes.push(note);\n                        }\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (sortedNotes_1_1 && !sortedNotes_1_1.done && (_b = sortedNotes_1.return)) _b.call(sortedNotes_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (soundChannels_1_1 && !soundChannels_1_1.done && (_a = soundChannels_1.return)) _a.call(soundChannels_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    }\n    return { notes: notes, keysounds: keysounds };\n}\nvar legacy_1 = require(\"./legacy\");\nObject.defineProperty(exports, \"_slicesForNotesAndTiming\", { enumerable: true, get: function () { return legacy_1._slicesForNotesAndTiming; } });\nfunction beatForPulseForBmson(bmson) {\n    if (!bmson.version)\n        return legacy.beatForLoc;\n    var resolution = (bmson.info && bmson.info.resolution) || 240;\n    return function (y) { return y / resolution; };\n}\nexports.beatForPulseForBmson = beatForPulseForBmson;\nfunction getColumn(x, options) {\n    switch (x) {\n        case 1:\n            return '1';\n        case 2:\n            return '2';\n        case 3:\n            return '3';\n        case 4:\n            return '4';\n        case 5:\n            return '5';\n        case 6:\n            return '6';\n        case 7:\n            return '7';\n        case 8:\n            return 'SC';\n    }\n    if (options.double) {\n        switch (x) {\n            case 9:\n                return '8';\n            case 10:\n                return '9';\n            case 11:\n                return '10';\n            case 12:\n                return '11';\n            case 13:\n                return '12';\n            case 14:\n                return '13';\n            case 15:\n                return '14';\n            case 16:\n                return 'SC2';\n        }\n    }\n    return undefined;\n}\n/**\n * Checks if there is a scratch in a bmson file\n */\nfunction hasScratch(bmson) {\n    var e_3, _a, e_4, _b;\n    var soundChannels = soundChannelsForBmson(bmson);\n    if (soundChannels) {\n        try {\n            for (var soundChannels_2 = __values(soundChannels), soundChannels_2_1 = soundChannels_2.next(); !soundChannels_2_1.done; soundChannels_2_1 = soundChannels_2.next()) {\n                var notes = soundChannels_2_1.value.notes;\n                try {\n                    for (var notes_1 = (e_4 = void 0, __values(notes)), notes_1_1 = notes_1.next(); !notes_1_1.done; notes_1_1 = notes_1.next()) {\n                        var x = notes_1_1.value.x;\n                        if (x === 8 || x === 18)\n                            return true;\n                    }\n                }\n                catch (e_4_1) { e_4 = { error: e_4_1 }; }\n                finally {\n                    try {\n                        if (notes_1_1 && !notes_1_1.done && (_b = notes_1.return)) _b.call(notes_1);\n                    }\n                    finally { if (e_4) throw e_4.error; }\n                }\n            }\n        }\n        catch (e_3_1) { e_3 = { error: e_3_1 }; }\n        finally {\n            try {\n                if (soundChannels_2_1 && !soundChannels_2_1.done && (_a = soundChannels_2.return)) _a.call(soundChannels_2);\n            }\n            finally { if (e_3) throw e_3.error; }\n        }\n    }\n    return false;\n}\nexports.hasScratch = hasScratch;\n/**\n * Checks the key mode for a bmson file\n */\nfunction keysForBmson(bmson) {\n    var e_5, _a, e_6, _b;\n    var soundChannels = soundChannelsForBmson(bmson);\n    var hasKeys = false;\n    var hasSecondPlayer = false;\n    var hasDeluxeKeys = false;\n    if (soundChannels) {\n        try {\n            for (var soundChannels_3 = __values(soundChannels), soundChannels_3_1 = soundChannels_3.next(); !soundChannels_3_1.done; soundChannels_3_1 = soundChannels_3.next()) {\n                var notes = soundChannels_3_1.value.notes;\n                try {\n                    for (var notes_2 = (e_6 = void 0, __values(notes)), notes_2_1 = notes_2.next(); !notes_2_1.done; notes_2_1 = notes_2.next()) {\n                        var x = notes_2_1.value.x;\n                        hasKeys = true;\n                        if (x >= 11 && x <= 20)\n                            hasSecondPlayer = true;\n                        if (x === 6 || x === 7 || x === 16 || x === 17)\n                            hasDeluxeKeys = true;\n                    }\n                }\n                catch (e_6_1) { e_6 = { error: e_6_1 }; }\n                finally {\n                    try {\n                        if (notes_2_1 && !notes_2_1.done && (_b = notes_2.return)) _b.call(notes_2);\n                    }\n                    finally { if (e_6) throw e_6.error; }\n                }\n            }\n        }\n        catch (e_5_1) { e_5 = { error: e_5_1 }; }\n        finally {\n            try {\n                if (soundChannels_3_1 && !soundChannels_3_1.done && (_a = soundChannels_3.return)) _a.call(soundChannels_3);\n            }\n            finally { if (e_5) throw e_5.error; }\n        }\n    }\n    if (!hasKeys)\n        return 'empty';\n    if (hasSecondPlayer) {\n        return hasDeluxeKeys ? '14K' : '10K';\n    }\n    else {\n        return hasDeluxeKeys ? '7K' : '5K';\n    }\n}\nexports.keysForBmson = keysForBmson;\n//# sourceMappingURL=index.js.map","\"use strict\";\n/* eslint camelcase: off */\n/* REASON: These snake case names are specified in bmsons spec. */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=types.js.map","import Player, { PlayerOptionsInput } from './player'\nimport Notechart from 'bemuse-notechart'\n\nexport type GamePlayerOptionsInput = {\n  players: Omit<PlayerOptionsInput, 'autosound' | 'tutorial'>[]\n  audioInputLatency: number\n  tutorial: boolean\n  soundVolume: number\n}\n\n/**\n * The Game model holds the game's options and the player objects.\n * This class represents all the data needed to start a game.\n * However, it is immutable.  See `GameState` for mutable stuff.\n */\nexport class Game {\n  /** The Game's players */\n  public players: Player[]\n\n  constructor(\n    notecharts: Notechart[],\n    public readonly options: GamePlayerOptionsInput\n  ) {\n    this.players = options.players.map(function (playerOptions, index) {\n      playerOptions = Object.assign({}, playerOptions, {\n        autosound: options.audioInputLatency >= 0.01,\n        tutorial: options.tutorial,\n      })\n      return new Player(notecharts[index], index + 1, playerOptions)\n    })\n  }\n\n  /** A list of all sound samples used in game. Used for loading sounds. */\n  get samples() {\n    let set = new Set()\n    for (let player of this.players) {\n      for (let sample of player.notechart.samples) {\n        set.add(sample)\n      }\n    }\n    return Array.from(set)\n  }\n}\n\nexport default Game\n","import _ from 'lodash'\n\nimport WaveFactory from './wave-factory'\nimport { isBad } from '../judgments'\n\nfunction autoplayer(array) {\n  array = _.sortBy(array, 'time')\n  let i = 0\n  return {\n    next(time) {\n      let out = []\n      for (; i < array.length && time >= array[i].time; i++) {\n        out.push(array[i])\n      }\n      return out\n    },\n  }\n}\n\nexport class PlayerAudio {\n  constructor({ player, samples, master, waveFactory, volume }) {\n    let notechart = player.notechart\n    this._waveFactory =\n      waveFactory ||\n      new WaveFactory(master, samples, notechart.keysounds, { volume })\n    this._autos = autoplayer(notechart.autos)\n    this._notes = autoplayer(notechart.notes)\n    this._played = new Map()\n    this._autosound = !!player.options.autosound\n  }\n  update(time, state) {\n    this._playAutokeysounds(time)\n    this._playAutosounds(time, state)\n    this._handleSoundNotifications((state && state.notifications.sounds) || [])\n  }\n  _playAutokeysounds(time) {\n    for (let auto of this._autos.next(time + 1 / 30)) {\n      this._waveFactory.playAuto(auto, auto.time - time)\n    }\n  }\n  _playAutosounds(time, state) {\n    let autosounds = this._notes.next(time + 1 / 30)\n    let poor = state && state.stats.poor\n    let shouldPlay = this._autosound && !poor\n    if (!shouldPlay) return\n    for (let note of autosounds) {\n      this._hitNote(note, note.time - time)\n    }\n  }\n  _handleSoundNotifications(soundNotifications) {\n    for (let notification of soundNotifications) {\n      let { type, note } = notification\n      if (type === 'hit') {\n        this._hitNote(note, 0, notification.judgment)\n      } else if (type === 'break') {\n        this._breakNote(note)\n      } else if (type === 'free') {\n        this._waveFactory.playFree(note, 0)\n      }\n    }\n  }\n  _hitNote(note, delay, judgment) {\n    let instance = this._played.get(note)\n    if (!instance) {\n      instance = this._waveFactory.playNote(note, delay)\n      this._played.set(note, instance)\n    }\n    if (instance) {\n      if (isBad(judgment)) {\n        instance.bad()\n      }\n    }\n  }\n  _breakNote(note) {\n    let instance = this._played.get(note)\n    if (instance) {\n      instance.stop()\n    }\n  }\n}\n\nexport default PlayerAudio\n","import PlayerState from './player-state'\nimport Game from '../game'\nimport Player from '../player'\nimport GameInput from '../input'\nimport GameTimer from '../game-timer'\nimport invariant from 'invariant'\n\nexport class GameState {\n  /** See Timer#readyFraction. We need it here so that the display can read this information. */\n  public readyFraction = 0\n  /** True if the the player is getting started (i.e. holding down the start button for the first time), false otherwise. */\n  public gettingStarted = false\n  /** True if the game is started, false otherwise. */\n  public started = false\n  /** True if the game is finished, false otherwise. */\n  public finished = false\n\n  private _players: Map<Player, PlayerState>\n\n  constructor(public readonly game: Game) {\n    this._players = new Map(\n      game.players.map((player) => [player, new PlayerState(player)])\n    )\n  }\n  update(gameTime: number, input: GameInput, timer: GameTimer) {\n    let finished = true\n    for (let [player, playerState] of this._players) {\n      playerState.update(gameTime, input)\n      if (!playerState.finished) finished = false\n      void player\n    }\n    this.readyFraction = timer.readyFraction\n    this.gettingStarted = timer.gettingStarted\n    this.started = timer.started\n    this.finished = finished\n  }\n  player(p: Player) {\n    const playerState = this._players.get(p)\n    return (\n      playerState ||\n      invariant(\n        false,\n        'Invariant violation: No player state found for player %s',\n        p.number\n      )\n    )\n  }\n}\n\nexport default GameState\n","import bench from 'bemuse/devtools/benchmark'\n\nimport * as touch3d from '../display/touch3d'\n\nlet BUTTONS = ['p1_1', 'p1_2', 'p1_3', 'p1_4', 'p1_5', 'p1_6', 'p1_7', 'start']\n\nwindow.BEMUSE_TOUCH_STATS = []\n\nfunction StatsRecorder() {\n  const stats = []\n  window.BEMUSE_TOUCH_STATS.push(stats)\n  return {\n    record(input) {\n      for (let { x, y } of input) {\n        stats.push({ x: Math.round(x), y: Math.round(y) })\n      }\n    },\n    done() {\n      if (stats.length) {\n        localStorage['_stats_touch'] = JSON.stringify(window.BEMUSE_TOUCH_STATS)\n      }\n    },\n  }\n}\n\nexport function TouchPlugin(context) {\n  let scratchStartY = null\n  let scratchY = null\n  let getInput = bench.wrap('input:touch:I', _getInput)\n  let getScratch = bench.wrap('input:touch:SC', _getScratch)\n  let getButton = bench.wrap('input:touch:B', _getButton)\n  let getPinch = bench.wrap('input:touch:P', _getPinch)\n  let statsRecorder = new StatsRecorder()\n  const touch3dMode = context.skinData.displayMode === 'touch3d'\n  const pinchThreshold = touch3dMode ? touch3d.getRow(0.8).y : 550\n  return {\n    name: 'TouchPlugin',\n    get() {\n      let input = getInput()\n      let output = {}\n      if (bench.enabled) bench.stats['input:touch:n'] = '' + input.length\n      statsRecorder.record(input)\n      output['p1_SC'] = getScratch(input)\n      for (let button of BUTTONS) {\n        output[button] = getButton(input, button)\n      }\n      if (touch3dMode) {\n        for (let p of input) {\n          const lane = touch3d.getTouchedColumn(p.x, p.y)\n          if (lane) output['p1_' + lane] = 1\n        }\n      }\n      output['p1_pinch'] = getPinch(input)\n      return output\n    },\n    destroy() {\n      statsRecorder.done()\n    },\n  }\n  function _expand(rectangle, amount = 4) {\n    const newRect = rectangle.clone()\n    newRect.x -= amount\n    newRect.y -= amount\n    newRect.width += amount * 2\n    newRect.height += amount * 2\n    return newRect\n  }\n  function _getInput() {\n    return context.input\n  }\n  function _getButton(input, button) {\n    let objects = context.refs[button]\n    if (objects) {\n      for (let object of objects) {\n        let bounds = _expand(object.getBounds())\n        for (let p of input) {\n          if (bounds.contains(p.x, p.y)) return 1\n        }\n      }\n    }\n    return 0\n  }\n  function _getScratch(input) {\n    let objects = context.refs['p1_SC']\n    if (!objects) return 0\n    scratchY = null\n    for (let p of input) {\n      for (let object of objects) {\n        if (_expand(object.getBounds(), 32).contains(p.x, p.y)) {\n          scratchY = p.y\n          break\n        }\n      }\n      if (scratchY !== null) {\n        break\n      }\n    }\n    if (scratchY === null) {\n      scratchStartY = null\n      return 0\n    }\n    if (scratchStartY === null) {\n      scratchStartY = scratchY\n    }\n    if (scratchY > scratchStartY + 24) {\n      scratchStartY = scratchY - 24\n    } else if (scratchY < scratchStartY - 24) {\n      scratchStartY = scratchY + 24\n    }\n    return scratchY > scratchStartY + 4\n      ? -1\n      : scratchY < scratchStartY - 4\n      ? 1\n      : 0\n  }\n  function _getPinch(input) {\n    let a = null\n    let b = null\n    for (let p of input) {\n      if (p.y < pinchThreshold) {\n        if (a === null) {\n          a = p.y\n        } else if (b === null) {\n          b = p.y\n        } else {\n          return 0\n        }\n      }\n    }\n    if (a !== null && b !== null) {\n      return Math.abs(a - b)\n    } else {\n      return 0\n    }\n  }\n}\n\nexport default TouchPlugin\n","import './game-display.scss'\n\nimport $ from 'jquery'\n\nimport PlayerDisplay from './player-display'\nimport formatTime from '../../utils/formatTime'\nimport { shouldDisableFullScreen } from 'bemuse/devtools/query-flags'\nimport screenfull from 'screenfull'\n\nexport class GameDisplay {\n  constructor({ game, context, backgroundImagePromise, video }) {\n    this._game = game\n    this._context = context\n    const skinData = context.skinData\n    this._players = new Map(\n      game.players.map((player) => [\n        player,\n        new PlayerDisplay(player, skinData),\n      ])\n    )\n    this._stateful = {}\n    this._wrapper = this._createWrapper({\n      backgroundImagePromise,\n      video,\n      panelPlacement: game.players[0].options.placement,\n      infoPanelPosition: skinData.infoPanelPosition,\n    })\n    this._createTouchEscapeButton()\n    this._createFullScreenButton()\n    this._escapeHintShown = false\n  }\n  setEscapeHandler(escapeHandler) {\n    this._onEscape = escapeHandler\n  }\n  setReplayHandler(replayHandler) {\n    this._onReplay = replayHandler\n  }\n  start() {\n    this._started = new Date().getTime()\n    const player = this._game.players[0]\n    const songInfo = player.notechart.songInfo\n    const prefix = player.options.autoplayEnabled ? '[AUTOPLAY] ' : ''\n    this._stateful['song_title'] = prefix + songInfo.title\n    this._stateful['song_artist'] = songInfo.artist\n    this._duration = player.notechart.duration\n  }\n  destroy() {\n    this._context.destroy()\n  }\n  update(gameTime, gameState) {\n    let time = (new Date().getTime() - this._started) / 1000\n    let data = this._getData(time, gameTime, gameState)\n    this._updateStatefulData(time, gameTime, gameState)\n    this._context.render(Object.assign({}, this._stateful, data))\n    this._synchronizeVideo(gameTime)\n    this._synchronizeTutorialEscapeHint(gameTime)\n  }\n  _synchronizeVideo(gameTime) {\n    if (this._video && !this._videoStarted && gameTime >= this._videoOffset) {\n      this._video.volume = 0\n      this._video.play()\n      this._video.classList.add('is-playing')\n      this._videoStarted = true\n    }\n  }\n  _synchronizeTutorialEscapeHint(gameTime) {\n    if (this._game.options.tutorial) {\n      const TUTORIAL_ESCAPE_HINT_SHOW_TIME = 101.123595506\n      if (\n        gameTime >= TUTORIAL_ESCAPE_HINT_SHOW_TIME &&\n        !this._escapeHintShown\n      ) {\n        this._escapeHintShown = true\n        this._escapeHint.classList.add('is-shown')\n      }\n    }\n  }\n  _getData(time, gameTime, gameState) {\n    let data = {}\n    data['tutorial'] = this._game.options.tutorial ? 'yes' : 'no'\n    data['t'] = time\n    data['gameTime'] = gameTime\n    data['ready'] = this._getReady(gameState)\n    data['song_time'] = this._getSongTime(gameTime)\n    for (let [player, playerDisplay] of this._players) {\n      let playerState = gameState.player(player)\n      let playerData = playerDisplay.update(time, gameTime, playerState)\n      for (let key in playerData) {\n        data[`p${player.number}_${key}`] = playerData[key]\n      }\n    }\n    return data\n  }\n  _updateStatefulData(time, gameTime, gameState) {\n    let data = this._stateful\n    if (data['started'] === undefined && gameState.started) {\n      data['started'] = time\n    }\n    if (data['gettingStarted'] === undefined && gameState.gettingStarted) {\n      data['gettingStarted'] = time\n    }\n  }\n  _getSongTime(gameTime) {\n    return (\n      formatTime(Math.min(this._duration, Math.max(0, gameTime))) +\n      ' / ' +\n      formatTime(this._duration)\n    )\n  }\n  _getReady(gameState) {\n    let f = gameState.readyFraction\n    return f > 0.5 ? Math.pow(1 - (f - 0.5) / 0.5, 2) : 0\n  }\n  _createWrapper({\n    backgroundImagePromise,\n    video,\n    panelPlacement,\n    infoPanelPosition,\n  }) {\n    var $wrapper = $('<div class=\"game-display\"></div>')\n      .attr('data-panel-placement', panelPlacement)\n      .attr('data-info-panel-position', infoPanelPosition)\n      .append('<div class=\"game-display--bg js-back-image\"></div>')\n      .append(this.view)\n    if (backgroundImagePromise) {\n      Promise.resolve(backgroundImagePromise).then((image) =>\n        $wrapper.find('.js-back-image').append(image)\n      )\n    }\n    if (video) {\n      this._video = video.element\n      this._videoOffset = video.offset\n      $(video.element).addClass('game-display--video-bg').appendTo($wrapper)\n    }\n    return $wrapper[0]\n  }\n  _createTouchEscapeButton() {\n    const touchButtons = document.createElement('div')\n    touchButtons.className = 'game-display--touch-buttons is-left'\n    this.wrapper.appendChild(touchButtons)\n    touchButtons.classList.add('is-visible')\n    const addTouchButton = (className, onClick) => {\n      let button = createTouchButton(onClick, className)\n      touchButtons.appendChild(button)\n    }\n    addTouchButton('game-display--touch-escape-button', () => this._onEscape())\n    addTouchButton('game-display--touch-replay-button', () => this._onReplay())\n\n    const escapeHint = document.createElement('div')\n    escapeHint.textContent = 'Click or press Esc to exit the tutorial'\n    escapeHint.className = 'game-display--escape-hint'\n    this._escapeHint = escapeHint\n    touchButtons.appendChild(escapeHint)\n  }\n  _createFullScreenButton() {\n    if (shouldDisableFullScreen() || !screenfull.enabled) {\n      return\n    }\n    const touchButtons = document.createElement('div')\n    touchButtons.className = 'game-display--touch-buttons is-visible is-right'\n    this.wrapper.appendChild(touchButtons)\n    const onClick = () => {\n      screenfull.request()\n    }\n    const button = createTouchButton(\n      onClick,\n      'game-display--touch-fullscreen-button'\n    )\n    touchButtons.appendChild(button)\n  }\n  get context() {\n    return this._context\n  }\n  get view() {\n    return this._context.view\n  }\n  get wrapper() {\n    return this._wrapper\n  }\n}\n\nfunction createTouchButton(onClick, className) {\n  let button = document.createElement('button')\n  button.addEventListener(\n    'touchstart',\n    (e) => {\n      e.stopPropagation()\n    },\n    true\n  )\n  button.onclick = (e) => {\n    e.preventDefault()\n    onClick()\n  }\n  button.className = className\n  return button\n}\n\nexport default GameDisplay\n","\nvar content = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./game-display.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../common/temp/node_modules/.pnpm/style-loader@0.23.1/node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./game-display.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/index.js??ref--9-1!../../../../common/temp/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??postcss!../../../../common/temp/node_modules/.pnpm/sass-loader@10.2.0_sass@1.43.4+webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-3!./game-display.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","var escape = require(\"../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/url/escape.js\");\nexports = module.exports = require(\"../../../../common/temp/node_modules/.pnpm/css-loader@1.0.1_webpack@4.46.0/node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".game-display {\\n  display: block;\\n  margin: 0 auto;\\n  overflow: hidden;\\n  position: relative;\\n}\\n.game-display--bg {\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  z-index: 10;\\n  background: url(\" + escape(require(\"./background/default.jpg\")) + \") center no-repeat;\\n  background-size: cover;\\n  -webkit-animation: 1.5s game-display--bg-default;\\n          animation: 1.5s game-display--bg-default;\\n  -webkit-animation-fill-mode: both;\\n          animation-fill-mode: both;\\n}\\n.game-display[data-info-panel-position=top] .game-display--bg {\\n  -webkit-animation-name: game-display--bg-down;\\n          animation-name: game-display--bg-down;\\n}\\n.game-display--video-bg {\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  top: -48px;\\n  left: 0px;\\n  z-index: 11;\\n  opacity: 0;\\n  transition: 0.5s opacity;\\n  will-change: opacity;\\n}\\n.game-display--video-bg.is-playing {\\n  opacity: 1;\\n}\\n.game-display[data-panel-placement=left] .game-display--video-bg {\\n  -webkit-transform: translateX(13.671875%) scale(0.87);\\n          transform: translateX(13.671875%) scale(0.87);\\n}\\n.game-display[data-panel-placement=right] .game-display--video-bg {\\n  -webkit-transform: translateX(13.671875%) scale(0.87);\\n          transform: translateX(13.671875%) scale(0.87);\\n}\\n.game-display--bg img {\\n  width: 100%;\\n  height: 100%;\\n  display: block;\\n  object-fit: cover;\\n  -webkit-animation: 1.2s game-display--bg-default;\\n          animation: 1.2s game-display--bg-default;\\n  -webkit-animation-fill-mode: both;\\n          animation-fill-mode: both;\\n}\\n.game-display[data-info-panel-position=top] .game-display--bg img {\\n  -webkit-animation-name: game-display--bg-down;\\n          animation-name: game-display--bg-down;\\n}\\n.game-display > canvas {\\n  position: relative;\\n  z-index: 100;\\n}\\n.game-display--touch-buttons {\\n  position: fixed;\\n  -webkit-transform: translateZ(0);\\n          transform: translateZ(0);\\n  top: 0;\\n  opacity: 0;\\n  z-index: 110;\\n}\\n.game-display--touch-buttons.is-visible {\\n  opacity: 1;\\n}\\n.game-display--touch-buttons.is-left {\\n  left: 0;\\n}\\n.game-display--touch-buttons.is-right {\\n  right: 0;\\n}\\n.game-display--touch-escape-button, .game-display--touch-replay-button, .game-display--touch-fullscreen-button {\\n  position: absolute;\\n  top: 12px;\\n  margin: 0;\\n  padding: 0;\\n  border: 0;\\n  width: 32px;\\n  height: 32px;\\n  background: transparent center center no-repeat;\\n  background-size: 32px 32px;\\n  cursor: pointer;\\n}\\n.game-display--touch-escape-button {\\n  background-image: url(\" + escape(require(\"./touch-escape.png\")) + \");\\n  left: 12px;\\n}\\n.game-display--touch-replay-button {\\n  background-image: url(\" + escape(require(\"./touch-replay.png\")) + \");\\n  left: 56px;\\n}\\n.game-display--touch-fullscreen-button {\\n  background-image: url(\" + escape(require(\"./touch-fullscreen.png\")) + \");\\n  right: 12px;\\n}\\n:root:-webkit-full-screen .game-display--touch-fullscreen-button {\\n  display: none;\\n}\\n:root:fullscreen .game-display--touch-fullscreen-button {\\n  display: none;\\n}\\n.game-display--escape-hint {\\n  position: absolute;\\n  left: 12px;\\n  top: 56px;\\n  display: none;\\n  background: #b61a44;\\n  padding: 8px 12px;\\n  color: white;\\n  white-space: nowrap;\\n  border-radius: 8px;\\n  font-weight: bold;\\n  font-size: 1rem;\\n  pointer-events: none;\\n}\\n.game-display--escape-hint.is-shown {\\n  display: block;\\n}\\n.game-display--escape-hint::after {\\n  content: \\\"\\\";\\n  display: block;\\n  position: absolute;\\n  width: 0;\\n  height: 0;\\n  top: -8px;\\n  left: 16px;\\n  margin-left: -8px;\\n  border-width: 0 8px 8px 8px;\\n  border-style: solid;\\n  border-color: transparent;\\n  border-bottom-color: #b61a44;\\n}\\n\\n@-webkit-keyframes game-display--bg-default {\\n  from {\\n    -webkit-transform: translate(0, 0);\\n            transform: translate(0, 0);\\n    opacity: 0;\\n  }\\n  to {\\n    -webkit-transform: translate(0, -35px);\\n            transform: translate(0, -35px);\\n    opacity: 1;\\n  }\\n}\\n\\n@keyframes game-display--bg-default {\\n  from {\\n    -webkit-transform: translate(0, 0);\\n            transform: translate(0, 0);\\n    opacity: 0;\\n  }\\n  to {\\n    -webkit-transform: translate(0, -35px);\\n            transform: translate(0, -35px);\\n    opacity: 1;\\n  }\\n}\\n@-webkit-keyframes game-display--bg-down {\\n  from {\\n    -webkit-transform: translate(0, 0);\\n            transform: translate(0, 0);\\n    opacity: 0;\\n  }\\n  to {\\n    -webkit-transform: translate(0, 35px);\\n            transform: translate(0, 35px);\\n    opacity: 1;\\n  }\\n}\\n@keyframes game-display--bg-down {\\n  from {\\n    -webkit-transform: translate(0, 0);\\n            transform: translate(0, 0);\\n    opacity: 0;\\n  }\\n  to {\\n    -webkit-transform: translate(0, 35px);\\n            transform: translate(0, 35px);\\n    opacity: 1;\\n  }\\n}\", \"\"]);\n\n// exports\n","module.exports = __webpack_public_path__ + \"build/ea410328703171d8f693d3a404a11a8f.jpg\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACxUlEQVR4AdSYgWfrUBTG2xWNhLbQUbQAlUA7oEzKUNSGwqbA84INBs3oJPvj+75wUMe5Sd+yfM3KD+L2nvPdnNz7ndtp+nc6nQIQghjsQALeQQoyIZVniYyJ5T9BI0kRRE/ABryCr5q8ylyTtovugxV4k8Sb4E1i9Nsk3ANr8CFJMviQmN41hXfBAqQVyeYgkTK+AzMwAj7oCb48m8mYjfwnr5j7IDl02eKH4E9JYhl4lo3Mq1ldocyVueJJLkOW+Ck4OBL5BA/AbyCuL3N/llTDtGnxS5A5yvwJDAgvYCCxckflLZsIegM2jpXfg/EV9qCxxP7SSK43Pyn+xRHovgWn0L0jt5cfWQTHmz+CeYuO4jk4WpVQ+5s3Jn0Hty00YreSm853WWe3zwzxQYvdaKAXQTRMv3POH3TZ22++lZVwNI7I4eUOzzY581/UjM0dZql7yZ8X5m5fvmBbEBEFRhKz+5+nw6LSehrefl8h/vHMDEUk8bnEfKxYhL3xKXhlk68NhzcuGb81xkcM8WdsK8ySHr8u6+d1S/t0SUKERfh2rEKD0Ur3rYEro7EZNJIYQbzqHXQDtbIG6pucB0KClLkLLfpmSQ+YGObBJyRKmbPQYpi6SZnffyYkTF3QQpOzTzBub0PCW2NXU6hvm8/9sw7kUb5bgnjlcfS8gbUyf2k7N0G8mj/RlV48jK1vg7cIBPHuvS4uHu7UwzuWgWEbqkKbirGzymLGdHFkNzlTcZKOcYEwIvr4nCVechjpC56O0f35zGaG3Ez5Kl7aMRxSj9HOssVL7J52vP/at28CgIEYiqF4AssQzH/Jmt4z/QfhqptkAzwBn6AwmJ4ISYWH1bUIKobiy2ENES0xTVFtcYMRozHD0Vms7IDxOEACIgOSgskBJaGyYGm4PGGCMkOaeq/N9QVtrh5oc/W7NkecpM6Sp+P1+REepk4aEr9vwAAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAEEklEQVR4AdSaBY/zPAzHBw8cMzMzCo+ZmZmZmfvh7/1P8kt+kq65dLt00k9QZYbUSWynvkj/Pj8/40Et6AZz4ABcgQfwTjzQswMa003/ifd58QfDc8EwOAGWJickK9d0p3+DNnAKrAhxSjp+m+R4DOgBj8CKEo+kM+Y7HfeDZvAQxtgPcEBh3AqKQAqIA0Eijp4V0Zhh+s9HGNn3ZIM/2s4ng10bw97BMqgFMZrRVUuy3mX6yJbkaDlfCO4lhryCfhAXAb1xJPvVJhoKI+18C3iXhPkUSIrCC0giXR+SyGuJhNIArUtLwBrI/IY9KJN0WxyyNeCm8ysSRZ0GnEKdEttWXJkEyZt/AdUGHcXV4EUUCW6seYtxBbIMTMSyyDaL0aKz279z503Oz6nuuBJsjIVfOefvediL37yRkfAiOCKTFTI8YZJTrWlYLGgEM2AbnIMX4hLsgRkak+BQ5oB0TxAnS34nQps1d3surwZsOUhrRQZX2sgdonG/FE6HZiep5wM/5zX2kD1gaXIMSkTOE9LkS5An3Num5lRh8Qwv8wt5wwiwXGYQBJnzIbLDJEs88nrs6nle0k59oXjZsHHiCHSDEpAOfhF/V4LdYYqsW8Gz4jA2TQlK6d+igW2CwiZJ0fkzieGLIF1xJ59xGBnVDmoHXkC1iQbyTk6/YthvSJKmAs3K85LJVE50Qr7wzpKgh8eSB4WSVrLmtxVkKMlmtDkspXlSl2uX7y8rvSWx80F95/mGJ6TPoaxlaZ0g6N7WKhi5Jwj7uGg4T4w5lFfLu83/zZ/50RejkORYjIJoOU/MK2zS/EiMF83MvoKhW3y3d8H5AWApsK4g++CPSKezV7mGptyez2i6SwXNLzq+skExRVoLaAN9YAzMg3UwqdHb6A49nGMPWx0Ka+RJjgcqxVZm85woLIocCpvls+mBCShiNh/4BA2EFIfCttn/SjwwASn8xPIJqr84h8LO+fr3wATEMZsffDxDcprACLouvzwwAUGe8XpyAsiRjv/QpjMBnlsC0JXG17LGEvDeJghd5Uz3lsYm6L1jkMJe0LhRPwY9mQiFdHGbdRIhY1Jhh3ozBMVbnE4qXMvD4juKIQWdC+4WQwaUw5rNlzqdctjMhoh8yV0wXXvAr9EQMbolxhOYHZ1oE7fEvNEUjQObCq0whaao+W3xfMmd/wb7+kOvLW7gxUgG/ccScMo3ae2LEQOuxtJAMegBhzb/3xQtK42rMU9djsq//NK8HOVv8N6w6/G9cBegGtfjxn4g8UGnSLXLn881m/CJzKzgE5kLejZLY2L/at8OLACAgSAI1nolpH9IC8kJ4U0Xi50H21y1yJikbHJGSausWdouD0wgM9DUBZtbB1mbgs3lP5sDJ9FZeHo6n99ybdMJ2yzi/QAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAC30lEQVR4AdyYgacqQRTGt1u0NmqhSyiAFFRAXEUICEHXA563KNiH9tK19cf3vjgexje7e+9p9m4NPxhzzpzzdXbmTJ7rcb1eW2AEFmALIhCDBKRCInORrFmITct7xIHAe2AN9uCiZC++elVPugnm4AAujjjIHs0qJe6DJfgAl5L4kD39n0y8BiYgyQn2DCIp4xkYgBAEoC4EMjeQNWuxOef4PkoMtbKT74DfGYGlYCcHma+srpH4Sm37SSydspLvi/IskE+wAoGDfQPx/ZlRDX3XyU9BainzDWiX8AO0Za+zpfKmLjZ9AWuL8r9A9wfOoK7szWJag5d7Jv9u2eitArfQmyW297uIYPnlT2BYoat4CE6sEtTfPHEag9cKNmKvICbxTjWnfUqSb1W4G20REVLQ/849fyRlz3/56lXCiVyRneIdHm9yhg/0GBtamqVaEeNJVU57B7fDpEjrmZj3fI7N5SuIWSn+SJ9wBH6WwZJ0eN0HFqBLOsal9T1PnrQb9wE797chT+kmWzgnD5v2EwjQJg+oOVt4MBatPAxFwGcwvsNhNs76X6Cgj5VhdzAX9EjzECgF0IlAklcIEJCmrpfV7++KB0mTVovAkmdifMHfzvpOIP/ejhQCjLUiZPlQCDAybPf/+2eykV/YMQlIIUKurUIAn/htMWX+eBgaAb4pQr6NQgCxjcxKv00u+LehECA7oRg0iJ8GiO3J6wUgZ93iNrk1Jmd6Aawi/AVhhq9Q1vBq0QswM+y3rCwGnnZwEWKaPBchBmMHcQyMXCOPlF3o6HXW0K9VxxCan6NHXn+B96TjlpuRa+KRDqn+xALUzY73X/v2UQAgDMBQVA+yKqH+L9zZezRPAnQn//sBlkD6JugYdBFyFe5G0yLoMeQ5nByIiMSEomJxxYhqTDk6PitrQD0OkIDIgKRgckBJqCxYGi5PmKDMkKbOa3N1QyhSDmhz5WVtjjhJnSVPB+jzPZGAyclJbc34AAAAAElFTkSuQmCC\"","/*!\n* screenfull\n* v3.3.3 - 2018-09-04\n* (c) Sindre Sorhus; MIT License\n*/\n(function () {\n\t'use strict';\n\n\tvar document = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\n\tvar isCommonjs = typeof module !== 'undefined' && module.exports;\n\tvar keyboardAllowed = typeof Element !== 'undefined' && 'ALLOW_KEYBOARD_INPUT' in Element;\n\n\tvar fn = (function () {\n\t\tvar val;\n\n\t\tvar fnMap = [\n\t\t\t[\n\t\t\t\t'requestFullscreen',\n\t\t\t\t'exitFullscreen',\n\t\t\t\t'fullscreenElement',\n\t\t\t\t'fullscreenEnabled',\n\t\t\t\t'fullscreenchange',\n\t\t\t\t'fullscreenerror'\n\t\t\t],\n\t\t\t// New WebKit\n\t\t\t[\n\t\t\t\t'webkitRequestFullscreen',\n\t\t\t\t'webkitExitFullscreen',\n\t\t\t\t'webkitFullscreenElement',\n\t\t\t\t'webkitFullscreenEnabled',\n\t\t\t\t'webkitfullscreenchange',\n\t\t\t\t'webkitfullscreenerror'\n\n\t\t\t],\n\t\t\t// Old WebKit (Safari 5.1)\n\t\t\t[\n\t\t\t\t'webkitRequestFullScreen',\n\t\t\t\t'webkitCancelFullScreen',\n\t\t\t\t'webkitCurrentFullScreenElement',\n\t\t\t\t'webkitCancelFullScreen',\n\t\t\t\t'webkitfullscreenchange',\n\t\t\t\t'webkitfullscreenerror'\n\n\t\t\t],\n\t\t\t[\n\t\t\t\t'mozRequestFullScreen',\n\t\t\t\t'mozCancelFullScreen',\n\t\t\t\t'mozFullScreenElement',\n\t\t\t\t'mozFullScreenEnabled',\n\t\t\t\t'mozfullscreenchange',\n\t\t\t\t'mozfullscreenerror'\n\t\t\t],\n\t\t\t[\n\t\t\t\t'msRequestFullscreen',\n\t\t\t\t'msExitFullscreen',\n\t\t\t\t'msFullscreenElement',\n\t\t\t\t'msFullscreenEnabled',\n\t\t\t\t'MSFullscreenChange',\n\t\t\t\t'MSFullscreenError'\n\t\t\t]\n\t\t];\n\n\t\tvar i = 0;\n\t\tvar l = fnMap.length;\n\t\tvar ret = {};\n\n\t\tfor (; i < l; i++) {\n\t\t\tval = fnMap[i];\n\t\t\tif (val && val[1] in document) {\n\t\t\t\tfor (i = 0; i < val.length; i++) {\n\t\t\t\t\tret[fnMap[0][i]] = val[i];\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t})();\n\n\tvar eventNameMap = {\n\t\tchange: fn.fullscreenchange,\n\t\terror: fn.fullscreenerror\n\t};\n\n\tvar screenfull = {\n\t\trequest: function (elem) {\n\t\t\tvar request = fn.requestFullscreen;\n\n\t\t\telem = elem || document.documentElement;\n\n\t\t\t// Work around Safari 5.1 bug: reports support for\n\t\t\t// keyboard in fullscreen even though it doesn't.\n\t\t\t// Browser sniffing, since the alternative with\n\t\t\t// setTimeout is even worse.\n\t\t\tif (/ Version\\/5\\.1(?:\\.\\d+)? Safari\\//.test(navigator.userAgent)) {\n\t\t\t\telem[request]();\n\t\t\t} else {\n\t\t\t\telem[request](keyboardAllowed ? Element.ALLOW_KEYBOARD_INPUT : {});\n\t\t\t}\n\t\t},\n\t\texit: function () {\n\t\t\tdocument[fn.exitFullscreen]();\n\t\t},\n\t\ttoggle: function (elem) {\n\t\t\tif (this.isFullscreen) {\n\t\t\t\tthis.exit();\n\t\t\t} else {\n\t\t\t\tthis.request(elem);\n\t\t\t}\n\t\t},\n\t\tonchange: function (callback) {\n\t\t\tthis.on('change', callback);\n\t\t},\n\t\tonerror: function (callback) {\n\t\t\tthis.on('error', callback);\n\t\t},\n\t\ton: function (event, callback) {\n\t\t\tvar eventName = eventNameMap[event];\n\t\t\tif (eventName) {\n\t\t\t\tdocument.addEventListener(eventName, callback, false);\n\t\t\t}\n\t\t},\n\t\toff: function (event, callback) {\n\t\t\tvar eventName = eventNameMap[event];\n\t\t\tif (eventName) {\n\t\t\t\tdocument.removeEventListener(eventName, callback, false);\n\t\t\t}\n\t\t},\n\t\traw: fn\n\t};\n\n\tif (!fn) {\n\t\tif (isCommonjs) {\n\t\t\tmodule.exports = false;\n\t\t} else {\n\t\t\twindow.screenfull = false;\n\t\t}\n\n\t\treturn;\n\t}\n\n\tObject.defineProperties(screenfull, {\n\t\tisFullscreen: {\n\t\t\tget: function () {\n\t\t\t\treturn Boolean(document[fn.fullscreenElement]);\n\t\t\t}\n\t\t},\n\t\telement: {\n\t\t\tenumerable: true,\n\t\t\tget: function () {\n\t\t\t\treturn document[fn.fullscreenElement];\n\t\t\t}\n\t\t},\n\t\tenabled: {\n\t\t\tenumerable: true,\n\t\t\tget: function () {\n\t\t\t\t// Coerce to boolean in case of old WebKit\n\t\t\t\treturn Boolean(document[fn.fullscreenEnabled]);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (isCommonjs) {\n\t\tmodule.exports = screenfull;\n\t} else {\n\t\twindow.screenfull = screenfull;\n\t}\n})();\n","import * as ProgressUtils from 'bemuse/progress/utils'\nimport _ from 'lodash'\nimport defaultKeysoundCache from 'bemuse/keysound-cache'\nimport { EXTRA_FORMATTER } from 'bemuse/progress/formatters'\n\nexport class SamplesLoader {\n  constructor(assets, master, { keysoundCache = defaultKeysoundCache } = {}) {\n    this._assets = assets\n    this._master = master\n    this._keysoundCache = keysoundCache\n  }\n  loadFiles(files, loadProgress, decodeProgress) {\n    let onload = ProgressUtils.fixed(files.length, loadProgress)\n    let ondecode = ProgressUtils.fixed(files.length, decodeProgress)\n    let load = (name) =>\n      new Promise((resolve) => {\n        requestAnimationFrame(() => {\n          resolve(this._loadSample(name, onload, ondecode))\n        })\n      })\n    if (decodeProgress) decodeProgress.formatter = EXTRA_FORMATTER\n    return Promise.map(files, load, { concurrency: 64 }).then((arr) =>\n      _(arr).filter().fromPairs().value()\n    )\n  }\n  _loadSample(name, onload, ondecode) {\n    const audioBufferPromise = (() => {\n      if (this._keysoundCache.isCached(name)) {\n        return Promise.resolve(this._keysoundCache.get(name)).tap(() => {\n          onload(name)\n          ondecode(name)\n        })\n      } else {\n        return this._getFile(name).then((file) =>\n          file\n            .read()\n            .tap(() => {\n              onload(name)\n            })\n            .then((buffer) => this._decode(buffer))\n            .tap((audioBuffer) => {\n              this._keysoundCache.cache(name, audioBuffer)\n              ondecode(name)\n            })\n        )\n      }\n    })()\n    return audioBufferPromise\n      .then((audioBuffer) => this._master.sample(audioBuffer))\n      .then((sample) => [name, sample])\n      .catch((e) => {\n        console.error('Unable to load keysound: ' + name, e)\n        return null\n      })\n  }\n  _decode(buffer) {\n    return this._master.decode(buffer)\n  }\n  _getFile(name) {\n    name = name.replace(/\\\\/g, '/')\n    return Promise.try(() => this._assets.file(name.replace(/\\.\\w+$/, '.ogg')))\n      .catch(() => this._assets.file(name.replace(/\\.\\w+$/, '.m4a')))\n      .catch(() => this._assets.file(name.replace(/\\.\\w+$/, '.mp3')))\n      .catch(() => this._assets.file(name))\n  }\n}\n\nexport default SamplesLoader\n","import _ from 'lodash'\nimport Notechart from 'bemuse-notechart'\n\nexport enum Judgment {\n  Missed = -1,\n  Unjudged = 0,\n  Meticulous = 1,\n  Precise = 2,\n  Good = 3,\n  Offbeat = 4,\n}\n\nexport type JudgedJudgment = Exclude<Judgment, Judgment.Unjudged>\n\nexport const UNJUDGED = Judgment.Unjudged\nexport const MISSED = Judgment.Missed\n\nexport type Timegate = {\n  value: Judgment\n  timegate: number\n  endTimegate: number\n}\nexport type Timegates = Timegate[]\n\n// #region judgment timegate\nconst NORMAL_TIMEGATES: Timegates = [\n  { value: 1, timegate: 0.02, endTimegate: 0.04 },\n  { value: 2, timegate: 0.05, endTimegate: 0.1 },\n  { value: 3, timegate: 0.1, endTimegate: 0.2 },\n  { value: 4, timegate: 0.2, endTimegate: 0.2 },\n]\nconst TRANSITIONAL_BEGINNER_LV5_TIMEGATES: Timegates = [\n  { value: 1, timegate: 0.021, endTimegate: 0.042 },\n  { value: 2, timegate: 0.06, endTimegate: 0.12 },\n  { value: 3, timegate: 0.12, endTimegate: 0.2 },\n  { value: 4, timegate: 0.2, endTimegate: 0.2 },\n]\nconst TRANSITIONAL_BEGINNER_LV4_TIMEGATES: Timegates = [\n  { value: 1, timegate: 0.022, endTimegate: 0.044 },\n  { value: 2, timegate: 0.07, endTimegate: 0.14 },\n  { value: 3, timegate: 0.14, endTimegate: 0.2 },\n  { value: 4, timegate: 0.2, endTimegate: 0.2 },\n]\nconst TRANSITIONAL_BEGINNER_LV3_TIMEGATES: Timegates = [\n  { value: 1, timegate: 0.023, endTimegate: 0.046 },\n  { value: 2, timegate: 0.08, endTimegate: 0.16 },\n  { value: 3, timegate: 0.16, endTimegate: 0.2 },\n  { value: 4, timegate: 0.2, endTimegate: 0.2 },\n]\nconst ABSOLUTE_BEGINNER_TIMEGATES: Timegates = [\n  { value: 1, timegate: 0.024, endTimegate: 0.048 },\n  { value: 2, timegate: 0.1, endTimegate: 0.18 },\n  { value: 3, timegate: 0.18, endTimegate: 0.2 },\n  { value: 4, timegate: 0.2, endTimegate: 0.2 },\n]\n// #endregion\n\nexport interface IJudge {\n  getTimegates(gameTime: number | null, noteTime: number | null): Timegates\n}\n\nclass FixedTimegatesJudge implements IJudge {\n  constructor(private timegates: Timegates) {}\n  getTimegates(_gameTime: number | null, _noteTime: number | null) {\n    return this.timegates\n  }\n}\n\nclass TutorialJudge implements IJudge {\n  getTimegates(_gameTime: number | null, noteTime: number | null) {\n    if (!noteTime || noteTime < 100) {\n      return ABSOLUTE_BEGINNER_TIMEGATES\n    } else {\n      return NORMAL_TIMEGATES\n    }\n  }\n}\n\nconst NORMAL_JUDGE = new FixedTimegatesJudge(NORMAL_TIMEGATES)\n\nexport function getJudgeForNotechart(\n  notechart: Notechart,\n  { tutorial = false }\n): IJudge {\n  const info = notechart.songInfo\n  const insane = info.difficulty >= 5\n  if (tutorial) {\n    return new TutorialJudge()\n  }\n  if (insane) {\n    return NORMAL_JUDGE\n  }\n  if (info.level === 1 || info.level === 2) {\n    return new FixedTimegatesJudge(ABSOLUTE_BEGINNER_TIMEGATES)\n  }\n  if (info.level === 3) {\n    return new FixedTimegatesJudge(TRANSITIONAL_BEGINNER_LV3_TIMEGATES)\n  }\n  if (info.level === 4) {\n    return new FixedTimegatesJudge(TRANSITIONAL_BEGINNER_LV4_TIMEGATES)\n  }\n  if (info.level === 5) {\n    return new FixedTimegatesJudge(TRANSITIONAL_BEGINNER_LV5_TIMEGATES)\n  }\n  return NORMAL_JUDGE\n}\n\n/**\n * Takes a gameTime and noteTime and returns the appropriate judgment.\n *\n *  1 - METICULOUS\n *  2 - PRECISE\n *  3 - GOOD\n *  4 - OFFBEAT\n *  0 - (not judge)\n * -1 - MISSED\n */\nexport function judgeTimeWith(f: (timegate: Timegate) => number) {\n  return function judgeTimeWithF(\n    gameTime: number,\n    noteTime: number,\n    judge: IJudge = NORMAL_JUDGE\n  ): Judgment {\n    const timegates = judge.getTimegates(gameTime, noteTime)\n    let delta = Math.abs(gameTime - noteTime)\n    for (let i = 0; i < timegates.length; i++) {\n      if (delta < f(timegates[i])) return timegates[i].value\n    }\n    return gameTime < noteTime ? UNJUDGED : MISSED\n  }\n}\n\nexport const judgeTime = judgeTimeWith((t) => t.timegate)\nexport const judgeEndTime = judgeTimeWith((t) => t.endTimegate)\n\nexport function timegate(judgment: Judgment, judge = NORMAL_JUDGE) {\n  return _.find(judge.getTimegates(null, null), { value: judgment })!.timegate\n}\n\nexport function isBad(judgment: Judgment) {\n  return judgment >= 4\n}\n\nexport function breaksCombo(judgment: Judgment) {\n  return judgment === MISSED || isBad(judgment)\n}\n\n// #region judgment weight\nexport function weight(judgment: Judgment) {\n  if (judgment === 1) return 100\n  if (judgment === 2) return 80\n  if (judgment === 3) return 50\n  return 0\n}\n// #endregion\n","import bytes from 'bytes'\n\nlet wrap = (f) => (progress) => progress.progress !== null ? f(progress) : ''\n\n// Formats the `Progress` as bytes (e.g. 1.23mb of 1.31mb).\nexport let BYTES_FORMATTER = wrap(\n  (progress) => bytes(progress.current) + ' / ' + bytes(progress.total)\n)\n\n// Formats the `Progress` as percentage.\nexport let PERCENTAGE_FORMATTER = wrap(\n  (progress) => ((progress.current / progress.total) * 100).toFixed(1) + '%'\n)\n\n// Formats the `Progress` simply by using the value of `Progress#extra`.\nexport let EXTRA_FORMATTER = wrap((progress) => progress.extra + '')\n","(function() {\nvar _slice = Array.prototype.slice;\nvar Bacon = {\n  toString: function () {\n    return \"Bacon\";\n  }\n};\n\nBacon.version = '0.7.95';\n\nvar Exception = (typeof global !== \"undefined\" && global !== null ? global : this).Error;\nvar nop = function () {};\nvar latter = function (_, x) {\n  return x;\n};\nvar former = function (x, _) {\n  return x;\n};\nvar cloneArray = function (xs) {\n  return xs.slice(0);\n};\nvar assert = function (message, condition) {\n  if (!condition) {\n    throw new Exception(message);\n  }\n};\nvar assertObservableIsProperty = function (x) {\n  if ((x != null ? x._isObservable : void 0) && !(x != null ? x._isProperty : void 0)) {\n    throw new Exception(\"Observable is not a Property : \" + x);\n  }\n};\nvar assertEventStream = function (event) {\n  if (!(event != null ? event._isEventStream : void 0)) {\n    throw new Exception(\"not an EventStream : \" + event);\n  }\n};\n\nvar assertObservable = function (event) {\n  if (!(event != null ? event._isObservable : void 0)) {\n    throw new Exception(\"not an Observable : \" + event);\n  }\n};\nvar assertFunction = function (f) {\n  return assert(\"not a function : \" + f, _.isFunction(f));\n};\nvar isArray = Array.isArray || function (xs) {\n  return xs instanceof Array;\n};\nvar isObservable = function (x) {\n  return x && x._isObservable;\n};\nvar assertArray = function (xs) {\n  if (!isArray(xs)) {\n    throw new Exception(\"not an array : \" + xs);\n  }\n};\nvar assertNoArguments = function (args) {\n  return assert(\"no arguments supported\", args.length === 0);\n};\nvar assertString = function (x) {\n  if (typeof x === \"string\") {\n    throw new Exception(\"not a string : \" + x);\n  }\n};\n\nvar extend = function (target) {\n  var length = arguments.length;\n  for (var i = 1; 1 < length ? i < length : i > length; 1 < length ? i++ : i--) {\n    for (var prop in arguments[i]) {\n      target[prop] = arguments[i][prop];\n    }\n  }\n  return target;\n};\n\nvar inherit = function (child, parent) {\n  var hasProp = ({}).hasOwnProperty;\n  var ctor = function () {};\n  ctor.prototype = parent.prototype;\n  child.prototype = new ctor();\n  for (var key in parent) {\n    if (hasProp.call(parent, key)) {\n      child[key] = parent[key];\n    }\n  }\n  return child;\n};\n\nvar symbol = function (key) {\n  if (typeof Symbol !== \"undefined\" && Symbol[key]) {\n    return Symbol[key];\n  } else if (typeof Symbol !== \"undefined\" && typeof Symbol[\"for\"] === \"function\") {\n    return Symbol[key] = Symbol[\"for\"](key);\n  } else {\n    return \"@@\" + key;\n  }\n};\n\nvar _ = {\n  indexOf: (function () {\n    if (Array.prototype.indexOf) {\n      return function (xs, x) {\n        return xs.indexOf(x);\n      };\n    } else {\n      return function (xs, x) {\n        for (var i = 0, y; i < xs.length; i++) {\n          y = xs[i];\n          if (x === y) {\n            return i;\n          }\n        }\n        return -1;\n      };\n    }\n  })(),\n  indexWhere: function (xs, f) {\n    for (var i = 0, y; i < xs.length; i++) {\n      y = xs[i];\n      if (f(y)) {\n        return i;\n      }\n    }\n    return -1;\n  },\n  head: function (xs) {\n    return xs[0];\n  },\n  always: function (x) {\n    return function () {\n      return x;\n    };\n  },\n  negate: function (f) {\n    return function (x) {\n      return !f(x);\n    };\n  },\n  empty: function (xs) {\n    return xs.length === 0;\n  },\n  tail: function (xs) {\n    return xs.slice(1, xs.length);\n  },\n  filter: function (f, xs) {\n    var filtered = [];\n    for (var i = 0, x; i < xs.length; i++) {\n      x = xs[i];\n      if (f(x)) {\n        filtered.push(x);\n      }\n    }\n    return filtered;\n  },\n  map: function (f, xs) {\n    return (function () {\n      var result = [];\n      for (var i = 0, x; i < xs.length; i++) {\n        x = xs[i];\n        result.push(f(x));\n      }\n      return result;\n    })();\n  },\n  each: function (xs, f) {\n    for (var key in xs) {\n      if (Object.prototype.hasOwnProperty.call(xs, key)) {\n        var value = xs[key];\n        f(key, value);\n      }\n    }\n  },\n  toArray: function (xs) {\n    return isArray(xs) ? xs : [xs];\n  },\n  contains: function (xs, x) {\n    return _.indexOf(xs, x) !== -1;\n  },\n  id: function (x) {\n    return x;\n  },\n  last: function (xs) {\n    return xs[xs.length - 1];\n  },\n  all: function (xs) {\n    var f = arguments.length <= 1 || arguments[1] === undefined ? _.id : arguments[1];\n\n    for (var i = 0, x; i < xs.length; i++) {\n      x = xs[i];\n      if (!f(x)) {\n        return false;\n      }\n    }\n    return true;\n  },\n  any: function (xs) {\n    var f = arguments.length <= 1 || arguments[1] === undefined ? _.id : arguments[1];\n\n    for (var i = 0, x; i < xs.length; i++) {\n      x = xs[i];\n      if (f(x)) {\n        return true;\n      }\n    }\n    return false;\n  },\n  without: function (x, xs) {\n    return _.filter(function (y) {\n      return y !== x;\n    }, xs);\n  },\n  remove: function (x, xs) {\n    var i = _.indexOf(xs, x);\n    if (i >= 0) {\n      return xs.splice(i, 1);\n    }\n  },\n  fold: function (xs, seed, f) {\n    for (var i = 0, x; i < xs.length; i++) {\n      x = xs[i];\n      seed = f(seed, x);\n    }\n    return seed;\n  },\n  flatMap: function (f, xs) {\n    return _.fold(xs, [], function (ys, x) {\n      return ys.concat(f(x));\n    });\n  },\n  cached: function (f) {\n    var value = None;\n    return function () {\n      if (typeof value !== \"undefined\" && value !== null ? value._isNone : undefined) {\n        value = f();\n        f = undefined;\n      }\n      return value;\n    };\n  },\n  bind: function (fn, me) {\n    return function () {\n      return fn.apply(me, arguments);\n    };\n  },\n  isFunction: function (f) {\n    return typeof f === \"function\";\n  },\n  toString: function (obj) {\n    var internals, key, value;\n    var hasProp = ({}).hasOwnProperty;\n    try {\n      recursionDepth++;\n      if (obj == null) {\n        return \"undefined\";\n      } else if (_.isFunction(obj)) {\n        return \"function\";\n      } else if (isArray(obj)) {\n        if (recursionDepth > 5) {\n          return \"[..]\";\n        }\n        return \"[\" + _.map(_.toString, obj).toString() + \"]\";\n      } else if ((obj != null ? obj.toString : void 0) != null && obj.toString !== Object.prototype.toString) {\n        return obj.toString();\n      } else if (typeof obj === \"object\") {\n        if (recursionDepth > 5) {\n          return \"{..}\";\n        }\n        internals = (function () {\n          var results = [];\n          for (key in obj) {\n            if (!hasProp.call(obj, key)) continue;\n            value = (function () {\n              var error;\n              try {\n                return obj[key];\n              } catch (error) {\n                return error;\n              }\n            })();\n            results.push(_.toString(key) + \":\" + _.toString(value));\n          }\n          return results;\n        })();\n        return \"{\" + internals + \"}\";\n      } else {\n        return obj;\n      }\n    } finally {\n      recursionDepth--;\n    }\n  }\n};\n\nvar recursionDepth = 0;\n\nBacon._ = _;\n\nvar UpdateBarrier = Bacon.UpdateBarrier = (function () {\n  var rootEvent;\n  var waiterObs = [];\n  var waiters = {};\n  var aftersStack = [];\n  var aftersStackHeight = 0;\n  var flushed = {};\n\n  function ensureStackHeight(h) {\n    if (h <= aftersStackHeight) return;\n    if (!aftersStack[h - 1]) {\n      aftersStack[h - 1] = [[], 0];\n    }\n    aftersStackHeight = h;\n  }\n\n  var afterTransaction = function (obs, f) {\n    if (rootEvent || aftersStack.length) {\n      ensureStackHeight(1);\n      var stackIndexForThisObs = 0;\n      while (stackIndexForThisObs < aftersStackHeight - 1) {\n        if (containsObs(obs, aftersStack[stackIndexForThisObs][0])) {\n          break;\n        }\n        stackIndexForThisObs++;\n      }\n      var listFromStack = aftersStack[stackIndexForThisObs][0];\n      listFromStack.push([obs, f]);\n      if (!rootEvent) {\n        processAfters();\n      }\n    } else {\n        return f();\n      }\n  };\n\n  function containsObs(obs, aftersList) {\n    for (var i = 0; i < aftersList.length; i++) {\n      if (aftersList[i][0].id == obs.id) return true;\n    }\n    return false;\n  }\n\n  function processAfters() {\n    var stackSizeAtStart = aftersStackHeight;\n    if (!stackSizeAtStart) return;\n    while (aftersStackHeight >= stackSizeAtStart) {\n      var topOfStack = aftersStack[aftersStackHeight - 1];\n      if (!topOfStack) throw new Error(\"Unexpected stack top: \" + topOfStack);\n      var topAfters = topOfStack[0];\n      var index = topOfStack[1];\n\n      if (index < topAfters.length) {\n        var _topAfters$index = topAfters[index];\n        var obs = _topAfters$index[0];\n        var after = _topAfters$index[1];\n\n        topOfStack[1]++;\n        ensureStackHeight(aftersStackHeight + 1);\n        var callSuccess = false;\n        try {\n          after();\n          callSuccess = true;\n          while (aftersStackHeight > stackSizeAtStart && aftersStack[aftersStackHeight - 1][0].length == 0) {\n            aftersStackHeight--;\n          }\n        } finally {\n          if (!callSuccess) {\n            aftersStack = [];\n            aftersStackHeight = 0;\n          }\n        }\n      } else {\n          topOfStack[0] = [];\n          topOfStack[1] = 0;\n          break;\n        }\n    }\n  }\n\n  var whenDoneWith = function (obs, f) {\n    if (rootEvent) {\n      var obsWaiters = waiters[obs.id];\n      if (!(typeof obsWaiters !== \"undefined\" && obsWaiters !== null)) {\n        obsWaiters = waiters[obs.id] = [f];\n        return waiterObs.push(obs);\n      } else {\n        return obsWaiters.push(f);\n      }\n    } else {\n      return f();\n    }\n  };\n\n  var flush = function () {\n    while (waiterObs.length > 0) {\n      flushWaiters(0, true);\n    }\n    flushed = {};\n  };\n\n  var flushWaiters = function (index, deps) {\n    var obs = waiterObs[index];\n    var obsId = obs.id;\n    var obsWaiters = waiters[obsId];\n    waiterObs.splice(index, 1);\n    delete waiters[obsId];\n    if (deps && waiterObs.length > 0) {\n      flushDepsOf(obs);\n    }\n    for (var i = 0, f; i < obsWaiters.length; i++) {\n      f = obsWaiters[i];\n      f();\n    }\n  };\n\n  var flushDepsOf = function (obs) {\n    if (flushed[obs.id]) return;\n    var deps = obs.internalDeps();\n    for (var i = 0, dep; i < deps.length; i++) {\n      dep = deps[i];\n      flushDepsOf(dep);\n      if (waiters[dep.id]) {\n        var index = _.indexOf(waiterObs, dep);\n        flushWaiters(index, false);\n      }\n    }\n    flushed[obs.id] = true;\n  };\n\n  var inTransaction = function (event, context, f, args) {\n    if (rootEvent) {\n      return f.apply(context, args);\n    } else {\n      rootEvent = event;\n      try {\n        var result = f.apply(context, args);\n\n        flush();\n      } finally {\n        rootEvent = undefined;\n        processAfters();\n      }\n      return result;\n    }\n  };\n\n  var currentEventId = function () {\n    return rootEvent ? rootEvent.id : undefined;\n  };\n\n  var wrappedSubscribe = function (obs, sink) {\n    var unsubd = false;\n    var shouldUnsub = false;\n    var doUnsub = function () {\n      shouldUnsub = true;\n      return shouldUnsub;\n    };\n    var unsub = function () {\n      unsubd = true;\n      return doUnsub();\n    };\n    doUnsub = obs.dispatcher.subscribe(function (event) {\n      return afterTransaction(obs, function () {\n        if (!unsubd) {\n          var reply = sink(event);\n          if (reply === Bacon.noMore) {\n            return unsub();\n          }\n        }\n      });\n    });\n    if (shouldUnsub) {\n      doUnsub();\n    }\n    return unsub;\n  };\n\n  var hasWaiters = function () {\n    return waiterObs.length > 0;\n  };\n\n  return { whenDoneWith: whenDoneWith, hasWaiters: hasWaiters, inTransaction: inTransaction, currentEventId: currentEventId, wrappedSubscribe: wrappedSubscribe, afterTransaction: afterTransaction };\n})();\n\nfunction Source(obs, sync) {\n  var lazy = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\n  this.obs = obs;\n  this.sync = sync;\n  this.lazy = lazy;\n  this.queue = [];\n}\n\nextend(Source.prototype, {\n  _isSource: true,\n\n  subscribe: function (sink) {\n    return this.obs.dispatcher.subscribe(sink);\n  },\n  toString: function () {\n    return this.obs.toString();\n  },\n  markEnded: function () {\n    this.ended = true;\n    return true;\n  },\n  consume: function () {\n    if (this.lazy) {\n      return { value: _.always(this.queue[0]) };\n    } else {\n      return this.queue[0];\n    }\n  },\n  push: function (x) {\n    this.queue = [x];\n    return [x];\n  },\n  mayHave: function () {\n    return true;\n  },\n  hasAtLeast: function () {\n    return this.queue.length;\n  },\n  flatten: true\n});\n\nfunction ConsumingSource() {\n  Source.apply(this, arguments);\n}\n\ninherit(ConsumingSource, Source);\nextend(ConsumingSource.prototype, {\n  consume: function () {\n    return this.queue.shift();\n  },\n  push: function (x) {\n    return this.queue.push(x);\n  },\n  mayHave: function (c) {\n    return !this.ended || this.queue.length >= c;\n  },\n  hasAtLeast: function (c) {\n    return this.queue.length >= c;\n  },\n  flatten: false\n});\n\nfunction BufferingSource(obs) {\n  Source.call(this, obs, true);\n}\n\ninherit(BufferingSource, Source);\nextend(BufferingSource.prototype, {\n  consume: function () {\n    var values = this.queue;\n    this.queue = [];\n    return {\n      value: function () {\n        return values;\n      }\n    };\n  },\n  push: function (x) {\n    return this.queue.push(x.value());\n  },\n  hasAtLeast: function () {\n    return true;\n  }\n});\n\nSource.isTrigger = function (s) {\n  if (s != null ? s._isSource : void 0) {\n    return s.sync;\n  } else {\n    return s != null ? s._isEventStream : void 0;\n  }\n};\n\nSource.fromObservable = function (s) {\n  if (s != null ? s._isSource : void 0) {\n    return s;\n  } else if (s != null ? s._isProperty : void 0) {\n    return new Source(s, false);\n  } else {\n    return new ConsumingSource(s, true);\n  }\n};\n\nfunction Desc(context, method, args) {\n  this.context = context;\n  this.method = method;\n  this.args = args;\n}\n\nextend(Desc.prototype, {\n  _isDesc: true,\n  deps: function () {\n    if (!this.cached) {\n      this.cached = findDeps([this.context].concat(this.args));\n    }\n    return this.cached;\n  },\n  toString: function () {\n    return _.toString(this.context) + \".\" + _.toString(this.method) + \"(\" + _.map(_.toString, this.args) + \")\";\n  }\n});\n\nvar describe = function (context, method) {\n  var ref = context || method;\n  if (ref && ref._isDesc) {\n    return context || method;\n  } else {\n    for (var _len = arguments.length, args = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      args[_key - 2] = arguments[_key];\n    }\n\n    return new Desc(context, method, args);\n  }\n};\n\nvar withDesc = function (desc, obs) {\n  obs.desc = desc;\n  return obs;\n};\n\nvar findDeps = function (x) {\n  if (isArray(x)) {\n    return _.flatMap(findDeps, x);\n  } else if (isObservable(x)) {\n    return [x];\n  } else if (typeof x !== \"undefined\" && x !== null ? x._isSource : undefined) {\n    return [x.obs];\n  } else {\n    return [];\n  }\n};\n\nBacon.Desc = Desc;\nBacon.Desc.empty = new Bacon.Desc(\"\", \"\", []);\n\nvar withMethodCallSupport = function (wrapped) {\n  return function (f) {\n    for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    if (typeof f === \"object\" && args.length) {\n      var context = f;\n      var methodName = args[0];\n      f = function () {\n        return context[methodName].apply(context, arguments);\n      };\n      args = args.slice(1);\n    }\n    return wrapped.apply(undefined, [f].concat(args));\n  };\n};\n\nvar makeFunctionArgs = function (args) {\n  args = Array.prototype.slice.call(args);\n  return makeFunction_.apply(undefined, args);\n};\n\nvar partiallyApplied = function (f, applied) {\n  return function () {\n    for (var _len3 = arguments.length, args = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    return f.apply(undefined, applied.concat(args));\n  };\n};\n\nvar toSimpleExtractor = function (args) {\n  return function (key) {\n    return function (value) {\n      if (!(typeof value !== \"undefined\" && value !== null)) {\n        return;\n      } else {\n        var fieldValue = value[key];\n        if (_.isFunction(fieldValue)) {\n          return fieldValue.apply(value, args);\n        } else {\n          return fieldValue;\n        }\n      }\n    };\n  };\n};\n\nvar toFieldExtractor = function (f, args) {\n  var parts = f.slice(1).split(\".\");\n  var partFuncs = _.map(toSimpleExtractor(args), parts);\n  return function (value) {\n    for (var i = 0, f; i < partFuncs.length; i++) {\n      f = partFuncs[i];\n      value = f(value);\n    }\n    return value;\n  };\n};\n\nvar isFieldKey = function (f) {\n  return typeof f === \"string\" && f.length > 1 && f.charAt(0) === \".\";\n};\n\nvar makeFunction_ = withMethodCallSupport(function (f) {\n  for (var _len4 = arguments.length, args = Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n    args[_key4 - 1] = arguments[_key4];\n  }\n\n  if (_.isFunction(f)) {\n    if (args.length) {\n      return partiallyApplied(f, args);\n    } else {\n      return f;\n    }\n  } else if (isFieldKey(f)) {\n    return toFieldExtractor(f, args);\n  } else {\n    return _.always(f);\n  }\n});\n\nvar makeFunction = function (f, args) {\n  return makeFunction_.apply(undefined, [f].concat(args));\n};\n\nvar convertArgsToFunction = function (obs, f, args, method) {\n  if (typeof f !== \"undefined\" && f !== null ? f._isProperty : undefined) {\n    var sampled = f.sampledBy(obs, function (p, s) {\n      return [p, s];\n    });\n    return method.call(sampled, function (_ref) {\n      var p = _ref[0];\n      var s = _ref[1];\n      return p;\n    }).map(function (_ref2) {\n      var p = _ref2[0];\n      var s = _ref2[1];\n      return s;\n    });\n  } else {\n    f = makeFunction(f, args);\n    return method.call(obs, f);\n  }\n};\n\nvar toCombinator = function (f) {\n  if (_.isFunction(f)) {\n    return f;\n  } else if (isFieldKey(f)) {\n    var key = toFieldKey(f);\n    return function (left, right) {\n      return left[key](right);\n    };\n  } else {\n    throw new Exception(\"not a function or a field key: \" + f);\n  }\n};\n\nvar toFieldKey = function (f) {\n  return f.slice(1);\n};\n\nfunction Some(value) {\n  this.value = value;\n}\n\nextend(Some.prototype, {\n  _isSome: true,\n  getOrElse: function () {\n    return this.value;\n  },\n  get: function () {\n    return this.value;\n  },\n  filter: function (f) {\n    if (f(this.value)) {\n      return new Some(this.value);\n    } else {\n      return None;\n    }\n  },\n  map: function (f) {\n    return new Some(f(this.value));\n  },\n  forEach: function (f) {\n    return f(this.value);\n  },\n  isDefined: true,\n  toArray: function () {\n    return [this.value];\n  },\n  inspect: function () {\n    return \"Some(\" + this.value + \")\";\n  },\n  toString: function () {\n    return this.inspect();\n  }\n});\n\nvar None = {\n  _isNone: true,\n  getOrElse: function (value) {\n    return value;\n  },\n  filter: function () {\n    return None;\n  },\n  map: function () {\n    return None;\n  },\n  forEach: function () {},\n  isDefined: false,\n  toArray: function () {\n    return [];\n  },\n  inspect: function () {\n    return \"None\";\n  },\n  toString: function () {\n    return this.inspect();\n  }\n};\n\nvar toOption = function (v) {\n  if ((typeof v !== \"undefined\" && v !== null ? v._isSome : undefined) || (typeof v !== \"undefined\" && v !== null ? v._isNone : undefined)) {\n    return v;\n  } else {\n    return new Some(v);\n  }\n};\n\nBacon.noMore = \"<no-more>\";\nBacon.more = \"<more>\";\n\nvar eventIdCounter = 0;\n\nfunction Event() {\n  this.id = ++eventIdCounter;\n}\n\nEvent.prototype._isEvent = true;\nEvent.prototype.isEvent = function () {\n  return true;\n};\nEvent.prototype.isEnd = function () {\n  return false;\n};\nEvent.prototype.isInitial = function () {\n  return false;\n};\nEvent.prototype.isNext = function () {\n  return false;\n};\nEvent.prototype.isError = function () {\n  return false;\n};\nEvent.prototype.hasValue = function () {\n  return false;\n};\nEvent.prototype.filter = function () {\n  return true;\n};\nEvent.prototype.inspect = function () {\n  return this.toString();\n};\nEvent.prototype.log = function () {\n  return this.toString();\n};\n\nfunction Next(valueF, eager) {\n  if (!(this instanceof Next)) {\n    return new Next(valueF, eager);\n  }\n\n  Event.call(this);\n\n  if (!eager && _.isFunction(valueF) || (valueF != null ? valueF._isNext : void 0)) {\n    this.valueF = valueF;\n    this.valueInternal = void 0;\n  } else {\n    this.valueF = void 0;\n    this.valueInternal = valueF;\n  }\n}\n\ninherit(Next, Event);\n\nNext.prototype.isNext = function () {\n  return true;\n};\nNext.prototype.hasValue = function () {\n  return true;\n};\nNext.prototype.value = function () {\n  var ref;\n  if ((ref = this.valueF) != null ? ref._isNext : void 0) {\n    this.valueInternal = this.valueF.value();\n    this.valueF = void 0;\n  } else if (this.valueF) {\n    this.valueInternal = this.valueF();\n    this.valueF = void 0;\n  }\n  return this.valueInternal;\n};\n\nNext.prototype.fmap = function (f) {\n  var event, value;\n  if (this.valueInternal) {\n    value = this.valueInternal;\n    return this.apply(function () {\n      return f(value);\n    });\n  } else {\n    event = this;\n    return this.apply(function () {\n      return f(event.value());\n    });\n  }\n};\n\nNext.prototype.apply = function (value) {\n  return new Next(value);\n};\nNext.prototype.filter = function (f) {\n  return f(this.value());\n};\nNext.prototype.toString = function () {\n  return _.toString(this.value());\n};\nNext.prototype.log = function () {\n  return this.value();\n};\nNext.prototype._isNext = true;\n\nfunction Initial(valueF, eager) {\n  if (!(this instanceof Initial)) {\n    return new Initial(valueF, eager);\n  }\n  Next.call(this, valueF, eager);\n}\n\ninherit(Initial, Next);\nInitial.prototype._isInitial = true;\nInitial.prototype.isInitial = function () {\n  return true;\n};\nInitial.prototype.isNext = function () {\n  return false;\n};\nInitial.prototype.apply = function (value) {\n  return new Initial(value);\n};\nInitial.prototype.toNext = function () {\n  return new Next(this);\n};\n\nfunction End() {\n  if (!(this instanceof End)) {\n    return new End();\n  }\n  Event.call(this);\n}\n\ninherit(End, Event);\nEnd.prototype.isEnd = function () {\n  return true;\n};\nEnd.prototype.fmap = function () {\n  return this;\n};\nEnd.prototype.apply = function () {\n  return this;\n};\nEnd.prototype.toString = function () {\n  return \"<end>\";\n};\n\nfunction Error(error) {\n  if (!(this instanceof Error)) {\n    return new Error(error);\n  }\n  this.error = error;\n  Event.call(this);\n}\n\ninherit(Error, Event);\nError.prototype.isError = function () {\n  return true;\n};\nError.prototype.fmap = function () {\n  return this;\n};\nError.prototype.apply = function () {\n  return this;\n};\nError.prototype.toString = function () {\n  return \"<error> \" + _.toString(this.error);\n};\n\nBacon.Event = Event;\nBacon.Initial = Initial;\nBacon.Next = Next;\nBacon.End = End;\nBacon.Error = Error;\n\nvar initialEvent = function (value) {\n  return new Initial(value, true);\n};\nvar nextEvent = function (value) {\n  return new Next(value, true);\n};\nvar endEvent = function () {\n  return new End();\n};\nvar toEvent = function (x) {\n  if (x && x._isEvent) {\n    return x;\n  } else {\n    return nextEvent(x);\n  }\n};\n\nvar idCounter = 0;\nvar registerObs = function () {};\n\nfunction Observable(desc) {\n  this.desc = desc;\n  this.id = ++idCounter;\n  this.initialDesc = this.desc;\n}\n\nextend(Observable.prototype, {\n  _isObservable: true,\n\n  subscribe: function (sink) {\n    return UpdateBarrier.wrappedSubscribe(this, sink);\n  },\n\n  subscribeInternal: function (sink) {\n    return this.dispatcher.subscribe(sink);\n  },\n\n  onValue: function () {\n    var f = makeFunctionArgs(arguments);\n    return this.subscribe(function (event) {\n      if (event.hasValue()) {\n        return f(event.value());\n      }\n    });\n  },\n\n  onValues: function (f) {\n    return this.onValue(function (args) {\n      return f.apply(undefined, args);\n    });\n  },\n\n  onError: function () {\n    var f = makeFunctionArgs(arguments);\n    return this.subscribe(function (event) {\n      if (event.isError()) {\n        return f(event.error);\n      }\n    });\n  },\n\n  onEnd: function () {\n    var f = makeFunctionArgs(arguments);\n    return this.subscribe(function (event) {\n      if (event.isEnd()) {\n        return f();\n      }\n    });\n  },\n\n  name: function (name) {\n    this._name = name;\n    return this;\n  },\n\n  withDescription: function () {\n    this.desc = describe.apply(undefined, arguments);\n    return this;\n  },\n\n  toString: function () {\n    if (this._name) {\n      return this._name;\n    } else {\n      return this.desc.toString();\n    }\n  },\n\n  deps: function () {\n    return this.desc.deps();\n  },\n\n  internalDeps: function () {\n    return this.initialDesc.deps();\n  }\n});\n\nObservable.prototype.assign = Observable.prototype.onValue;\nObservable.prototype.forEach = Observable.prototype.onValue;\nObservable.prototype.inspect = Observable.prototype.toString;\n\nBacon.Observable = Observable;\n\nfunction CompositeUnsubscribe() {\n  var ss = arguments.length <= 0 || arguments[0] === undefined ? [] : arguments[0];\n\n  this.unsubscribe = _.bind(this.unsubscribe, this);\n  this.unsubscribed = false;\n  this.subscriptions = [];\n  this.starting = [];\n  for (var i = 0, s; i < ss.length; i++) {\n    s = ss[i];\n    this.add(s);\n  }\n}\n\nextend(CompositeUnsubscribe.prototype, {\n  add: function (subscription) {\n    var _this2 = this;\n\n    if (this.unsubscribed) {\n      return;\n    }\n    var ended = false;\n    var unsub = nop;\n    this.starting.push(subscription);\n    var unsubMe = function () {\n      if (_this2.unsubscribed) {\n        return;\n      }\n      ended = true;\n      _this2.remove(unsub);\n      return _.remove(subscription, _this2.starting);\n    };\n    unsub = subscription(this.unsubscribe, unsubMe);\n    if (!(this.unsubscribed || ended)) {\n      this.subscriptions.push(unsub);\n    } else {\n      unsub();\n    }\n    _.remove(subscription, this.starting);\n    return unsub;\n  },\n\n  remove: function (unsub) {\n    if (this.unsubscribed) {\n      return;\n    }\n    if (_.remove(unsub, this.subscriptions) !== undefined) {\n      return unsub();\n    }\n  },\n\n  unsubscribe: function () {\n    if (this.unsubscribed) {\n      return;\n    }\n    this.unsubscribed = true;\n    var iterable = this.subscriptions;\n    for (var i = 0; i < iterable.length; i++) {\n      iterable[i]();\n    }\n    this.subscriptions = [];\n    this.starting = [];\n    return [];\n  },\n\n  count: function () {\n    if (this.unsubscribed) {\n      return 0;\n    }\n    return this.subscriptions.length + this.starting.length;\n  },\n\n  empty: function () {\n    return this.count() === 0;\n  }\n});\n\nBacon.CompositeUnsubscribe = CompositeUnsubscribe;\n\nfunction Dispatcher(_subscribe, _handleEvent) {\n  this._subscribe = _subscribe;\n  this._handleEvent = _handleEvent;\n  this.subscribe = _.bind(this.subscribe, this);\n  this.handleEvent = _.bind(this.handleEvent, this);\n  this.pushing = false;\n  this.ended = false;\n  this.prevError = undefined;\n  this.unsubSrc = undefined;\n  this.subscriptions = [];\n  this.queue = [];\n}\n\nDispatcher.prototype.hasSubscribers = function () {\n  return this.subscriptions.length > 0;\n};\n\nDispatcher.prototype.removeSub = function (subscription) {\n  this.subscriptions = _.without(subscription, this.subscriptions);\n  return this.subscriptions;\n};\n\nDispatcher.prototype.push = function (event) {\n  if (event.isEnd()) {\n    this.ended = true;\n  }\n  return UpdateBarrier.inTransaction(event, this, this.pushIt, [event]);\n};\n\nDispatcher.prototype.pushToSubscriptions = function (event) {\n  try {\n    var tmp = this.subscriptions;\n    var len = tmp.length;\n    for (var i = 0; i < len; i++) {\n      var sub = tmp[i];\n      var reply = sub.sink(event);\n      if (reply === Bacon.noMore || event.isEnd()) {\n        this.removeSub(sub);\n      }\n    }\n    return true;\n  } catch (error) {\n    this.pushing = false;\n    this.queue = [];\n    throw error;\n  }\n};\n\nDispatcher.prototype.pushIt = function (event) {\n  if (!this.pushing) {\n    if (event === this.prevError) {\n      return;\n    }\n    if (event.isError()) {\n      this.prevError = event;\n    }\n    this.pushing = true;\n    this.pushToSubscriptions(event);\n    this.pushing = false;\n    while (this.queue.length) {\n      event = this.queue.shift();\n      this.push(event);\n    }\n    if (this.hasSubscribers()) {\n      return Bacon.more;\n    } else {\n      this.unsubscribeFromSource();\n      return Bacon.noMore;\n    }\n  } else {\n    this.queue.push(event);\n    return Bacon.more;\n  }\n};\n\nDispatcher.prototype.handleEvent = function (event) {\n  if (this._handleEvent) {\n    return this._handleEvent(event);\n  } else {\n    return this.push(event);\n  }\n};\n\nDispatcher.prototype.unsubscribeFromSource = function () {\n  if (this.unsubSrc) {\n    this.unsubSrc();\n  }\n  this.unsubSrc = undefined;\n};\n\nDispatcher.prototype.subscribe = function (sink) {\n  var subscription;\n  if (this.ended) {\n    sink(endEvent());\n    return nop;\n  } else {\n    assertFunction(sink);\n    subscription = {\n      sink: sink\n    };\n    this.subscriptions.push(subscription);\n    if (this.subscriptions.length === 1) {\n      this.unsubSrc = this._subscribe(this.handleEvent);\n      assertFunction(this.unsubSrc);\n    }\n    return (function (_this) {\n      return function () {\n        _this.removeSub(subscription);\n        if (!_this.hasSubscribers()) {\n          return _this.unsubscribeFromSource();\n        }\n      };\n    })(this);\n  }\n};\n\nBacon.Dispatcher = Dispatcher;\n\nfunction EventStream(desc, subscribe, handler) {\n  if (!(this instanceof EventStream)) {\n    return new EventStream(desc, subscribe, handler);\n  }\n  if (_.isFunction(desc)) {\n    handler = subscribe;\n    subscribe = desc;\n    desc = Desc.empty;\n  }\n  Observable.call(this, desc);\n  assertFunction(subscribe);\n  this.dispatcher = new Dispatcher(subscribe, handler);\n  registerObs(this);\n}\n\ninherit(EventStream, Observable);\nextend(EventStream.prototype, {\n  _isEventStream: true,\n\n  toProperty: function (initValue_) {\n    var initValue = arguments.length === 0 ? None : toOption(function () {\n      return initValue_;\n    });\n    var disp = this.dispatcher;\n    var desc = new Bacon.Desc(this, \"toProperty\", [initValue_]);\n    return new Property(desc, function (sink) {\n      var initSent = false;\n      var subbed = false;\n      var unsub = nop;\n      var reply = Bacon.more;\n      var sendInit = function () {\n        if (!initSent) {\n          return initValue.forEach(function (value) {\n            initSent = true;\n            reply = sink(new Initial(value));\n            if (reply === Bacon.noMore) {\n              unsub();\n              unsub = nop;\n              return nop;\n            }\n          });\n        }\n      };\n\n      unsub = disp.subscribe(function (event) {\n        if (event.hasValue()) {\n          if (event.isInitial() && !subbed) {\n            initValue = new Some(function () {\n              return event.value();\n            });\n            return Bacon.more;\n          } else {\n            if (!event.isInitial()) {\n              sendInit();\n            }\n            initSent = true;\n            initValue = new Some(event);\n            return sink(event);\n          }\n        } else {\n          if (event.isEnd()) {\n            reply = sendInit();\n          }\n          if (reply !== Bacon.noMore) {\n            return sink(event);\n          }\n        }\n      });\n      subbed = true;\n      sendInit();\n      return unsub;\n    });\n  },\n\n  toEventStream: function () {\n    return this;\n  },\n\n  withHandler: function (handler) {\n    return new EventStream(new Bacon.Desc(this, \"withHandler\", [handler]), this.dispatcher.subscribe, handler);\n  }\n});\n\nBacon.EventStream = EventStream;\n\nBacon.never = function () {\n  return new EventStream(describe(Bacon, \"never\"), function (sink) {\n    sink(endEvent());\n    return nop;\n  });\n};\n\nBacon.when = function () {\n  if (arguments.length === 0) {\n    return Bacon.never();\n  }\n  var len = arguments.length;\n  var usage = \"when: expecting arguments in the form (Observable+,function)+\";\n\n  assert(usage, len % 2 === 0);\n  var sources = [];\n  var pats = [];\n  var i = 0;\n  var patterns = [];\n  while (i < len) {\n    patterns[i] = arguments[i];\n    patterns[i + 1] = arguments[i + 1];\n    var patSources = _.toArray(arguments[i]);\n    var f = constantToFunction(arguments[i + 1]);\n    var pat = { f: f, ixs: [] };\n    var triggerFound = false;\n    for (var j = 0, s; j < patSources.length; j++) {\n      s = patSources[j];\n      var index = _.indexOf(sources, s);\n      if (!triggerFound) {\n        triggerFound = Source.isTrigger(s);\n      }\n      if (index < 0) {\n        sources.push(s);\n        index = sources.length - 1;\n      }\n      for (var k = 0, ix; k < pat.ixs.length; k++) {\n        ix = pat.ixs[k];\n        if (ix.index === index) {\n          ix.count++;\n        }\n      }\n      pat.ixs.push({ index: index, count: 1 });\n    }\n\n    assert(\"At least one EventStream required\", triggerFound || !patSources.length);\n\n    if (patSources.length > 0) {\n      pats.push(pat);\n    }\n    i = i + 2;\n  }\n\n  if (!sources.length) {\n    return Bacon.never();\n  }\n\n  sources = _.map(Source.fromObservable, sources);\n  var needsBarrier = _.any(sources, function (s) {\n    return s.flatten;\n  }) && containsDuplicateDeps(_.map(function (s) {\n    return s.obs;\n  }, sources));\n\n  var desc = new Bacon.Desc(Bacon, \"when\", patterns);\n  var resultStream = new EventStream(desc, function (sink) {\n    var triggers = [];\n    var ends = false;\n    var match = function (p) {\n      for (var i1 = 0, i; i1 < p.ixs.length; i1++) {\n        i = p.ixs[i1];\n        if (!sources[i.index].hasAtLeast(i.count)) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var cannotSync = function (source) {\n      return !source.sync || source.ended;\n    };\n    var cannotMatch = function (p) {\n      for (var i1 = 0, i; i1 < p.ixs.length; i1++) {\n        i = p.ixs[i1];\n        if (!sources[i.index].mayHave(i.count)) {\n          return true;\n        }\n      }\n    };\n    var nonFlattened = function (trigger) {\n      return !trigger.source.flatten;\n    };\n    var part = function (source) {\n      return function (unsubAll) {\n        var flushLater = function () {\n          return UpdateBarrier.whenDoneWith(resultStream, flush);\n        };\n        var flushWhileTriggers = function () {\n          if (triggers.length > 0) {\n            var reply = Bacon.more;\n            var trigger = triggers.pop();\n            for (var i1 = 0, p; i1 < pats.length; i1++) {\n              p = pats[i1];\n              if (match(p)) {\n                var events = (function () {\n                  var result = [];\n                  for (var i2 = 0, i; i2 < p.ixs.length; i2++) {\n                    i = p.ixs[i2];\n                    result.push(sources[i.index].consume());\n                  }\n                  return result;\n                })();\n                reply = sink(trigger.e.apply(function () {\n                  var _p;\n\n                  var values = (function () {\n                    var result = [];\n                    for (var i2 = 0, event; i2 < events.length; i2++) {\n                      event = events[i2];\n                      result.push(event.value());\n                    }\n                    return result;\n                  })();\n\n                  return (_p = p).f.apply(_p, values);\n                }));\n                if (triggers.length) {\n                  triggers = _.filter(nonFlattened, triggers);\n                }\n                if (reply === Bacon.noMore) {\n                  return reply;\n                } else {\n                  return flushWhileTriggers();\n                }\n              }\n            }\n          } else {\n            return Bacon.more;\n          }\n        };\n        var flush = function () {\n          var reply = flushWhileTriggers();\n          if (ends) {\n            if (_.all(sources, cannotSync) || _.all(pats, cannotMatch)) {\n              reply = Bacon.noMore;\n              sink(endEvent());\n            }\n          }\n          if (reply === Bacon.noMore) {\n            unsubAll();\n          }\n\n          return reply;\n        };\n        return source.subscribe(function (e) {\n          if (e.isEnd()) {\n            ends = true;\n            source.markEnded();\n            flushLater();\n          } else if (e.isError()) {\n            var reply = sink(e);\n          } else {\n            source.push(e);\n            if (source.sync) {\n              triggers.push({ source: source, e: e });\n              if (needsBarrier || UpdateBarrier.hasWaiters()) {\n                flushLater();\n              } else {\n                flush();\n              }\n            }\n          }\n          if (reply === Bacon.noMore) {\n            unsubAll();\n          }\n          return reply || Bacon.more;\n        });\n      };\n    };\n\n    return new Bacon.CompositeUnsubscribe((function () {\n      var result = [];\n      for (var i1 = 0, s; i1 < sources.length; i1++) {\n        s = sources[i1];\n        result.push(part(s));\n      }\n      return result;\n    })()).unsubscribe;\n  });\n  return resultStream;\n};\n\nvar containsDuplicateDeps = function (observables) {\n  var state = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];\n\n  var checkObservable = function (obs) {\n    if (_.contains(state, obs)) {\n      return true;\n    } else {\n      var deps = obs.internalDeps();\n      if (deps.length) {\n        state.push(obs);\n        return _.any(deps, checkObservable);\n      } else {\n        state.push(obs);\n        return false;\n      }\n    }\n  };\n\n  return _.any(observables, checkObservable);\n};\n\nvar constantToFunction = function (f) {\n  if (_.isFunction(f)) {\n    return f;\n  } else {\n    return _.always(f);\n  }\n};\n\nBacon.groupSimultaneous = function () {\n  for (var _len5 = arguments.length, streams = Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n    streams[_key5] = arguments[_key5];\n  }\n\n  if (streams.length === 1 && isArray(streams[0])) {\n    streams = streams[0];\n  }\n  var sources = (function () {\n    var result = [];\n    for (var i = 0, s; i < streams.length; i++) {\n      s = streams[i];\n      result.push(new BufferingSource(s));\n    }\n    return result;\n  })();\n  return withDesc(new Bacon.Desc(Bacon, \"groupSimultaneous\", streams), Bacon.when(sources, function () {\n    for (var _len6 = arguments.length, xs = Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n      xs[_key6] = arguments[_key6];\n    }\n\n    return xs;\n  }));\n};\n\nfunction PropertyDispatcher(property, subscribe, handleEvent) {\n  Dispatcher.call(this, subscribe, handleEvent);\n  this.property = property;\n  this.subscribe = _.bind(this.subscribe, this);\n  this.current = None;\n  this.currentValueRootId = undefined;\n  this.propertyEnded = false;\n}\n\ninherit(PropertyDispatcher, Dispatcher);\nextend(PropertyDispatcher.prototype, {\n  push: function (event) {\n    if (event.isEnd()) {\n      this.propertyEnded = true;\n    }\n    if (event.hasValue()) {\n      this.current = new Some(event);\n      this.currentValueRootId = UpdateBarrier.currentEventId();\n    }\n    return Dispatcher.prototype.push.call(this, event);\n  },\n\n  maybeSubSource: function (sink, reply) {\n    if (reply === Bacon.noMore) {\n      return nop;\n    } else if (this.propertyEnded) {\n      sink(endEvent());\n      return nop;\n    } else {\n      return Dispatcher.prototype.subscribe.call(this, sink);\n    }\n  },\n\n  subscribe: function (sink) {\n    var _this3 = this;\n\n    var initSent = false;\n\n    var reply = Bacon.more;\n\n    if (this.current.isDefined && (this.hasSubscribers() || this.propertyEnded)) {\n      var dispatchingId = UpdateBarrier.currentEventId();\n      var valId = this.currentValueRootId;\n      if (!this.propertyEnded && valId && dispatchingId && dispatchingId !== valId) {\n        UpdateBarrier.whenDoneWith(this.property, function () {\n          if (_this3.currentValueRootId === valId) {\n            return sink(initialEvent(_this3.current.get().value()));\n          }\n        });\n\n        return this.maybeSubSource(sink, reply);\n      } else {\n        UpdateBarrier.inTransaction(undefined, this, function () {\n          reply = sink(initialEvent(this.current.get().value()));\n          return reply;\n        }, []);\n        return this.maybeSubSource(sink, reply);\n      }\n    } else {\n      return this.maybeSubSource(sink, reply);\n    }\n  }\n});\n\nfunction Property(desc, subscribe, handler) {\n  Observable.call(this, desc);\n  assertFunction(subscribe);\n  this.dispatcher = new PropertyDispatcher(this, subscribe, handler);\n  registerObs(this);\n}\n\ninherit(Property, Observable);\nextend(Property.prototype, {\n  _isProperty: true,\n\n  changes: function () {\n    var _this4 = this;\n\n    return new EventStream(new Bacon.Desc(this, \"changes\", []), function (sink) {\n      return _this4.dispatcher.subscribe(function (event) {\n        if (!event.isInitial()) {\n          return sink(event);\n        }\n      });\n    });\n  },\n\n  withHandler: function (handler) {\n    return new Property(new Bacon.Desc(this, \"withHandler\", [handler]), this.dispatcher.subscribe, handler);\n  },\n\n  toProperty: function () {\n    assertNoArguments(arguments);\n    return this;\n  },\n\n  toEventStream: function () {\n    var _this5 = this;\n\n    return new EventStream(new Bacon.Desc(this, \"toEventStream\", []), function (sink) {\n      return _this5.dispatcher.subscribe(function (event) {\n        if (event.isInitial()) {\n          event = event.toNext();\n        }\n        return sink(event);\n      });\n    });\n  }\n});\n\nBacon.Property = Property;\n\nBacon.constant = function (value) {\n  return new Property(new Bacon.Desc(Bacon, \"constant\", [value]), function (sink) {\n    sink(initialEvent(value));\n    sink(endEvent());\n    return nop;\n  });\n};\n\nBacon.fromBinder = function (binder) {\n  var eventTransformer = arguments.length <= 1 || arguments[1] === undefined ? _.id : arguments[1];\n\n  var desc = new Bacon.Desc(Bacon, \"fromBinder\", [binder, eventTransformer]);\n  return new EventStream(desc, function (sink) {\n    var unbound = false;\n    var shouldUnbind = false;\n    var unbind = function () {\n      if (!unbound) {\n        if (typeof unbinder !== \"undefined\" && unbinder !== null) {\n          unbinder();\n          return unbound = true;\n        } else {\n          return shouldUnbind = true;\n        }\n      }\n    };\n    var unbinder = binder(function () {\n      var ref;\n\n      for (var _len7 = arguments.length, args = Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {\n        args[_key7] = arguments[_key7];\n      }\n\n      var value = eventTransformer.apply(this, args);\n      if (!(isArray(value) && ((ref = _.last(value)) != null ? ref._isEvent : undefined))) {\n        value = [value];\n      }\n      var reply = Bacon.more;\n      for (var i = 0, event; i < value.length; i++) {\n        event = value[i];\n        reply = sink(event = toEvent(event));\n        if (reply === Bacon.noMore || event.isEnd()) {\n          unbind();\n          return reply;\n        }\n      }\n      return reply;\n    });\n    if (shouldUnbind) {\n      unbind();\n    }\n    return unbind;\n  });\n};\n\nBacon.Observable.prototype.map = function (p) {\n  for (var _len8 = arguments.length, args = Array(_len8 > 1 ? _len8 - 1 : 0), _key8 = 1; _key8 < _len8; _key8++) {\n    args[_key8 - 1] = arguments[_key8];\n  }\n\n  return convertArgsToFunction(this, p, args, function (f) {\n    return withDesc(new Bacon.Desc(this, \"map\", [f]), this.withHandler(function (event) {\n      return this.push(event.fmap(f));\n    }));\n  });\n};\n\nvar argumentsToObservables = function (args) {\n  if (isArray(args[0])) {\n    return args[0];\n  } else {\n    return Array.prototype.slice.call(args);\n  }\n};\n\nvar argumentsToObservablesAndFunction = function (args) {\n  if (_.isFunction(args[0])) {\n    return [argumentsToObservables(Array.prototype.slice.call(args, 1)), args[0]];\n  } else {\n    return [argumentsToObservables(Array.prototype.slice.call(args, 0, args.length - 1)), _.last(args)];\n  }\n};\n\nBacon.combineAsArray = function () {\n  var streams = argumentsToObservables(arguments);\n  if (streams.length) {\n    var sources = [];\n    for (var i = 0; i < streams.length; i++) {\n      var stream = isObservable(streams[i]) ? streams[i] : Bacon.constant(streams[i]);\n      sources.push(new Source(stream, true));\n    }\n    return withDesc(new Bacon.Desc(Bacon, \"combineAsArray\", streams), Bacon.when(sources, function () {\n      for (var _len9 = arguments.length, xs = Array(_len9), _key9 = 0; _key9 < _len9; _key9++) {\n        xs[_key9] = arguments[_key9];\n      }\n\n      return xs;\n    }).toProperty());\n  } else {\n    return Bacon.constant([]);\n  }\n};\n\nBacon.onValues = function () {\n  return Bacon.combineAsArray(Array.prototype.slice.call(arguments, 0, arguments.length - 1)).onValues(arguments[arguments.length - 1]);\n};\n\nBacon.combineWith = function () {\n  var _argumentsToObservablesAndFunction = argumentsToObservablesAndFunction(arguments);\n\n  var streams = _argumentsToObservablesAndFunction[0];\n  var f = _argumentsToObservablesAndFunction[1];\n\n  var desc = new Bacon.Desc(Bacon, \"combineWith\", [f].concat(streams));\n  return withDesc(desc, Bacon.combineAsArray(streams).map(function (values) {\n    return f.apply(undefined, values);\n  }));\n};\n\nBacon.Observable.prototype.combine = function (other, f) {\n  var combinator = toCombinator(f);\n  var desc = new Bacon.Desc(this, \"combine\", [other, f]);\n  return withDesc(desc, Bacon.combineAsArray(this, other).map(function (values) {\n    return combinator(values[0], values[1]);\n  }));\n};\n\nBacon.Observable.prototype.withStateMachine = function (initState, f) {\n  var state = initState;\n  var desc = new Bacon.Desc(this, \"withStateMachine\", [initState, f]);\n  return withDesc(desc, this.withHandler(function (event) {\n    var fromF = f(state, event);\n    var newState = fromF[0];\n    var outputs = fromF[1];\n\n    state = newState;\n    var reply = Bacon.more;\n    for (var i = 0, output; i < outputs.length; i++) {\n      output = outputs[i];\n      reply = this.push(output);\n      if (reply === Bacon.noMore) {\n        return reply;\n      }\n    }\n    return reply;\n  }));\n};\n\nvar equals = function (a, b) {\n  return a === b;\n};\n\nvar isNone = function (object) {\n  return typeof object !== \"undefined\" && object !== null ? object._isNone : false;\n};\n\nBacon.Observable.prototype.skipDuplicates = function () {\n  var isEqual = arguments.length <= 0 || arguments[0] === undefined ? equals : arguments[0];\n\n  var desc = new Bacon.Desc(this, \"skipDuplicates\", []);\n  return withDesc(desc, this.withStateMachine(None, function (prev, event) {\n    if (!event.hasValue()) {\n      return [prev, [event]];\n    } else if (event.isInitial() || isNone(prev) || !isEqual(prev.get(), event.value())) {\n      return [new Some(event.value()), [event]];\n    } else {\n      return [prev, []];\n    }\n  }));\n};\n\nBacon.Observable.prototype.awaiting = function (other) {\n  var desc = new Bacon.Desc(this, \"awaiting\", [other]);\n  return withDesc(desc, Bacon.groupSimultaneous(this, other).map(function (values) {\n    return values[1].length === 0;\n  }).toProperty(false).skipDuplicates());\n};\n\nBacon.Observable.prototype.not = function () {\n  return withDesc(new Bacon.Desc(this, \"not\", []), this.map(function (x) {\n    return !x;\n  }));\n};\n\nBacon.Property.prototype.and = function (other) {\n  return withDesc(new Bacon.Desc(this, \"and\", [other]), this.combine(other, function (x, y) {\n    return x && y;\n  }));\n};\n\nBacon.Property.prototype.or = function (other) {\n  return withDesc(new Bacon.Desc(this, \"or\", [other]), this.combine(other, function (x, y) {\n    return x || y;\n  }));\n};\n\nBacon.scheduler = {\n  setTimeout: function (f, d) {\n    return setTimeout(f, d);\n  },\n  setInterval: function (f, i) {\n    return setInterval(f, i);\n  },\n  clearInterval: function (id) {\n    return clearInterval(id);\n  },\n  clearTimeout: function (id) {\n    return clearTimeout(id);\n  },\n  now: function () {\n    return new Date().getTime();\n  }\n};\n\nBacon.EventStream.prototype.bufferWithTime = function (delay) {\n  return withDesc(new Bacon.Desc(this, \"bufferWithTime\", [delay]), this.bufferWithTimeOrCount(delay, Number.MAX_VALUE));\n};\n\nBacon.EventStream.prototype.bufferWithCount = function (count) {\n  return withDesc(new Bacon.Desc(this, \"bufferWithCount\", [count]), this.bufferWithTimeOrCount(undefined, count));\n};\n\nBacon.EventStream.prototype.bufferWithTimeOrCount = function (delay, count) {\n  var flushOrSchedule = function (buffer) {\n    if (buffer.values.length === count) {\n      return buffer.flush();\n    } else if (delay !== undefined) {\n      return buffer.schedule();\n    }\n  };\n  var desc = new Bacon.Desc(this, \"bufferWithTimeOrCount\", [delay, count]);\n  return withDesc(desc, this.buffer(delay, flushOrSchedule, flushOrSchedule));\n};\n\nBacon.EventStream.prototype.buffer = function (delay) {\n  var onInput = arguments.length <= 1 || arguments[1] === undefined ? nop : arguments[1];\n  var onFlush = arguments.length <= 2 || arguments[2] === undefined ? nop : arguments[2];\n\n  var buffer = {\n    scheduled: null,\n    end: undefined,\n    values: [],\n    flush: function () {\n      if (this.scheduled) {\n        Bacon.scheduler.clearTimeout(this.scheduled);\n        this.scheduled = null;\n      }\n      if (this.values.length > 0) {\n        var valuesToPush = this.values;\n        this.values = [];\n        var reply = this.push(nextEvent(valuesToPush));\n        if (this.end != null) {\n          return this.push(this.end);\n        } else if (reply !== Bacon.noMore) {\n          return onFlush(this);\n        }\n      } else {\n        if (this.end != null) {\n          return this.push(this.end);\n        }\n      }\n    },\n    schedule: function () {\n      var _this6 = this;\n\n      if (!this.scheduled) {\n        return this.scheduled = delay(function () {\n          return _this6.flush();\n        });\n      }\n    }\n  };\n  var reply = Bacon.more;\n  if (!_.isFunction(delay)) {\n    var delayMs = delay;\n    delay = function (f) {\n      return Bacon.scheduler.setTimeout(f, delayMs);\n    };\n  }\n  return withDesc(new Bacon.Desc(this, \"buffer\", []), this.withHandler(function (event) {\n    var _this7 = this;\n\n    buffer.push = function (event) {\n      return _this7.push(event);\n    };\n    if (event.isError()) {\n      reply = this.push(event);\n    } else if (event.isEnd()) {\n      buffer.end = event;\n      if (!buffer.scheduled) {\n        buffer.flush();\n      }\n    } else {\n      buffer.values.push(event.value());\n\n      onInput(buffer);\n    }\n    return reply;\n  }));\n};\n\nBacon.Observable.prototype.filter = function (f) {\n  assertObservableIsProperty(f);\n\n  for (var _len10 = arguments.length, args = Array(_len10 > 1 ? _len10 - 1 : 0), _key10 = 1; _key10 < _len10; _key10++) {\n    args[_key10 - 1] = arguments[_key10];\n  }\n\n  return convertArgsToFunction(this, f, args, function (f) {\n    return withDesc(new Bacon.Desc(this, \"filter\", [f]), this.withHandler(function (event) {\n      if (event.filter(f)) {\n        return this.push(event);\n      } else {\n        return Bacon.more;\n      }\n    }));\n  });\n};\n\nBacon.once = function (value) {\n  return new EventStream(new Desc(Bacon, \"once\", [value]), function (sink) {\n    sink(toEvent(value));\n    sink(endEvent());\n    return nop;\n  });\n};\n\nBacon.EventStream.prototype.concat = function (right) {\n  var left = this;\n  return new EventStream(new Bacon.Desc(left, \"concat\", [right]), function (sink) {\n    var unsubRight = nop;\n    var unsubLeft = left.dispatcher.subscribe(function (e) {\n      if (e.isEnd()) {\n        unsubRight = right.toEventStream().dispatcher.subscribe(sink);\n        return unsubRight;\n      } else {\n        return sink(e);\n      }\n    });\n    return function () {\n      return unsubLeft(), unsubRight();\n    };\n  });\n};\n\nBacon.Property.prototype.concat = function (right) {\n  return addPropertyInitValueToStream(this, this.changes().concat(right));\n};\n\nBacon.concatAll = function () {\n  var streams = argumentsToObservables(arguments);\n  if (streams.length) {\n    return withDesc(new Bacon.Desc(Bacon, \"concatAll\", streams), _.fold(_.tail(streams), _.head(streams).toEventStream(), function (a, b) {\n      return a.concat(b);\n    }));\n  } else {\n    return Bacon.never();\n  }\n};\n\nvar addPropertyInitValueToStream = function (property, stream) {\n  var justInitValue = new EventStream(describe(property, \"justInitValue\"), function (sink) {\n    var value = undefined;\n    var unsub = property.dispatcher.subscribe(function (event) {\n      if (!event.isEnd()) {\n        value = event;\n      }\n      return Bacon.noMore;\n    });\n    UpdateBarrier.whenDoneWith(justInitValue, function () {\n      if (typeof value !== \"undefined\" && value !== null) {\n        sink(value);\n      }\n      return sink(endEvent());\n    });\n    return unsub;\n  });\n  return justInitValue.concat(stream).toProperty();\n};\n\nBacon.Observable.prototype.flatMap = function () {\n  return flatMap_(this, makeSpawner(arguments));\n};\n\nBacon.Observable.prototype.flatMapFirst = function () {\n  return flatMap_(this, makeSpawner(arguments), true);\n};\n\nvar makeSpawner = function (args) {\n  if (args.length === 1 && isObservable(args[0])) {\n    return _.always(args[0]);\n  } else {\n    return makeFunctionArgs(args);\n  }\n};\n\nvar makeObservable = function (x) {\n  if (isObservable(x)) {\n    return x;\n  } else {\n    return Bacon.once(x);\n  }\n};\n\nvar flatMap_ = function (root, f, firstOnly, limit) {\n  var rootDep = [root];\n  var childDeps = [];\n  var desc = new Bacon.Desc(root, \"flatMap\" + (firstOnly ? \"First\" : \"\"), [f]);\n  var result = new EventStream(desc, function (sink) {\n    var composite = new CompositeUnsubscribe();\n    var queue = [];\n    var spawn = function (event) {\n      var child = makeObservable(f(event.value()));\n      childDeps.push(child);\n      return composite.add(function (unsubAll, unsubMe) {\n        return child.dispatcher.subscribe(function (event) {\n          if (event.isEnd()) {\n            _.remove(child, childDeps);\n            checkQueue();\n            checkEnd(unsubMe);\n            return Bacon.noMore;\n          } else {\n            if (typeof event !== \"undefined\" && event !== null ? event._isInitial : undefined) {\n              event = event.toNext();\n            }\n            var reply = sink(event);\n            if (reply === Bacon.noMore) {\n              unsubAll();\n            }\n            return reply;\n          }\n        });\n      });\n    };\n    var checkQueue = function () {\n      var event = queue.shift();\n      if (event) {\n        return spawn(event);\n      }\n    };\n    var checkEnd = function (unsub) {\n      unsub();\n      if (composite.empty()) {\n        return sink(endEvent());\n      }\n    };\n    composite.add(function (__, unsubRoot) {\n      return root.dispatcher.subscribe(function (event) {\n        if (event.isEnd()) {\n          return checkEnd(unsubRoot);\n        } else if (event.isError()) {\n          return sink(event);\n        } else if (firstOnly && composite.count() > 1) {\n          return Bacon.more;\n        } else {\n          if (composite.unsubscribed) {\n            return Bacon.noMore;\n          }\n          if (limit && composite.count() > limit) {\n            return queue.push(event);\n          } else {\n            return spawn(event);\n          }\n        }\n      });\n    });\n    return composite.unsubscribe;\n  });\n  result.internalDeps = function () {\n    if (childDeps.length) {\n      return rootDep.concat(childDeps);\n    } else {\n      return rootDep;\n    }\n  };\n  return result;\n};\n\nBacon.Observable.prototype.flatMapWithConcurrencyLimit = function (limit) {\n  for (var _len11 = arguments.length, args = Array(_len11 > 1 ? _len11 - 1 : 0), _key11 = 1; _key11 < _len11; _key11++) {\n    args[_key11 - 1] = arguments[_key11];\n  }\n\n  var desc = new Bacon.Desc(this, \"flatMapWithConcurrencyLimit\", [limit].concat(args));\n  return withDesc(desc, flatMap_(this, makeSpawner(args), false, limit));\n};\n\nBacon.Observable.prototype.flatMapConcat = function () {\n  var desc = new Bacon.Desc(this, \"flatMapConcat\", Array.prototype.slice.call(arguments, 0));\n  return withDesc(desc, this.flatMapWithConcurrencyLimit.apply(this, [1].concat(_slice.call(arguments))));\n};\n\nBacon.later = function (delay, value) {\n  return withDesc(new Bacon.Desc(Bacon, \"later\", [delay, value]), Bacon.fromBinder(function (sink) {\n    var sender = function () {\n      return sink([value, endEvent()]);\n    };\n    var id = Bacon.scheduler.setTimeout(sender, delay);\n    return function () {\n      return Bacon.scheduler.clearTimeout(id);\n    };\n  }));\n};\n\nBacon.Observable.prototype.bufferingThrottle = function (minimumInterval) {\n  var desc = new Bacon.Desc(this, \"bufferingThrottle\", [minimumInterval]);\n  return withDesc(desc, this.flatMapConcat(function (x) {\n    return Bacon.once(x).concat(Bacon.later(minimumInterval).filter(false));\n  }));\n};\n\nBacon.Property.prototype.bufferingThrottle = function () {\n  return Bacon.Observable.prototype.bufferingThrottle.apply(this, arguments).toProperty();\n};\n\nfunction Bus() {\n  if (!(this instanceof Bus)) {\n    return new Bus();\n  }\n\n  this.unsubAll = _.bind(this.unsubAll, this);\n  this.subscribeAll = _.bind(this.subscribeAll, this);\n  this.guardedSink = _.bind(this.guardedSink, this);\n\n  this.sink = undefined;\n  this.subscriptions = [];\n  this.ended = false;\n  EventStream.call(this, new Bacon.Desc(Bacon, \"Bus\", []), this.subscribeAll);\n}\n\ninherit(Bus, EventStream);\nextend(Bus.prototype, {\n  unsubAll: function () {\n    var iterable = this.subscriptions;\n    for (var i = 0, sub; i < iterable.length; i++) {\n      sub = iterable[i];\n      if (typeof sub.unsub === \"function\") {\n        sub.unsub();\n      }\n    }\n  },\n\n  subscribeAll: function (newSink) {\n    if (this.ended) {\n      newSink(endEvent());\n    } else {\n      this.sink = newSink;\n      var iterable = cloneArray(this.subscriptions);\n      for (var i = 0, subscription; i < iterable.length; i++) {\n        subscription = iterable[i];\n        this.subscribeInput(subscription);\n      }\n    }\n    return this.unsubAll;\n  },\n\n  guardedSink: function (input) {\n    var _this8 = this;\n\n    return function (event) {\n      if (event.isEnd()) {\n        _this8.unsubscribeInput(input);\n        return Bacon.noMore;\n      } else {\n        return _this8.sink(event);\n      }\n    };\n  },\n\n  subscribeInput: function (subscription) {\n    subscription.unsub = subscription.input.dispatcher.subscribe(this.guardedSink(subscription.input));\n    return subscription.unsub;\n  },\n\n  unsubscribeInput: function (input) {\n    var iterable = this.subscriptions;\n    for (var i = 0, sub; i < iterable.length; i++) {\n      sub = iterable[i];\n      if (sub.input === input) {\n        if (typeof sub.unsub === \"function\") {\n          sub.unsub();\n        }\n        this.subscriptions.splice(i, 1);\n        return;\n      }\n    }\n  },\n\n  plug: function (input) {\n    var _this9 = this;\n\n    assertObservable(input);\n    if (this.ended) {\n      return;\n    }\n    var sub = { input: input };\n    this.subscriptions.push(sub);\n    if (typeof this.sink !== \"undefined\") {\n      this.subscribeInput(sub);\n    }\n    return function () {\n      return _this9.unsubscribeInput(input);\n    };\n  },\n\n  end: function () {\n    this.ended = true;\n    this.unsubAll();\n    if (typeof this.sink === \"function\") {\n      return this.sink(endEvent());\n    }\n  },\n\n  push: function (value) {\n    if (!this.ended && typeof this.sink === \"function\") {\n      var rootPush = !this.pushing;\n      if (!rootPush) {\n        if (!this.pushQueue) this.pushQueue = [];\n        this.pushQueue.push(value);\n\n        return;\n      }\n      this.pushing = true;\n      try {\n        return this.sink(nextEvent(value));\n      } finally {\n        if (rootPush && this.pushQueue) {\n          var i = 0;\n          while (i < this.pushQueue.length) {\n            var value = this.pushQueue[i];\n            this.sink(nextEvent(value));\n            i++;\n          }\n          this.pushQueue = null;\n        }\n        this.pushing = false;\n      }\n    }\n  },\n\n  error: function (error) {\n    if (typeof this.sink === \"function\") {\n      return this.sink(new Error(error));\n    }\n  }\n});\n\nBacon.Bus = Bus;\n\nvar liftCallback = function (desc, wrapped) {\n  return withMethodCallSupport(function (f) {\n    var stream = partiallyApplied(wrapped, [function (values, callback) {\n      return f.apply(undefined, values.concat([callback]));\n    }]);\n\n    for (var _len12 = arguments.length, args = Array(_len12 > 1 ? _len12 - 1 : 0), _key12 = 1; _key12 < _len12; _key12++) {\n      args[_key12 - 1] = arguments[_key12];\n    }\n\n    return withDesc(new Bacon.Desc(Bacon, desc, [f].concat(args)), Bacon.combineAsArray(args).flatMap(stream));\n  });\n};\n\nBacon.fromCallback = liftCallback(\"fromCallback\", function (f) {\n  for (var _len13 = arguments.length, args = Array(_len13 > 1 ? _len13 - 1 : 0), _key13 = 1; _key13 < _len13; _key13++) {\n    args[_key13 - 1] = arguments[_key13];\n  }\n\n  return Bacon.fromBinder(function (handler) {\n    makeFunction(f, args)(handler);\n    return nop;\n  }, function (value) {\n    return [value, endEvent()];\n  });\n});\n\nBacon.fromNodeCallback = liftCallback(\"fromNodeCallback\", function (f) {\n  for (var _len14 = arguments.length, args = Array(_len14 > 1 ? _len14 - 1 : 0), _key14 = 1; _key14 < _len14; _key14++) {\n    args[_key14 - 1] = arguments[_key14];\n  }\n\n  return Bacon.fromBinder(function (handler) {\n    makeFunction(f, args)(handler);\n    return nop;\n  }, function (error, value) {\n    if (error) {\n      return [new Error(error), endEvent()];\n    }\n    return [value, endEvent()];\n  });\n});\n\nBacon.combineTemplate = function (template) {\n  function current(ctxStack) {\n    return ctxStack[ctxStack.length - 1];\n  }\n  function setValue(ctxStack, key, value) {\n    current(ctxStack)[key] = value;\n    return value;\n  }\n  function applyStreamValue(key, index) {\n    return function (ctxStack, values) {\n      setValue(ctxStack, key, values[index]);\n    };\n  }\n  function constantValue(key, value) {\n    return function (ctxStack) {\n      setValue(ctxStack, key, value);\n    };\n  }\n\n  function mkContext(template) {\n    return isArray(template) ? [] : {};\n  }\n\n  function pushContext(key, value) {\n    return function (ctxStack) {\n      var newContext = mkContext(value);\n      setValue(ctxStack, key, newContext);\n      ctxStack.push(newContext);\n    };\n  }\n\n  function containsObservables(value) {\n    if (isObservable(value)) {\n      return true;\n    } else if (value && (value.constructor == Object || value.constructor == Array)) {\n      for (var key in value) {\n        if (Object.prototype.hasOwnProperty.call(value, key)) {\n          var child = value[key];\n          if (containsObservables(child)) return true;\n        }\n      }\n    }\n  }\n\n  function compile(key, value) {\n    if (isObservable(value)) {\n      streams.push(value);\n      funcs.push(applyStreamValue(key, streams.length - 1));\n    } else if (containsObservables(value)) {\n      var popContext = function (ctxStack) {\n        ctxStack.pop();\n      };\n      funcs.push(pushContext(key, value));\n      compileTemplate(value);\n      funcs.push(popContext);\n    } else {\n      funcs.push(constantValue(key, value));\n    }\n  }\n\n  function combinator(values) {\n    var rootContext = mkContext(template);\n    var ctxStack = [rootContext];\n    for (var i = 0, f; i < funcs.length; i++) {\n      f = funcs[i];\n      f(ctxStack, values);\n    }\n    return rootContext;\n  }\n\n  function compileTemplate(template) {\n    _.each(template, compile);\n  }\n\n  var funcs = [];\n  var streams = [];\n\n  var resultProperty = containsObservables(template) ? (compileTemplate(template), Bacon.combineAsArray(streams).map(combinator)) : Bacon.constant(template);\n\n  return withDesc(new Bacon.Desc(Bacon, \"combineTemplate\", [template]), resultProperty);\n};\n\nBacon.Observable.prototype.mapEnd = function () {\n  var f = makeFunctionArgs(arguments);\n  return withDesc(new Bacon.Desc(this, \"mapEnd\", [f]), this.withHandler(function (event) {\n    if (event.isEnd()) {\n      this.push(nextEvent(f(event)));\n      this.push(endEvent());\n      return Bacon.noMore;\n    } else {\n      return this.push(event);\n    }\n  }));\n};\n\nBacon.Observable.prototype.skipErrors = function () {\n  return withDesc(new Bacon.Desc(this, \"skipErrors\", []), this.withHandler(function (event) {\n    if (event.isError()) {\n      return Bacon.more;\n    } else {\n      return this.push(event);\n    }\n  }));\n};\n\nBacon.EventStream.prototype.takeUntil = function (stopper) {\n  var endMarker = {};\n  return withDesc(new Bacon.Desc(this, \"takeUntil\", [stopper]), Bacon.groupSimultaneous(this.mapEnd(endMarker), stopper.skipErrors()).withHandler(function (event) {\n    if (!event.hasValue()) {\n      return this.push(event);\n    } else {\n      var _event$value = event.value();\n\n      var data = _event$value[0];\n      var stopper = _event$value[1];\n\n      if (stopper.length) {\n        return this.push(endEvent());\n      } else {\n        var reply = Bacon.more;\n        for (var i = 0, value; i < data.length; i++) {\n          value = data[i];\n          if (value === endMarker) {\n            reply = this.push(endEvent());\n          } else {\n            reply = this.push(nextEvent(value));\n          }\n        }\n        return reply;\n      }\n    }\n  }));\n};\n\nBacon.Property.prototype.takeUntil = function (stopper) {\n  var changes = this.changes().takeUntil(stopper);\n  return withDesc(new Bacon.Desc(this, \"takeUntil\", [stopper]), addPropertyInitValueToStream(this, changes));\n};\n\nBacon.Observable.prototype.flatMapLatest = function () {\n  var f = makeSpawner(arguments);\n  var stream = this.toEventStream();\n  return withDesc(new Bacon.Desc(this, \"flatMapLatest\", [f]), stream.flatMap(function (value) {\n    return makeObservable(f(value)).takeUntil(stream);\n  }));\n};\n\nBacon.Property.prototype.delayChanges = function (desc, f) {\n  return withDesc(desc, addPropertyInitValueToStream(this, f(this.changes())));\n};\n\nBacon.EventStream.prototype.delayChanges = function (desc, f) {\n  return withDesc(desc, f(this));\n};\n\nBacon.Observable.prototype.delay = function (delay) {\n  return this.delayChanges(new Bacon.Desc(this, \"delay\", [delay]), function (changes) {\n    return changes.flatMap(function (value) {\n      return Bacon.later(delay, value);\n    });\n  });\n};\n\nBacon.Observable.prototype.debounce = function (delay) {\n  return this.delayChanges(new Bacon.Desc(this, \"debounce\", [delay]), function (changes) {\n    return changes.flatMapLatest(function (value) {\n      return Bacon.later(delay, value);\n    });\n  });\n};\n\nBacon.Observable.prototype.debounceImmediate = function (delay) {\n  return this.delayChanges(new Bacon.Desc(this, \"debounceImmediate\", [delay]), function (changes) {\n    return changes.flatMapFirst(function (value) {\n      return Bacon.once(value).concat(Bacon.later(delay).filter(false));\n    });\n  });\n};\n\nBacon.Observable.prototype.decode = function (cases) {\n  return withDesc(new Bacon.Desc(this, \"decode\", [cases]), this.combine(Bacon.combineTemplate(cases), function (key, values) {\n    return values[key];\n  }));\n};\n\nBacon.Observable.prototype.scan = function (seed, f) {\n  var _this10 = this;\n\n  var resultProperty;\n  f = toCombinator(f);\n  var acc = toOption(seed);\n  var initHandled = false;\n  var subscribe = function (sink) {\n    var initSent = false;\n    var unsub = nop;\n    var reply = Bacon.more;\n    var sendInit = function () {\n      if (!initSent) {\n        return acc.forEach(function (value) {\n          initSent = initHandled = true;\n          reply = sink(new Initial(function () {\n            return value;\n          }));\n          if (reply === Bacon.noMore) {\n            unsub();\n            unsub = nop;\n            return unsub;\n          }\n        });\n      }\n    };\n    unsub = _this10.dispatcher.subscribe(function (event) {\n      if (event.hasValue()) {\n        if (initHandled && event.isInitial()) {\n          return Bacon.more;\n        } else {\n            if (!event.isInitial()) {\n              sendInit();\n            }\n            initSent = initHandled = true;\n            var prev = acc.getOrElse(undefined);\n            var next = f(prev, event.value());\n\n            acc = new Some(next);\n            return sink(event.apply(function () {\n              return next;\n            }));\n          }\n      } else {\n        if (event.isEnd()) {\n          reply = sendInit();\n        }\n        if (reply !== Bacon.noMore) {\n          return sink(event);\n        }\n      }\n    });\n    UpdateBarrier.whenDoneWith(resultProperty, sendInit);\n    return unsub;\n  };\n  resultProperty = new Property(new Bacon.Desc(this, \"scan\", [seed, f]), subscribe);\n  return resultProperty;\n};\n\nBacon.Observable.prototype.diff = function (start, f) {\n  f = toCombinator(f);\n  return withDesc(new Bacon.Desc(this, \"diff\", [start, f]), this.scan([start], function (prevTuple, next) {\n    return [next, f(prevTuple[0], next)];\n  }).filter(function (tuple) {\n    return tuple.length === 2;\n  }).map(function (tuple) {\n    return tuple[1];\n  }));\n};\n\nBacon.Observable.prototype.doAction = function () {\n  var f = makeFunctionArgs(arguments);\n  return withDesc(new Bacon.Desc(this, \"doAction\", [f]), this.withHandler(function (event) {\n    if (event.hasValue()) {\n      f(event.value());\n    }\n    return this.push(event);\n  }));\n};\n\nBacon.Observable.prototype.doEnd = function () {\n  var f = makeFunctionArgs(arguments);\n  return withDesc(new Bacon.Desc(this, \"doEnd\", [f]), this.withHandler(function (event) {\n    if (event.isEnd()) {\n      f();\n    }\n    return this.push(event);\n  }));\n};\n\nBacon.Observable.prototype.doError = function () {\n  var f = makeFunctionArgs(arguments);\n  return withDesc(new Bacon.Desc(this, \"doError\", [f]), this.withHandler(function (event) {\n    if (event.isError()) {\n      f(event.error);\n    }\n    return this.push(event);\n  }));\n};\n\nBacon.Observable.prototype.doLog = function () {\n  for (var _len15 = arguments.length, args = Array(_len15), _key15 = 0; _key15 < _len15; _key15++) {\n    args[_key15] = arguments[_key15];\n  }\n\n  return withDesc(new Bacon.Desc(this, \"doLog\", args), this.withHandler(function (event) {\n    if (typeof console !== \"undefined\" && console !== null && typeof console.log === \"function\") {\n      console.log.apply(console, args.concat([event.log()]));\n    }\n    return this.push(event);\n  }));\n};\n\nBacon.Observable.prototype.endOnError = function (f) {\n  if (!(typeof f !== \"undefined\" && f !== null)) {\n    f = true;\n  }\n\n  for (var _len16 = arguments.length, args = Array(_len16 > 1 ? _len16 - 1 : 0), _key16 = 1; _key16 < _len16; _key16++) {\n    args[_key16 - 1] = arguments[_key16];\n  }\n\n  return convertArgsToFunction(this, f, args, function (f) {\n    return withDesc(new Bacon.Desc(this, \"endOnError\", []), this.withHandler(function (event) {\n      if (event.isError() && f(event.error)) {\n        this.push(event);\n        return this.push(endEvent());\n      } else {\n        return this.push(event);\n      }\n    }));\n  });\n};\n\nObservable.prototype.errors = function () {\n  return withDesc(new Bacon.Desc(this, \"errors\", []), this.filter(function () {\n    return false;\n  }));\n};\n\nBacon.Observable.prototype.take = function (count) {\n  if (count <= 0) {\n    return Bacon.never();\n  }\n  return withDesc(new Bacon.Desc(this, \"take\", [count]), this.withHandler(function (event) {\n    if (!event.hasValue()) {\n      return this.push(event);\n    } else {\n      count--;\n      if (count > 0) {\n        return this.push(event);\n      } else {\n        if (count === 0) {\n          this.push(event);\n        }\n        this.push(endEvent());\n        return Bacon.noMore;\n      }\n    }\n  }));\n};\n\nBacon.Observable.prototype.first = function () {\n  return withDesc(new Bacon.Desc(this, \"first\", []), this.take(1));\n};\n\nBacon.Observable.prototype.mapError = function () {\n  var f = makeFunctionArgs(arguments);\n  return withDesc(new Bacon.Desc(this, \"mapError\", [f]), this.withHandler(function (event) {\n    if (event.isError()) {\n      return this.push(nextEvent(f(event.error)));\n    } else {\n      return this.push(event);\n    }\n  }));\n};\n\nBacon.Observable.prototype.flatMapError = function (fn) {\n  var desc = new Bacon.Desc(this, \"flatMapError\", [fn]);\n  return withDesc(desc, this.mapError(function (err) {\n    return new Error(err);\n  }).flatMap(function (x) {\n    if (x instanceof Error) {\n      return fn(x.error);\n    } else {\n      return Bacon.once(x);\n    }\n  }));\n};\n\nBacon.EventStream.prototype.flatScan = function (seed, f) {\n  var current = seed;\n  return this.flatMapConcat(function (next) {\n    return makeObservable(f(current, next)).doAction(function (updated) {\n      return current = updated;\n    });\n  }).toProperty(seed);\n};\n\nBacon.EventStream.prototype.sampledBy = function (sampler, combinator) {\n  return withDesc(new Bacon.Desc(this, \"sampledBy\", [sampler, combinator]), this.toProperty().sampledBy(sampler, combinator));\n};\n\nBacon.Property.prototype.sampledBy = function (sampler, combinator) {\n  var lazy = false;\n  if (typeof combinator !== \"undefined\" && combinator !== null) {\n    combinator = toCombinator(combinator);\n  } else {\n    lazy = true;\n    combinator = function (f) {\n      return f.value();\n    };\n  }\n  var thisSource = new Source(this, false, lazy);\n  var samplerSource = new Source(sampler, true, lazy);\n  var stream = Bacon.when([thisSource, samplerSource], combinator);\n  var result = sampler._isProperty ? stream.toProperty() : stream;\n  return withDesc(new Bacon.Desc(this, \"sampledBy\", [sampler, combinator]), result);\n};\n\nBacon.Property.prototype.sample = function (interval) {\n  return withDesc(new Bacon.Desc(this, \"sample\", [interval]), this.sampledBy(Bacon.interval(interval, {})));\n};\n\nBacon.Observable.prototype.map = function (p) {\n  if (p && p._isProperty) {\n    return p.sampledBy(this, former);\n  } else {\n    for (var _len17 = arguments.length, args = Array(_len17 > 1 ? _len17 - 1 : 0), _key17 = 1; _key17 < _len17; _key17++) {\n      args[_key17 - 1] = arguments[_key17];\n    }\n\n    return convertArgsToFunction(this, p, args, function (f) {\n      return withDesc(new Bacon.Desc(this, \"map\", [f]), this.withHandler(function (event) {\n        return this.push(event.fmap(f));\n      }));\n    });\n  }\n};\n\nBacon.Observable.prototype.fold = function (seed, f) {\n  return withDesc(new Bacon.Desc(this, \"fold\", [seed, f]), this.scan(seed, f).sampledBy(this.filter(false).mapEnd().toProperty()));\n};\n\nObservable.prototype.reduce = Observable.prototype.fold;\n\nvar eventMethods = [[\"addEventListener\", \"removeEventListener\"], [\"addListener\", \"removeListener\"], [\"on\", \"off\"], [\"bind\", \"unbind\"]];\n\nvar findHandlerMethods = function (target) {\n  var pair;\n  for (var i = 0; i < eventMethods.length; i++) {\n    pair = eventMethods[i];\n    var methodPair = [target[pair[0]], target[pair[1]]];\n    if (methodPair[0] && methodPair[1]) {\n      return methodPair;\n    }\n  }\n  for (var j = 0; j < eventMethods.length; j++) {\n    pair = eventMethods[j];\n    var addListener = target[pair[0]];\n    if (addListener) {\n      return [addListener, function () {}];\n    }\n  }\n  throw new Error(\"No suitable event methods in \" + target);\n};\n\nBacon.fromEventTarget = function (target, eventName, eventTransformer) {\n  var _findHandlerMethods = findHandlerMethods(target);\n\n  var sub = _findHandlerMethods[0];\n  var unsub = _findHandlerMethods[1];\n\n  var desc = new Bacon.Desc(Bacon, \"fromEvent\", [target, eventName]);\n  return withDesc(desc, Bacon.fromBinder(function (handler) {\n    sub.call(target, eventName, handler);\n    return function () {\n      return unsub.call(target, eventName, handler);\n    };\n  }, eventTransformer));\n};\n\nBacon.fromEvent = Bacon.fromEventTarget;\n\nBacon.fromPoll = function (delay, poll) {\n  var desc = new Bacon.Desc(Bacon, \"fromPoll\", [delay, poll]);\n  return withDesc(desc, Bacon.fromBinder(function (handler) {\n    var id = Bacon.scheduler.setInterval(handler, delay);\n    return function () {\n      return Bacon.scheduler.clearInterval(id);\n    };\n  }, poll));\n};\n\nfunction valueAndEnd(value) {\n  return [value, endEvent()];\n}\n\nBacon.fromPromise = function (promise, abort) {\n  var eventTransformer = arguments.length <= 2 || arguments[2] === undefined ? valueAndEnd : arguments[2];\n\n  return withDesc(new Bacon.Desc(Bacon, \"fromPromise\", [promise]), Bacon.fromBinder(function (handler) {\n    var bound = promise.then(handler, function (e) {\n      return handler(new Error(e));\n    });\n    if (bound && typeof bound.done === \"function\") {\n      bound.done();\n    }\n\n    if (abort) {\n      return function () {\n        if (typeof promise.abort === \"function\") {\n          return promise.abort();\n        }\n      };\n    } else {\n      return function () {};\n    }\n  }, eventTransformer));\n};\n\nBacon.Observable.prototype.groupBy = function (keyF) {\n  var limitF = arguments.length <= 1 || arguments[1] === undefined ? Bacon._.id : arguments[1];\n\n  var streams = {};\n  var src = this;\n  return src.filter(function (x) {\n    return !streams[keyF(x)];\n  }).map(function (x) {\n    var key = keyF(x);\n    var similar = src.filter(function (x) {\n      return keyF(x) === key;\n    });\n    var data = Bacon.once(x).concat(similar);\n    var limited = limitF(data, x).withHandler(function (event) {\n      this.push(event);\n      if (event.isEnd()) {\n        return delete streams[key];\n      }\n    });\n    streams[key] = limited;\n    return limited;\n  });\n};\n\nBacon.fromArray = function (values) {\n  assertArray(values);\n  if (!values.length) {\n    return withDesc(new Bacon.Desc(Bacon, \"fromArray\", values), Bacon.never());\n  } else {\n    var i = 0;\n    var stream = new EventStream(new Bacon.Desc(Bacon, \"fromArray\", [values]), function (sink) {\n      var unsubd = false;\n      var reply = Bacon.more;\n      var pushing = false;\n      var pushNeeded = false;\n      function push() {\n        pushNeeded = true;\n        if (pushing) {\n          return;\n        }\n        pushing = true;\n        while (pushNeeded) {\n          pushNeeded = false;\n          if (reply !== Bacon.noMore && !unsubd) {\n            var value = values[i++];\n            reply = sink(toEvent(value));\n            if (reply !== Bacon.noMore) {\n              if (i === values.length) {\n                sink(endEvent());\n              } else {\n                UpdateBarrier.afterTransaction(stream, push);\n              }\n            }\n          }\n        }\n        pushing = false;\n        return pushing;\n      };\n\n      push();\n      return function () {\n        unsubd = true;\n        return unsubd;\n      };\n    });\n    return stream;\n  }\n};\n\nBacon.EventStream.prototype.holdWhen = function (valve) {\n  var onHold = false;\n  var bufferedValues = [];\n  var src = this;\n  var srcIsEnded = false;\n  return new EventStream(new Bacon.Desc(this, \"holdWhen\", [valve]), function (sink) {\n    var composite = new CompositeUnsubscribe();\n    var subscribed = false;\n    var endIfBothEnded = function (unsub) {\n      if (typeof unsub === \"function\") {\n        unsub();\n      }\n      if (composite.empty() && subscribed) {\n        return sink(endEvent());\n      }\n    };\n    composite.add(function (unsubAll, unsubMe) {\n      return valve.subscribeInternal(function (event) {\n        if (event.hasValue()) {\n          onHold = event.value();\n          if (!onHold) {\n            var toSend = bufferedValues;\n            bufferedValues = [];\n            return (function () {\n              var result = [];\n              for (var i = 0, value; i < toSend.length; i++) {\n                value = toSend[i];\n                result.push(sink(nextEvent(value)));\n              }\n              if (srcIsEnded) {\n                result.push(sink(endEvent()));\n                unsubMe();\n              }\n              return result;\n            })();\n          }\n        } else if (event.isEnd()) {\n          return endIfBothEnded(unsubMe);\n        } else {\n          return sink(event);\n        }\n      });\n    });\n    composite.add(function (unsubAll, unsubMe) {\n      return src.subscribeInternal(function (event) {\n        if (onHold && event.hasValue()) {\n          return bufferedValues.push(event.value());\n        } else if (event.isEnd() && bufferedValues.length) {\n          srcIsEnded = true;\n          return endIfBothEnded(unsubMe);\n        } else {\n          return sink(event);\n        }\n      });\n    });\n    subscribed = true;\n    endIfBothEnded();\n    return composite.unsubscribe;\n  });\n};\n\nBacon.interval = function (delay) {\n  var value = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n  return withDesc(new Bacon.Desc(Bacon, \"interval\", [delay, value]), Bacon.fromPoll(delay, function () {\n    return nextEvent(value);\n  }));\n};\n\nBacon.$ = {};\nBacon.$.asEventStream = function (eventName, selector, eventTransformer) {\n  var _this11 = this;\n\n  if (_.isFunction(selector)) {\n    eventTransformer = selector;\n    selector = undefined;\n  }\n\n  return withDesc(new Bacon.Desc(this.selector || this, \"asEventStream\", [eventName]), Bacon.fromBinder(function (handler) {\n    _this11.on(eventName, selector, handler);\n    return function () {\n      return _this11.off(eventName, selector, handler);\n    };\n  }, eventTransformer));\n};\n\nif (typeof jQuery !== \"undefined\" && jQuery) {\n  jQuery.fn.asEventStream = Bacon.$.asEventStream;\n}\n\nif (typeof Zepto !== \"undefined\" && Zepto) {\n  Zepto.fn.asEventStream = Bacon.$.asEventStream;\n}\n\nBacon.Observable.prototype.last = function () {\n  var lastEvent;\n\n  return withDesc(new Bacon.Desc(this, \"last\", []), this.withHandler(function (event) {\n    if (event.isEnd()) {\n      if (lastEvent) {\n        this.push(lastEvent);\n      }\n      this.push(endEvent());\n      return Bacon.noMore;\n    } else {\n      lastEvent = event;\n    }\n  }));\n};\n\nBacon.Observable.prototype.log = function () {\n  for (var _len18 = arguments.length, args = Array(_len18), _key18 = 0; _key18 < _len18; _key18++) {\n    args[_key18] = arguments[_key18];\n  }\n\n  this.subscribe(function (event) {\n    if (typeof console !== \"undefined\" && typeof console.log === \"function\") {\n      console.log.apply(console, args.concat([event.log()]));\n    }\n  });\n  return this;\n};\n\nBacon.EventStream.prototype.merge = function (right) {\n  assertEventStream(right);\n  var left = this;\n  return withDesc(new Bacon.Desc(left, \"merge\", [right]), Bacon.mergeAll(this, right));\n};\n\nBacon.mergeAll = function () {\n  var streams = argumentsToObservables(arguments);\n  if (streams.length) {\n    return new EventStream(new Bacon.Desc(Bacon, \"mergeAll\", streams), function (sink) {\n      var ends = 0;\n      var smartSink = function (obs) {\n        return function (unsubBoth) {\n          return obs.dispatcher.subscribe(function (event) {\n            if (event.isEnd()) {\n              ends++;\n              if (ends === streams.length) {\n                return sink(endEvent());\n              } else {\n                return Bacon.more;\n              }\n            } else {\n              var reply = sink(event);\n              if (reply === Bacon.noMore) {\n                unsubBoth();\n              }\n              return reply;\n            }\n          });\n        };\n      };\n      var sinks = _.map(smartSink, streams);\n      return new Bacon.CompositeUnsubscribe(sinks).unsubscribe;\n    });\n  } else {\n    return Bacon.never();\n  }\n};\n\nBacon.repeatedly = function (delay, values) {\n  var index = 0;\n  return withDesc(new Bacon.Desc(Bacon, \"repeatedly\", [delay, values]), Bacon.fromPoll(delay, function () {\n    return values[index++ % values.length];\n  }));\n};\n\nBacon.repeat = function (generator) {\n  var index = 0;\n  return Bacon.fromBinder(function (sink) {\n    var flag = false;\n    var reply = Bacon.more;\n    var unsub = function () {};\n    function handleEvent(event) {\n      if (event.isEnd()) {\n        if (!flag) {\n          return flag = true;\n        } else {\n          return subscribeNext();\n        }\n      } else {\n        return reply = sink(event);\n      }\n    };\n    function subscribeNext() {\n      var next;\n      flag = true;\n      while (flag && reply !== Bacon.noMore) {\n        next = generator(index++);\n        flag = false;\n        if (next) {\n          unsub = next.subscribeInternal(handleEvent);\n        } else {\n          sink(endEvent());\n        }\n      }\n      return flag = true;\n    };\n    subscribeNext();\n    return function () {\n      return unsub();\n    };\n  });\n};\n\nBacon.retry = function (options) {\n  if (!_.isFunction(options.source)) {\n    throw new Exception(\"'source' option has to be a function\");\n  }\n  var source = options.source;\n  var retries = options.retries || 0;\n  var retriesDone = 0;\n  var delay = options.delay || function () {\n    return 0;\n  };\n  var isRetryable = options.isRetryable || function () {\n    return true;\n  };\n  var finished = false;\n  var error = null;\n\n  return withDesc(new Bacon.Desc(Bacon, \"retry\", [options]), Bacon.repeat(function (count) {\n    function valueStream() {\n      return source(count).endOnError().withHandler(function (event) {\n        if (event.isError()) {\n          error = event;\n          if (!(isRetryable(error.error) && (retries === 0 || retriesDone < retries))) {\n            finished = true;\n            return this.push(event);\n          }\n        } else {\n          if (event.hasValue()) {\n            error = null;\n            finished = true;\n          }\n          return this.push(event);\n        }\n      });\n    }\n\n    if (finished) {\n      return null;\n    } else if (error) {\n      var context = {\n        error: error.error,\n        retriesDone: retriesDone\n      };\n      var pause = Bacon.later(delay(context)).filter(false);\n      retriesDone++;\n      return pause.concat(Bacon.once().flatMap(valueStream));\n    } else {\n      return valueStream();\n    }\n  }));\n};\n\nBacon.sequentially = function (delay, values) {\n  var index = 0;\n  return withDesc(new Bacon.Desc(Bacon, \"sequentially\", [delay, values]), Bacon.fromPoll(delay, function () {\n    var value = values[index++];\n    if (index < values.length) {\n      return value;\n    } else if (index === values.length) {\n      return [value, endEvent()];\n    } else {\n      return endEvent();\n    }\n  }));\n};\n\nBacon.Observable.prototype.skip = function (count) {\n  return withDesc(new Bacon.Desc(this, \"skip\", [count]), this.withHandler(function (event) {\n    if (!event.hasValue()) {\n      return this.push(event);\n    } else if (count > 0) {\n      count--;\n      return Bacon.more;\n    } else {\n      return this.push(event);\n    }\n  }));\n};\n\nBacon.EventStream.prototype.skipUntil = function (starter) {\n  var started = starter.take(1).map(true).toProperty(false);\n  return withDesc(new Bacon.Desc(this, \"skipUntil\", [starter]), this.filter(started));\n};\n\nBacon.EventStream.prototype.skipWhile = function (f) {\n  assertObservableIsProperty(f);\n  var ok = false;\n\n  for (var _len19 = arguments.length, args = Array(_len19 > 1 ? _len19 - 1 : 0), _key19 = 1; _key19 < _len19; _key19++) {\n    args[_key19 - 1] = arguments[_key19];\n  }\n\n  return convertArgsToFunction(this, f, args, function (f) {\n    return withDesc(new Bacon.Desc(this, \"skipWhile\", [f]), this.withHandler(function (event) {\n      if (ok || !event.hasValue() || !f(event.value())) {\n        if (event.hasValue()) {\n          ok = true;\n        }\n        return this.push(event);\n      } else {\n        return Bacon.more;\n      }\n    }));\n  });\n};\n\nBacon.Observable.prototype.slidingWindow = function (n) {\n  var minValues = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n\n  return withDesc(new Bacon.Desc(this, \"slidingWindow\", [n, minValues]), this.scan([], function (window, value) {\n    return window.concat([value]).slice(-n);\n  }).filter(function (values) {\n    return values.length >= minValues;\n  }));\n};\n\nvar spies = [];\nvar registerObs = function (obs) {\n  if (spies.length) {\n    if (!registerObs.running) {\n      try {\n        registerObs.running = true;\n        spies.forEach(function (spy) {\n          spy(obs);\n        });\n      } finally {\n        delete registerObs.running;\n      }\n    }\n  }\n};\n\nBacon.spy = function (spy) {\n  return spies.push(spy);\n};\n\nBacon.Property.prototype.startWith = function (seed) {\n  return withDesc(new Bacon.Desc(this, \"startWith\", [seed]), this.scan(seed, function (prev, next) {\n    return next;\n  }));\n};\n\nBacon.EventStream.prototype.startWith = function (seed) {\n  return withDesc(new Bacon.Desc(this, \"startWith\", [seed]), Bacon.once(seed).concat(this));\n};\n\nBacon.Observable.prototype.takeWhile = function (f) {\n  assertObservableIsProperty(f);\n\n  for (var _len20 = arguments.length, args = Array(_len20 > 1 ? _len20 - 1 : 0), _key20 = 1; _key20 < _len20; _key20++) {\n    args[_key20 - 1] = arguments[_key20];\n  }\n\n  return convertArgsToFunction(this, f, args, function (f) {\n    return withDesc(new Bacon.Desc(this, \"takeWhile\", [f]), this.withHandler(function (event) {\n      if (event.filter(f)) {\n        return this.push(event);\n      } else {\n        this.push(endEvent());\n        return Bacon.noMore;\n      }\n    }));\n  });\n};\n\nBacon.Observable.prototype.throttle = function (delay) {\n  return this.delayChanges(new Bacon.Desc(this, \"throttle\", [delay]), function (changes) {\n    return changes.bufferWithTime(delay).map(function (values) {\n      return values[values.length - 1];\n    });\n  });\n};\n\nObservable.prototype.firstToPromise = function (PromiseCtr) {\n  var _this12 = this;\n\n  if (typeof PromiseCtr !== \"function\") {\n    if (typeof Promise === \"function\") {\n      PromiseCtr = Promise;\n    } else {\n      throw new Exception(\"There isn't default Promise, use shim or parameter\");\n    }\n  }\n\n  return new PromiseCtr(function (resolve, reject) {\n    return _this12.subscribe(function (event) {\n      if (event.hasValue()) {\n        resolve(event.value());\n      }\n      if (event.isError()) {\n        reject(event.error);\n      }\n\n      return Bacon.noMore;\n    });\n  });\n};\n\nObservable.prototype.toPromise = function (PromiseCtr) {\n  return this.last().firstToPromise(PromiseCtr);\n};\n\nBacon[\"try\"] = function (f) {\n  return function (value) {\n    try {\n      return Bacon.once(f(value));\n    } catch (e) {\n      return new Bacon.Error(e);\n    }\n  };\n};\n\nBacon.update = function (initial) {\n  function lateBindFirst(f) {\n    return function () {\n      for (var _len22 = arguments.length, args = Array(_len22), _key22 = 0; _key22 < _len22; _key22++) {\n        args[_key22] = arguments[_key22];\n      }\n\n      return function (i) {\n        return f.apply(undefined, [i].concat(args));\n      };\n    };\n  }\n\n  for (var _len21 = arguments.length, patterns = Array(_len21 > 1 ? _len21 - 1 : 0), _key21 = 1; _key21 < _len21; _key21++) {\n    patterns[_key21 - 1] = arguments[_key21];\n  }\n\n  var i = patterns.length - 1;\n  while (i > 0) {\n    if (!(patterns[i] instanceof Function)) {\n      patterns[i] = _.always(patterns[i]);\n    }\n    patterns[i] = lateBindFirst(patterns[i]);\n    i = i - 2;\n  }\n  return withDesc(new Bacon.Desc(Bacon, \"update\", [initial].concat(patterns)), Bacon.when.apply(Bacon, patterns).scan(initial, function (x, f) {\n    return f(x);\n  }));\n};\n\nBacon.zipAsArray = function () {\n  for (var _len23 = arguments.length, args = Array(_len23), _key23 = 0; _key23 < _len23; _key23++) {\n    args[_key23] = arguments[_key23];\n  }\n\n  var streams = argumentsToObservables(args);\n  return withDesc(new Bacon.Desc(Bacon, \"zipAsArray\", streams), Bacon.zipWith(streams, function () {\n    for (var _len24 = arguments.length, xs = Array(_len24), _key24 = 0; _key24 < _len24; _key24++) {\n      xs[_key24] = arguments[_key24];\n    }\n\n    return xs;\n  }));\n};\n\nBacon.zipWith = function () {\n  for (var _len25 = arguments.length, args = Array(_len25), _key25 = 0; _key25 < _len25; _key25++) {\n    args[_key25] = arguments[_key25];\n  }\n\n  var observablesAndFunction = argumentsToObservablesAndFunction(args);\n  var streams = observablesAndFunction[0];\n  var f = observablesAndFunction[1];\n\n  streams = _.map(function (s) {\n    return s.toEventStream();\n  }, streams);\n  return withDesc(new Bacon.Desc(Bacon, \"zipWith\", [f].concat(streams)), Bacon.when(streams, f));\n};\n\nBacon.Observable.prototype.zip = function (other, f) {\n  return withDesc(new Bacon.Desc(this, \"zip\", [other]), Bacon.zipWith([this, other], f || Array));\n};\n\nfunction ESObservable(observable) {\n  this.observable = observable;\n}\n\nESObservable.prototype.subscribe = function (observerOrOnNext, onError, onComplete) {\n  var observer = typeof observerOrOnNext === 'function' ? { next: observerOrOnNext, error: onError, complete: onComplete } : observerOrOnNext;\n  var subscription = {\n    closed: false,\n    unsubscribe: function () {\n      subscription.closed = true;\n      cancel();\n    }\n  };\n\n  var cancel = this.observable.subscribe(function (event) {\n    if (event.isError()) {\n      if (observer.error) observer.error(event.error);\n      subscription.unsubscribe();\n    } else if (event.isEnd()) {\n      subscription.closed = true;\n      if (observer.complete) observer.complete();\n    } else if (observer.next) {\n      observer.next(event.value());\n    }\n  });\n  return subscription;\n};\n\nESObservable.prototype[symbol('observable')] = function () {\n  return this;\n};\n\nBacon.Observable.prototype.toESObservable = function () {\n  return new ESObservable(this);\n};\n\nBacon.Observable.prototype[symbol('observable')] = Bacon.Observable.prototype.toESObservable;\n\nBacon.fromESObservable = function (_observable) {\n  var observable;\n  if (_observable[symbol(\"observable\")]) {\n    observable = _observable[symbol(\"observable\")]();\n  } else {\n    observable = _observable;\n  }\n\n  var desc = new Bacon.Desc(Bacon, \"fromESObservable\", [observable]);\n  return new Bacon.EventStream(desc, function (sink) {\n    var cancel = observable.subscribe({\n      error: function () {\n        sink(new Bacon.Error());\n        sink(new Bacon.End());\n      },\n      next: function (value) {\n        sink(new Bacon.Next(value, true));\n      },\n      complete: function () {\n        sink(new Bacon.End());\n      }\n    });\n\n    if (cancel.unsubscribe) {\n      return function () {\n        cancel.unsubscribe();\n      };\n    } else {\n      return cancel;\n    }\n  });\n};\n\nif (typeof define !== \"undefined\" && define !== null && define.amd != null) {\n  define([], function () {\n    return Bacon;\n  });\n  if (typeof this !== \"undefined\" && this !== null) {\n    this.Bacon = Bacon;\n  }\n} else if (typeof module !== \"undefined\" && module !== null && module.exports != null) {\n  module.exports = Bacon;\n  Bacon.Bacon = Bacon;\n} else {\n    this.Bacon = Bacon;\n  }\n}).call(this);\n","export default readBlob\n\n// Reads the blob as a specified type. The blob will not actually be read\n// unless the ``as()`` method is called.\n//\n// .. js:function:: as(type)\n//\n//    Starts reading the blob as ``type``. The ``type`` is a String such as\n//    \"arraybuffer\" or \"text\".\nexport function readBlob(blob) {\n  return {\n    as(type) {\n      return new Promise(function (resolve, reject) {\n        let reader = new FileReader()\n        reader.onload = function () {\n          resolve(reader.result)\n        }\n        reader.onerror = function () {\n          reject(new Error('Unable to read from Blob'))\n        }\n        switch (type) {\n          case 'arraybuffer':\n            reader.readAsArrayBuffer(blob)\n            break\n          case 'text':\n            reader.readAsText(blob)\n            break\n        }\n      })\n    },\n  }\n}\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.assign = exports.values = exports.map = exports.uniq = void 0;\n// A subset of lodash that we actually use.\nvar lodash_uniq_1 = __importDefault(require(\"lodash.uniq\"));\nexports.uniq = lodash_uniq_1.default;\nvar lodash_map_1 = __importDefault(require(\"lodash.map\"));\nexports.map = lodash_map_1.default;\nvar lodash_values_1 = __importDefault(require(\"lodash.values\"));\nexports.values = lodash_values_1.default;\nvar lodash_assign_1 = __importDefault(require(\"lodash.assign\"));\nexports.assign = lodash_assign_1.default;\n//# sourceMappingURL=lodash.js.map"],"sourceRoot":""}