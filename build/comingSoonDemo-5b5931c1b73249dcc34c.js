(this.webpackJsonp=this.webpackJsonp||[]).push([[16],{100:function(t,e,n){"use strict";e.a=function(t){return{as:e=>new Promise(function(n,r){let o=new FileReader;switch(o.onload=function(){n(o.result)},o.onerror=function(){r(new Error("Unable to read from Blob"))},e){case"arraybuffer":o.readAsArrayBuffer(t);break;case"text":o.readAsText(t)}})}}},104:function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}var o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(249));e.Reader=i;var s=o(n(251));e.Compiler=s,r(n(40)),r(n(150)),r(n(151)),r(n(69)),r(n(152)),r(n(253)),r(n(256)),r(n(257)),r(n(258)),r(n(259)),r(n(260))},140:function(t,e,n){"use strict";var r=n(166);e.a=r.a},149:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.match=function(t){var e=!1;return{when:function(n,r){if(e)return this;var o=t.match(n);return o&&(e=!0,r(o)),this},else:function(t){if(e)return this;t()}}}},150:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this._data={},this._dataAll={}}return t.prototype.each=function(t){for(var e in this._data)t(e,this._data[e])},t.prototype.get=function(t){return this._data[t.toLowerCase()]},t.prototype.getAll=function(t){return this._dataAll[t.toLowerCase()]},t.prototype.set=function(t,e){var n=t.toLowerCase();this._data[n]=e,(this._dataAll[n]||(this._dataAll[n]=[])).push(e)},t}();e.BMSHeaders=r},151:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this._objects=[]}return t.prototype.add=function(t){if("01"!==t.channel)for(var e=0;e<this._objects.length;e++){var n=this._objects[e];if(n.channel===t.channel&&n.measure===t.measure&&n.fraction===t.fraction)return void(this._objects[e]=t)}this._objects.push(t)},t.prototype.all=function(){return this._objects.slice()},t.prototype.allSorted=function(){var t=this.all();return t.sort(function(t,e){return t.measure+t.fraction-(e.measure+e.fraction)}),t},t}();e.BMSObjects=r},152:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this._values={}}return t.prototype.set=function(t,e){this._values[t]=e},t.prototype.get=function(t){return this._values[t]||1},t.prototype.getBeats=function(t){return 4*this.get(t)},t.prototype.measureToBeat=function(t,e){for(var n=0,r=0;r<t;r++)n+=this.getBeats(r);return n+this.getBeats(t)*e},t}();e.TimeSignatures=r},166:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(167);class o{constructor(){this.current=void 0,this.total=void 0,this._observable=new r.a}report(t,e,n){this.current=t,this.total=e,this.extra=n,this._observable.notify()}watch(t){return t(this),this._observable.watch(()=>t(this))}get progress(){return this.total&&void 0!==this.current&&null!==this.current?this.current/this.total:null}toString(){return void 0!==this.formatter?this.formatter(this):null!==this.progress?this.current+" / "+this.total:""}}},167:function(t,e,n){"use strict";var r=n(168);e.a=class{constructor(t){this._callbacks=new r.a,this._value=t}get value(){return this._value}set value(t){this._value=t,this.notify(t)}notify(t){this._callbacks.call(t)}watch(t){return void 0!==this._value&&t(this._value),this._callbacks.add(t)}}},168:function(t,e,n){"use strict";e.a=class{constructor(t){if(this._callbacks={},this._nextId=1,"function"==typeof t)this.add(t);else if("object"==typeof t&&t&&t.length)for(var e=0;e<t.length;e++)this.add(t[e])}call(...t){var e=this._callbacks;for(var n in e)e[n](...t)}add(t){var e=this._nextId++;return this._callbacks[e]=t,()=>delete this._callbacks[e]}}},169:function(t,e,n){"use strict";var r=n(248),o=n.n(r);e.a=o()({latencyHint:"interaction"})},1734:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"main",function(){return d});n(1735);var r=n(67),o=n.n(r),i=n(104),s=n(504),a=n(207),u=n(114),c=n.n(u),l=n(169),f=n(1737),h=n.n(f);function d(e){o()(e).text("Technical Demo!").on("click",function n(){!function(){var e=o()(h()()).appendTo("body");e.find(".js-play").hide(),e.on("dragover",()=>!1).on("drop",n=>{n.preventDefault();let r=new s.a(n.originalEvent);return function(e,n){let r=new a.b(l.a),s=n.find(".js-log"),u=n.find(".js-play").hide(),f=n.find(".js-sampler");function h(t){s.text(t)}function d(t){return"string"!=typeof t?Promise.reject(new Error("Empty name")):e.file(t).catch(()=>e.file(t.replace(/\.\w+$/,".ogg"))).catch(()=>e.file(t.replace(/\.\w+$/,".mp3"))).catch(()=>e.file(t.replace(/\.\w+$/,".wav"))).then(t=>t.read())}c()(function*(){h("Loading file list");let n=yield e.fileList,s=n.filter(t=>t.match(/\.(?:bms|bme|bml|pms)$/i))[0];h("Loading "+s);let a=yield(yield e.file(s)).read(),c=t.from(new Uint8Array(a)),l=yield Promise.promisify(i.Reader.readAsync)(c),p=i.Compiler.compile(l).chart;var m=i.Timing.fromBMSChart(p),v=i.Notes.fromBMSChart(p),b=i.SongInfo.fromBMSChart(p);o()("<pre wrap></pre>").text(JSON.stringify(b,null,2)).appendTo(f),h("Loading samples");var _=yield function(t,e){var n={},o=[];let i=0;for(let s of t.all()){let t=s.keysound;t in n||(n[t]=null,o.push(d(e.headers.get("wav"+t)).then(t=>r.sample(t)).then(e=>n[t]=e).catch(e=>console.error("Unable to load "+t+": "+e)).tap(()=>h("[loaded "+ ++i+"/"+o.length+" samples]"))))}return Promise.all(o).then(()=>n)}(v,p);h("Click the button to play!"),yield new Promise(function(t){u.show(),u.on("click",()=>{t(),u.hide()})}),function(){r.unmute();for(let t of v.all())setTimeout(()=>{let e=_[t.keysound];if(!e)return void console.log("warn: unknown sample "+t.keysound);let n=o()("<span></span>").text("["+t.keysound+"] ").appendTo(f),r=e.play();f[0].scrollTop=f[0].scrollHeight,r.onstop=function(){n.addClass("is-off")}},1e3*m.beatToSeconds(t.beat))}()}).done()}(r,e),!1})}();o()(e).off("click",n);o()(e).hide();return!1})}}.call(this,n(288).Buffer)},1735:function(t,e,n){var r=n(1736);"string"==typeof r&&(r=[[t.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(0)(r,o);r.locals&&(t.exports=r.locals)},1736:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,".jukebox--overlay {\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background: rgba(139, 134, 133, 0.5);\n}\n\n.jukebox--inner {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  border: 2px solid #8b8685;\n  background: #252423;\n  padding: 12px;\n}\n\n.jukebox--sampler {\n  background: #090807;\n  padding: 9px;\n  border: 1px solid #8b8685;\n  margin-top: 10px;\n  height: 192px;\n  width: 40em;\n  overflow: auto;\n}\n\n.jukebox--sampler span {\n  font-size: 12px;\n  opacity: 1;\n  transition: 0.5s opacity;\n}\n\n.jukebox--sampler span.is-off {\n  color: #8b8685;\n  opacity: 0;\n}\n\n.jukebox h1 {\n  margin: 0 0 20px;\n  font: 30px Helvetica Neue, Helvetica, sans-serif;\n}\n\n.jukebox p {\n  margin: 10px 0 0;\n}\n\n.jukebox .jukebox--status {\n  color: #8b8685;\n  font-style: italic;\n  margin-bottom: 20px;\n}\n\n.jukebox button {\n  display: block;\n  box-sizing: border-box;\n  width: 100%;\n  background: #090807;\n  color: #7f3;\n  cursor: pointer;\n  border: 1px solid #8b8685;\n  padding: 8px;\n  font: bold 15px verdana, sans-serif;\n  margin-top: 18px;\n}\n",""])},1737:function(t,e,n){n(4);t.exports=function(t){var e=[];return e.push('<div class="jukebox"><div class="jukebox--overlay"></div><div class="jukebox--inner"><h1>BMS Jukebox</h1><p class="jukebox--status js-log">Waiting for BMS file...</p><p>Google Chrome: Drag a BMS folder into this box.</p><p>Firefox, Safari: Select all files (BMS+sounds) and drag into this box.</p><button class="js-play">Click Here to Play</button><div class="js-sampler jukebox--sampler"></div></div></div>'),e.join("")}},207:function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"c",function(){return h});var r=n(169),o=n(100),i=n(239);const s=.001;let a=document.createElement("audio");const u=!a.canPlayType('audio/ogg; codecs="vorbis"');class c{constructor(t,{volume:e}={}){this._master=t,this._gain=this._master.audioContext.createGain(),null!=e&&(this._gain.gain.value=e),this._gain.connect(this._master.destination)}get destination(){return this._gain}destroy(){this._gain.disconnect(),this._gain=null}}class l{constructor(t,e){this._master=t,this._buffer=e}play(t,e){return new f(this._master,this._buffer,t,e)}destroy(){this._master=null,this._buffer=null}}class f{constructor(t,e,n,r={}){n=n||0,this._master=t;let o=t.audioContext,i=o.createBufferSource();i.buffer=e,i.onended=(()=>this.stop());let a=o.createGain();i.connect(a);let u=r.node||r.group&&r.group.destination||t.destination;a.connect(u),this._source=i,this._gain=this.TEST_node=a;let c=n?Math.max(0,o.currentTime+n):0,l=r.start||0,f=l>0,h=!1;if(f&&a.gain.setValueAtTime(0,0),void 0!==r.end){let t=Math.max(r.end-l,0);i.start(c,l,t+s),h=o.currentTime+n+t}else i.start(c,l);f&&(a.gain.setValueAtTime(0,o.currentTime+n),a.gain.linearRampToValueAtTime(1,o.currentTime+n+s)),!1!==h&&(a.gain.setValueAtTime(1,h),a.gain.linearRampToValueAtTime(0,h+s)),this._master._startPlaying(this)}stop(){this._source&&(this._source.stop(0),this._source.disconnect(),this._gain.disconnect(),this._source=null,this._gain=null,this._master._stoppedPlaying(this),this.onstop&&this.onstop())}bad(){this._source&&(this._source.playbackRate.value=Math.random()<.5?Math.pow(2,1/24):Math.pow(2,-1/24))}destroy(){this.stop()}}function h(t=r.a){let e=t.createGain(),n=t.createOscillator();n.frequency.value=440,n.start(t.currentTime+.1),n.stop(t.currentTime+.1),e.connect(t.destination),e.disconnect();try{t.resume()}catch(t){console.error("[sampling-master] Cannot resume AudioContext",t)}}e.b=class{constructor(t){this._audioContext=t||r.a,this._samples=[],this._groups=[],this._instances=new Set,this._destination=this._audioContext.destination}unmute(){h(this._audioContext)}get audioContext(){return this._audioContext}get destination(){return this._destination}destroy(){if(!this._destroyed){this._destroyed=!0;for(let t of this._samples)t.destroy();for(let t of this._instances)t.destroy();this._samples=null,this._instances=null}}decode(t){return this._coerceToArrayBuffer(t).then(t=>this._decodeAudio(t))}sample(t){return(()=>t.numberOfChannels?Promise.resolve(t):this.decode(t))().then(t=>{if(this._destroyed)throw new Error("SamplingMaster already destroyed!");var e=new l(this,t);return this._samples.push(e),e})}group(t){const e=new c(this,t);return this._groups.push(e),e}_coerceToArrayBuffer(t){return t instanceof ArrayBuffer?Promise.resolve(t):Object(o.a)(t).as("arraybuffer")}_decodeAudio(t){return new Promise((e,n)=>{if(u&&t.byteLength>4){const n=new Uint8Array(t,0,4);if(79===n[0]&&103===n[1]&&103===n[2]&&83===n[3])return e(Object(i.a)(this.audioContext,t))}this.audioContext.decodeAudioData(t,function(t){e(t)},function(t){n(new Error("Unable to decode audio: "+t))})})}_startPlaying(t){this._instances.add(t)}_stoppedPlaying(t){this._instances.delete(t)}}},239:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(205),o=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())})};let i;const s=n.n(r)()(1);function a(t,e){return o(this,void 0,void 0,function*(){const r=yield(i||(i=n.e(13).then(n.t.bind(null,850,7)).then(t=>t.default).then(t=>(0,eval)(t+";stbvorbis"))),i);return s(()=>(function(t,e,n){return new Promise((r,i)=>{const s=[];let a,c=0;t.decode(n,function(t){if(t.data&&(a=t.sampleRate,s.push(t.data),c+=t.data[0].length),t.error){const e=t.error instanceof Error?t.error:`stbvorbis.js Error: ${t.error}`;i(e)}t.eof&&r(function(t,e,n,r){return o(this,void 0,void 0,function*(){if(!n)throw new Error("stbvorbis.js Error: No length");if(!r)throw new Error("stbvorbis.js Error: No sample rate");const o=e[0].length,i=t.createBuffer(o,n,r),s=Array(i.numberOfChannels).fill(null).map((t,e)=>new u(i.getChannelData(e)));for(const t of e)t.forEach((t,e)=>{s[e].write(t)});return i})}(e,s,c,a))})})})(r,t,e))})}class u{constructor(t){this.data=t,this.offset=0}write(t){const{offset:e,data:n}=this;for(var r=0;r<t.length;r++)n[r+e]=t[r];this.offset+=t.length}}},249:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(586);e.read=function(t){throw new Error("Synchronous read unsupported in browser!")},e.readAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],o=t[1],i=t[2];i?(o=t[1],i=t[2]):(o=null,i=t[1]);var s=o&&o.forceEncoding||r.detect(n),a=new FileReader;a.onload=function(){i(null,a.result)},a.onerror=function(){i(new Error("cannot read it"))},a.readAsText(new Blob([n]),s)};var o=n(250);e.getReaderOptionsFromFilename=o.getReaderOptionsFromFilename},250:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getReaderOptionsFromFilename=function(t){var e;return t.match(/\.sjis\.\w+$/i)&&(e="Shift-JIS"),t.match(/\.euc_kr\.\w+$/i)&&(e="EUC-KR"),t.match(/\.utf8\.\w+$/i)&&(e="UTF-8"),{forceEncoding:e}}},251:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(149),o=n(40),i={bms:{random:/^#RANDOM\s+(\d+)$/i,if:/^#IF\s+(\d+)$/i,endif:/^#ENDIF$/i,timeSignature:/^#(\d\d\d)02:(\S*)$/,channel:/^#(?:EXT\s+#)?(\d\d\d)(\S\S):(\S*)$/,header:/^#(\w+)(?:\s+(\S.*))?$/},dtx:{random:/^#RANDOM\s+(\d+)$/i,if:/^#IF\s+(\d+)$/i,endif:/^#ENDIF$/i,timeSignature:/^#(\d\d\d)02:\s*(\S*)$/,channel:/^#(?:EXT\s+#)?(\d\d\d)(\S\S):\s*(\S*)$/,header:/^#(\w+):(?:\s+(\S.*))?$/}};e.compile=function(t,e){e=e||{};var n=new o.BMSChart,s=e.rng||function(t){return 1+Math.floor(Math.random()*t)},a=e.format&&i[e.format]||i.bms,u=[],c=[!1],l={headerSentences:0,channelSentences:0,controlSentences:0,skippedSentences:0,malformedSentences:0,chart:n,warnings:[]};return function(t,e){t.split(/\r\n|\r|\n/).map(function(t){return t.trim()}).forEach(function(t,n){e(t,n+1)})}(t,function(t,e){var o=!0;if("#"===t.charAt(0)&&(r.match(t).when(a.random,function(t){l.controlSentences+=1,u.push(s(+t[1]))}).when(a.if,function(t){l.controlSentences+=1,c.push(u[u.length-1]!==+t[1])}).when(a.endif,function(t){l.controlSentences+=1,c.pop()}).else(function(){o=!1}),!o)){var i=c[c.length-1];r.match(t).when(a.timeSignature,function(t){l.channelSentences+=1,i||n.timeSignatures.set(+t[1],+t[2])}).when(a.channel,function(t){l.channelSentences+=1,i||function(t,e,r,o){var i=Math.floor(r.length/2);if(0!==i)for(var s=0;s<i;s++){var a=r.substr(2*s,2),u=s/i;"00"!==a&&n.objects.add({measure:t,fraction:u,value:a,channel:e,lineNumber:o})}}(+t[1],t[2],t[3],e)}).when(a.header,function(t){l.headerSentences+=1,i||n.headers.set(t[1],t[2])}).else(function(){!function(t,e){l.warnings.push({lineNumber:t,message:e})}(e,"Invalid command")})}}),l}},252:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(240));e.Segment=o.default({t:"number",x:"number",dx:"number"})},253:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=n(254),s=r(n(56)),a=o(n(255)),u=n(40),c=function(){function t(t){t.forEach(i.Note),this._notes=t}return t.prototype.count=function(){return this._notes.length},t.prototype.all=function(){return this._notes.slice()},t.fromBMSChart=function(e,n){u.BMSChart;var r=(n=n||{}).mapping||t.CHANNEL_MAPPING.IIDX_P1;return new l(e,{mapping:r}).build()},t.CHANNEL_MAPPING=a,t}();e.Notes=c;var l=function(){function t(t,e){this._chart=t,s.default(e.mapping,"Expected options.mapping"),s.default("object"==typeof e.mapping,"options.mapping must be object"),this._mapping=e.mapping,this._notes=[],this._activeLN={},this._lastNote={},this._lnObj=(this._chart.headers.get("lnobj")||"").toLowerCase(),this._channelMapping=this._mapping,this._objects=this._chart.objects.allSorted()}return t.prototype.build=function(){var t=this;return this._objects.forEach(function(e){t._handle(e)}),new c(this._notes)},t.prototype._handle=function(t){if("01"===t.channel)this._handleNormalNote(t);else switch(t.channel.charAt(0)){case"1":case"2":this._handleNormalNote(t);break;case"5":case"6":this._handleLongNote(t)}},t.prototype._handleNormalNote=function(t){var e=this._normalizeChannel(t.channel),n=this._getBeat(t);if(t.value.toLowerCase()===this._lnObj)this._lastNote[e]&&(this._lastNote[e].endBeat=n);else{var r={beat:n,endBeat:void 0,keysound:t.value,column:this._getColumn(e)};this._lastNote[e]=r,this._notes.push(r)}},t.prototype._handleLongNote=function(t){var e=this._normalizeChannel(t.channel),n=this._getBeat(t);if(this._activeLN[e]){var r=this._activeLN[e];r.endBeat=n,this._notes.push(r),delete this._activeLN[e]}else this._activeLN[e]={beat:n,keysound:t.value,column:this._getColumn(e)}},t.prototype._getBeat=function(t){return this._chart.measureToBeat(t.measure,t.fraction)},t.prototype._getColumn=function(t){return this._channelMapping[t]},t.prototype._normalizeChannel=function(t){return t.replace(/^5/,"1").replace(/^6/,"2")},t}()},254:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(240));e.Note=o.default({beat:"number",endBeat:o.default.maybe("number"),column:o.default.maybe("string"),keysound:"string"})},255:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IIDX_P1={11:"1",12:"2",13:"3",14:"4",15:"5",18:"6",19:"7",16:"SC"}},256:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(69),o=n(95),i=n(40),s={bpm:1,stop:2},a=function(){function t(t,e){var n={bpm:t,beat:0,seconds:0},i=[];i.push({t:0,x:0,dx:n.bpm/60,bpm:n.bpm,inclusive:!0}),(e=e.slice()).sort(function(t,e){return t.beat-e.beat||s[t.type]-s[e.type]}),e.forEach(function(t){var e=t.beat,r=n.seconds+60*(e-n.beat)/n.bpm;switch(t.type){case"bpm":n.bpm=t.bpm,i.push({t:r,x:e,dx:n.bpm/60,bpm:n.bpm,inclusive:!0});break;case"stop":i.push({t:r,x:e,dx:0,bpm:n.bpm,inclusive:!0}),r+=60*(t.stopBeats||0)/n.bpm,i.push({t:r,x:e,dx:n.bpm/60,bpm:n.bpm,inclusive:!1});break;default:throw new Error("Unrecognized segment object!")}n.beat=e,n.seconds=r}),this._speedcore=new r.Speedcore(i),this._eventBeats=o.uniq(o.map(e,function(t){return t.beat}))}return t.prototype.beatToSeconds=function(t){return this._speedcore.t(t)},t.prototype.secondsToBeat=function(t){return this._speedcore.x(t)},t.prototype.bpmAtBeat=function(t){return this._speedcore.segmentAtX(t).bpm},t.prototype.getEventBeats=function(){return this._eventBeats},t.fromBMSChart=function(e){i.BMSChart;var n=[];return e.objects.all().forEach(function(t){var r,o=e.measureToBeat(t.measure,t.fraction);if("03"===t.channel)r=parseInt(t.value,16),n.push({type:"bpm",beat:o,bpm:r});else if("08"===t.channel)r=+e.headers.get("bpm"+t.value),isNaN(r)||n.push({type:"bpm",beat:o,bpm:r});else if("09"===t.channel){var i=+e.headers.get("stop"+t.value)/48;n.push({type:"stop",beat:o,stopBeats:i})}}),new t(+e.headers.get("bpm")||60,n)},t}();e.Timing=a},257:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(149),o=n(95),i=n(40),s=function(){function t(t){this.title="NO TITLE",this.artist="NO ARTIST",this.genre="NO GENRE",this.subtitles=[],this.subartists=[],this.difficulty=0,this.level=0,t&&o.assign(this,t)}return t.fromBMSChart=function(e){i.BMSChart;var n={},o=e.headers.get("title"),s=e.headers.get("artist"),a=e.headers.get("genre"),u=+e.headers.get("difficulty")||0,c=+e.headers.get("playlevel")||0,l=e.headers.getAll("subtitle"),f=e.headers.getAll("subartist");if("string"==typeof o&&!l){var h=function(t){o=t[1],l=[t[2]]};r.match(o).when(/^(.*\S)\s*-(.+?)-$/,h).when(/^(.*\S)\s*～(.+?)～$/,h).when(/^(.*\S)\s*\((.+?)\)$/,h).when(/^(.*\S)\s*\[(.+?)\]$/,h).when(/^(.*\S)\s*<(.+?)>$/,h)}return o&&(n.title=o),s&&(n.artist=s),a&&(n.genre=a),l&&(n.subtitles=l),f&&(n.subartists=f),u&&(n.difficulty=u),c&&(n.level=c),new t(n)},t}();e.SongInfo=s},258:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(95),o=n(40),i=function(){function t(t){this._map=t}return t.prototype.get=function(t){return this._map[t.toLowerCase()]},t.prototype.files=function(){return r.uniq(r.values(this._map))},t.prototype.all=function(){return this._map},t.fromBMSChart=function(e){o.BMSChart;var n={};return e.headers.each(function(t,e){var r=t.match(/^wav(\S\S)$/i);r&&(n[r[1].toLowerCase()]=e)}),new t(n)},t}();e.Keysounds=i},259:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(69),o=n(40),i=function(){function t(t){this._speedcore=new r.Speedcore(t)}return t.prototype.speed=function(t){return this._speedcore.dx(t)},t.prototype.position=function(t){return this._speedcore.x(t)},t.fromBMSChart=function(e){o.BMSChart;var n=[],r=0;return n.push({t:0,x:r,dx:1,inclusive:!0}),e.objects.allSorted().forEach(function(t){if("SC"===t.channel){var o=e.measureToBeat(t.measure,t.fraction),i=+e.headers.get("scroll"+t.value);if(isNaN(i))return;var s=n[n.length-1];r+=(o-s.t)*s.dx,0===o&&1===n.length?n[0].dx=i:n.push({t:o,x:r,dx:i,inclusive:!0})}}),new t(n)},t}();e.Positioning=i},260:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(69),o=n(40),i=function(){function t(t){t.length>0&&(this._speedcore=new r.Speedcore(t))}return t.prototype.factor=function(t){return this._speedcore?this._speedcore.x(t):1},t.fromBMSChart=function(e){o.BMSChart;var n=[];return e.objects.allSorted().forEach(function(t){if("SP"===t.channel){var r=e.measureToBeat(t.measure,t.fraction),o=+e.headers.get("speed"+t.value);if(isNaN(o))return;if(n.length>0){var i=n[n.length-1];i.dx=(o-i.x)/(r-i.t)}n.push({t:r,x:o,dx:0,inclusive:!0})}}),n.length>0&&n.unshift({t:0,x:n[0].x,dx:0,inclusive:!0}),new t(n)},t}();e.Spacing=i},278:function(t,e,n){"use strict";var r=n(93);class o{constructor(){this.buffer=[],this.loggingFunction=(t=>{this.buffer&&this.buffer.push(t)}),this.log=(t=>{this.loggingFunction(t)}),this.setLoggingFunction=(t=>{this.loggingFunction=t,this.buffer&&(this.buffer.forEach(e=>t(e)),this.buffer=null)})}}var i=n(526),s=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())})};i.a.init({workerUrl:"/vendor/libarchive.js-1.3.0/dist/worker-bundle.js"});var a=n(100),u=n(140),c=n(94);n.d(e,"a",function(){return f}),n.d(e,"b",function(){return d}),n.d(e,"c",function(){return m});var l=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())})};const f=/\.(?:zip|rar|7z|tar(?:\.(?:gz|bz2))?)/i,h=/https?:\/\/(?:(?:www|dl)\.dropbox\.com|dl\.dropboxusercontent\.com)\/(sh?)\/([^?]*)(.*)?$/;class d{constructor(t){this._logging=new o,this.setLoggingFunction=this._logging.setLoggingFunction,this._files=Promise.resolve(t.getFiles(this._logging.log)).then(t=>(function(t,e){return l(this,void 0,void 0,function*(){if(1!==t.length)return t;const n=t[0];return n.name.match(f)?(e("Archive file detected! Now unarchiving…"),function(t){return s(this,void 0,void 0,function*(){const e=[],n=yield(yield i.a.open(t)).extractFiles(),r=t=>{for(const n of Object.keys(t))t[n]instanceof File?e.push({name:n,file:t[n]}):t[n]&&"object"==typeof t[n]&&r(t[n])};return r(n),e})}(n.file)):t})})(t,this._logging.log))}file(t){return this._files.then(function(e){for(let n of e)if(n.name.toLowerCase()===t.toLowerCase())return new p(n.file);throw new Error("unable to find "+t)})}get fileList(){return Promise.resolve(this._files).map(t=>t.name)}}class p{constructor(t){this._file=t}read(t){return r.a(t,Object(a.a)(this._file).as("arraybuffer"))}resolveUrl(){return Promise.resolve(URL.createObjectURL(this._file))}get name(){return this._file.name}}function m(t,e){return l(this,void 0,void 0,function*(){const n=t.replace(/[?#].*/,"").split("/").pop(),r=t.match(h);r&&(t=`https://dl.dropboxusercontent.com/${r[1]}/${r[2]}`);const o=new u.a;let i=0;return o.watch(()=>{Date.now()<i+5e3||(e(`Downloading: ${o}`),i=Date.now())}),{name:n,file:yield Object(c.a)(t).as("blob",o)}})}},40:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(150),o=n(151),i=n(152),s=function(){function t(){this.headers=new r.BMSHeaders,this.objects=new o.BMSObjects,this.timeSignatures=new i.TimeSignatures}return t.prototype.measureToBeat=function(t,e){return this.timeSignatures.measureToBeat(t,e)},t}();e.BMSChart=s},504:function(t,e,n){"use strict";var r=n(278),o=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())})};e.a=class extends r.b{constructor(t){super({getFiles:e=>(function(t,e){return o(this,void 0,void 0,function*(){let n=[];const i=t.dataTransfer;if(!i)throw new Error("Expect event.dataTransfer to be present");if(i.types.indexOf("text/uri-list")>-1){let t=i.getData("text/uri-list").split(/\r\n|\r|\n/).filter(t=>t&&!t.startsWith("#"))[0];if(r.a.test(t&&t.replace(/[?#].*/,"")))return e("Link to archive file detected. Trying to download"),[yield Object(r.c)(t,e)]}else if(i.items)for(let t of Array.from(i.items))yield s(t);else if(i.files)for(let t of Array.from(i.files))u(t);return n;function s(t){return o(this,void 0,void 0,function*(){let e=t.webkitGetAsEntry&&t.webkitGetAsEntry();if(e)yield a(e);else{let e=t.getAsFile&&t.getAsFile();e&&u(e)}})}function a(t){return t.isFile?function(t){return new Promise((e,n)=>{t.file(e,n)}).tap(t=>{u(t)})}(t):t.isDirectory?function(t){return o(this,void 0,void 0,function*(){let e=[],n=t.createReader();for(;;){let t=yield new Promise((t,e)=>{n.readEntries(t,e)});if(!t||0===t.length)break;e.push(...Array.from(t))}for(let t of e)yield a(t)})}(t):void 0}function u(t){t&&n.push({name:t.name,file:t})}})})(t,e)})}}},69:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(252),o=function(){function t(t){t.forEach(r.Segment),this._segments=t}return t.prototype._reached=function(t,e,n){if(t>=this._segments.length)return!1;var r=this._segments[t],o=e(r);return r.inclusive?n>=o:n>o},t.prototype._segmentAt=function(t,e){for(var n=0;n<this._segments.length;n++)if(!this._reached(n+1,t,e))return this._segments[n];throw new Error("Unable to find a segment matching a criteria (this should never happen)!")},t.prototype.segmentAtX=function(t){return this._segmentAt(s,t)},t.prototype.segmentAtT=function(t){return this._segmentAt(i,t)},t.prototype.t=function(t){var e=this.segmentAtX(t);return e.t+(t-e.x)/(e.dx||1)},t.prototype.x=function(t){var e=this.segmentAtT(t);return e.x+(t-e.t)*e.dx},t.prototype.dx=function(t){return this.segmentAtT(t).dx},t}();e.Speedcore=o;var i=function(t){return t.t},s=function(t){return t.x}},74:function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"c",function(){return a}),n.d(e,"b",function(){return u});var r=n(492),o=n.n(r);let i=t=>e=>null!==e.progress?t(e):"",s=i(t=>o()(t.current)+" / "+o()(t.total)),a=i(t=>(t.current/t.total*100).toFixed(1)+"%"),u=i(t=>t.extra+"")},93:function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"a",function(){return i}),n.d(e,"e",function(){return s}),n.d(e,"b",function(){return a}),n.d(e,"d",function(){return u});var r=n(74);function o(t,e){if(!e)return()=>{};let n=0;return e.report(0,t),r=>e.report(++n,t,r)}function i(t,e){return t?Promise.resolve(e).tap(e=>{!function(t){return t&&t.byteLength}(e)?t.report(1,1):(t.formatter=r.a,t.report(e.byteLength,e.byteLength))}):e}function s(t,e){let n=0,r=0;return function(...o){return t.report(n,++r),Promise.resolve(e.apply(this,o)).tap(()=>t.report(++n,r))}}function a(t,e){return t.watch(()=>e.report(t.current,t.total,t.extra))}function u(t){let e,n=[],r=null;function o(){e&&t.report(e.current,e.total,e.extra),n.length>0&&(!e||e.progress>=1)&&function(t){if(e===t)return;r&&(r(),r=null);(e=t)&&(r=e.watch(o))}(n.shift())}return{add(t){n.push(t),o()}}}},94:function(t,e,n){"use strict";var r=n(74);e.a=function(t){return{as:(e,n)=>new Promise((o,i)=>{var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType=e,s.onload=(()=>{200==+s.status?o(s.response):i(new Error(`Unable to download ${t}: HTTP ${s.status}`))}),s.onerror=(()=>i(new Error(`Unable to download ${t}`))),n&&(n.formatter=r.a,s.onprogress=(t=>n.report(t.loaded,t.total))),s.send(null)})}}},95:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(588));e.uniq=o.default;var i=r(n(589));e.map=i.default;var s=r(n(590));e.values=s.default;var a=r(n(591));e.assign=a.default}}]);
//# sourceMappingURL=comingSoonDemo-5b5931c1b73249dcc34c.js.map