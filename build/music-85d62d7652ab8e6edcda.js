(this.webpackJsonp=this.webpackJsonp||[]).push([[11],{114:function(e,t,n){"use strict";t.a=document.querySelector("#scene-root")},1796:function(e,t,n){"use strict";n.r(t),n.d(t,"main",(function(){return C}));var r=n(570),a=n(114),o=n(26),s=n.n(o),l=n(56),i=n(490),u=n(2),c=n(358),d=n(31),f=n.n(d),p=n(933),m=n(27),h=n.n(m),b=n(284),g=n(934),y=n(489),E=n(491);const v={ingame:e=>Object(y.a)(Object(E.a)(e)),added:e=>[{title:"Sorted by added date",songs:f.a.reverse(f.a.sortBy(e,w))}]},w=e=>e.added||(e.initial?"0000-00-00":"9999-99-99");function k(e){const t=function(e){const t=[],n=(e,...n)=>t.push({keys:n,message:e});e.unreleased&&n("Not released","unreleased"),e.readme||n("No README file found","README.md"),e.replaygain||n("No replay gain","replaygain"),e.artist_url||n("No artist URL","artist_url"),e.added||e.initial||n("No added date","added"),e.song_url||e.youtube_url||e.long_url||n("No song/YouTube/long URL","song_url","long_url","youtube_url"),e.bms_url||e.exclusive||n("No download URL","bms_url"),e.bmssearch_id||e.exclusive||n("No BMS search ID","bmssearch_id"),e.charts.filter(e=>"5K"===e.keys).length||n("No 5-key charts","5key");for(const t of Object(b.a)(e.charts))t.info.subtitles.length||n("Missing subtitle","chart_names "+t.file);return t}(e);return t.length?s.a.createElement("div",null,t.map((e,t)=>s.a.createElement("div",{key:t},e.keys.map(e=>s.a.createElement("code",{key:e,style:{fontFamily:"Ubuntu Mono",marginRight:"2",padding:3,fontSize:"0.8em",background:"#755"}},e)),e.message))):null}class S extends s.a.Component{constructor(e){super(e),this.state={sort:this.props.initialSort||Object.keys(v)[0],previewUrl:null,previewEnabled:!1}}renderTable(){return s.a.createElement("table",{style:{borderSpacing:4}},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",{colSpan:4},this.renderSorter()," · ",this.renderPreview())),s.a.createElement("tr",null,s.a.createElement("th",null,"id"),s.a.createElement("th",null,"song"),s.a.createElement("th",null,"warnings"))),s.a.createElement("tbody",null,this.renderRows()))}renderSorter(){const e=[];for(const t of Object.keys(v))e.push(s.a.createElement("button",{key:t,onClick:()=>{this.setState({sort:t})}},t));return s.a.createElement("span",null,s.a.createElement("strong",null,"Sort by:")," ",e)}renderPreview(){const e=s.a.createElement("button",{onClick:()=>{this.setState(e=>({previewEnabled:!e.previewEnabled}))}},this.state.previewEnabled?"disable":"enable");return s.a.createElement("span",null,s.a.createElement("strong",null,"Music preview:")," ",e,this.state.previewEnabled&&s.a.createElement(p.a,{url:this.state.previewUrl}))}renderRows(){const e=v[this.state.sort](this.props.data.songs),t=[];for(const r of e){t.push(s.a.createElement("tr",{key:r.title},s.a.createElement("th",{colSpan:4},r.title)));for(const e of r.songs)t.push(s.a.createElement("tr",{key:e.id},s.a.createElement("td",null,s.a.createElement("strong",{onClick:()=>{prompt("",`vim '${e.id}/README.md'`)}},s.a.createElement("code",{style:{fontFamily:"Ubuntu Mono"}},e.id)),s.a.createElement("br",null),s.a.createElement("span",{style:{color:"#8b8685"}},e.added)),s.a.createElement("td",{style:{textAlign:"center",background:"#353433"}},s.a.createElement("span",{style:{color:"#8b8685"},onClick:()=>{const t=Object(g.a)(this.props.url,e);this.setState({previewUrl:t})}},e.genre),s.a.createElement("br",null),s.a.createElement("strong",{onClick:()=>{console.log(e),alert(n(102).inspect(e))}},e.title),s.a.createElement("br",null),e.artist),s.a.createElement("td",null,k(e))))}return t}renderMessage(e){return s.a.createElement("div",{style:{textAlign:"center"}},e)}render(){if(!this.props.data)return this.renderMessage("No data");try{return this.renderTable()}catch(e){return this.renderMessage("Error: "+e)}}}S.propTypes={data:h.a.object,url:h.a.string,initialSort:h.a.string};var M=S;class _ extends s.a.Component{constructor(e){super(e),this.state={url:u.a.server||c.a,status:"Loading"}}componentDidMount(){Object(c.b)(this.state.url).then(e=>{this.setState({status:"Load completed",data:e})}).catch(e=>{this.setState({status:"Load error: "+e})})}render(){return s.a.createElement("div",null,s.a.createElement("header",{style:{textAlign:"center"}},s.a.createElement("h1",null,"Bemuse collection viewer"),s.a.createElement("div",null,this.state.url,s.a.createElement("br",null),this.state.status)),s.a.createElement("div",{style:{padding:20}},s.a.createElement(M,{data:this.state.data&&Object(i.a)(this.state.data),url:this.state.url,initialSort:u.a.sort})))}}var j=_;function C(){r.d(),Object(l.render)(s.a.createElement(j,null),a.a)}},202:function(e,t,n){"use strict";t.a=function(e){return"7K"===e.keys||"5K"===e.keys}},284:function(e,t,n){"use strict";var r=n(31),a=n.n(r),o=n(202);t.a=function(e){return a()(e).filter(o.a).orderBy([e=>e.info.difficulty>=5?1:0,e=>e.keys,e=>e.info.level]).value()}},358:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="https://music.bemuse.ninja/live";function a(t,{fetch:n=e.fetch}={}){return n(t+"/index.json").then(e=>e.json())}}).call(this,n(33))},489:function(e,t,n){"use strict";var r=n(31),a=n.n(r);const o=[{title:"Custom Song",criteria:e=>e.custom},{title:"Tutorial",criteria:e=>e.tutorial},{title:"Unreleased",criteria:e=>e.unreleased},{title:"Recently Added Songs",criteria:e=>e.added&&Date.now()-Date.parse(e.added)<5184e6,sort:e=>e.added,reverse:!0},{title:"☆",criteria:()=>!0}];t.a=function(e){let t=o.map(e=>({input:e,output:{title:e.title,songs:[]}}));for(let n of e)for(let{input:e,output:r}of t)if(e.criteria(n)){r.songs.push(n);break}for(let{input:e,output:n}of t)e.sort&&(n.songs=a.a.sortBy(n.songs,e.sort)),e.reverse&&n.songs.reverse();return a()(t).map("output").filter(e=>e.songs.length>0).value()}},490:function(e,t,n){"use strict";var r=n(86),a=n.n(r);const o=a()({songs:a.a.map((function(e){e.chart_names&&(e=a()({charts:a.a.map(t=>{const n=e.chart_names[t.file];return n?a()({info:{subtitles:e=>[...e,n]}},t):t})},e));return e}))});t.a=o},491:function(e,t,n){"use strict";var r=n(31),a=n.n(r),o=n(202);t.a=function(e){return a.a.orderBy(e,[e=>a()(e.charts).filter(o.a).filter(e=>e.info.difficulty<5).filter(e=>e.info.level>0).map(e=>e.info.level).min(),e=>e.bpm,e=>e.title.toLowerCase()])}},570:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return u}));let r=null;function a(){return r||(r=function(){let e=!1,t=null,r=!1,a=!1;const o={},s=new Audio(n(921));s.preload="auto",s.loop=!0,s.oncanplaythrough=()=>{r=!0,u()},s.load();const l=document.createElement("audio");l.src=n(922),l.volume=.5,l.load();const i=c(s,.5,e=>{0===e&&a&&(a=!1,s.pause())});function u(){if(!e){a&&(i.fadeTo(0,100),a=!1,s.pause());for(const e of Object.keys(o)){o[e].destroy()}return}let n=null;for(const e of Object.keys(o)){const r=o[e];e===t?r.loaded&&(r.play(),n=r):r.stop()}if(n)i.fadeTo(0,1);else if(i.fadeTo(.4,.5),r&&!a){a=!0;try{s.play()}catch(e){console.warn("Cannot play background music")}}}return{enable(){e||(e=!0,u())},disable(){e&&(e=!1,u())},go(){if(e){l.currentTime=0;try{l.play()}catch(e){console.warn("Cannot play go sound.")}}},preview(e){t!==e&&(t=e,e&&!o[e]&&(o[e]=function(e){const t=document.createElement("audio");t.src=e;let n=!1;const r=c(t,1,n=>{0===n&&(t.pause(),delete o[e],u())}),a={loaded:!1,play(){if(!n)try{t.play(),n=!0}catch(e){console.warn("Cannot play",t.src)}r.fadeTo(1,2)},stop(){r.fadeTo(0,4)},destroy(){t.pause(),delete o[e],u()}};return t.oncanplaythrough=()=>{a.loaded=!0,u()},t.onended=()=>{delete o[e],u()},t.load(),a}(e)),u())}}}())}function o(){a()}function s(){return a().enable()}function l(){return a().disable()}function i(){return a().go()}function u(e){return a().preview(e)}function c(e,t,n){let r,a=0,o=0,s=!1;function l(){return(Date.now()-r)/1e3}function i(){return a>t?Math.min(a,t+l()*o):a<t?Math.max(a,t-l()*o):a}function u(){s=!1;const t=i();e.volume=t,t===a?n&&n(a):s||(s=!0,requestAnimationFrame(u))}return e.volume=t,{fadeTo(e,n){a===e&&n===o||(t=i(),a=e,o=n,r=Date.now(),u())}}}},921:function(e,t,n){e.exports=n.p+"build/354b30433269481d2f132496a0d13f64.ogg"},922:function(e,t,n){e.exports=n.p+"build/38fbcad5f2b14ca6ffc359446f7ec455.ogg"},933:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(26),a=n.n(r),o=n(27),s=n.n(o),l=n(570);l.d();class i extends a.a.Component{componentDidMount(){l.b(),l.e(this.props.url),addEventListener("message",this.handleMessage)}componentWillUnmount(){l.a(),removeEventListener("message",this.handleMessage)}componentWillReceiveProps(e){l.e(e.url)}render(){return null}handleMessage({data:e}){"calibration-started"===e.type?l.a():"calibration-closed"===e.type&&l.b()}}i.propTypes={url:s.a.string}},934:function(e,t,n){"use strict";t.a=function(e,t){return t?t.tutorial?null:e+"/"+t.path+"/_bemuse_preview.mp3":null}}}]);
//# sourceMappingURL=music-85d62d7652ab8e6edcda.js.map