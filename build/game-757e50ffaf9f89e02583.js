(this.webpackJsonp=this.webpackJsonp||[]).push([[8,5,17],{103:function(t,e,n){e.Reader=n(617),e.Compiler=n(615),e.BMSChart=n(614),e.BMSHeaders=n(613),e.BMSObjects=n(612),e.Speedcore=n(161),e.TimeSignatures=n(611),e.Notes=n(610),e.Timing=n(609),e.SongInfo=n(608),e.Keysounds=n(336),e.Positioning=n(335),e.Spacing=n(334)},1106:function(t,e,n){"use strict";function r(t,e){return t.file(e).then(function(t){return t.read()}).then(function(t){return new Blob([t])}).then(function(t){return URL.createObjectURL(t)}).then(function(t){return new Promise(function(e,n){var r=new Image;r.onload=function(){return e(r)},r.onerror=n,r.src=t})})}Object.defineProperty(e,"__esModule",{value:!0}),e.loadImage=r,e.default=r},1107:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(268);e.default=function(t){var e=new r.OmniInput(window,{exclusive:!0}),n=t.players[0].options.input.keyboard;return{name:"GameKBPlugin",get:function(){var t=e.update(),r={p1_1:t[n[1]||"83"],p1_2:t[n[2]||"68"],p1_3:t[n[3]||"70"],p1_4:t[n[4]||"32"],p1_5:t[n[5]||"74"],p1_6:t[n[6]||"75"],p1_7:t[n[7]||"76"],p1_SC:t[n.SC||"65"]||-t[n.SC2||"16"],p1_speedup:t[38],p1_speeddown:t[40],start:t[13]||t["gamepad.0.button.9"],select:t[18]||t["gamepad.0.button.8"]};return(r.start||r.select)&&((r.p1_1||r.p1_3||r.p1_5||r.p1_7)&&(r.p1_speeddown=!0),(r.p1_2||r.p1_4||r.p1_6)&&(r.p1_speedup=!0)),r},destroy:function(){e.dispose()}}}},1108:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GameTimer=void 0;var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(153),a=(r=o)&&r.__esModule?r:{default:r};var u=e.GameTimer=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._clock=e,this._input=n,this._now=a.default.synchronized(),this.startTime=null,this.readyFraction=0}return i(t,[{key:"update",value:function(){this._checkStartGame(),this.time=this._calculateTime()}},{key:"_checkStartGame",value:function(){this.started||(this._input.get("start").value&&(this.gettingStarted=!0),this.gettingStarted&&!this._input.get("start").value&&(this.startTime=this._clock.time+this._getWait()),this.started||(this.readyFraction=1-this._getWait()))}},{key:"_getWait",value:function(){var t=this._now()/1e3;return Math.ceil(t)-t}},{key:"_calculateTime",value:function(){var t=null===this.startTime?0:this._clock.time-this.startTime;return t<0&&(t=0),t<1?(Math.pow(t,6)-1)/6-1/30:t-31/30}},{key:"started",get:function(){return null!==this.startTime}}]),t}();e.default=u},1109:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Clock=void 0;var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(153),a=(r=o)&&r.__esModule?r:{default:r};var u=e.Clock=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e.unmute(),this._context=e.context,this._offset=[],this._sum=0,this.update()}return i(t,[{key:"update",value:function(){var t=(0,a.default)()/1e3,e=t-this._context.currentTime;for(this._offset.push(e),this._sum+=e;this._offset.length>60;)this._sum-=this._offset.shift();this.time=t-this._sum/this._offset.length}}]),t}();e.default=u},1110:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GameController=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=f(n(171)),o=f(n(1109)),a=f(n(270)),u=f(n(603)),s=f(n(1108)),l=f(n(1107)),c=f(n(602));function f(t){return t&&t.__esModule?t:{default:t}}var h=e.GameController=function(){function t(e){var n=this,r=e.game,l=e.display,c=e.audio;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._audioInputLatency=r.options.audioInputLatency,this._game=r,this._display=l,this._audio=c,this._clock=new o.default(this._audio),this._input=new a.default,this._timer=new s.default(this._clock,this._input),this._state=new u.default(r),this._promise=new Promise(function(t){return n._resolvePromise=t}),this._display.setEscapeHandler(function(){return n._quitGame()}),this._display.setReplayHandler(function(){return n._replayGame()}),i.default.enabled&&this.enableBenchmark()}return r(t,[{key:"start",value:function(){var t=this;this._handleEscape(),this._display.start(),this._input.use(new l.default(this._game)),this._input.use(new c.default(this._display.context));var e=!1;requestAnimationFrame(function n(){e||(t._update(),requestAnimationFrame(n))}),this._endGameLoop=function(){return e=!0}}},{key:"_handleEscape",value:function(){var t=this,e=function(e){27===e.keyCode?(e.preventDefault(),e.stopPropagation(),t._quitGame()):112===e.keyCode&&(e.preventDefault(),e.stopPropagation(),t._replayGame())};window.addEventListener("keydown",e,!0),this._promise.finally(function(){window.removeEventListener("keydown",e,!0)}).done()}},{key:"_quitGame",value:function(){this._resolvePromise({finished:!1,replay:!1})}},{key:"_replayGame",value:function(){this._resolvePromise({finished:!1,replay:!0})}},{key:"destroy",value:function(){this._endGameLoop(),this._audio.destroy(),this._input.destroy(),this._display.destroy()}},{key:"_update",value:function(){this._clock.update(),this._input.update(),this._timer.update();var t=this._timer.time,e=this._audioInputLatency;this._latestGameTime=t,this._state.update(t-e,this._input,this._timer),this._audio.update(t,this._state),this._display.update(t-e,this._state),this._state.finished&&this._resolvePromise&&(this._resolvePromise({finished:!0}),this._resolvePromise=null)}},{key:"enableBenchmark",value:function(){i.default.benchmark("update",this,"_update"),i.default.benchmark("input_update",this._input,"update"),i.default.benchmark("state_update",this._state,"update"),i.default.benchmark("audio_update",this._audio,"update"),i.default.benchmark("display_update",this._display,"update"),i.default.benchmark("display_compute",this._display,"_getData"),i.default.benchmark("display_push",this._display._context._instance,"push"),i.default.benchmark("display_render",this._display._context._renderer,"render")}},{key:"game",get:function(){return this._game}},{key:"display",get:function(){return this._display}},{key:"audio",get:function(){return this._audio}},{key:"promise",get:function(){return this._promise}},{key:"state",get:function(){return this._state}},{key:"latestGameTime",get:function(){return this._latestGameTime}}]),t}();e.default=h},1111:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GameAudio=void 0;var r,i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(604),u=(r=a)&&r.__esModule?r:{default:r};var s=e.GameAudio=function(){function t(e){var n=e.game,r=e.samples,i=e.master;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=n.options.soundVolume;this._master=i,this._context=i.audioContext,this._players=new Map(n.players.map(function(t){return[t,new u.default({player:t,samples:r,master:i,volume:o})]}))}return o(t,[{key:"destroy",value:function(){this._master.destroy()}},{key:"unmute",value:function(){this._master.unmute()}},{key:"update",value:function(t,e){var n=!0,r=!1,o=void 0;try{for(var a,u=this._players[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var s=a.value,l=i(s,2),c=l[0];l[1].update(t,e.player(c))}}catch(t){r=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(r)throw o}}}},{key:"context",get:function(){return this._context}}]),t}();e.default=s},1112:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.start=function(t){var e={},n={},a=[];function u(t,n,r,o){var u=new i.default;n&&a.push({text:n,progress:u}),e[t]=function(){return Promise.all(r.map(s)).then(function(t){return o.apply(void 0,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t.concat([u])))})}}function s(t){return n[t]||(n[t]=e[t]())}function l(){return a.map(function(t){return{text:t.text,progress:t.progress.progress,progressText:t.progress.toString()}})}u.bar=function(t,e){a.push({text:t,progress:e})};var c=t(u,s),f=new r.default(l()),h=(0,o.throttle)(function(){f.value=l()},16),p=!0,d=!1,v=void 0;try{for(var y,_=a[Symbol.iterator]();!(p=(y=_.next()).done);p=!0){var g=y.value;g.progress.watch(h)}}catch(t){d=!0,v=t}finally{try{!p&&_.return&&_.return()}finally{if(d)throw v}}return{tasks:f,promise:c,get:s}};var r=a(n(7)),i=a(n(4)),o=n(43);function a(t){return t&&t.__esModule?t:{default:t}}},1113:function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.barLinesForBmson=function(t){var e=t.lines;return(0,a.default)(e).map(function(t){var e=t.y;return s(e)}).sortBy().value()},e.timingInfoForBmson=function(t){return{initialBPM:t.info.initBPM,actions:[].concat(r((t.bpmNotes||[]).map(function(t){var e=t.y,n=t.v;return{type:"bpm",beat:s(e),bpm:n}})),r((t.stopNotes||[]).map(function(t){var e=t.y,n=t.v;return{type:"stop",beat:s(e),stopBeats:s(Math.floor(n))}})))}},e.beatForLoc=s;var i,o=n(331),a=(i=o)&&i.__esModule?i:{default:i},u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(607));function s(t){return t/240}e._slicesForNotesAndTiming=function(t,e){return u.slicesForNotesAndTiming(t,e,{beatForPulse:s})}},1114:function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.songInfoForBmson=function(t){var e=t.info,n={};e.title&&(n.title=e.title);e.artist&&(n.artist=e.artist);e.genre&&(n.genre=e.genre);e.level&&(n.level=e.level);n.subtitles=function(){if(!t.version)return["Warning: legacy bmson"];var n=[];return e.chart_name&&"string"==typeof e.chart_name&&n.push(e.chart_name),e.subtitle&&"string"==typeof e.subtitle&&n.push.apply(n,o(e.subtitle.split("\n"))),n}(),e.subartists&&(n.subartists=e.subartists);return new u.default.SongInfo(n)},e.barLinesForBmson=function(t){if(!t.version)return l.barLinesForBmson(t);var e=p(t),n=t.lines;return(0,a.default)(n).map(function(t){var n=t.y;return e(n)}).sortBy().value()},e.timingInfoForBmson=f,e.musicalScoreForBmson=function(t){var e=function(t){var e=f(t),n=e.initialBPM,r=e.actions;return new u.default.Timing(n,r)}(t),n=function(t,e){var n=1,r=p(t),i=[],o={},u=h(t);if(u){var s=!0,l=!1,f=void 0;try{for(var v,y=u[Symbol.iterator]();!(s=(v=y.next()).done);s=!0){var _=v.value,g=_.name,m=_.notes,b=a.default.sortBy(m,"y"),w=n++,k=a.default.padLeft(""+w,4,"0"),x=c.slicesForNotesAndTiming(m,e,{beatForPulse:r});o[k]=g;var E=!0,S=!1,j=void 0;try{for(var C,T=b[Symbol.iterator]();!(E=(C=T.next()).done);E=!0){var P=C.value,A=P.x,O=P.y,M=P.l,R={column:d(A),beat:r(O),keysound:k,endBeat:void 0};M>0&&(R.endBeat=r(O+M));var F=x.get(O);F&&(Object.assign(R,F),i.push(R))}}catch(t){S=!0,j=t}finally{try{!E&&T.return&&T.return()}finally{if(S)throw j}}}}catch(t){l=!0,f=t}finally{try{!s&&y.return&&y.return()}finally{if(l)throw f}}}return{notes:i,keysounds:o}}(t,e),r=n.notes,i=n.keysounds;return{timing:e,notes:new u.default.Notes(r),keysounds:new u.default.Keysounds(i)}},e.beatForPulseForBmson=p,e.hasScratch=function(t){var e=h(t);if(e){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value.notes,s=!0,l=!1,c=void 0;try{for(var f,p=u[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var d=f.value.x;if(8===d||18===d)return!0}}catch(t){l=!0,c=t}finally{try{!s&&p.return&&p.return()}finally{if(l)throw c}}}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}return!1},e.keysForBmson=function(t){var e=h(t),n=!1,r=!1,i=!1;if(e){var o=!0,a=!1,u=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value.notes,f=!0,p=!1,d=void 0;try{for(var v,y=c[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var _=v.value.x;n=!0,_>=11&&_<=20&&(r=!0),6!==_&&7!==_&&16!==_&&17!==_||(i=!0)}}catch(t){p=!0,d=t}finally{try{!f&&y.return&&y.return()}finally{if(p)throw d}}}}catch(t){a=!0,u=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw u}}}if(!n)return"empty";return r?i?"14K":"10K":i?"7K":"5K"};var a=i(n(331)),u=i(n(103)),s=n(1113),l=r(s),c=r(n(607));function f(t){if(!t.version)return l.timingInfoForBmson(t);var e=p(t);return{initialBPM:t.info.init_bpm,actions:[].concat(o((t.bpm_events||[]).map(function(t){var n=t.y,r=t.bpm;return{type:"bpm",beat:e(n),bpm:r}})),o((t.stop_events||[]).map(function(t){var n=t.y,r=t.duration;return{type:"stop",beat:e(n),stopBeats:e(Math.floor(r))}})))}}function h(t){return t.version?t.sound_channels:t.soundChannel}function p(t){if(!t.version)return l.beatForLoc;var e=t.info&&t.info.resolution||240;return function(t){return t/e}}function d(t){switch(t){case 1:return"1";case 2:return"2";case 3:return"3";case 4:return"4";case 5:return"5";case 6:return"6";case 7:return"7";case 8:return"SC"}}Object.defineProperty(e,"_slicesForNotesAndTiming",{enumerable:!0,get:function(){return s._slicesForNotesAndTiming}})},1115:function(t,e,n){t.exports=n(1114)},1116:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.load=function(t,e){var n=JSON.parse(t),a=r.songInfoForBmson(n),u=r.musicalScoreForBmson(n),s=r.barLinesForBmson(n),l={notes:u.notes.all(),timing:u.timing,keysounds:u.keysounds,songInfo:a,positioning:new i.default.Positioning([{t:0,x:0,dx:1,inclusive:!0}]),spacing:new i.default.Spacing([]),barLines:s,images:{eyecatch:n.info.eyecatch_image,background:n.info.back_image},expertJudgmentWindow:function(t){var e=(t.info&&t.info.judge_rank&&+t.info.judge_rank||100)/100;return[18*e,40*e]}(n)};return new o.default(l,e)};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1115)),i=a(n(103)),o=a(n(254));function a(t){return t&&t.__esModule?t:{default:t}}},1117:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.NotechartLoader=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=l(n(103)),o=s(n(333)),a=s(n(1116)),u=l(n(606));function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function l(t){return t&&t.__esModule?t:{default:t}}function c(t){return function(){var e=t.apply(this,arguments);return new u.default(function(t,n){return function r(i,o){try{var a=e[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return u.default.resolve(s).then(function(t){return r("next",t)},function(t){return r("throw",t)});t(s)}("next")})}}var f=function(e){return t.isBuffer(e)?e:new t(new Uint8Array(e))},h=e.NotechartLoader=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,[{key:"load",value:function(t,e,n){return e.name.match(/\.bmson$/i)?this.loadBmson(t,e,n):this.loadBMS(t,e,n)}},{key:"loadBMS",value:function(){var t=c(regeneratorRuntime.mark(function t(e,n,r){var a,s,l,c,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=f(e),t.next=3,u.default.promisify(i.default.Reader.readAsync)(a);case 3:return s=t.sent,l=i.default.Compiler.compile(s),c=l.chart,h=o.fromBMSChart(c,r),t.abrupt("return",h);case 8:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"loadBmson",value:function(){var t=c(regeneratorRuntime.mark(function t(e,n,r){var i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=f(e),o=i.toString("utf-8"),t.abrupt("return",a.load(o,r));case 3:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()}]),t}();e.default=h}).call(this,n(272).Buffer)},1118:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.load=function(t){var e=t.assets,y=t.bms,_=t.songId;return l.start(function(l,g){l("Scintillator","Loading game engine",[],function(t){return new Promise(function(e){var i=new r.default(t);i.use(function(){Promise.all([n.e(16),n.e(15)]).then(function(){var t=n(495);return"object"==typeof t&&t&&t.__esModule?t:Object.assign({},"object"==typeof t&&t,{default:t})}).then(function(t){return e(t)})})})}),l("Skin","Loading skin",["Scintillator"],function(e,n){return e.load(e.getSkinUrl({displayMode:t.displayMode}),n)}),l("SkinContext",null,["Scintillator","Skin"],function(t,e){return new t.Context(e)}),e.progress&&(e.progress.current&&l.bar("Loading package",e.progress.current),e.progress.all&&l.bar("Loading song packages",e.progress.all)),l("Notechart","Loading "+t.bms.name,[],u.default.wrap(regeneratorRuntime.mark(function e(n){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new i.default,e.next=3,y.read(n);case 3:return o=e.sent,e.next=6,r.load(o,t.bms,t.options.players[0]);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}))),l("EyecatchImage",null,["Notechart"],function(t){return(0,v.default)(e,t.eyecatchImage)}),l("BackgroundImage",null,["Notechart"],function(t){return(0,v.default)(e,t.backgroundImage)});var m=new o.default,b=new o.default;return l.bar("Loading audio",m),l.bar("Decoding audio",b),l("SamplingMaster",null,[],function(){return new a.default}),l("Video",t.videoUrl?"Loading video":null,["Notechart"],function(e,n){return t.videoUrl?new Promise(function(e,r){var i=document.createElement("video");if(!i.canPlayType("video/webm"))return e(null);function o(t){i.buffered&&i.buffered.length&&i.duration&&n.report(i.buffered.end(0)-i.buffered.start(0),i.duration)}function a(){i.removeEventListener("progress",o,!0),i.removeEventListener("canplaythrough",u,!0),i.removeEventListener("error",s,!0),i.removeEventListener("abort",s,!0)}function u(){a();var r=i.duration||100;n.report(r,r),e({element:i,offset:t.videoOffset})}function s(){a(),console.warn("Cannot load video... Just skip it!"),e(null)}i.src=t.videoUrl,i.preload="auto",i.addEventListener("progress",o,!0),i.addEventListener("canplaythrough",u,!0),i.addEventListener("error",s,!0),i.addEventListener("abort",s,!0),i.load()}):Promise.resolve(null)}),l("Game",null,["Notechart"],function(e){return new c.default([e],t.options)}),l("GameDisplay",null,["Game","Skin","SkinContext","Video"],function(t,e,n,r){return new p.default({game:t,skin:e,context:n,backgroundImagePromise:g("BackgroundImage"),video:r})}),l("Samples",null,["SamplingMaster","Game"],function(t,n){s.default.receiveSongId(_);var r=new d.default(e,t);return r.loadFiles(n.samples,m,b)}),l("GameAudio",null,["Game","Samples","SamplingMaster"],function(t,e,n){return new f.default({game:t,samples:e,master:n})}),l("GameController",null,["Game","GameDisplay","GameAudio"],function(t,e,n){return new h.default({game:t,display:e,audio:n})}),g("GameController")})};var r=y(n(8)),i=y(n(1117)),o=y(n(4)),a=y(n(150)),u=y(n(88)),s=y(n(329)),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1112)),c=y(n(605)),f=y(n(1111)),h=y(n(1110)),p=y(n(601)),d=y(n(595)),v=y(n(1106));function y(t){return t&&t.__esModule?t:{default:t}}},113:function(t,e,n){"use strict";function r(t){return{as:function(e){return new Promise(function(n,r){var i=new FileReader;switch(i.onload=function(){n(i.result)},i.onerror=function(){r(new Error("Unable to read from Blob"))},e){case"arraybuffer":i.readAsArrayBuffer(t);break;case"text":i.readAsText(t)}})}}}Object.defineProperty(e,"__esModule",{value:!0}),e.readBlob=r,e.default=r},1158:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,'@charset "UTF-8";\n.LoadingSceneProgressBar {\n  border: 1px solid rgba(0, 0, 0, 0.6);\n  padding: 1px;\n}\n\n.LoadingSceneProgressBarのbar {\n  height: 8px;\n  background: rgba(0, 0, 0, 0.6);\n  width: 0%;\n}\n',""])},1159:function(t,e,n){var r=n(1158);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},1160:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(1159);var i=a(n(39)),o=a(n(41));function a(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default.Component),r(e,[{key:"render",value:function(){return i.default.createElement("div",{className:"LoadingSceneProgressBar"},i.default.createElement("div",{className:"LoadingSceneProgressBarのbar",style:{width:this.props.width}}))}}]),e}();u.propTypes={width:o.default.oneOfType([o.default.string,o.default.number]).isRequired},e.default=u},1161:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,'@charset "UTF-8";\n.LoadingSceneProgress {\n  color: #333;\n  font-size: 11px;\n}\n\n.LoadingSceneProgress .LoadingSceneProgressBar {\n  display: inline-block;\n  vertical-align: middle;\n  width: 48px;\n  margin-right: 4px;\n  position: relative;\n  top: -1px;\n}\n\n.LoadingSceneProgressのextra {\n  font-size: 83%;\n  opacity: 0.7;\n}\n',""])},1162:function(t,e,n){var r=n(1161);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},1163:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(1162);var i=u(n(39)),o=u(n(41)),a=u(n(1160));function u(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var l=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,u=Array(o),l=0;l<o;l++)u[l]=arguments[l];return n=r=s(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(u))),r.renderItem=function(t){var e=t.text,n=t.progressText,r=t.progress,o=Math.round(100*r||0).toString()+"%",u=n?" ("+n+")":"";return i.default.createElement("div",{key:e,className:"LoadingSceneProgressのitem"},i.default.createElement(a.default,{width:o}),e,i.default.createElement("span",{className:"LoadingSceneProgressのextra"},u))},s(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default.Component),r(e,[{key:"render",value:function(){var t=this;return i.default.createElement("div",{className:"LoadingSceneProgress"},this.props.tasks.value.map(function(e){return t.renderItem(e)}))}},{key:"componentDidMount",value:function(){var t=this;this._unsubscribe=this.props.tasks.watch(function(){return t.forceUpdate()})}},{key:"componentWillUnmount",value:function(){this._unsubscribe()}}]),e}();l.propTypes={tasks:o.default.object},e.default=l},1164:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,'@charset "UTF-8";\n.LoadingSceneSongInfo {\n  background: rgba(255, 255, 255, 0.96);\n  color: #191817;\n  text-align: center;\n  padding: 25px 0px;\n  -webkit-box-shadow: 0 2px 18px rgba(0, 0, 0, 0.2);\n          box-shadow: 0 2px 18px rgba(0, 0, 0, 0.2);\n}\n\n.LoadingSceneSongInfoのgenre {\n  font-size: 1.2rem;\n}\n\n.LoadingSceneSongInfoのtitle {\n  font-size: 3.2rem;\n  font-weight: bold;\n}\n\n.LoadingSceneSongInfoのsubtitle {\n  font-size: 2.4rem;\n}\n\n.LoadingSceneSongInfoのartist {\n  font-size: 1.6rem;\n  margin-top: 0.8ex;\n}\n\n.LoadingSceneSongInfoのsubartist {\n  font-size: 1rem;\n}\n',""])},1165:function(t,e,n){var r=n(1164);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},1166:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(1165);var i=u(n(39)),o=u(n(41)),a=n(165);function u(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default.Component),r(e,[{key:"render",value:function(){var t=this.props.song;return i.default.createElement("div",{className:"LoadingSceneSongInfo"},i.default.createElement("div",{className:"LoadingSceneSongInfoのgenre"},t.genre),i.default.createElement("div",{className:"LoadingSceneSongInfoのtitle"},t.title),(0,a.isTitleDisplayMode)()?null:t.subtitles.map(function(t){return i.default.createElement("div",{key:t,className:"LoadingSceneSongInfoのsubtitle"},t)}),i.default.createElement("div",{className:"LoadingSceneSongInfoのartist"},t.artist),t.subartists.map(function(t){return i.default.createElement("div",{key:t,className:"LoadingSceneSongInfoのsubartist"},t)}))}}]),e}();s.propTypes={song:o.default.shape({title:o.default.string,artist:o.default.string,genre:o.default.string,subtitles:o.default.arrayOf(o.default.string),subartists:o.default.arrayOf(o.default.string),difficulty:o.default.number,level:o.default.number}).isRequired},e.default=s},1167:function(t,e,n){var r=n(120);(t.exports=n(1)(!1)).push([t.i,'@charset "UTF-8";\n.LoadingScene {\n  background: url('+r(n(734))+") center no-repeat;\n  background-size: cover;\n}\n\n.LoadingSceneのinfo {\n  position: absolute;\n  top: 40%;\n  left: 0;\n  right: 0;\n  -webkit-transform: translateY(-50%);\n          transform: translateY(-50%);\n}\n\n.LoadingScene .LoadingSceneSongInfo {\n  -webkit-animation: loading-scene--loading-scene-song-info--animation 1s ease;\n          animation: loading-scene--loading-scene-song-info--animation 1s ease;\n}\n\n.LoadingScene .LoadingSceneProgress {\n  position: absolute;\n  bottom: 10px;\n  left: 10px;\n}\n\n.LoadingSceneのimage {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n\n.LoadingSceneのimage img {\n  width: 100%;\n  height: 100%;\n  display: block;\n  -o-object-fit: cover;\n     object-fit: cover;\n  -webkit-animation: loading-scene--eyecatch-fade 0.8s;\n          animation: loading-scene--eyecatch-fade 0.8s;\n}\n\n.LoadingSceneのflash {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  opacity: 0;\n  pointer-events: none;\n  background: white;\n  -webkit-animation: loading-scene--flash-animation 0.8s ease-out;\n          animation: loading-scene--flash-animation 0.8s ease-out;\n}\n\n.LoadingSceneのcover {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  opacity: 0;\n  pointer-events: none;\n  background: black;\n}\n\n.Scene.is-exiting .LoadingSceneのinfo {\n  -webkit-animation: loading-scene--info-exit 0.3s linear;\n          animation: loading-scene--info-exit 0.3s linear;\n}\n\n.Scene.is-exiting .LoadingSceneのflash {\n  -webkit-animation: loading-scene--flash-exit 0.3s ease;\n          animation: loading-scene--flash-exit 0.3s ease;\n}\n\n.Scene.is-exiting .LoadingSceneのcover {\n  -webkit-animation: loading-scene--cover-exit 0.3s linear;\n          animation: loading-scene--cover-exit 0.3s linear;\n  opacity: 1;\n}\n\n@-webkit-keyframes loading-scene--eyecatch-fade {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n@keyframes loading-scene--eyecatch-fade {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n@-webkit-keyframes loading-scene--loading-scene-song-info--animation {\n  0% {\n    -webkit-transform: scale(1.5, 0.02);\n            transform: scale(1.5, 0.02);\n  }\n  100% {\n    -webkit-transform: scale(1, 1);\n            transform: scale(1, 1);\n  }\n}\n\n@keyframes loading-scene--loading-scene-song-info--animation {\n  0% {\n    -webkit-transform: scale(1.5, 0.02);\n            transform: scale(1.5, 0.02);\n  }\n  100% {\n    -webkit-transform: scale(1, 1);\n            transform: scale(1, 1);\n  }\n}\n\n@-webkit-keyframes loading-scene--info-exit {\n  0% {\n    -webkit-transform: translateY(-50%) scale(1, 1);\n            transform: translateY(-50%) scale(1, 1);\n  }\n  100% {\n    -webkit-transform: translateY(-50%) scale(2, 2);\n            transform: translateY(-50%) scale(2, 2);\n  }\n}\n\n@keyframes loading-scene--info-exit {\n  0% {\n    -webkit-transform: translateY(-50%) scale(1, 1);\n            transform: translateY(-50%) scale(1, 1);\n  }\n  100% {\n    -webkit-transform: translateY(-50%) scale(2, 2);\n            transform: translateY(-50%) scale(2, 2);\n  }\n}\n\n@-webkit-keyframes loading-scene--cover-exit {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n@keyframes loading-scene--cover-exit {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n@-webkit-keyframes loading-scene--flash-animation {\n  0% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n\n@keyframes loading-scene--flash-animation {\n  0% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n\n@-webkit-keyframes loading-scene--flash-exit {\n  0% {\n    opacity: 0.5;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n\n@keyframes loading-scene--flash-exit {\n  0% {\n    opacity: 0.5;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n",""])},1168:function(t,e,n){var r=n(1167);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},1169:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(1168);var i=c(n(39)),o=c(n(74)),a=c(n(41)),u=c(n(195)),s=c(n(1166)),l=c(n(1163));function c(t){return t&&t.__esModule?t:{default:t}}var f=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default.Component),r(e,[{key:"render",value:function(){return i.default.createElement(u.default,{className:"LoadingScene",ref:"scene"},i.default.createElement("div",{className:"LoadingSceneのimage",ref:"eyecatch"}),i.default.createElement("div",{className:"LoadingSceneのinfo"},i.default.createElement(s.default,{song:this.props.song})),i.default.createElement(l.default,{tasks:this.props.tasks}),i.default.createElement("div",{className:"LoadingSceneのflash"}),i.default.createElement("div",{className:"LoadingSceneのcover"}))}},{key:"componentDidMount",value:function(){var t=this;this.props.eyecatchImagePromise&&this.props.eyecatchImagePromise.then(function(e){o.default.findDOMNode(t.refs.eyecatch).appendChild(e)}),this.props.registerTeardownCallback(function(){return o.default.findDOMNode(t.refs.scene).classList.add("is-exiting"),Promise.delay(500)})}}]),e}();f.propTypes={song:a.default.shape({title:a.default.string,artist:a.default.string,genre:a.default.string,subtitles:a.default.arrayOf(a.default.string),subartists:a.default.arrayOf(a.default.string),difficulty:a.default.number,level:a.default.number}),tasks:a.default.object,eyecatchImagePromise:a.default.object,registerTeardownCallback:a.default.func},e.default=f},1170:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return function(e){var n=function(){return!1};return(0,o.default)(window).on("touchstart",n),function(t,e){var n=t.view,r=t.wrapper,i=n.width,a=n.height;function u(){var t=Math.min(window.innerWidth/i,window.innerHeight/a);n.style.width=Math.round(i*t)+"px",n.style.height=Math.round(a*t)+"px",r.style.width=Math.round(i*t)+"px",r.style.height=Math.round(a*t)+"px";var e=(window.innerHeight-a*t)/2;r.style.marginTop=Math.round(e)+"px"}e.appendChild(r),u(),(0,o.default)(window).on("resize",u)}(t,e),{teardown:function(){(0,o.default)(window).off("touchstart",n)}}}};var r,i=n(76),o=(r=i)&&r.__esModule?r:{default:r}},120:function(t,e){t.exports=function(t){return"string"!=typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)?'"'+t.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':t)}},126:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fixed=function(t,e){if(!e)return function(){};var n=0;return e.report(0,t),function(r){return e.report(++n,t,r)}},e.atomic=function(t,e){return t?Promise.resolve(e).tap(function(e){e&&e.byteLength?(t.formatter=r.BYTES_FORMATTER,t.report(e.byteLength,e.byteLength)):t.report(1,1)}):e},e.wrapPromise=function(t,e){var n=0,r=0;return function(){return t.report(n,++r),Promise.resolve(e.apply(this,arguments)).tap(function(){return t.report(++n,r)})}},e.bind=function(t,e){return t.watch(function(){return e.report(t.current,t.total,t.extra)})},e.simultaneous=function(t){var e=[],n=void 0,r=void 0;function i(){n&&t.report(n.current,n.total,n.extra),e.length>0&&(!n||n.progress>=1)&&function(t){if(n===t)return;r&&(r(),r=null);(n=t)&&(r=n.watch(i))}(e.shift())}return{add:function(t){e.push(t),i()}}};var r=n(89)},150:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SamplingMaster=e.FADE_LENGTH=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.canPlay=function(t){return"probably"===l.canPlayType(t)},e.unmuteAudio=d;var i=a(n(172)),o=a(n(113));function a(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=e.FADE_LENGTH=.001,l=document.createElement("audio");var c=e.SamplingMaster=function(){function t(e){u(this,t),this._audioContext=e||i.default,this._samples=[],this._groups=[],this._instances=new Set,this._destination=this._audioContext.destination}return r(t,[{key:"unmute",value:function(){d(this._audioContext)}},{key:"destroy",value:function(){if(!this._destroyed){this._destroyed=!0;var t=!0,e=!1,n=void 0;try{for(var r,i=this._samples[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.destroy()}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}var o=!0,a=!1,u=void 0;try{for(var s,l=this._instances[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){s.value.destroy()}}catch(t){a=!0,u=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw u}}this._samples=null,this._instances=null}}},{key:"decode",value:function(t){var e=this;return this._coerceToArrayBuffer(t).then(function(t){return e._decodeAudio(t)})}},{key:"sample",value:function(t){var e=this;return(t.numberOfChannels?Promise.resolve(t):e.decode(t)).then(function(t){if(e._destroyed)throw new Error("SamplingMaster already destroyed!");var n=new h(e,t);return e._samples.push(n),n})}},{key:"group",value:function(t){var e=new f(this,t);return this._groups.push(e),e}},{key:"_coerceToArrayBuffer",value:function(t){return t instanceof ArrayBuffer?Promise.resolve(t):(0,o.default)(t).as("arraybuffer")}},{key:"_decodeAudio",value:function(t){var e=this;return new Promise(function(n,r){e.audioContext.decodeAudioData(t,function(t){n(t)},function(t){r(new Error("Unable to decode audio: "+t))})})}},{key:"_startPlaying",value:function(t){this._instances.add(t)}},{key:"_stoppedPlaying",value:function(t){this._instances.delete(t)}},{key:"audioContext",get:function(){return this._audioContext}},{key:"destination",get:function(){return this._destination}}]),t}(),f=function(){function t(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).volume;u(this,t),this._master=e,this._gain=this._master.audioContext.createGain(),null!=n&&(this._gain.gain.value=n),this._gain.connect(this._master.destination)}return r(t,[{key:"destroy",value:function(){this._gain.disconnect(),this._gain=null}},{key:"destination",get:function(){return this._gain}}]),t}(),h=function(){function t(e,n){u(this,t),this._master=e,this._buffer=n}return r(t,[{key:"play",value:function(t,e){return new p(this._master,this._buffer,t,e)}},{key:"destroy",value:function(){this._master=null,this._buffer=null}}]),t}(),p=function(){function t(e,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};u(this,t),r=r||0,this._master=e;var a=e.audioContext,l=a.createBufferSource();l.buffer=n,l.onended=function(){return i.stop()};var c=a.createGain();l.connect(c);var f=o.node||o.group&&o.group.destination||e.destination;c.connect(f),this._source=l,this._gain=this.TEST_node=c;var h=r?Math.max(0,a.currentTime+r):0,p=o.start||0,d=p>0,v=!1;if(d&&c.gain.setValueAtTime(0,0),void 0!==o.end){var y=Math.max(o.end-p,0);l.start(h,p,y+s),v=a.currentTime+r+y}else l.start(h,p);d&&(c.gain.setValueAtTime(0,a.currentTime+r),c.gain.linearRampToValueAtTime(1,a.currentTime+r+s)),!1!==v&&(c.gain.setValueAtTime(1,v),c.gain.linearRampToValueAtTime(0,v+s)),this._master._startPlaying(this)}return r(t,[{key:"stop",value:function(){this._source&&(this._source.stop(0),this._source.disconnect(),this._gain.disconnect(),this._source=null,this._gain=null,this._master._stoppedPlaying(this),this.onstop&&this.onstop())}},{key:"bad",value:function(){this._source&&(this._source.playbackRate.value=Math.random()<.5?Math.pow(2,1/24):Math.pow(2,-1/24))}},{key:"destroy",value:function(){this.stop()}}]),t}();function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.default,e=t.createGain(),n=t.createOscillator();n.frequency.value=440,n.start(t.currentTime+.1),n.stop(t.currentTime+.1),e.connect(t.destination),e.disconnect();try{t.resume()}catch(t){console.error("[sampling-master] Cannot resume AudioContext",t)}}e.default=c},153:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.now=void 0;var r,i=n(480),o=(r=i)&&r.__esModule?r:{default:r};var a=t.forModule("timesynchro"),u=void 0,s=0;window.performance&&"function"==typeof window.performance.now?e.now=u=function(){return window.performance.now()}:e.now=u=function(){return Date.now()},u.synchronize=function(t){function e(t){s=t+Date.now()-u()}(0,o.default)(t,function(t,n){t?a.error("Cannot synchronize time: "+t):(e(n),a.info("Synchronized time with global server! Offset = "+s))},e)},u.synchronized=function(){var t=s;return function(){return u()+t}},e.now=u,e.default=u}).call(this,n(289))},154:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=document.querySelector("#scene-root")},1546:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,".GameShellScene {\n  margin: 20px auto;\n  background: #353433;\n  border: 1px solid #555453;\n  padding: 15px;\n  max-width: 720px;\n}\n\n.GameShellScene .drop-zone {\n  border: 2px dashed #555453;\n  padding: 5px;\n}\n\n.GameShellScene .drop-zone a.is-active {\n  font-weight: bold;\n}\n\n.GameShellScene .drop-zone-hint {\n  padding: 10px;\n  text-align: center;\n  color: #8b8685;\n}\n\n.GameShellScene form > div {\n  margin-bottom: 1em;\n}\n\n.GameShellScene form > div.text .label {\n  display: block;\n  color: #8b8685;\n  font-weight: bold;\n  font-size: 0.8em;\n  margin: 0;\n  margin-bottom: 0.5ex;\n}\n\n.GameShellScene form > div.text input {\n  font: inherit;\n  display: block;\n  width: 100%;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  border: 1px inset #555453;\n  background: #252423;\n  color: #bfb;\n}\n\n.GameShellScene form > div.text input:disabled {\n  opacity: 0.2;\n}\n\n.GameShellScene form > div.checkbox input {\n  margin-right: 1ex;\n}\n\n.GameShellScene form > div.radio > h3 {\n  display: block;\n  color: #8b8685;\n  font-weight: bold;\n  font-size: 0.8em;\n  margin: 0;\n  margin-bottom: 0.5ex;\n}\n\n.GameShellScene form > div.radio > label {\n  display: block;\n}\n\n.GameShellScene form > div.radio input {\n  margin-right: 1ex;\n}\n\n.GameShellScene button {\n  background: #8b8685;\n  border: 1px outset #aba6a5;\n  font: inherit;\n  font-size: 1.5em;\n  color: #e9e8e7;\n  display: block;\n  width: 100%;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n\n.GameShellScene a {\n  color: #fed;\n}\n",""])},1547:function(t,e,n){var r=n(1546);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},1548:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(1547);var i=s(n(39)),o=s(n(41)),a=s(n(318)),u=s(n(56));function s(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=function(t){function e(t){l(this,e);var n=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.handleDrop=function(t){t.preventDefault();var e=t.nativeEvent,r=new a.default(e);r.fileList.then(function(t){return t.filter(function(t){return/\.(bms|bme|bml)$/i.test(t)})}).map(function(t){return r.file(t).then(function(e){return{name:t,resource:e}})}).then(function(t){n.setState({files:t,resources:r})}).catch(function(e){throw"FileError"===e.constructor.name?new Error("File Error code "+t.code):e}).done()},n.handleItemClick=function(t){return function(){n.props.onSelect(n.state.resources,t.resource)}},n.handleClear=function(){n.props.onSelect(null,null)},n.state={files:[]},n}return f(e,i.default.Component),r(e,[{key:"render",value:function(){var t=this,e=this.state.files;return i.default.createElement("div",{className:"drop-zone"},e.length?i.default.createElement("ul",null,e.map(function(e){return i.default.createElement("li",null,i.default.createElement("a",{href:"javascript://",onClick:t.handleItemClick,className:(0,u.default)({"is-active":e.resource===t.props.selectedResource})},e.name))}),this.props.selectedResource?i.default.createElement("li",null,i.default.createElement("a",{href:"javascript://",onClick:this.handleClear},"Clear")):null):i.default.createElement("div",{className:"drop-zone-hint"},"Drop BMS folder here",i.default.createElement("br",null),"(only works on Google Chrome)"))}}]),e}();h.propTypes={selectedResource:o.default.any,onSelect:o.default.func};var p=function(t){function e(t){l(this,e);var n=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.submit=function(t){t.preventDefault(),n.props.play(n.state.options)},n.bindOption=function(t){return function(e){t(n.state.options,e.target.value),n.forceUpdate()}},n.handleDragOver=function(t){t.preventDefault()},n.handleDrop=function(t){t.preventDefault(),n.refs.dropzone.handleDrop(t)},n.handleSelectFile=function(t,e){n.setState({options:Object.assign(n.state.options,{resources:t,resource:e})}),n.forceUpdate()},n.state={options:n.props.options},n}return f(e,i.default.Component),r(e,[{key:"render",value:function(){var t=this,e=this.state.options;return i.default.createElement("div",{className:"GameShellScene",onDragOver:this.handleDragOver,onDrop:this.handleDrop},i.default.createElement("h1",null,"Bemuse Game Shell"),i.default.createElement("p",null,"This tool is intended for developers testing the game."),i.default.createElement("form",{onSubmit:this.submit},i.default.createElement("div",{className:"text"},i.default.createElement("label",null,i.default.createElement("span",{className:"label"},"BMS URL:"),i.default.createElement("input",{type:"text",disabled:e.resource,onChange:this.bindOption(function(t,e){return t.url=e}),value:e.url}))),i.default.createElement("div",{className:"text"},i.default.createElement("label",null,i.default.createElement("span",{className:"label"},"-or- Drop BMS folder here"),i.default.createElement(h,{ref:"dropzone",selectedResource:e.resource,onSelect:this.handleSelectFile}))),i.default.createElement("div",{className:"text"},i.default.createElement("label",null,i.default.createElement("span",{className:"label"},"Audio-Input Latency"),i.default.createElement("input",{type:"text",onChange:this.bindOption(function(t,e){return t.game.audioInputLatency=e}),value:e.game.audioInputLatency}))),i.default.createElement("div",{className:"text"},i.default.createElement("label",null,i.default.createElement("span",{className:"label"},"HI-SPEED:"),i.default.createElement("input",{type:"text",onChange:this.bindOption(function(t,e){return t.players[0].speed=e}),value:e.players[0].speed}))),i.default.createElement("div",{className:"radio"},i.default.createElement("h3",null,"Placement"),["left","center","right"].map(function(n){return i.default.createElement("label",null,i.default.createElement("input",{type:"radio",value:n,onChange:t.bindOption(function(t,e){return t.players[0].placement=e}),checked:e.players[0].placement===n}),i.default.createElement("span",{className:"label"},n))})),i.default.createElement("button",{type:"submit"},"Play")))}}]),e}();p.propTypes={options:o.default.object,play:o.default.func},e.default=p},162:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.download=i;var r=n(89);function i(t){return{as:function(e,n){return new Promise(function(i,o){var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType=e,a.onload=function(){200==+a.status?i(a.response):o(new Error("Unable to download "+t+": HTTP "+a.status))},a.onerror=function(){return o(new Error("Unable to download "+t))},n&&(n.formatter=r.BYTES_FORMATTER,a.onprogress=function(t){return n.report(t.loaded,t.total)}),a.send(null)})}}}e.default=i},165:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.shouldShowOptions=function(){return"1"===o.default.BEMUSE_SHOW_OPTIONS},e.shouldEnableBenchmark=function(){return"1"===o.default.BEMUSE_BENCHMARK},e.shouldDisableFullScreen=function(){return"1"===o.default.BEMUSE_NO_FULLSCREEN},e.shouldShowAbout=function(){return"1"===o.default.BEMUSE_SHOW_ABOUT},e.shouldShowModeSelect=function(){return"1"===o.default.BEMUSE_SHOW_MODE_SELECT},e.isTitleDisplayMode=function(){return"1"===o.default.BEMUSE_TITLE_DISPLAY};var r,i=n(3),o=(r=i)&&r.__esModule?r:{default:r}},170:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getRow=i,e.getTouchedColumn=function(t,e){for(var n=.75,o=1,a=void 0,u=void 0,s=0;s<8;s++)(u=i(a=(n+o)/2)).y>e?o=a:n=a;if(a<.8)return null;var l=640+u.projection*-r.w,c=640+u.projection*r.w,f=Math.floor((t-l)/(c-l)*7);if(f>=-1&&f<=7)return f<0&&(f=0),f>6&&(f=6),String(f+1);return null};var r={cx:1024,cy:-975,r:1024,t0:3.922,t1:4.555,p:960,w:60};function i(t){var e=Math.max(0,t-1);t<0&&(t=0),t>1&&(t=1);var n=r.t0+(r.t1-r.t0)*t,i=r.cx+Math.cos(n)*r.r,o=r.cy-Math.sin(n)*r.r,a=r.p/(r.p-i);return{y:o*a+360+2048*e,projection:a}}e.PLAY_AREA_WIDTH=r.w},171:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(153)),i=n(165),o=s(n(39)),a=s(n(74)),u=s(n(328));function s(t){return t&&t.__esModule?t:{default:t}}function l(t){return t.toFixed(2)+"ms"}e.default=window.BEMUSE_BENCHMARK=(0,i.shouldEnableBenchmark)()?new function(){var t={},e={enabled:!0,stats:t,wrap:function(e,n){return function(){try{var i=(0,r.default)();return n.apply(this,arguments)}finally{var o=(0,r.default)();(t[e]||(t[e]=new function(){var t=0,e=0,n=0,i=[],o=0,a=0;return{push:function(u){var s=(0,r.default)();for(n=(t+=u)/(e+=1),o+=u,i.push({delta:u,time:s});i[0]&&i[0].time<s-1e3;)o-=i.shift().delta;a=o/i.length},toString:function(){return l(n)+" / "+l(a)}}}(e))).push(o-i)}}},benchmark:function(t,e,n){e[n]=this.wrap(t,e[n])},toString:function(){var e=[];return Object.keys(t).forEach(function(n){e.push("- "+n+": "+t[n])}),e.join("\n")}},n=document.createElement("div");return n.setAttribute("style","position:fixed;top:10px;right:10px;z-index:99999"),document.body.appendChild(n),a.default.render(o.default.createElement(u.default,{bench:e}),n),e}:new function(){return{enabled:!1,wrap:function(t,e){return e}}}},172:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(256),o=(r=i)&&r.__esModule?r:{default:r};e.default=(0,o.default)({latencyHint:"interaction"})},188:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GameEvent=void 0;var r,i=n(240),o=(r=i)&&r.__esModule?r:{default:r};var a=e.GameEvent=new o.default({beat:Number,time:Number,position:Number});e.default=a},189:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.URLResource=void 0;var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(162),a=(r=o)&&r.__esModule?r:{default:r},u=n(339);var s=e.URLResource=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._url=e}return i(t,[{key:"read",value:function(t){return(0,a.default)(this._url).as("arraybuffer",t)}},{key:"resolveUrl",value:function(){return Promise.resolve(this._url)}},{key:"name",get:function(){return(0,u.basename)(this._url)}}]),t}();e.default=s},190:function(t,e,n){"use strict";var r=n(273),i=n(340);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=m,e.resolve=function(t,e){return m(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?m(t,!1,!0).resolveObject(e):e},e.format=function(t){i.isString(t)&&(t=m(t));return t instanceof o?t.format():o.prototype.format.call(t)},e.Url=o;var a=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(l),f=["%","/","?",";","#"].concat(c),h=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=n(5);function m(t,e,n){if(t&&i.isObject(t)&&t instanceof o)return t;var r=new o;return r.parse(t,e,n),r}o.prototype.parse=function(t,e,n){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),u=-1!==o&&o<t.indexOf("#")?"?":"#",l=t.split(u);l[0]=l[0].replace(/\\/g,"/");var m=t=l.join(u);if(m=m.trim(),!n&&1===t.split("#").length){var b=s.exec(m);if(b)return this.path=m,this.href=m,this.pathname=b[1],b[2]?(this.search=b[2],this.query=e?g.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var w=a.exec(m);if(w){var k=(w=w[0]).toLowerCase();this.protocol=k,m=m.substr(w.length)}if(n||w||m.match(/^\/\/[^@\/]+@[^@\/]+/)){var x="//"===m.substr(0,2);!x||w&&y[w]||(m=m.substr(2),this.slashes=!0)}if(!y[w]&&(x||w&&!_[w])){for(var E,S,j=-1,C=0;C<h.length;C++){-1!==(T=m.indexOf(h[C]))&&(-1===j||T<j)&&(j=T)}-1!==(S=-1===j?m.lastIndexOf("@"):m.lastIndexOf("@",j))&&(E=m.slice(0,S),m=m.slice(S+1),this.auth=decodeURIComponent(E)),j=-1;for(C=0;C<f.length;C++){var T;-1!==(T=m.indexOf(f[C]))&&(-1===j||T<j)&&(j=T)}-1===j&&(j=m.length),this.host=m.slice(0,j),m=m.slice(j),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var A=this.hostname.split(/\./),O=(C=0,A.length);C<O;C++){var M=A[C];if(M&&!M.match(p)){for(var R="",F=0,I=M.length;F<I;F++)M.charCodeAt(F)>127?R+="x":R+=M[F];if(!R.match(p)){var B=A.slice(0,C),L=A.slice(C+1),N=M.match(d);N&&(B.push(N[1]),L.unshift(N[2])),L.length&&(m="/"+L.join(".")+m),this.hostname=B.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=r.toASCII(this.hostname));var U=this.port?":"+this.port:"",D=this.hostname||"";this.host=D+U,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==m[0]&&(m="/"+m))}if(!v[k])for(C=0,O=c.length;C<O;C++){var G=c[C];if(-1!==m.indexOf(G)){var z=encodeURIComponent(G);z===G&&(z=escape(G)),m=m.split(G).join(z)}}var H=m.indexOf("#");-1!==H&&(this.hash=m.substr(H),m=m.slice(0,H));var V=m.indexOf("?");if(-1!==V?(this.search=m.substr(V),this.query=m.substr(V+1),e&&(this.query=g.parse(this.query)),m=m.slice(0,V)):e&&(this.search="",this.query={}),m&&(this.pathname=m),_[k]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var Y=this.search||"";this.path=U+Y}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,a="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(a=g.stringify(this.query));var u=this.search||a&&"?"+a||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||_[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),u&&"?"!==u.charAt(0)&&(u="?"+u),e+o+(n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(u=u.replace("#","%23"))+r},o.prototype.resolve=function(t){return this.resolveObject(m(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(i.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var n=new o,r=Object.keys(this),a=0;a<r.length;a++){var u=r[a];n[u]=this[u]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),l=0;l<s.length;l++){var c=s[l];"protocol"!==c&&(n[c]=t[c])}return _[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!_[t.protocol]){for(var f=Object.keys(t),h=0;h<f.length;h++){var p=f[h];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||y[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var v=n.pathname||"",g=n.search||"";n.path=v+g}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var m=n.pathname&&"/"===n.pathname.charAt(0),b=t.host||t.pathname&&"/"===t.pathname.charAt(0),w=b||m||n.host&&t.pathname,k=w,x=n.pathname&&n.pathname.split("/")||[],E=(d=t.pathname&&t.pathname.split("/")||[],n.protocol&&!_[n.protocol]);if(E&&(n.hostname="",n.port=null,n.host&&(""===x[0]?x[0]=n.host:x.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),w=w&&(""===d[0]||""===x[0])),b)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,x=d;else if(d.length)x||(x=[]),x.pop(),x=x.concat(d),n.search=t.search,n.query=t.query;else if(!i.isNullOrUndefined(t.search)){if(E)n.hostname=n.host=x.shift(),(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.host=n.hostname=P.shift());return n.search=t.search,n.query=t.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!x.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var S=x.slice(-1)[0],j=(n.host||t.host||x.length>1)&&("."===S||".."===S)||""===S,C=0,T=x.length;T>=0;T--)"."===(S=x[T])?x.splice(T,1):".."===S?(x.splice(T,1),C++):C&&(x.splice(T,1),C--);if(!w&&!k)for(;C--;C)x.unshift("..");!w||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),j&&"/"!==x.join("/").substr(-1)&&x.push("");var P,A=""===x[0]||x[0]&&"/"===x[0].charAt(0);E&&(n.hostname=n.host=A?"":x.length?x.shift():"",(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.host=n.hostname=P.shift()));return(w=w||n.host&&x.length)&&!A&&x.unshift(""),x.length?n.pathname=x.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var t=this.host,e=u.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},195:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(684);var i=u(n(56)),o=u(n(39)),a=u(n(41));function u(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default.Component),r(e,[{key:"render",value:function(){return o.default.createElement("div",{className:(0,i.default)("Scene",this.props.className),onDragEnter:this.props.onDragEnter},this.props.children)}}]),e}();s.propTypes={className:a.default.string,children:a.default.node,onDragEnter:a.default.func},e.default=s},230:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.instance=e.SceneManager=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=s(n(88)),o=s(n(39)),a=s(n(74)),u=s(n(154));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.SceneManager=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._transitioning=!1,this._stack=[]}return r(t,[{key:"display",value:function(t){return this._transitionTo(function(){return t})}},{key:"push",value:function(t){var e=this,n=this.currentScene;return this._transitionTo(function(){return e._stack.push(n),t})}},{key:"pop",value:function(){var t=this;return this._transitionTo(function(){return t._stack.pop()})}},{key:"_transitionTo",value:function(t){return(0,i.default)(regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._transitioning){e.next=2;break}throw new Error("Scene is transitioning!");case 2:if(e.prev=2,this._transitioning=!0,!this.currentSceneInstance){e.next=8;break}return e.next=7,Promise.resolve(this.currentSceneInstance.teardown());case 7:c(this.currentElement);case 8:"function"!=typeof(n=t())&&(n=new h(n,this.ReactSceneContainer)),(r=document.createElement("div")).className="scene-manager--scene",u.default.appendChild(r),this.currentElement=r,this.currentScene=n,this.currentSceneInstance=n(r);case 16:return e.prev=16,this._transitioning=!1,e.finish(16);case 19:case"end":return e.stop()}},e,this,[[2,,16,19]])}).bind(this))}}]),t}();function c(t){t&&t.parentNode===u.default&&u.default.removeChild(t)}var f=e.instance=new l;function h(t,e){return function(n){var r=function(){},i=o.default.cloneElement(t,{scene:t,registerTeardownCallback:function(t){r=t}}),u=e?o.default.createElement(e,null,i):i;return a.default.render(u,n),{teardown:function(){return Promise.try(function(){return r()}).finally(function(){a.default.unmountComponentAtNode(n)})}}}}e.default=f},239:function(t,e,n){var r=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new i(r.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new i(r.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(330),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},254:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Notechart=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=s(n(43)),o=s(n(119)),a=(s(n(103)),s(n(188))),u=s(n(332));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.Notechart=function(){function t(e){var n=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=e.notes,a=e.timing,u=e.keysounds,s=e.songInfo,l=e.positioning,c=e.spacing,f=e.barLines,h=e.images,p=e.expertJudgmentWindow;(0,o.default)(i,'Expected "data.notes"'),(0,o.default)(a,'Expected "data.timing"'),(0,o.default)(u,'Expected "data.keysounds"'),(0,o.default)(s,'Expected "data.songInfo"'),(0,o.default)(l,'Expected "data.positioning"'),(0,o.default)(c,'Expected "data.spacing"'),(0,o.default)(f,'Expected "data.barLines"'),this.expertJudgmentWindow=p,i=this._preTransform(i,r),this._timing=a,this._positioning=l,this._spacing=c,this._keysounds=u,this._duration=0,this._notes=this._generatePlayableNotesFromBMS(i),this._autos=this._generateAutoKeysoundEventsFromBMS(i),this._barLines=this._generateBarLineEvents(f),this._samples=this._generateKeysoundFiles(u),this._infos=new Map(this._notes.map(function(t){return[t,n._getNoteInfo(t)]})),this._songInfo=s,this._images=h}return r(t,[{key:"info",value:function(t){return this._infos.get(t)}},{key:"beatToSeconds",value:function(t){return this._timing.beatToSeconds(t)}},{key:"beatToPosition",value:function(t){return this._positioning.position(t)}},{key:"secondsToBeat",value:function(t){return this._timing.secondsToBeat(t)}},{key:"secondsToPosition",value:function(t){return this.beatToPosition(this.secondsToBeat(t))}},{key:"bpmAtBeat",value:function(t){return this._timing.bpmAtBeat(t)}},{key:"scrollSpeedAtBeat",value:function(t){return this._positioning.speed(t)}},{key:"spacingAtBeat",value:function(t){return this._spacing.factor(t)}},{key:"_preTransform",value:function(t,e){var n,r,a=i.default.chain(t),u=function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;if("6"===a.column||"7"===a.column)return"7K"}}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}return"5K"}(t);return"off"===e.scratch&&(a=a.map(function(t){return t.column&&"SC"===t.column?Object.assign({},t,{column:null}):t})),"5K"===u&&(n=["1","2","3","4","5","6","7"],r=function(t){return function(e){if(e.column){var r=n.indexOf(e.column);if(r>-1){var i=r+t;(0,o.default)(i<n.length,"Weird. Columns must not shift beyond available column");var a=n[i];return Object.assign({},e,{column:a})}}return e}},"off"===e.scratch?a=a.map(r(1)):"right"===e.scratch&&(a=a.map(r(2)))),a.value()}},{key:"_generatePlayableNotesFromBMS",value:function(t){var e=this,n=1;return t.filter(function(t){return t.column}).map(function(t){var r=e._generateEvent(t.beat);return r.id=n++,r.column=t.column,r.keysound=t.keysound,r.keysoundStart=t.keysoundStart,r.keysoundEnd=t.keysoundEnd,e._updateDuration(r),void 0!==t.endBeat?(r.end=e._generateEvent(t.endBeat),e._updateDuration(r.end)):r.end=void 0,new u.default(r)})}},{key:"_updateDuration",value:function(t){t.time>this._duration&&(this._duration=t.time)}},{key:"_generateAutoKeysoundEventsFromBMS",value:function(t){var e=this;return t.filter(function(t){return!t.column}).map(function(t){var n=e._generateEvent(t.beat);return n.keysound=t.keysound,n.keysoundStart=t.keysoundStart,n.keysoundEnd=t.keysoundEnd,new a.default(n)})}},{key:"_generateKeysoundFiles",value:function(t){for(var e=new Set,n=[this.notes,this.autos],r=0;r<n.length;r++){var i=n[r],o=!0,a=!1,u=void 0;try{for(var s,l=i[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value,f=t.get(c.keysound);f&&e.add(f)}}catch(t){a=!0,u=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw u}}}return Array.from(e)}},{key:"_generateBarLineEvents",value:function(t){var e=this;return t.map(function(t){return e._generateEvent(t)})}},{key:"_generateEvent",value:function(t){return{beat:t,time:this.beatToSeconds(t),position:this.beatToPosition(t)}}},{key:"_getNoteInfo",value:function(t){return{combos:t.end?2:1}}},{key:"notes",get:function(){return this._notes}},{key:"autos",get:function(){return this._autos}},{key:"samples",get:function(){return this._samples}},{key:"keysounds",get:function(){return this._keysounds.all()}},{key:"barLines",get:function(){return this._barLines}},{key:"columns",get:function(){return["SC","1","2","3","4","5","6","7"]}},{key:"duration",get:function(){return this._duration}},{key:"songInfo",get:function(){return this._songInfo}},{key:"eyecatchImage",get:function(){return this._images&&this._images.eyecatch||"eyecatch_image.png"}},{key:"backgroundImage",get:function(){return this._images&&this._images.background||"back_image.png"}}]),t}();e.default=l},255:function(t,e,n){(function(e){var n;n="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(this,n(46))},256:function(t,e,n){"use strict";var r=n(255),i=r.OfflineAudioContext||r.webkitOfflineAudioContext,o=r.AudioContext||r.webkitAudioContext,a={};t.exports=function(t){if(!o)return null;"number"==typeof t&&(t={sampleRate:t});var e=t&&t.sampleRate;if(t&&t.offline)return i?new i(t.channels||2,t.length,e||44100):null;var n=a[e];if(n)return n;try{n=new o(t)}catch(t){n=new o}return a[n.sampleRate]=a[e]=n,n}},265:function(t,e,n){"use strict";function r(t){var e=Math.floor(t%60);return Math.floor(t/60)+":"+(e<10?"0":"")+e}Object.defineProperty(e,"__esModule",{value:!0}),e.formatTime=r,e.default=r},266:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getGauge=function(t){if("hope"===t)return e=void 0,n=void 0,r=void 0,{update:function(t){var i=t.stats,o=i.numJudgments/i.totalCombo,a=function(t,e,n){var r=e+(n-e)*o,a=i.maxPossibleScore;return Math.max(0,(a-t)/(r-t))},u=.5*a(5e5,555555,51e4);if(e=Math.min(1,u),r=Math.max(0,Math.min(1,u-1)),u>0)n=0;else{var s=a(45e4,5e5,5e5);n=s}},shouldDisplay:function(){return e>0||n>0},getPrimary:function(){return e},getSecondary:function(){return n},getExtra:function(){return r}};var e,n,r;return{update:function(){},shouldDisplay:function(){return!1},getPrimary:function(){return 0},getSecondary:function(){return 0},getExtra:function(){return 0}}}},267:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoteArea=void 0;var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(43),a=(r=o)&&r.__esModule?r:{default:r};var u=e.NoteArea=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._notes=a.default.sortBy(e,l),this._barLines=(0,a.default)(n).map("position").sortBy().value()}return i(t,[{key:"getVisibleNotes",value:function(t,e,n){var r=[],i=this._notes;n||(n=0);for(var o=0;o<i.length;o++){var a=i[o];if(a.end?!(a.position>e||a.end.position<t-n):!(a.position>e||a.position<t-n)){var u={note:a};if(a.end){var l=s(t,e,a.position),c=s(t,e,a.end.position);u.y=Math.min(l,c),u.height=Math.abs(l-c)}else u.y=s(t,e,a.position);r.push(u)}}return r}},{key:"getVisibleBarLines",value:function(t,e,n){return n||(n=0),this._barLines.filter(function(r){return t-n<=r&&r<=e}).map(function(n){return{id:n,y:s(t,e,n)}})}}]),t}();function s(t,e,n){return 1-(n-t)/(e-t)}function l(t){return t.position}e.default=u},268:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OmniInput=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.key川=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new l,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return c(a.default.fromBinder(function(n){var r=e.setInterval(function(){n(new a.default.Next(t.update()))},16);return function(){return e.clearInterval(r)}}))},e._key川ForUpdate川=c,e.getName=function(t){if(+t)return o.default.capitalize((0,i.default)(+t));var e=t.match(/^gamepad\.(\d+)\.axis\.(\d+)\.(\w+)/);if(e)return"Joy"+e[1]+" Axis"+e[2]+" ("+("positive"===e[3]?"+":"-")+")";var n=t.match(/^gamepad\.(\d+)\.button\.(\d+)/);if(n)return"Joy"+n[1]+" Btn"+n[2];var r=t.match(/^midi\.(.+)\.(\d+)\.(.+)$/);if(r){var a=r[3].split("."),u=r[1],s=f[u]||(f[u]=Object.keys(f).length+1),l="MIDI"+s+" Ch"+(+r[2]+1);if("note"===a[0]){var c=+a[1],h=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][c%12],p=Math.floor(c/12)-1;return l+" "+h+p}if("pitch"===a[0])return l+" Pitch"+("up"===a[1]?"+":"-");if("sustain"===a[0])return"Sustain";if("mod"===a[0])return"Mod"}return String(t).replace(/\./g," ")+"?"};var i=s(n(323)),o=s(n(43)),a=s(n(114)),u=s(n(322));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.OmniInput=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=(r.getMidi川||u.default)();this._window=n,this._exclusive=!!r.exclusive,this._disposables=[h(n,"keydown",function(t){return e._handleKeyDown(t)}),h(n,"keyup",function(t){return e._handleKeyUp(t)}),i.onValue(function(t){return e._handleMIDIMessage(t)})],this._status={}}return r(t,[{key:"_handleKeyDown",value:function(t){this._status[""+t.which]=!0,this._exclusive&&t.preventDefault()}},{key:"_handleKeyUp",value:function(t){this._status[""+t.which]=!1}},{key:"_handleMIDIMessage",value:function(t){var e=this;if(t&&t.data){var n=t.data,r="midi."+t.target.id+"."+(15&t.data[0]),i=function(t){e._status[r+".note."+n[1]]=t};if(128==(240&n[0]))i(!1);else if(144==(240&n[0]))n[2]>0?i(!0):i(!1);else if(176==(240&n[0]))64===n[1]?this._status[r+".sustain"]=n[2]>=64:1===n[1]&&(this._status[r+".mod"]=n[2]>=16);else if(224==(240&n[0])){var o=n[1]|n[2]<<7;this._status[r+".pitch.up"]=o>=8448,this._status[r+".pitch.down"]=o<7936}}}},{key:"_updateGamepads",value:function(){var t=this._window.navigator,e=t.getGamepads?t.getGamepads():t.webkitGetGamepads?t.webkitGetGamepads():[];if(e)for(var n=0;n<e.length;n++){var r=e[n];r&&this._updateGamepad(r)}}},{key:"_updateGamepad",value:function(t){for(var e="gamepad."+t.index,n=0;n<t.buttons.length;n++){var r=t.buttons[n];this._status[e+".button."+n]=r&&r.value>=.5}for(var i=0;i<t.axes.length;i++){var o=t.axes[i];this._status[e+".axis."+i+".positive"]=o>=.01,this._status[e+".axis."+i+".negative"]=o<=-.01}}},{key:"update",value:function(){return this._updateGamepads(),this._status}},{key:"dispose",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._disposables[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o()}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}}]),t}();function c(t){return t.map(function(t){return Object.keys(t).filter(function(e){return t[e]})}).diff([],function(t,e){return o.default.difference(e,t)}).flatMap(function(t){return a.default.fromArray(t)})}e.default=l;var f={};function h(t,e,n){return t.addEventListener(e,n),function(){t.removeEventListener(e,n)}}},269:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerStats=void 0;var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(77)),a=n(43),u=(r=a)&&r.__esModule?r:{default:r};function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l=function(t){return Math.floor(5e5*t)},c=function(t,e){return Math.floor(55555*t/e)},f=e.PlayerStats=function(){function t(e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.totalCombo=(0,u.default)(e.notes).map(function(t){return e.info(t).combos}).sum(),this.totalNotes=e.notes.length,this.combo=0,this.maxCombo=0,this.rawSumJudgmentWeight=0,this.rawTotalComboScore=this._calculateRawTotalComboScore(this.totalCombo),this._remainingMaxPossibleRawComboScore=this.rawTotalComboScore,this.rawSumComboScore=0,this.counts=(s(n={},o.MISSED,0),s(n,"1",0),s(n,"2",0),s(n,"3",0),s(n,"4",0),n),this.numJudgments=0,this.poor=!1,this._log=[],this.deltas=[]}return i(t,[{key:"handleJudgment",value:function(t){if(this.counts[t]+=1,this.numJudgments+=1,o.breaksCombo(t)){var e=this.totalCombo-this.numJudgments;this.combo=0,this.poor=!0,this._remainingMaxPossibleRawComboScore=this._calculateRawTotalComboScore(e)}else{this.combo+=1;var n=this._calculateRawComboScore(this.combo);this.rawSumComboScore+=n,this._remainingMaxPossibleRawComboScore-=n,this.poor=!1}this.rawSumJudgmentWeight+=o.weight(t),this.combo>this.maxCombo&&(this.maxCombo=this.combo),this._recordLog(t)}},{key:"handleDelta",value:function(t){this.deltas.push(t)}},{key:"_calculateRawTotalComboScore",value:function(t){for(var e=0,n=1;n<=t;n++)e+=this._calculateRawComboScore(n);return e}},{key:"_calculateRawComboScore",value:function(t){return 0===t?0:t<23?1:t<51?2:t<92?3:t<161?4:5}},{key:"_recordLog",value:function(t){var e=this._getLogCharacter(t);e&&(0===this._log.length||this._log[this._log.length-1].character!==e?this._log.push({character:e,count:1}):this._log[this._log.length-1].count+=1)}},{key:"_getLogCharacter",value:function(t){switch(t){case 1:return"A";case 2:return"B";case 3:return"C";case 4:return"D";case o.MISSED:return"M"}}},{key:"score",get:function(){return this.accuracyScore+this.comboScore}},{key:"accuracyScore",get:function(){return l(this.accuracy)}},{key:"comboScore",get:function(){return c(this.rawSumComboScore,this.rawTotalComboScore)}},{key:"maxPossibleScore",get:function(){return this.maxPossibleAccuracyScore+this.maxPossibleComboScore}},{key:"maxPossibleAccuracyScore",get:function(){var t=this.totalCombo-this.numJudgments,e=(this.rawSumJudgmentWeight+o.weight(1)*t)/(o.weight(1)*this.totalCombo);return l(e)}},{key:"maxPossibleComboScore",get:function(){var t=this.rawSumComboScore+this._remainingMaxPossibleRawComboScore;return c(t,this.rawTotalComboScore)}},{key:"accuracy",get:function(){return this.rawSumJudgmentWeight/(o.weight(1)*this.totalCombo)}},{key:"currentAccuracy",get:function(){return this.rawSumJudgmentWeight/(o.weight(1)*this.numJudgments||1)}},{key:"log",get:function(){return this._log.map(function(t){var e=t.character,n=t.count;return""+(n>1?n:"")+e}).join("")}}]),t}();e.default=f},270:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GameInput=void 0;var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=s(n(325)),a=s(n(43)),u=s(n(171));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.GameInput=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._controls=new Map,this._plugins=[]}return i(t,[{key:"update",value:function(){var t=new Map,e=!0,n=!1,i=void 0;try{for(var o,a=this._controls[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var u=o.value,s=r(u,2);s[0];s[1].changed=!1}}catch(t){n=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw i}}var l=!0,c=!1,f=void 0;try{for(var h,p=this._plugins[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var d=h.value,v=!0,y=!1,_=void 0;try{for(var g,m=d.get()[Symbol.iterator]();!(v=(g=m.next()).done);v=!0){var b=g.value,w=r(b,2),k=w[0],x=w[1];t.set(k,x)}}catch(t){y=!0,_=t}finally{try{!v&&m.return&&m.return()}finally{if(y)throw _}}}}catch(t){c=!0,f=t}finally{try{!l&&p.return&&p.return()}finally{if(c)throw f}}var E=!0,S=!1,j=void 0;try{for(var C,T=t[Symbol.iterator]();!(E=(C=T.next()).done);E=!0){var P=C.value,A=r(P,2),O=A[0],M=A[1],R=this.get(O);R.value!==M&&(R.changed=!0,R.value=M)}}catch(t){S=!0,j=t}finally{try{!E&&T.return&&T.return()}finally{if(S)throw j}}}},{key:"destroy",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._plugins[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.destroy()}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}},{key:"get",value:function(t){return this._controls.has(t)||this._controls.set(t,new o.default),this._controls.get(t)}},{key:"use",value:function(t){var e={},n="input:"+t.name;this._plugins.push({get:u.default.wrap(n,function(){var n=t.get(),r=[],i=!0,o=!1,u=void 0;try{for(var s,l=a.default.union(a.default.keys(n),a.default.keys(e))[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value,f=+e[c]||0,h=+n[c]||0;f!==h&&r.push([c,h]),e[c]=h}}catch(t){o=!0,u=t}finally{try{!i&&l.return&&l.return()}finally{if(o)throw u}}return r}),destroy:function(){return"function"!=typeof t.destroy||t.destroy()}})}}]),t}();e.default=l},271:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=e.Player=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._notechart=e,this._number=n,this._options={autosound:!!r.autosound,speed:+r.speed,placement:r.placement||"center",scratch:r.scratch||"left",input:r.input,laneCover:+r.laneCover||0,gauge:r.gauge,tutorial:!!r.tutorial}}return r(t,[{key:"notechart",get:function(){return this._notechart}},{key:"columns",get:function(){return this._notechart.columns}},{key:"number",get:function(){return this._number}},{key:"options",get:function(){return this._options}}]),t}();e.default=i},272:function(t,e,n){"use strict";(function(t){var r=n(241),i=n(338),o=n(337);function a(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=s.prototype:(null===t&&(t=new s(e)),t.length=e),t}function s(t,e,n){if(!(s.TYPED_ARRAY_SUPPORT||this instanceof s))return new s(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return l(this,t,e,n)}function l(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);s.TYPED_ARRAY_SUPPORT?(t=e).__proto__=s.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!s.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=u(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(s.isBuffer(e)){var n=0|p(e.length);return 0===(t=u(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?u(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(c(e),t=u(t,e<0?0:0|p(e)),!s.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|p(e.length);t=u(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(s.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return D(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(t).length;default:if(r)return D(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:_(t,e,n,r,i);if("number"==typeof e)return e&=255,s.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):_(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function _(t,e,n,r,i){var o,a=1,u=t.length,s=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,u/=2,s/=2,n/=2}function l(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var c=-1;for(o=n;o<u;o++)if(l(t,o)===l(e,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===s)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(n+s>u&&(n=u-s),o=n;o>=0;o--){for(var f=!0,h=0;h<s;h++)if(l(t,o+h)!==l(e,h)){f=!1;break}if(f)return o}return-1}function g(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var u=parseInt(e.substr(2*a,2),16);if(isNaN(u))return a;t[n+a]=u}return a}function m(t,e,n,r){return z(D(e,t.length-n),t,n,r)}function b(t,e,n,r){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return b(t,e,n,r)}function k(t,e,n,r){return z(G(e),t,n,r)}function x(t,e,n,r){return z(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function S(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,u,s,l=t[i],c=null,f=l>239?4:l>223?3:l>191?2:1;if(i+f<=n)switch(f){case 1:l<128&&(c=l);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&l)<<6|63&o)>127&&(c=s);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(s=(15&l)<<12|(63&o)<<6|63&a)>2047&&(s<55296||s>57343)&&(c=s);break;case 4:o=t[i+1],a=t[i+2],u=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&u)&&(s=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&u)>65535&&s<1114112&&(c=s)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=f}return function(t){var e=t.length;if(e<=j)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=j));return n}(r)}e.Buffer=s,e.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},e.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),s.poolSize=8192,s._augment=function(t){return t.__proto__=s.prototype,t},s.from=function(t,e,n){return l(null,t,e,n)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(t,e,n){return function(t,e,n,r){return c(e),e<=0?u(t,e):void 0!==n?"string"==typeof r?u(t,e).fill(n,r):u(t,e).fill(n):u(t,e)}(null,t,e,n)},s.allocUnsafe=function(t){return f(null,t)},s.allocUnsafeSlow=function(t){return f(null,t)},s.isBuffer=function(t){return!(null==t||!t._isBuffer)},s.compare=function(t,e){if(!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=s.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!s.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},s.byteLength=d,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},s.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?S(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return C(this,e,n);case"latin1":case"binary":return T(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},s.prototype.compare=function(t,e,n,r,i){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),u=Math.min(o,a),l=this.slice(r,i),c=t.slice(e,n),f=0;f<u;++f)if(l[f]!==c[f]){o=l[f],a=c[f];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},s.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return g(this,t,e,n);case"utf8":case"utf-8":return m(this,t,e,n);case"ascii":return b(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return k(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var j=4096;function C(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function T(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function P(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=U(t[o]);return i}function A(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function O(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,n,r,i,o){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function R(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function F(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function I(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(t,e,n,r,o){return o||I(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function L(t,e,n,r,o){return o||I(t,0,n,8),i.write(t,e,n,r,52,8),n+8}s.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),s.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=s.prototype;else{var i=e-t;n=new s(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},s.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},s.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},s.prototype.readUInt8=function(t,e){return e||O(t,1,this.length),this[t]},s.prototype.readUInt16LE=function(t,e){return e||O(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUInt16BE=function(t,e){return e||O(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUInt32LE=function(t,e){return e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUInt32BE=function(t,e){return e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},s.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},s.prototype.readInt8=function(t,e){return e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){e||O(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){e||O(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return e||O(t,4,this.length),i.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return e||O(t,4,this.length),i.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return e||O(t,8,this.length),i.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return e||O(t,8,this.length),i.read(this,t,!1,52,8)},s.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},s.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},s.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,255,0),s.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):F(this,t,e,!0),e+4},s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):F(this,t,e,!1),e+4},s.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=0,a=1,u=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===u&&0!==this[e+o-1]&&(u=1),this[e+o]=(t/a>>0)-u&255;return e+n},s.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=n-1,a=1,u=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===u&&0!==this[e+o+1]&&(u=1),this[e+o]=(t/a>>0)-u&255;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,127,-128),s.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):F(this,t,e,!0),e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):F(this,t,e,!1),e+4},s.prototype.writeFloatLE=function(t,e,n){return B(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return B(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!s.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},s.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=s.isBuffer(t)?t:D(new s(t,r).toString()),u=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%u]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function D(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(N,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(46))},273:function(t,e,n){(function(t,r){var i;!function(o){"object"==typeof e&&e&&e.nodeType,"object"==typeof t&&t&&t.nodeType;var a="object"==typeof r&&r;a.global!==a&&a.window!==a&&a.self;var u,s=2147483647,l=36,c=1,f=26,h=38,p=700,d=72,v=128,y="-",_=/^xn--/,g=/[^\x20-\x7E]/,m=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=l-c,k=Math.floor,x=String.fromCharCode;function E(t){throw new RangeError(b[t])}function S(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function j(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+S((t=t.replace(m,".")).split("."),e).join(".")}function C(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function T(t){return S(t,function(t){var e="";return t>65535&&(e+=x((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=x(t)}).join("")}function P(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function A(t,e,n){var r=0;for(t=n?k(t/p):t>>1,t+=k(t/e);t>w*f>>1;r+=l)t=k(t/w);return k(r+(w+1)*t/(t+h))}function O(t){var e,n,r,i,o,a,u,h,p,_,g,m=[],b=t.length,w=0,x=v,S=d;for((n=t.lastIndexOf(y))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&E("not-basic"),m.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<b;){for(o=w,a=1,u=l;i>=b&&E("invalid-input"),((h=(g=t.charCodeAt(i++))-48<10?g-22:g-65<26?g-65:g-97<26?g-97:l)>=l||h>k((s-w)/a))&&E("overflow"),w+=h*a,!(h<(p=u<=S?c:u>=S+f?f:u-S));u+=l)a>k(s/(_=l-p))&&E("overflow"),a*=_;S=A(w-o,e=m.length+1,0==o),k(w/e)>s-x&&E("overflow"),x+=k(w/e),w%=e,m.splice(w++,0,x)}return T(m)}function M(t){var e,n,r,i,o,a,u,h,p,_,g,m,b,w,S,j=[];for(m=(t=C(t)).length,e=v,n=0,o=d,a=0;a<m;++a)(g=t[a])<128&&j.push(x(g));for(r=i=j.length,i&&j.push(y);r<m;){for(u=s,a=0;a<m;++a)(g=t[a])>=e&&g<u&&(u=g);for(u-e>k((s-n)/(b=r+1))&&E("overflow"),n+=(u-e)*b,e=u,a=0;a<m;++a)if((g=t[a])<e&&++n>s&&E("overflow"),g==e){for(h=n,p=l;!(h<(_=p<=o?c:p>=o+f?f:p-o));p+=l)S=h-_,w=l-_,j.push(x(P(_+S%w,0))),h=k(S/w);j.push(x(P(h,0))),o=A(n,b,r==i),n=0,++r}++n,++e}return j.join("")}u={version:"1.4.1",ucs2:{decode:C,encode:T},decode:O,encode:M,toASCII:function(t){return j(t,function(t){return g.test(t)?"xn--"+M(t):t})},toUnicode:function(t){return j(t,function(t){return _.test(t)?O(t.slice(4).toLowerCase()):t})}},void 0===(i=function(){return u}.call(e,n,e,t))||(t.exports=i)}()}).call(this,n(79)(t),n(46))},274:function(t,e,n){"use strict";t.exports=function(e){var n;function r(t,e){var r=[];function i(e,i,a){if(t){t--;var u=new n(function(t){t(e.apply(i,a))});return u.then(o,o),u}return new n(function(t){r.push(new function(t,e,n,r){this.resolve=t,this.fn=e,this.self=n||null,this.args=r}(t,e,i,a))})}function o(){if(t++,r.length){var e=r.shift();e.resolve(i(e.fn,e.self,e.args))}}if("function"==typeof t&&"number"==typeof e){var a=e;e=t,t=a}return"function"==typeof e?function(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);return i(e,this,t)}:function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);return i(t,this,e)}}if("number"==typeof arguments[0]||"number"==typeof arguments[1]){if("function"!=typeof(n=t.exports.Promise))throw new Error("You must provide a Promise polyfill for this library to work in older environments");return r(arguments[0],arguments[1])}return n=e,r},"function"==typeof Promise&&(t.exports.Promise=Promise)},289:function(t,e,n){"use strict";function r(t,e){return function(){var r;console.log("["+(new Date).toJSON()+"] ["+t+"] ["+e+"] "+(r=n(121)).format.apply(r,arguments))}}Object.defineProperty(e,"__esModule",{value:!0}),e.forModule=function(t){return{info:r(t,"info"),warn:r(t,"warn"),error:r(t,"error")}}},318:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FileResource=e.DndResources=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(126)),o=u(n(88)),a=u(n(113));function u(t){return t&&t.__esModule?t:{default:t}}function s(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var c=e.DndResources=function(){function t(e){l(this,t),this._files=function(t){var e=[];return(0,o.default)(regeneratorRuntime.mark(function r(){var o,a,u,s,l,c,f,h,p,d,v;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.dataTransfer.items){r.next=29;break}o=!0,a=!1,u=void 0,r.prev=4,s=Array.from(t.dataTransfer.items)[Symbol.iterator]();case 6:if(o=(l=s.next()).done){r.next=13;break}return c=l.value,r.next=10,n(c);case 10:o=!0,r.next=6;break;case 13:r.next=19;break;case 15:r.prev=15,r.t0=r.catch(4),a=!0,u=r.t0;case 19:r.prev=19,r.prev=20,!o&&s.return&&s.return();case 22:if(r.prev=22,!a){r.next=25;break}throw u;case 25:return r.finish(22);case 26:return r.finish(19);case 27:r.next=49;break;case 29:if(!t.dataTransfer.files){r.next=49;break}for(f=!0,h=!1,p=void 0,r.prev=33,d=Array.from(t.dataTransfer.files)[Symbol.iterator]();!(f=(v=d.next()).done);f=!0)i(v.value);r.next=41;break;case 37:r.prev=37,r.t1=r.catch(33),h=!0,p=r.t1;case 41:r.prev=41,r.prev=42,!f&&d.return&&d.return();case 44:if(r.prev=44,!h){r.next=47;break}throw p;case 47:return r.finish(44);case 48:return r.finish(41);case 49:return r.abrupt("return",e);case 50:case"end":return r.stop()}},r,this,[[4,15,19,27],[20,,22,26],[33,37,41,49],[42,,44,48]])}));function n(t){return(0,o.default)(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.webkitGetAsEntry&&t.webkitGetAsEntry())){e.next=6;break}return e.next=4,r(n);case 4:e.next=8;break;case 6:i(t.getAsFile&&t.getAsFile());case 8:case"end":return e.stop()}},e,this)}))}function r(t){return t.isFile?function(t){return new Promise(function(e,n){t.file(e,n)}).tap(function(t){i(t)})}(t):t.isDirectory?(e=t,(0,o.default)(regeneratorRuntime.mark(function t(){var n,i,o,a,u,l,c,f,h,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=[],i=e.createReader(),o=function(){return new Promise(function(t,e){i.readEntries(t,e)})};case 3:return t.next=5,o();case 5:if((a=t.sent)&&0!==a.length){t.next=8;break}return t.abrupt("break",11);case 8:n.push.apply(n,s(Array.from(a)));case 9:t.next=3;break;case 11:u=!0,l=!1,c=void 0,t.prev=14,f=n[Symbol.iterator]();case 16:if(u=(h=f.next()).done){t.next=23;break}return p=h.value,t.next=20,r(p);case 20:u=!0,t.next=16;break;case 23:t.next=29;break;case 25:t.prev=25,t.t0=t.catch(14),l=!0,c=t.t0;case 29:t.prev=29,t.prev=30,!u&&f.return&&f.return();case 32:if(t.prev=32,!l){t.next=35;break}throw c;case 35:return t.finish(32);case 36:return t.finish(29);case 37:case"end":return t.stop()}},t,this,[[14,25,29,37],[30,,32,36]])}))):void 0;var e}function i(t){t&&e.push({name:t.name,file:t})}}(e)}return r(t,[{key:"file",value:function(t){return this._files.then(function(e){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;if(u.name.toLowerCase()===t.toLowerCase())return new f(u.file)}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}throw new Error("unable to find "+t)})}},{key:"fileList",get:function(){return Promise.resolve(this._files.map(function(t){return t.name}))}}]),t}(),f=e.FileResource=function(){function t(e){l(this,t),this._file=e}return r(t,[{key:"read",value:function(t){return i.atomic(t,(0,a.default)(this._file).as("arraybuffer"))}},{key:"resolveUrl",value:function(){return Promise.resolve(URL.createObjectURL(this._file))}},{key:"name",get:function(){return this._file.name}}]),t}();e.default=c},32:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.main=function(){window.addEventListener("touchstart",function t(){(0,f.unmuteAudio)(u.default),window.removeEventListener("touchstart",t)});var t=function(t){return new Promise(function(e){var n=i.default.createElement(d.default,{options:t,play:function(t){e(t)}});o.default.display(n).done()})},e=s.default.wrap(regeneratorRuntime.mark(function e(){var n,i,o,u,s,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(l.default.keyboard||"").split(",").map(function(t){return+t}),i={url:l.default.bms||"/music/[snack]dddd/dddd_sph.bme",game:{audioInputLatency:+l.default.latency||0},players:[{speed:+l.default.speed||3,autoplay:!!l.default.autoplay,placement:"center",scratch:l.default.scratch||"left",input:{keyboard:{1:n[0]||83,2:n[1]||68,3:n[2]||70,4:n[3]||32,5:n[4]||74,6:n[5]||75,7:n[6]||76,SC:n[7]||65,SC2:n[8]||16}}}]},e.next=4,t(i);case 4:return i=e.sent,o=i.url,u=(0,c.resolveUrl)(o,"assets/"),s={title:"Loading",subtitles:[],artist:"",genre:"",subartists:[]},f={bms:i.resource||new a.default(o),assets:i.resources||new r.default(u),metadata:s,options:Object.assign({},i.game,{players:i.players})},e.abrupt("return",f);case 10:case"end":return e.stop()}},e,this)}));(0,s.default)(regeneratorRuntime.mark(function t(){var n,r,a,u,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:return n=t.sent,r=h.load(n),a=r.tasks,u=r.promise,t.next=6,o.default.display(i.default.createElement(v.default,{tasks:a,song:n.metadata}));case 6:return t.next=8,u;case 8:return s=t.sent,t.next=11,o.default.display(new p.default(s.display));case 11:s.start();case 12:case"end":return t.stop()}},t,this)})).done()};var r=y(n(620)),i=y(n(39)),o=y(n(230)),a=y(n(189)),u=y(n(172)),s=y(n(88)),l=y(n(3)),c=n(190),f=n(150),h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1118)),p=y(n(1170)),d=y(n(1548)),v=y(n(1169));function y(t){return t&&t.__esModule?t:{default:t}}},321:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerDisplay=void 0;var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(170)),a=n(267),u=(r=a)&&r.__esModule?r:{default:r},s=n(77),l=n(266);var c=e.PlayerDisplay=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e.notechart;this._currentSpeed=1,this._player=e,this._noteArea=new u.default(r.notes,r.barLines),this._stateful={},this._defaultData={placement:e.options.placement,scratch:e.options.scratch,key_mode:function(t,e){var n={},r=!0,i=!1,o=void 0;try{for(var a,u=t.notes[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value;n[s.column]=!0}}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return("off"!==e||n[1]||n[7])&&("left"!==e||n[6]||n[7])&&("right"!==e||n[1]||n[2])?"7K":"5K"}(r,e.options.scratch),lane_lift:Math.max(0,-e.options.laneCover),lane_press:Math.max(0,e.options.laneCover)},this._gauge=(0,l.getGauge)(e.options.gauge),this._touch3dMode="touch3d"===n.displayMode}return i(t,[{key:"update",value:function(t,e,n){var r=this._touch3dMode,i=this._player,a=this._noteArea,u=this._stateful,l=i.notechart.secondsToBeat(e),c=i.notechart.beatToPosition(l),f=i.notechart.spacingAtBeat(l),h=Object.assign({},this._defaultData),p=function(t,e){return(h[t]||(h[t]=[])).push(e)},d=this._gauge;this._currentSpeed+=(n.speed-this._currentSpeed)/3;var v=this._currentSpeed*f;h.beat=l,function(){var t=a.getVisibleNotes(c,g(),1);if(r){var e=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=o.getRow(e-.01),a=+n||-1,u=o.PLAY_AREA_WIDTH,s=i.projection*u*(2*(a-.5)/7-1),l=i.projection*r*u*2/7;p("note3d_"+n,{key:t,y:i.y,x:s+640,width:l})},i=!0,u=!1,l=void 0;try{for(var f,h=t[Symbol.iterator]();!(i=(f=h.next()).done);i=!0){var d=f.value,v=d.note,y=v.column;if(d.height){for(var _=0,m=d.y+d.height,b=m-Math.max(0,Math.floor((m-1)/(3/128))*(3/128));b>=0&&b>=d.y;b-=3/128)e(v.id+"x"+_++,b,y,.8);e(v.id,d.y+d.height,y)}else"judged"!==n.getNoteStatus(v)&&e(v.id,d.y,y)}}catch(t){u=!0,l=t}finally{try{!i&&h.return&&h.return()}finally{if(u)throw l}}}else{var w=!0,k=!1,x=void 0;try{for(var E,S=t[Symbol.iterator]();!(w=(E=S.next()).done);w=!0){var j=E.value,C=j.note,T=C.column;if(j.height){var P=n.getNoteJudgment(C),A=n.getNoteStatus(C);p("longnote_"+T,{key:C.id,y:j.y,height:j.height,active:0!==P&&P!==s.MISSED,missed:"judged"===A&&P===s.MISSED})}else"judged"!==n.getNoteStatus(C)&&p("note_"+T,{key:C.id,y:j.y})}}catch(t){k=!0,x=t}finally{try{!w&&S.return&&S.return()}finally{if(k)throw x}}}}(),function(){var t=a.getVisibleBarLines(c,g(),1),e=!0,n=!1,i=void 0;try{for(var u,s=t[Symbol.iterator]();!(e=(u=s.next()).done);e=!0){var l=u.value;if(r){var f=o.getRow(l.y-.01);p("barlines3d",{key:l.id,y:f.y,x:f.projection*-o.PLAY_AREA_WIDTH+640,width:f.projection*o.PLAY_AREA_WIDTH*2})}else p("barlines",{key:l.id,y:l.y})}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}}(),function(){var e=n.input,r=!0,o=!1,a=void 0;try{for(var s,l=i.columns[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value,f=e.get(c);h[c+"_active"]=0!==f.value?1:0,f.changed&&(0!==f.value?u[c+"_down"]=t:u[c+"_up"]=t)}}catch(t){o=!0,a=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw a}}}(),function(){var e=n.notifications.judgments,r=e[e.length-1];if(r){var i=-1===r.judgment?"missed":""+r.judgment;u["judge_"+i]=t;var o=-1===r.judgment||1===r.judgment?"none":r.delta>0?"late":r.delta<0?"early":"none";u["judge_deviation_"+o]=t,u.combo=r.combo}h.score=n.stats.score}(),function(){d.update(n),d.shouldDisplay()?u.gauge_enter||(u.gauge_enter=t):u.gauge_enter&&(u.gauge_exit||(u.gauge_exit=t));h.gauge_primary=d.getPrimary(),h.gauge_secondary=d.getSecondary(),h.gauge_extra=d.getExtra()}(),function(){for(var e=n.notifications.judgments,r=0;r<e.length;r++){var i=e[r];(0,s.breaksCombo)(i.judgment)||(u[i.column+"_explode"]=t)}}(),h.speed=n.speed.toFixed(1)+"x",h.stat_1=_(1),h.stat_2=_(2),h.stat_3=_(3),h.stat_4=_(4),h.stat_missed=_(s.MISSED),h.stat_acc=(100*(n.stats.currentAccuracy||0)).toFixed(2)+"%";var y=i.notechart.bpmAtBeat(l);return h.bpm=y<1?"":Math.round(y)%1e4||"",Object.assign(h,u),h;function _(t){return n.stats.counts&&n.stats.counts[t]}function g(){return c+5/v}}}]),t}();e.default=c},322:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getMidi川=u;var r,i=n(114),o=(r=i)&&r.__esModule?r:{default:r};function a(t){return o.default.fromBinder(function(e){var n=!0,r=!1,i=void 0;try{for(var a,u=t.inputs.values()[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var s=a.value;e(new o.default.Next(s))}}catch(t){r=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}var l=!0,c=!1,f=void 0;try{for(var h,p=t.outputs.values()[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var d=h.value;e(new o.default.Next(d))}}catch(t){c=!0,f=t}finally{try{!l&&p.return&&p.return()}finally{if(c)throw f}}t.onstatechange=function(t){e(new o.default.Next(t.port))}})}function u(){return o.default.fromPromise(navigator.requestMIDIAccess?navigator.requestMIDIAccess():Promise.reject(new Error("MIDI is not supported"))).flatMap(a).flatMapError(function(t){return console.warn("MIDI Error:",t.stack),o.default.never()}).flatMap(s).doLog("messageforport")}function s(t){return"input"!==t.type?o.default.never():o.default.fromEvent(t,"midimessage")}e.default=u},323:function(t,e){var n=(e=t.exports=function(t){if(t&&"object"==typeof t){var e=t.which||t.keyCode||t.charCode;e&&(t=e)}if("number"==typeof t)return o[t];var i,a=String(t);return(i=n[a.toLowerCase()])?i:(i=r[a.toLowerCase()])||(1===a.length?a.charCodeAt(0):void 0)}).code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},r=e.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(i=97;i<123;i++)n[String.fromCharCode(i)]=i-32;for(var i=48;i<58;i++)n[i-48]=i;for(i=1;i<13;i++)n["f"+i]=i+111;for(i=0;i<10;i++)n["numpad "+i]=i+96;var o=e.names=e.title={};for(i in n)o[n[i]]=i;for(var a in r)n[a]=r[a]},324:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerState=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=u(n(43)),o=u(n(269)),a=n(77);function u(t){return t&&t.__esModule?t:{default:t}}var s=e.PlayerState=function(){function t(e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._player=e,this._columns=e.columns,this._noteBufferByColumn=(0,i.default)(e.notechart.notes).sortBy("time").groupBy("column").mapValues((n=this,function(t){var e=0;return{notes:t,get startIndex(){return e},update:function(){for(;e<t.length&&"judged"===n.getNoteStatus(t[e]);)e+=1}}})).value(),this._noteResult=new Map,this._duration=e.notechart.duration,this._judge=(0,a.getJudgeForNotechart)(e.notechart,{tutorial:e.options.tutorial}),console.log("GET JDG",this._judge),this.stats=new o.default(e.notechart),this.notifications={},this.speed=e.options.speed,this.finished=!1,this.tainted=!1}return r(t,[{key:"update",value:function(t,e){this._gameTime=t,this._rawInput=e,this.notifications={},this.notifications.sounds=[],this.notifications.judgments=[],this._updateInputColumnMap(),this._judgeNotes(),this._updateSpeed(),t>this._duration+1&&(this.finished=!0)}},{key:"getNoteStatus",value:function(t){var e=this._noteResult.get(t);return e?e.status:"unjudged"}},{key:"getNoteJudgment",value:function(t){var e=this._noteResult.get(t);return e?e.judgment:0}},{key:"getPlayerInput",value:function(t){return this._rawInput.get("p"+this._player.number+"_"+t)}},{key:"_updateInputColumnMap",value:function(){var t=this;this.input=new Map(this._columns.map(function(e){return[e,t.getPlayerInput(e)]}))}},{key:"_judgeNotes",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._columns[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value,a=this._noteBufferByColumn[o];if(a){var u=this.input.get(o);this._judgeColumn(a,u),a.update()}}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}},{key:"_updateSpeed",value:function(){this.getPlayerInput("speedup").justPressed&&this._modifySpeed(1),this.getPlayerInput("speeddown").justPressed&&this._modifySpeed(-1);var t=this.getPlayerInput("pinch").value;if(t&&!this._pinching?this._pinching={start:t,speed:this.speed}:t||(this._pinching=null),t){var e=this._pinching,n=e.speed*t/e.start;this.speed=Math.max(.2,Math.round(10*n)/10)}}},{key:"_modifySpeed",value:function(t){var e=this._rawInput.get("select").value?.1:this.speed<.5?.3:.5;this.speed+=t*e,this.speed<.2&&(this.speed=.2)}},{key:"_judgeColumn",value:function(t,e){for(var n=void 0,r=void 0,i=t.notes,o=!1,a=t.startIndex;a<i.length;a++){var u=i[a];if(this._shouldJudge(u,e,t)){var s="active"!==this.getNoteStatus(u);if(n=u,r=this._judgeNote(u),window.BEMUSE_AUTOPLAY&&(o=!0),s)break}}if(e.justPressed||o)if(n)this.notifications.sounds.push({note:n,type:"hit",judgment:r});else{var l=this._getFreestyleNote(i);l&&this.notifications.sounds.push({note:l,type:"free"})}}},{key:"_getClosestNote",value:function(t){var e=this;return i.default.minBy(t,function(t){return Math.abs(e._gameTime-t.time)})}},{key:"_getFreestyleNote",value:function(t){var e=this;return i.default.minBy(t,function(t){return Math.abs(e._gameTime-t.time)+(e._gameTime<t.time-1?1e6:0)})}},{key:"_shouldJudge",value:function(t,e,n){var r=this.getNoteStatus(t);if("unjudged"===r){if(window.BEMUSE_AUTOPLAY&&this._gameTime>=t.time)return this.tainted=!0,!0;var i=(0,a.judgeTime)(this._gameTime,t.time,this._judge),o=i===a.MISSED,u=i>0&&e.changed&&e.value;return(0,a.isBad)(i)&&this._getClosestNote(n.notes)!==t&&(u=!1),o||u}if("active"===r){if(window.BEMUSE_AUTOPLAY&&this._gameTime>=t.end.time)return this.tainted=!0,!0;var s=(0,a.judgeEndTime)(this._gameTime,t.end.time,this._judge)===a.MISSED,l=e.changed,c="SC"===t.column,f=this._gameTime>=t.end.time;return s||l||c&&f}return!1}},{key:"_judgeNote",value:function(t){var e=this._gameTime-t.time,n=(0,a.judgeTime)(this._gameTime,t.time,this._judge),r=this._noteResult.get(t),i=!r||"unjudged"===r.status,o=r&&"active"===r.status;if(window.BEMUSE_AUTOPLAY&&n>=1&&(n=1),t.end){if(i){var u=n===a.MISSED?"judged":"active";n===a.MISSED&&this._setJudgment(n,e,t.column),r={status:u,judgment:n,delta:e}}else if(o){var s="SC"===t.column;e=this._gameTime-t.end.time,n=(0,a.judgeEndTime)(this._gameTime,t.end.time,this._judge)||a.MISSED,s&&e>0&&(n=1),r={status:"judged",judgment:n,delta:e}}}else r={status:"judged",judgment:n,delta:e};return n===a.MISSED&&this.notifications.sounds.push({note:t,type:"break"}),i&&n!==a.MISSED&&this.stats.handleDelta(e),this._noteResult.set(t,r),this._setJudgment(n,e,t.column),n}},{key:"_setJudgment",value:function(t,e,n){this.stats.handleJudgment(t);var r={judgment:t,combo:this.stats.combo,delta:e,column:n};this.notifications.judgments.push(r)}},{key:"player",get:function(){return this._player}}]),t}();e.default=s},325:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=e.Control=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=0,this.changed=!1}return r(t,[{key:"justPressed",get:function(){return this.changed&&this.value}}]),t}();e.default=i},326:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,".BenchmarkPanel {\n  background: #449;\n  border: 2px solid #66e;\n  padding: 4px;\n}\n\n.BenchmarkPanel table {\n  font-size: 10px;\n}\n",""])},327:function(t,e,n){var r=n(326);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},328:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(327);var i=a(n(39)),o=a(n(41));function a(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.renderTable=function(){var t=n.props.bench.stats;return i.default.createElement("table",null,i.default.createElement("tbody",null,Object.keys(t).map(function(e){var n=t[e];return i.default.createElement("tr",null,i.default.createElement("td",null,i.default.createElement("strong",null,e)),i.default.createElement("td",{align:"right"},""+n))})))},n.handleInteraction=function(t){t.preventDefault(),t.stopPropagation(),n.setState({show:!n.state.show})},n.state={show:!1,text:"wow"},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default.Component),r(e,[{key:"render",value:function(){return i.default.createElement("div",{className:"BenchmarkPanel",onClick:this.handleInteraction,onTouchStart:this.handleInteraction},this.state.show?i.default.createElement("article",null,i.default.createElement("b",null,"Benchmark Stats"),i.default.createElement("br",null),this.renderTable()):"Show Benchmark Stats")}},{key:"componentDidMount",value:function(){var t=this;setInterval(function(){return t.forceUpdate()},1e3)}}]),e}();u.propTypes={bench:o.default.object},e.default=u},329:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(497),o=(r=i)&&r.__esModule?r:{default:r};e.default=(0,o.default)()},330:function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,a,u,s=1,l={},c=!1,f=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){d(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},r=function(t){o.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(i=f.documentElement,r=function(t){var e=f.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(d,0,t)}:(a="setImmediate$"+Math.random()+"$",u=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&d(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",u,!1):t.attachEvent("onmessage",u),r=function(e){t.postMessage(a+e,"*")}),h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return l[s]=i,r(s),s++},h.clearImmediate=p}function p(t){delete l[t]}function d(t){if(c)setTimeout(d,0,t);else{var e=l[t];if(e){c=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{p(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(46),n(66))},331:function(t,e,n){(function(t,r){var i;(function(){var o,a,u,s="3.10.1",l=1,c=2,f=4,h=8,p=16,d=32,v=64,y=128,_=256,g=30,m="...",b=150,w=16,k=200,x=1,E=2,S="Expected a function",j="__lodash_placeholder__",C="[object Arguments]",T="[object Array]",P="[object Boolean]",A="[object Date]",O="[object Error]",M="[object Function]",R="[object Number]",F="[object Object]",I="[object RegExp]",B="[object String]",L="[object ArrayBuffer]",N="[object Float32Array]",U="[object Float64Array]",D="[object Int8Array]",G="[object Int16Array]",z="[object Int32Array]",H="[object Uint8Array]",V="[object Uint8ClampedArray]",Y="[object Uint16Array]",q="[object Uint32Array]",W=/\b__p \+= '';/g,J=/\b(__p \+=) '' \+/g,K=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Q=/&(?:amp|lt|gt|quot|#39|#96);/g,$=/[&<>"'`]/g,X=RegExp(Q.source),Z=RegExp($.source),tt=/<%-([\s\S]+?)%>/g,et=/<%([\s\S]+?)%>/g,nt=/<%=([\s\S]+?)%>/g,rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,it=/^\w*$/,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,at=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,ut=RegExp(at.source),st=/[\u0300-\u036f\ufe20-\ufe23]/g,lt=/\\(\\)?/g,ct=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ft=/\w*$/,ht=/^0[xX]/,pt=/^\[object .+?Constructor\]$/,dt=/^\d+$/,vt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,yt=/($^)/,_t=/['\n\r\u2028\u2029\\]/g,gt=(a="[A-Z\\xc0-\\xd6\\xd8-\\xde]",u="[a-z\\xdf-\\xf6\\xf8-\\xff]+",RegExp(a+"+(?="+a+u+")|"+a+"?"+u+"|"+a+"+|[0-9]+","g")),mt=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],bt=-1,wt={};wt[N]=wt[U]=wt[D]=wt[G]=wt[z]=wt[H]=wt[V]=wt[Y]=wt[q]=!0,wt[C]=wt[T]=wt[L]=wt[P]=wt[A]=wt[O]=wt[M]=wt["[object Map]"]=wt[R]=wt[F]=wt[I]=wt["[object Set]"]=wt[B]=wt["[object WeakMap]"]=!1;var kt={};kt[C]=kt[T]=kt[L]=kt[P]=kt[A]=kt[N]=kt[U]=kt[D]=kt[G]=kt[z]=kt[R]=kt[F]=kt[I]=kt[B]=kt[H]=kt[V]=kt[Y]=kt[q]=!0,kt[O]=kt[M]=kt["[object Map]"]=kt["[object Set]"]=kt["[object WeakMap]"]=!1;var xt={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Et={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},St={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},jt={function:!0,object:!0},Ct={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Tt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Pt=jt[typeof e]&&e&&!e.nodeType&&e,At=jt[typeof t]&&t&&!t.nodeType&&t,Ot=Pt&&At&&"object"==typeof r&&r&&r.Object&&r,Mt=jt[typeof self]&&self&&self.Object&&self,Rt=jt[typeof window]&&window&&window.Object&&window,Ft=(At&&At.exports,Ot||Rt!==(this&&this.window)&&Rt||Mt||this);function It(t,e){if(t!==e){var n=null===t,r=t===o,i=t==t,a=null===e,u=e===o,s=e==e;if(t>e&&!a||!i||n&&!u&&s||r&&s)return 1;if(t<e&&!n||!s||a&&!r&&i||u&&i)return-1}return 0}function Bt(t,e,n){for(var r=t.length,i=n?r:-1;n?i--:++i<r;)if(e(t[i],i,t))return i;return-1}function Lt(t,e,n){if(e!=e)return Wt(t,n);for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function Nt(t){return"function"==typeof t||!1}function Ut(t){return null==t?"":t+""}function Dt(t,e){for(var n=-1,r=t.length;++n<r&&e.indexOf(t.charAt(n))>-1;);return n}function Gt(t,e){for(var n=t.length;n--&&e.indexOf(t.charAt(n))>-1;);return n}function zt(t,e){return It(t.criteria,e.criteria)||t.index-e.index}function Ht(t){return xt[t]}function Vt(t){return Et[t]}function Yt(t,e,n){return e?t=Ct[t]:n&&(t=Tt[t]),"\\"+t}function qt(t){return"\\"+Tt[t]}function Wt(t,e,n){for(var r=t.length,i=e+(n?0:-1);n?i--:++i<r;){var o=t[i];if(o!=o)return i}return-1}function Jt(t){return!!t&&"object"==typeof t}function Kt(t){return t<=160&&t>=9&&t<=13||32==t||160==t||5760==t||6158==t||t>=8192&&(t<=8202||8232==t||8233==t||8239==t||8287==t||12288==t||65279==t)}function Qt(t,e){for(var n=-1,r=t.length,i=-1,o=[];++n<r;)t[n]===e&&(t[n]=j,o[++i]=n);return o}function $t(t){for(var e=-1,n=t.length;++e<n&&Kt(t.charCodeAt(e)););return e}function Xt(t){for(var e=t.length;e--&&Kt(t.charCodeAt(e)););return e}function Zt(t){return St[t]}var te=function t(e){var n=(e=e?te.defaults(Ft.Object(),e,te.pick(Ft,mt)):Ft).Array,r=e.Date,i=e.Error,a=e.Function,u=e.Math,xt=e.Number,Et=e.Object,St=e.RegExp,jt=e.String,Ct=e.TypeError,Tt=n.prototype,Pt=Et.prototype,At=jt.prototype,Ot=a.prototype.toString,Mt=Pt.hasOwnProperty,Rt=0,Kt=Pt.toString,ee=Ft._,ne=St("^"+Ot.call(Mt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),re=e.ArrayBuffer,ie=e.clearTimeout,oe=e.parseFloat,ae=u.pow,ue=Pt.propertyIsEnumerable,se=gr(e,"Set"),le=e.setTimeout,ce=Tt.splice,fe=e.Uint8Array,he=gr(e,"WeakMap"),pe=u.ceil,de=gr(Et,"create"),ve=u.floor,ye=gr(n,"isArray"),_e=e.isFinite,ge=gr(Et,"keys"),me=u.max,be=u.min,we=gr(r,"now"),ke=e.parseInt,xe=u.random,Ee=xt.NEGATIVE_INFINITY,Se=xt.POSITIVE_INFINITY,je=4294967295,Ce=je-1,Te=je>>>1,Pe=9007199254740991,Ae=he&&new he,Oe={};function Me(t){if(Jt(t)&&!qi(t)&&!(t instanceof Ie)){if(t instanceof Fe)return t;if(Mt.call(t,"__chain__")&&Mt.call(t,"__wrapped__"))return Br(t)}return new Fe(t)}function Re(){}function Fe(t,e,n){this.__wrapped__=t,this.__actions__=n||[],this.__chain__=!!e}Me.support={};function Ie(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Se,this.__views__=[]}function Be(){this.__data__={}}function Le(t){var e=t?t.length:0;for(this.data={hash:de(null),set:new se};e--;)this.push(t[e])}function Ne(t,e){var n=t.data;return("string"==typeof e||Qi(e)?n.set.has(e):n.hash[e])?0:-1}function Ue(t,e){var r=-1,i=t.length;for(e||(e=n(i));++r<i;)e[r]=t[r];return e}function De(t,e){for(var n=-1,r=t.length;++n<r&&!1!==e(t[n],n,t););return t}function Ge(t,e){for(var n=-1,r=t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function ze(t,e){for(var n=-1,r=t.length,i=-1,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[++i]=a)}return o}function He(t,e){for(var r=-1,i=t.length,o=n(i);++r<i;)o[r]=e(t[r],r,t);return o}function Ve(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function Ye(t,e,n,r){var i=-1,o=t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function qe(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function We(t,e,n,r){return t!==o&&Mt.call(r,n)?t:e}function Je(t,e,n){for(var r=-1,i=go(e),a=i.length;++r<a;){var u=i[r],s=t[u],l=n(s,e[u],u,t,e);(l==l?l===s:s!=s)&&(s!==o||u in t)||(t[u]=l)}return t}function Ke(t,e){return null==e?t:$e(e,go(e),t)}function Qe(t,e){for(var r=-1,i=null==t,a=!i&&br(t),u=a?t.length:0,s=e.length,l=n(s);++r<s;){var c=e[r];l[r]=a?wr(c,u)?t[c]:o:i?o:t[c]}return l}function $e(t,e,n){n||(n={});for(var r=-1,i=e.length;++r<i;){var o=e[r];n[o]=t[o]}return n}function Xe(t,e,n){var r=typeof t;return"function"==r?e===o?t:Bn(t,e,n):null==t?No:"object"==r?bn(t):e===o?Vo(t):wn(t,e)}function Ze(t,e,n,r,i,a,u){var s;if(n&&(s=i?n(t,r,i):n(t)),s!==o)return s;if(!Qi(t))return t;var l=qi(t);if(l){if(s=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Mt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!e)return Ue(t,s)}else{var c=Kt.call(t),f=c==M;if(c!=F&&c!=C&&(!f||i))return kt[c]?function(t,e,n){var r=t.constructor;switch(e){case L:return Ln(t);case P:case A:return new r(+t);case N:case U:case D:case G:case z:case H:case V:case Y:case q:var i=t.buffer;return new r(n?Ln(i):i,t.byteOffset,t.length);case R:case B:return new r(t);case I:var o=new r(t.source,ft.exec(t));o.lastIndex=t.lastIndex}return o}(t,c,e):i?t:{};if(s=function(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Et),new e}(f?{}:t),!e)return Ke(s,t)}a||(a=[]),u||(u=[]);for(var h=a.length;h--;)if(a[h]==t)return u[h];return a.push(t),u.push(s),(l?De:pn)(t,function(r,i){s[i]=Ze(r,e,n,i,t,a,u)}),s}Me.templateSettings={escape:tt,evaluate:et,interpolate:nt,variable:"",imports:{_:Me}};var tn=function(){function t(){}return function(e){if(Qi(e)){t.prototype=e;var n=new t;t.prototype=o}return n||{}}}();function en(t,e,n){if("function"!=typeof t)throw new Ct(S);return le(function(){t.apply(o,n)},e)}function nn(t,e){var n=t?t.length:0,r=[];if(!n)return r;var i=-1,o=vr(),a=o==Lt,u=a&&e.length>=k?Vn(e):null,s=e.length;u&&(o=Ne,a=!1,e=u);t:for(;++i<n;){var l=t[i];if(a&&l==l){for(var c=s;c--;)if(e[c]===l)continue t;r.push(l)}else o(e,l,0)<0&&r.push(l)}return r}var rn=zn(pn),on=zn(dn,!0);function an(t,e){var n=!0;return rn(t,function(t,r,i){return n=!!e(t,r,i)}),n}function un(t,e){var n=[];return rn(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function sn(t,e,n,r){var i;return n(t,function(t,n,o){if(e(t,n,o))return i=r?n:t,!1}),i}function ln(t,e,n,r){r||(r=[]);for(var i=-1,o=t.length;++i<o;){var a=t[i];Jt(a)&&br(a)&&(n||qi(a)||Yi(a))?e?ln(a,e,n,r):Ve(r,a):n||(r[r.length]=a)}return r}var cn=Hn(),fn=Hn(!0);function hn(t,e){return cn(t,e,mo)}function pn(t,e){return cn(t,e,go)}function dn(t,e){return fn(t,e,go)}function vn(t,e){for(var n=-1,r=e.length,i=-1,o=[];++n<r;){var a=e[n];Ki(t[a])&&(o[++i]=a)}return o}function yn(t,e,n){if(null!=t){n!==o&&n in Fr(t)&&(e=[n]);for(var r=0,i=e.length;null!=t&&r<i;)t=t[e[r++]];return r&&r==i?t:o}}function _n(t,e,n,r,i,a){return t===e||(null==t||null==e||!Qi(t)&&!Jt(e)?t!=t&&e!=e:function(t,e,n,r,i,a,u){var s=qi(t),l=qi(e),c=T,f=T;s||((c=Kt.call(t))==C?c=F:c!=F&&(s=no(t))),l||((f=Kt.call(e))==C?f=F:f!=F&&(l=no(e)));var h=c==F,p=f==F,d=c==f;if(d&&!s&&!h)return function(t,e,n){switch(n){case P:case A:return+t==+e;case O:return t.name==e.name&&t.message==e.message;case R:return t!=+t?e!=+e:t==+e;case I:case B:return t==e+""}return!1}(t,e,c);if(!i){var v=h&&Mt.call(t,"__wrapped__"),y=p&&Mt.call(e,"__wrapped__");if(v||y)return n(v?t.value():t,y?e.value():e,r,i,a,u)}if(!d)return!1;a||(a=[]),u||(u=[]);for(var _=a.length;_--;)if(a[_]==t)return u[_]==e;a.push(t),u.push(e);var g=(s?function(t,e,n,r,i,a,u){var s=-1,l=t.length,c=e.length;if(l!=c&&!(i&&c>l))return!1;for(;++s<l;){var f=t[s],h=e[s],p=r?r(i?h:f,i?f:h,s):o;if(p!==o){if(p)continue;return!1}if(i){if(!qe(e,function(t){return f===t||n(f,t,r,i,a,u)}))return!1}else if(f!==h&&!n(f,h,r,i,a,u))return!1}return!0}:function(t,e,n,r,i,a,u){var s=go(t),l=s.length,c=go(e).length;if(l!=c&&!i)return!1;for(var f=l;f--;){var h=s[f];if(!(i?h in e:Mt.call(e,h)))return!1}for(var p=i;++f<l;){h=s[f];var d=t[h],v=e[h],y=r?r(i?v:d,i?d:v,h):o;if(!(y===o?n(d,v,r,i,a,u):y))return!1;p||(p="constructor"==h)}if(!p){var _=t.constructor,g=e.constructor;if(_!=g&&"constructor"in t&&"constructor"in e&&!("function"==typeof _&&_ instanceof _&&"function"==typeof g&&g instanceof g))return!1}return!0})(t,e,n,r,i,a,u);return a.pop(),u.pop(),g}(t,e,_n,n,r,i,a))}function gn(t,e,n){var r=e.length,i=r,a=!n;if(null==t)return!i;for(t=Fr(t);r--;){var u=e[r];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++r<i;){var s=(u=e[r])[0],l=t[s],c=u[1];if(a&&u[2]){if(l===o&&!(s in t))return!1}else{var f=n?n(l,c,s):o;if(!(f===o?_n(c,l,n,!0):f))return!1}}return!0}function mn(t,e){var r=-1,i=br(t)?n(t.length):[];return rn(t,function(t,n,o){i[++r]=e(t,n,o)}),i}function bn(t){var e=_r(t);if(1==e.length&&e[0][2]){var n=e[0][0],r=e[0][1];return function(t){return null!=t&&t[n]===r&&(r!==o||n in Fr(t))}}return function(t){return gn(t,e)}}function wn(t,e){var n=qi(t),r=xr(t)&&jr(e),i=t+"";return t=Ir(t),function(a){if(null==a)return!1;var u=i;if(a=Fr(a),(n||!r)&&!(u in a)){if(null==(a=1==t.length?a:yn(a,jn(t,0,-1))))return!1;u=Yr(t),a=Fr(a)}return a[u]===e?e!==o||u in a:_n(e,a[u],o,!0)}}function kn(t){return function(e){return null==e?o:e[t]}}function xn(t,e){for(var n=t?e.length:0;n--;){var r=e[n];if(r!=i&&wr(r)){var i=r;ce.call(t,r,1)}}return t}function En(t,e){return t+ve(xe()*(e-t+1))}var Sn=Ae?function(t,e){return Ae.set(t,e),t}:No;function jn(t,e,r){var i=-1,a=t.length;(e=null==e?0:+e||0)<0&&(e=-e>a?0:a+e),(r=r===o||r>a?a:+r||0)<0&&(r+=a),a=e>r?0:r-e>>>0,e>>>=0;for(var u=n(a);++i<a;)u[i]=t[i+e];return u}function Cn(t,e){var n;return rn(t,function(t,r,i){return!(n=e(t,r,i))}),!!n}function Tn(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function Pn(t,e,n){var r=hr(),i=-1;return e=He(e,function(t){return r(t)}),Tn(mn(t,function(t){return{criteria:He(e,function(e){return e(t)}),index:++i,value:t}}),function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,a=i.length,u=n.length;++r<a;){var s=It(i[r],o[r]);if(s){if(r>=u)return s;var l=n[r];return s*("asc"===l||!0===l?1:-1)}}return t.index-e.index}(t,e,n)})}function An(t,e){var n=-1,r=vr(),i=t.length,o=r==Lt,a=o&&i>=k,u=a?Vn():null,s=[];u?(r=Ne,o=!1):(a=!1,u=e?[]:s);t:for(;++n<i;){var l=t[n],c=e?e(l,n,t):l;if(o&&l==l){for(var f=u.length;f--;)if(u[f]===c)continue t;e&&u.push(c),s.push(l)}else r(u,c,0)<0&&((e||a)&&u.push(c),s.push(l))}return s}function On(t,e){for(var r=-1,i=e.length,o=n(i);++r<i;)o[r]=t[e[r]];return o}function Mn(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?jn(t,r?0:o,r?o+1:i):jn(t,r?o+1:0,r?i:o)}function Rn(t,e){var n=t;n instanceof Ie&&(n=n.value());for(var r=-1,i=e.length;++r<i;){var o=e[r];n=o.func.apply(o.thisArg,Ve([n],o.args))}return n}function Fn(t,e,n){var r=0,i=t?t.length:r;if("number"==typeof e&&e==e&&i<=Te){for(;r<i;){var o=r+i>>>1,a=t[o];(n?a<=e:a<e)&&null!==a?r=o+1:i=o}return i}return In(t,e,No,n)}function In(t,e,n,r){e=n(e);for(var i=0,a=t?t.length:0,u=e!=e,s=null===e,l=e===o;i<a;){var c=ve((i+a)/2),f=n(t[c]),h=f!==o,p=f==f;if(u)var d=p||r;else d=s?p&&h&&(r||null!=f):l?p&&(r||h):null!=f&&(r?f<=e:f<e);d?i=c+1:a=c}return be(a,Ce)}function Bn(t,e,n){if("function"!=typeof t)return No;if(e===o)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)};case 5:return function(n,r,i,o,a){return t.call(e,n,r,i,o,a)}}return function(){return t.apply(e,arguments)}}function Ln(t){var e=new re(t.byteLength);return new fe(e).set(new fe(t)),e}function Nn(t,e,r){for(var i=r.length,o=-1,a=me(t.length-i,0),u=-1,s=e.length,l=n(s+a);++u<s;)l[u]=e[u];for(;++o<i;)l[r[o]]=t[o];for(;a--;)l[u++]=t[o++];return l}function Un(t,e,r){for(var i=-1,o=r.length,a=-1,u=me(t.length-o,0),s=-1,l=e.length,c=n(u+l);++a<u;)c[a]=t[a];for(var f=a;++s<l;)c[f+s]=e[s];for(;++i<o;)c[f+r[i]]=t[a++];return c}function Dn(t,e){return function(n,r,i){var o=e?e():{};if(r=hr(r,i,3),qi(n))for(var a=-1,u=n.length;++a<u;){var s=n[a];t(o,s,r(s,a,n),n)}else rn(n,function(e,n,i){t(o,e,r(e,n,i),i)});return o}}function Gn(t){return Hi(function(e,n){var r=-1,i=null==e?0:n.length,a=i>2?n[i-2]:o,u=i>2?n[2]:o,s=i>1?n[i-1]:o;for("function"==typeof a?(a=Bn(a,s,5),i-=2):i-=(a="function"==typeof s?s:o)?1:0,u&&kr(n[0],n[1],u)&&(a=i<3?o:a,i=1);++r<i;){var l=n[r];l&&t(e,l,a)}return e})}function zn(t,e){return function(n,r){var i=n?yr(n):0;if(!Sr(i))return t(n,r);for(var o=e?i:-1,a=Fr(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Hn(t){return function(e,n,r){for(var i=Fr(e),o=r(e),a=o.length,u=t?a:-1;t?u--:++u<a;){var s=o[u];if(!1===n(i[s],s,i))break}return e}}function Vn(t){return de&&se?new Le(t):null}function Yn(t){return function(e){for(var n=-1,r=Io(Co(e)),i=r.length,o="";++n<i;)o=t(o,r[n],n);return o}}function qn(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=tn(t.prototype),r=t.apply(n,e);return Qi(r)?r:n}}function Wn(t){return function e(n,r,i){i&&kr(n,r,i)&&(r=o);var a=fr(n,t,o,o,o,o,o,r);return a.placeholder=e.placeholder,a}}function Jn(t,e){return Hi(function(n){var r=n[0];return null==r?r:(n.push(e),t.apply(o,n))})}function Kn(t,e){return function(n,r,i){if(i&&kr(n,r,i)&&(r=o),1==(r=hr(r,i,3)).length){var a=function(t,e,n,r){for(var i=-1,o=t.length,a=r,u=a;++i<o;){var s=t[i],l=+e(s);n(l,a)&&(a=l,u=s)}return u}(n=qi(n)?n:Rr(n),r,t,e);if(!n.length||a!==e)return a}return function(t,e,n,r){var i=r,o=i;return rn(t,function(t,a,u){var s=+e(t,a,u);(n(s,i)||s===r&&s===o)&&(i=s,o=t)}),o}(n,r,t,e)}}function Qn(t,e){return function(n,r,i){if(r=hr(r,i,3),qi(n)){var a=Bt(n,r,e);return a>-1?n[a]:o}return sn(n,r,t)}}function $n(t){return function(e,n,r){return e&&e.length?Bt(e,n=hr(n,r,3),t):-1}}function Xn(t){return function(e,n,r){return sn(e,n=hr(n,r,3),t,!0)}}function Zn(t){return function(){for(var e,r=arguments.length,i=t?r:-1,a=0,u=n(r);t?i--:++i<r;){var s=u[a++]=arguments[i];if("function"!=typeof s)throw new Ct(S);!e&&Fe.prototype.thru&&"wrapper"==dr(s)&&(e=new Fe([],!0))}for(i=e?-1:r;++i<r;){var l=dr(s=u[i]),c="wrapper"==l?pr(s):o;e=c&&Er(c[0])&&c[1]==(y|h|d|_)&&!c[4].length&&1==c[9]?e[dr(c[0])].apply(e,c[3]):1==s.length&&Er(s)?e[l]():e.thru(s)}return function(){var t=arguments,n=t[0];if(e&&1==t.length&&qi(n)&&n.length>=k)return e.plant(n).value();for(var i=0,o=r?u[i].apply(this,t):n;++i<r;)o=u[i].call(this,o);return o}}}function tr(t,e){return function(n,r,i){return"function"==typeof r&&i===o&&qi(n)?t(n,r):e(n,Bn(r,i,3))}}function er(t){return function(e,n,r){return"function"==typeof n&&r===o||(n=Bn(n,r,3)),t(e,n,mo)}}function nr(t){return function(e,n,r){return"function"==typeof n&&r===o||(n=Bn(n,r,3)),t(e,n)}}function rr(t){return function(e,n,r){var i={};return n=hr(n,r,3),pn(e,function(e,r,o){var a=n(e,r,o);e=t?e:a,i[r=t?a:r]=e}),i}}function ir(t){return function(e,n,r){return e=Ut(e),(t?e:"")+sr(e,n,r)+(t?"":e)}}function or(t){var e=Hi(function(n,r){var i=Qt(r,e.placeholder);return fr(n,t,o,r,i)});return e}function ar(t,e){return function(n,r,i,a){var u=arguments.length<3;return"function"==typeof r&&a===o&&qi(n)?t(n,r,i,u):function(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}(n,hr(r,a,4),i,u,e)}}function ur(t,e,r,i,a,u,s,_,g,m){var b=e&y,w=e&l,k=e&c,x=e&h,E=e&f,S=e&p,j=k?o:qn(t);return function f(){for(var h=arguments.length,p=h,y=n(h);p--;)y[p]=arguments[p];if(i&&(y=Nn(y,i,a)),u&&(y=Un(y,u,s)),x||S){var C=f.placeholder,T=Qt(y,C);if((h-=T.length)<m){var P=_?Ue(_):o,A=me(m-h,0);e|=x?d:v,e&=~(x?v:d),E||(e&=~(l|c));var O=[t,e,r,x?y:o,x?T:o,x?o:y,x?o:T,P,g,A],M=ur.apply(o,O);return Er(t)&&Or(M,O),M.placeholder=C,M}}var R=w?r:this,F=k?R[t]:t;return _&&(y=function(t,e){for(var n=t.length,r=be(e.length,n),i=Ue(t);r--;){var a=e[r];t[r]=wr(a,n)?i[a]:o}return t}(y,_)),b&&g<y.length&&(y.length=g),this&&this!==Ft&&this instanceof f&&(F=j||qn(t)),F.apply(R,y)}}function sr(t,e,n){var r=t.length;if(r>=(e=+e)||!_e(e))return"";var i=e-r;return Oo(n=null==n?" ":n+"",pe(i/n.length)).slice(0,i)}function lr(t){var e=u[t];return function(t,n){return(n=n===o?0:+n||0)?(n=ae(10,n),e(t*n)/n):e(t)}}function cr(t){return function(e,n,r,i){var o=hr(r);return null==r&&o===Xe?Fn(e,n,t):In(e,n,o(r,i,1),t)}}function fr(t,e,r,i,a,u,s,p){var g=e&c;if(!g&&"function"!=typeof t)throw new Ct(S);var m=i?i.length:0;if(m||(e&=~(d|v),i=a=o),m-=a?a.length:0,e&v){var b=i,w=a;i=a=o}var k=g?o:pr(t),x=[t,e,r,i,a,b,w,u,s,p];if(k&&(function(t,e){var n=t[1],r=e[1],i=n|r,o=i<y,a=r==y&&n==h||r==y&&n==_&&t[7].length<=e[8]||r==(y|_)&&n==h;if(!o&&!a)return t;r&l&&(t[2]=e[2],i|=n&l?0:f);var u=e[3];if(u){var s=t[3];t[3]=s?Nn(s,u,e[4]):Ue(u),t[4]=s?Qt(t[3],j):Ue(e[4])}(u=e[5])&&(s=t[5],t[5]=s?Un(s,u,e[6]):Ue(u),t[6]=s?Qt(t[5],j):Ue(e[6])),(u=e[7])&&(t[7]=Ue(u)),r&y&&(t[8]=null==t[8]?e[8]:be(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(x,k),e=x[1],p=x[9]),x[9]=null==p?g?0:t.length:me(p-m,0)||0,e==l)var E=function(t,e){var n=qn(t);return function r(){return(this&&this!==Ft&&this instanceof r?n:t).apply(e,arguments)}}(x[0],x[2]);else E=e!=d&&e!=(l|d)||x[4].length?ur.apply(o,x):function(t,e,r,i){var o=e&l,a=qn(t);return function e(){for(var u=-1,s=arguments.length,l=-1,c=i.length,f=n(c+s);++l<c;)f[l]=i[l];for(;s--;)f[l++]=arguments[++u];return(this&&this!==Ft&&this instanceof e?a:t).apply(o?r:this,f)}}.apply(o,x);return(k?Sn:Or)(E,x)}function hr(t,e,n){var r=Me.callback||Lo;return r=r===Lo?Xe:r,n?r(t,e,n):r}var pr=Ae?function(t){return Ae.get(t)}:Ho;function dr(t){for(var e=t.name,n=Oe[e],r=n?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function vr(t,e,n){var r=Me.indexOf||Hr;return r=r===Hr?Lt:r,t?r(t,e,n):r}var yr=kn("length");function _r(t){for(var e=xo(t),n=e.length;n--;)e[n][2]=jr(e[n][1]);return e}function gr(t,e){var n=null==t?o:t[e];return $i(n)?n:o}function mr(t,e,n){null==t||xr(e,t)||(t=1==(e=Ir(e)).length?t:yn(t,jn(e,0,-1)),e=Yr(e));var r=null==t?t:t[e];return null==r?o:r.apply(t,n)}function br(t){return null!=t&&Sr(yr(t))}function wr(t,e){return t="number"==typeof t||dt.test(t)?+t:-1,e=null==e?Pe:e,t>-1&&t%1==0&&t<e}function kr(t,e,n){if(!Qi(n))return!1;var r=typeof e;if("number"==r?br(n)&&wr(e,n.length):"string"==r&&e in n){var i=n[e];return t==t?t===i:i!=i}return!1}function xr(t,e){var n=typeof t;return!!("string"==n&&it.test(t)||"number"==n)||!qi(t)&&(!rt.test(t)||null!=e&&t in Fr(e))}function Er(t){var e=dr(t);if(!(e in Ie.prototype))return!1;var n=Me[e];if(t===n)return!0;var r=pr(n);return!!r&&t===r[0]}function Sr(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Pe}function jr(t){return t==t&&!Qi(t)}function Cr(t,e){t=Fr(t);for(var n=-1,r=e.length,i={};++n<r;){var o=e[n];o in t&&(i[o]=t[o])}return i}function Tr(t,e){var n={};return hn(t,function(t,r,i){e(t,r,i)&&(n[r]=t)}),n}var Pr,Ar,Or=(Pr=0,Ar=0,function(t,e){var n=ji(),r=w-(n-Ar);if(Ar=n,r>0){if(++Pr>=b)return t}else Pr=0;return Sn(t,e)});function Mr(t){for(var e=mo(t),n=e.length,r=n&&t.length,i=!!r&&Sr(r)&&(qi(t)||Yi(t)),o=-1,a=[];++o<n;){var u=e[o];(i&&wr(u,r)||Mt.call(t,u))&&a.push(u)}return a}function Rr(t){return null==t?[]:br(t)?Qi(t)?t:Et(t):So(t)}function Fr(t){return Qi(t)?t:Et(t)}function Ir(t){if(qi(t))return t;var e=[];return Ut(t).replace(ot,function(t,n,r,i){e.push(r?i.replace(lt,"$1"):n||t)}),e}function Br(t){return t instanceof Ie?t.clone():new Fe(t.__wrapped__,t.__chain__,Ue(t.__actions__))}var Lr=Hi(function(t,e){return Jt(t)&&br(t)?nn(t,ln(e,!1,!0)):[]});function Nr(t,e,n){return t&&t.length?((n?kr(t,e,n):null==e)&&(e=1),jn(t,e<0?0:e)):[]}function Ur(t,e,n){var r=t?t.length:0;return r?((n?kr(t,e,n):null==e)&&(e=1),jn(t,0,(e=r-(+e||0))<0?0:e)):[]}var Dr=$n(),Gr=$n(!0);function zr(t){return t?t[0]:o}function Hr(t,e,n){var r=t?t.length:0;if(!r)return-1;if("number"==typeof n)n=n<0?me(r+n,0):n;else if(n){var i=Fn(t,e);return i<r&&(e==e?e===t[i]:t[i]!=t[i])?i:-1}return Lt(t,e,n||0)}var Vr=Hi(function(t){for(var e=t.length,r=e,i=n(f),o=vr(),a=o==Lt,u=[];r--;){var s=t[r]=br(s=t[r])?s:[];i[r]=a&&s.length>=120?Vn(r&&s):null}var l=t[0],c=-1,f=l?l.length:0,h=i[0];t:for(;++c<f;)if(s=l[c],(h?Ne(h,s):o(u,s,0))<0){for(r=e;--r;){var p=i[r];if((p?Ne(p,s):o(t[r],s,0))<0)continue t}h&&h.push(s),u.push(s)}return u});function Yr(t){var e=t?t.length:0;return e?t[e-1]:o}var qr=Hi(function(t,e){var n=Qe(t,e=ln(e));return xn(t,e.sort(It)),n});function Wr(t){return Nr(t,1)}var Jr=cr(),Kr=cr(!0);var Qr=Hi(function(t){return An(ln(t,!1,!0))});function $r(t,e,n,r){if(!t||!t.length)return[];null!=e&&"boolean"!=typeof e&&(n=kr(t,e,r=n)?o:e,e=!1);var i=hr();return null==n&&i===Xe||(n=i(n,r,3)),e&&vr()==Lt?function(t,e){for(var n,r=-1,i=t.length,o=-1,a=[];++r<i;){var u=t[r],s=e?e(u,r,t):u;r&&n===s||(n=s,a[++o]=u)}return a}(t,n):An(t,n)}function Xr(t){if(!t||!t.length)return[];var e=-1,r=0;t=ze(t,function(t){if(br(t))return r=me(t.length,r),!0});for(var i=n(r);++e<r;)i[e]=He(t,kn(e));return i}function Zr(t,e,n){if(!t||!t.length)return[];var r=Xr(t);return null==e?r:(e=Bn(e,n,4),He(r,function(t){return Ye(t,e,o,!0)}))}var ti=Hi(function(t,e){return br(t)?nn(t,e):[]});var ei=Hi(Xr);function ni(t,e){var n=-1,r=t?t.length:0,i={};for(!r||e||qi(t[0])||(e=[]);++n<r;){var o=t[n];e?i[o]=e[n]:o&&(i[o[0]]=o[1])}return i}var ri=Hi(function(t){var e=t.length,n=e>2?t[e-2]:o,r=e>1?t[e-1]:o;return e>2&&"function"==typeof n?e-=2:(n=e>1&&"function"==typeof r?(--e,r):o,r=o),t.length=e,Zr(t,n,r)});function ii(t){var e=Me(t);return e.__chain__=!0,e}function oi(t,e,n){return e.call(n,t)}var ai=Hi(function(t){return t=ln(t),this.thru(function(e){return function(t,e){for(var r=-1,i=t.length,o=-1,a=e.length,u=n(i+a);++r<i;)u[r]=t[r];for(;++o<a;)u[r++]=e[o];return u}(qi(e)?e:[Fr(e)],t)})});var ui=Hi(function(t,e){return Qe(t,ln(e))}),si=Dn(function(t,e,n){Mt.call(t,n)?++t[n]:t[n]=1});function li(t,e,n){var r=qi(t)?Ge:an;return n&&kr(t,e,n)&&(e=o),"function"==typeof e&&n===o||(e=hr(e,n,3)),r(t,e)}function ci(t,e,n){return(qi(t)?ze:un)(t,e=hr(e,n,3))}var fi=Qn(rn),hi=Qn(on,!0);var pi=tr(De,rn),di=tr(function(t,e){for(var n=t.length;n--&&!1!==e(t[n],n,t););return t},on),vi=Dn(function(t,e,n){Mt.call(t,n)?t[n].push(e):t[n]=[e]});function yi(t,e,n,r){var i=t?yr(t):0;return Sr(i)||(i=(t=So(t)).length),n="number"!=typeof n||r&&kr(e,n,r)?0:n<0?me(i+n,0):n||0,"string"==typeof t||!qi(t)&&eo(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&vr(t,e,n)>-1}var _i=Dn(function(t,e,n){t[n]=e}),gi=Hi(function(t,e,r){var i=-1,a="function"==typeof e,u=xr(e),s=br(t)?n(t.length):[];return rn(t,function(t){var n=a?e:u&&null!=t?t[e]:o;s[++i]=n?n.apply(t,r):mr(t,e,r)}),s});function mi(t,e,n){return(qi(t)?He:mn)(t,e=hr(e,n,3))}var bi=Dn(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]});var wi=ar(Ye,rn),ki=ar(function(t,e,n,r){var i=t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n},on);function xi(t,e,n){if(n?kr(t,e,n):null==e)return(r=(t=Rr(t)).length)>0?t[En(0,r-1)]:o;var r,i=-1,a=io(t),u=(r=a.length)-1;for(e=be(e<0?0:+e||0,r);++i<e;){var s=En(i,u),l=a[s];a[s]=a[i],a[i]=l}return a.length=e,a}function Ei(t,e,n){var r=qi(t)?qe:Cn;return n&&kr(t,e,n)&&(e=o),"function"==typeof e&&n===o||(e=hr(e,n,3)),r(t,e)}var Si=Hi(function(t,e){if(null==t)return[];var n=e[2];return n&&kr(e[0],e[1],n)&&(e.length=1),Pn(t,ln(e),[])});var ji=we||function(){return(new r).getTime()};function Ci(t,e){var n;if("function"!=typeof e){if("function"!=typeof t)throw new Ct(S);var r=t;t=e,e=r}return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=o),n}}var Ti=Hi(function(t,e,n){var r=l;if(n.length){var i=Qt(n,Ti.placeholder);r|=d}return fr(t,r,e,n,i)}),Pi=Hi(function(t,e){for(var n=-1,r=(e=e.length?ln(e):_o(t)).length;++n<r;){var i=e[n];t[i]=fr(t[i],l,t)}return t}),Ai=Hi(function(t,e,n){var r=l|c;if(n.length){var i=Qt(n,Ai.placeholder);r|=d}return fr(e,r,t,n,i)}),Oi=Wn(h),Mi=Wn(p);function Ri(t,e,n){var r,i,a,u,s,l,c,f=0,h=!1,p=!0;if("function"!=typeof t)throw new Ct(S);if(e=e<0?0:+e||0,!0===n){var d=!0;p=!1}else Qi(n)&&(d=!!n.leading,h="maxWait"in n&&me(+n.maxWait||0,e),p="trailing"in n?!!n.trailing:p);function v(e,n){n&&ie(n),i=l=c=o,e&&(f=ji(),a=t.apply(s,r),l||i||(r=s=o))}function y(){var t=e-(ji()-u);t<=0||t>e?v(c,i):l=le(y,t)}function _(){v(p,l)}function g(){if(r=arguments,u=ji(),s=this,c=p&&(l||!d),!1===h)var n=d&&!l;else{i||d||(f=u);var v=h-(u-f),g=v<=0||v>h;g?(i&&(i=ie(i)),f=u,a=t.apply(s,r)):i||(i=le(_,v))}return g&&l?l=ie(l):l||e===h||(l=le(y,e)),n&&(g=!0,a=t.apply(s,r)),!g||l||i||(r=s=o),a}return g.cancel=function(){l&&ie(l),i&&ie(i),f=0,i=l=c=o},g}var Fi=Hi(function(t,e){return en(t,1,e)}),Ii=Hi(function(t,e,n){return en(t,e,n)}),Bi=Zn(),Li=Zn(!0);function Ni(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new Ct(S);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a),a};return n.cache=new Ni.Cache,n}var Ui=Hi(function(t,e){if(e=ln(e),"function"!=typeof t||!Ge(e,Nt))throw new Ct(S);var n=e.length;return Hi(function(r){for(var i=be(r.length,n);i--;)r[i]=e[i](r[i]);return t.apply(this,r)})});var Di=or(d),Gi=or(v),zi=Hi(function(t,e){return fr(t,_,o,o,o,ln(e))});function Hi(t,e){if("function"!=typeof t)throw new Ct(S);return e=me(e===o?t.length-1:+e||0,0),function(){for(var r=arguments,i=-1,o=me(r.length-e,0),a=n(o);++i<o;)a[i]=r[e+i];switch(e){case 0:return t.call(this,a);case 1:return t.call(this,r[0],a);case 2:return t.call(this,r[0],r[1],a)}var u=n(e+1);for(i=-1;++i<e;)u[i]=r[i];return u[e]=a,t.apply(this,u)}}function Vi(t,e){return t>e}function Yi(t){return Jt(t)&&br(t)&&Mt.call(t,"callee")&&!ue.call(t,"callee")}var qi=ye||function(t){return Jt(t)&&Sr(t.length)&&Kt.call(t)==T};function Wi(t,e,n,r){var i=(n="function"==typeof n?Bn(n,r,3):o)?n(t,e):o;return i===o?_n(t,e,n):!!i}function Ji(t){return Jt(t)&&"string"==typeof t.message&&Kt.call(t)==O}function Ki(t){return Qi(t)&&Kt.call(t)==M}function Qi(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function $i(t){return null!=t&&(Ki(t)?ne.test(Ot.call(t)):Jt(t)&&pt.test(t))}function Xi(t){return"number"==typeof t||Jt(t)&&Kt.call(t)==R}function Zi(t){var e,n;return!(!Jt(t)||Kt.call(t)!=F||Yi(t)||!(Mt.call(t,"constructor")||"function"!=typeof(e=t.constructor)||e instanceof e))&&(hn(t,function(t,e){n=e}),n===o||Mt.call(t,n))}function to(t){return Qi(t)&&Kt.call(t)==I}function eo(t){return"string"==typeof t||Jt(t)&&Kt.call(t)==B}function no(t){return Jt(t)&&Sr(t.length)&&!!wt[Kt.call(t)]}function ro(t,e){return t<e}function io(t){var e=t?yr(t):0;return Sr(e)?e?Ue(t):[]:So(t)}function oo(t){return $e(t,mo(t))}var ao=Gn(function t(e,n,r,i,a){if(!Qi(e))return e;var u=br(n)&&(qi(n)||no(n)),s=u?o:go(n);return De(s||n,function(l,c){if(s&&(l=n[c=l]),Jt(l))i||(i=[]),a||(a=[]),function(t,e,n,r,i,a,u){for(var s=a.length,l=e[n];s--;)if(a[s]==l)return void(t[n]=u[s]);var c=t[n],f=i?i(c,l,n,t,e):o,h=f===o;h&&(f=l,br(l)&&(qi(l)||no(l))?f=qi(c)?c:br(c)?Ue(c):[]:Zi(l)||Yi(l)?f=Yi(c)?oo(c):Zi(c)?c:{}:h=!1),a.push(l),u.push(f),h?t[n]=r(f,l,i,a,u):(f==f?f!==c:c==c)&&(t[n]=f)}(e,n,c,t,r,i,a);else{var f=e[c],h=r?r(f,l,c,e,n):o,p=h===o;p&&(h=l),h===o&&(!u||c in e)||!p&&(h==h?h===f:f!=f)||(e[c]=h)}}),e}),uo=Gn(function(t,e,n){return n?Je(t,e,n):Ke(t,e)});var so=Jn(uo,function(t,e){return t===o?e:t}),lo=Jn(ao,function t(e,n){return e===o?n:ao(e,n,t)}),co=Xn(pn),fo=Xn(dn),ho=er(cn),po=er(fn),vo=nr(pn),yo=nr(dn);function _o(t){return vn(t,mo(t))}var go=ge?function(t){var e=null==t?o:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&br(t)?Mr(t):Qi(t)?ge(t):[]}:Mr;function mo(t){if(null==t)return[];Qi(t)||(t=Et(t));var e=t.length;e=e&&Sr(e)&&(qi(t)||Yi(t))&&e||0;for(var r=t.constructor,i=-1,o="function"==typeof r&&r.prototype===t,a=n(e),u=e>0;++i<e;)a[i]=i+"";for(var s in t)u&&wr(s,e)||"constructor"==s&&(o||!Mt.call(t,s))||a.push(s);return a}var bo=rr(!0),wo=rr(),ko=Hi(function(t,e){if(null==t)return{};if("function"!=typeof e[0])return e=He(ln(e),jt),Cr(t,nn(mo(t),e));var n=Bn(e[0],e[1],3);return Tr(t,function(t,e,r){return!n(t,e,r)})});function xo(t){t=Fr(t);for(var e=-1,r=go(t),i=r.length,o=n(i);++e<i;){var a=r[e];o[e]=[a,t[a]]}return o}var Eo=Hi(function(t,e){return null==t?{}:"function"==typeof e[0]?Tr(t,Bn(e[0],e[1],3)):Cr(t,ln(e))});function So(t){return On(t,go(t))}var jo=Yn(function(t,e,n){return e=e.toLowerCase(),t+(n?e.charAt(0).toUpperCase()+e.slice(1):e)});function Co(t){return(t=Ut(t))&&t.replace(vt,Ht).replace(st,"")}var To=Yn(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()});var Po=ir(),Ao=ir(!0);function Oo(t,e){var n="";if(t=Ut(t),(e=+e)<1||!t||!_e(e))return n;do{e%2&&(n+=t),e=ve(e/2),t+=t}while(e);return n}var Mo=Yn(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Ro=Yn(function(t,e,n){return t+(n?" ":"")+(e.charAt(0).toUpperCase()+e.slice(1))});function Fo(t,e,n){var r=t;return(t=Ut(t))?(n?kr(r,e,n):null==e)?t.slice($t(t),Xt(t)+1):(e+="",t.slice(Dt(t,e),Gt(t,e)+1)):t}function Io(t,e,n){return n&&kr(t,e,n)&&(e=o),(t=Ut(t)).match(e||gt)||[]}var Bo=Hi(function(t,e){try{return t.apply(o,e)}catch(t){return Ji(t)?t:new i(t)}});function Lo(t,e,n){return n&&kr(t,e,n)&&(e=o),Jt(t)?Uo(t):Xe(t,e)}function No(t){return t}function Uo(t){return bn(Ze(t,!0))}var Do=Hi(function(t,e){return function(n){return mr(n,t,e)}}),Go=Hi(function(t,e){return function(n){return mr(t,n,e)}});function zo(t,e,n){if(null==n){var r=Qi(e),i=r?go(e):o,a=i&&i.length?vn(e,i):o;(a?a.length:r)||(a=!1,n=e,e=t,t=this)}a||(a=vn(e,go(e)));var u=!0,s=-1,l=Ki(t),c=a.length;!1===n?u=!1:Qi(n)&&"chain"in n&&(u=n.chain);for(;++s<c;){var f=a[s],h=e[f];t[f]=h,l&&(t.prototype[f]=function(e){return function(){var n=this.__chain__;if(u||n){var r=t(this.__wrapped__);return(r.__actions__=Ue(this.__actions__)).push({func:e,args:arguments,thisArg:t}),r.__chain__=n,r}return e.apply(t,Ve([this.value()],arguments))}}(h))}return t}function Ho(){}function Vo(t){return xr(t)?kn(t):function(t){var e=t+"";return t=Ir(t),function(n){return yn(n,t,e)}}(t)}var Yo,qo=lr("ceil"),Wo=lr("floor"),Jo=Kn(Vi,Ee),Ko=Kn(ro,Se),Qo=lr("round");return Me.prototype=Re.prototype,Fe.prototype=tn(Re.prototype),Fe.prototype.constructor=Fe,Ie.prototype=tn(Re.prototype),Ie.prototype.constructor=Ie,Be.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Be.prototype.get=function(t){return"__proto__"==t?o:this.__data__[t]},Be.prototype.has=function(t){return"__proto__"!=t&&Mt.call(this.__data__,t)},Be.prototype.set=function(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this},Le.prototype.push=function(t){var e=this.data;"string"==typeof t||Qi(t)?e.set.add(t):e.hash[t]=!0},Ni.Cache=Be,Me.after=function(t,e){if("function"!=typeof e){if("function"!=typeof t)throw new Ct(S);var n=t;t=e,e=n}return t=_e(t=+t)?t:0,function(){if(--t<1)return e.apply(this,arguments)}},Me.ary=function(t,e,n){return n&&kr(t,e,n)&&(e=o),e=t&&null==e?t.length:me(+e||0,0),fr(t,y,o,o,o,o,e)},Me.assign=uo,Me.at=ui,Me.before=Ci,Me.bind=Ti,Me.bindAll=Pi,Me.bindKey=Ai,Me.callback=Lo,Me.chain=ii,Me.chunk=function(t,e,r){e=(r?kr(t,e,r):null==e)?1:me(ve(e)||1,1);for(var i=0,o=t?t.length:0,a=-1,u=n(pe(o/e));i<o;)u[++a]=jn(t,i,i+=e);return u},Me.compact=function(t){for(var e=-1,n=t?t.length:0,r=-1,i=[];++e<n;){var o=t[e];o&&(i[++r]=o)}return i},Me.constant=function(t){return function(){return t}},Me.countBy=si,Me.create=function(t,e,n){var r=tn(t);return n&&kr(t,e,n)&&(e=o),e?Ke(r,e):r},Me.curry=Oi,Me.curryRight=Mi,Me.debounce=Ri,Me.defaults=so,Me.defaultsDeep=lo,Me.defer=Fi,Me.delay=Ii,Me.difference=Lr,Me.drop=Nr,Me.dropRight=Ur,Me.dropRightWhile=function(t,e,n){return t&&t.length?Mn(t,hr(e,n,3),!0,!0):[]},Me.dropWhile=function(t,e,n){return t&&t.length?Mn(t,hr(e,n,3),!0):[]},Me.fill=function(t,e,n,r){var i=t?t.length:0;return i?(n&&"number"!=typeof n&&kr(t,e,n)&&(n=0,r=i),function(t,e,n,r){var i=t.length;for((n=null==n?0:+n||0)<0&&(n=-n>i?0:i+n),(r=r===o||r>i?i:+r||0)<0&&(r+=i),i=n>r?0:r>>>0,n>>>=0;n<i;)t[n++]=e;return t}(t,e,n,r)):[]},Me.filter=ci,Me.flatten=function(t,e,n){var r=t?t.length:0;return n&&kr(t,e,n)&&(e=!1),r?ln(t,e):[]},Me.flattenDeep=function(t){return t&&t.length?ln(t,!0):[]},Me.flow=Bi,Me.flowRight=Li,Me.forEach=pi,Me.forEachRight=di,Me.forIn=ho,Me.forInRight=po,Me.forOwn=vo,Me.forOwnRight=yo,Me.functions=_o,Me.groupBy=vi,Me.indexBy=_i,Me.initial=function(t){return Ur(t,1)},Me.intersection=Vr,Me.invert=function(t,e,n){n&&kr(t,e,n)&&(e=o);for(var r=-1,i=go(t),a=i.length,u={};++r<a;){var s=i[r],l=t[s];e?Mt.call(u,l)?u[l].push(s):u[l]=[s]:u[l]=s}return u},Me.invoke=gi,Me.keys=go,Me.keysIn=mo,Me.map=mi,Me.mapKeys=bo,Me.mapValues=wo,Me.matches=Uo,Me.matchesProperty=function(t,e){return wn(t,Ze(e,!0))},Me.memoize=Ni,Me.merge=ao,Me.method=Do,Me.methodOf=Go,Me.mixin=zo,Me.modArgs=Ui,Me.negate=function(t){if("function"!=typeof t)throw new Ct(S);return function(){return!t.apply(this,arguments)}},Me.omit=ko,Me.once=function(t){return Ci(2,t)},Me.pairs=xo,Me.partial=Di,Me.partialRight=Gi,Me.partition=bi,Me.pick=Eo,Me.pluck=function(t,e){return mi(t,Vo(e))},Me.property=Vo,Me.propertyOf=function(t){return function(e){return yn(t,Ir(e),e+"")}},Me.pull=function(){var t=arguments,e=t[0];if(!e||!e.length)return e;for(var n=0,r=vr(),i=t.length;++n<i;)for(var o=0,a=t[n];(o=r(e,a,o))>-1;)ce.call(e,o,1);return e},Me.pullAt=qr,Me.range=function(t,e,r){r&&kr(t,e,r)&&(e=r=o),t=+t||0,null==e?(e=t,t=0):e=+e||0;for(var i=-1,a=me(pe((e-t)/((r=null==r?1:+r||0)||1)),0),u=n(a);++i<a;)u[i]=t,t+=r;return u},Me.rearg=zi,Me.reject=function(t,e,n){var r=qi(t)?ze:un;return e=hr(e,n,3),r(t,function(t,n,r){return!e(t,n,r)})},Me.remove=function(t,e,n){var r=[];if(!t||!t.length)return r;var i=-1,o=[],a=t.length;for(e=hr(e,n,3);++i<a;){var u=t[i];e(u,i,t)&&(r.push(u),o.push(i))}return xn(t,o),r},Me.rest=Wr,Me.restParam=Hi,Me.set=function(t,e,n){if(null==t)return t;for(var r=e+"",i=-1,o=(e=null!=t[r]||xr(e,t)?[r]:Ir(e)).length,a=o-1,u=t;null!=u&&++i<o;){var s=e[i];Qi(u)&&(i==a?u[s]=n:null==u[s]&&(u[s]=wr(e[i+1])?[]:{})),u=u[s]}return t},Me.shuffle=function(t){return xi(t,Se)},Me.slice=function(t,e,n){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&kr(t,e,n)&&(e=0,n=r),jn(t,e,n)):[]},Me.sortBy=function(t,e,n){if(null==t)return[];n&&kr(t,e,n)&&(e=o);var r=-1;return e=hr(e,n,3),Tn(mn(t,function(t,n,i){return{criteria:e(t,n,i),index:++r,value:t}}),zt)},Me.sortByAll=Si,Me.sortByOrder=function(t,e,n,r){return null==t?[]:(r&&kr(e,n,r)&&(n=o),qi(e)||(e=null==e?[]:[e]),qi(n)||(n=null==n?[]:[n]),Pn(t,e,n))},Me.spread=function(t){if("function"!=typeof t)throw new Ct(S);return function(e){return t.apply(this,e)}},Me.take=function(t,e,n){return t&&t.length?((n?kr(t,e,n):null==e)&&(e=1),jn(t,0,e<0?0:e)):[]},Me.takeRight=function(t,e,n){var r=t?t.length:0;return r?((n?kr(t,e,n):null==e)&&(e=1),jn(t,(e=r-(+e||0))<0?0:e)):[]},Me.takeRightWhile=function(t,e,n){return t&&t.length?Mn(t,hr(e,n,3),!1,!0):[]},Me.takeWhile=function(t,e,n){return t&&t.length?Mn(t,hr(e,n,3)):[]},Me.tap=function(t,e,n){return e.call(n,t),t},Me.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Ct(S);return!1===n?r=!1:Qi(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ri(t,e,{leading:r,maxWait:+e,trailing:i})},Me.thru=oi,Me.times=function(t,e,r){if((t=ve(t))<1||!_e(t))return[];var i=-1,o=n(be(t,je));for(e=Bn(e,r,1);++i<t;)i<je?o[i]=e(i):e(i);return o},Me.toArray=io,Me.toPlainObject=oo,Me.transform=function(t,e,n,r){var i=qi(t)||no(t);if(e=hr(e,r,4),null==n)if(i||Qi(t)){var a=t.constructor;n=i?qi(t)?new a:[]:tn(Ki(a)?a.prototype:o)}else n={};return(i?De:pn)(t,function(t,r,i){return e(n,t,r,i)}),n},Me.union=Qr,Me.uniq=$r,Me.unzip=Xr,Me.unzipWith=Zr,Me.values=So,Me.valuesIn=function(t){return On(t,mo(t))},Me.where=function(t,e){return ci(t,bn(e))},Me.without=ti,Me.wrap=function(t,e){return fr(e=null==e?No:e,d,o,[t],[])},Me.xor=function(){for(var t=-1,e=arguments.length;++t<e;){var n=arguments[t];if(br(n))var r=r?Ve(nn(r,n),nn(n,r)):n}return r?An(r):[]},Me.zip=ei,Me.zipObject=ni,Me.zipWith=ri,Me.backflow=Li,Me.collect=mi,Me.compose=Li,Me.each=pi,Me.eachRight=di,Me.extend=uo,Me.iteratee=Lo,Me.methods=_o,Me.object=ni,Me.select=ci,Me.tail=Wr,Me.unique=$r,zo(Me,Me),Me.add=function(t,e){return(+t||0)+(+e||0)},Me.attempt=Bo,Me.camelCase=jo,Me.capitalize=function(t){return(t=Ut(t))&&t.charAt(0).toUpperCase()+t.slice(1)},Me.ceil=qo,Me.clone=function(t,e,n,r){return e&&"boolean"!=typeof e&&kr(t,e,n)?e=!1:"function"==typeof e&&(r=n,n=e,e=!1),"function"==typeof n?Ze(t,e,Bn(n,r,1)):Ze(t,e)},Me.cloneDeep=function(t,e,n){return"function"==typeof e?Ze(t,!0,Bn(e,n,1)):Ze(t,!0)},Me.deburr=Co,Me.endsWith=function(t,e,n){e+="";var r=(t=Ut(t)).length;return n=n===o?r:be(n<0?0:+n||0,r),(n-=e.length)>=0&&t.indexOf(e,n)==n},Me.escape=function(t){return(t=Ut(t))&&Z.test(t)?t.replace($,Vt):t},Me.escapeRegExp=function(t){return(t=Ut(t))&&ut.test(t)?t.replace(at,Yt):t||"(?:)"},Me.every=li,Me.find=fi,Me.findIndex=Dr,Me.findKey=co,Me.findLast=hi,Me.findLastIndex=Gr,Me.findLastKey=fo,Me.findWhere=function(t,e){return fi(t,bn(e))},Me.first=zr,Me.floor=Wo,Me.get=function(t,e,n){var r=null==t?o:yn(t,Ir(e),e+"");return r===o?n:r},Me.gt=Vi,Me.gte=function(t,e){return t>=e},Me.has=function(t,e){if(null==t)return!1;var n=Mt.call(t,e);if(!n&&!xr(e)){if(null==(t=1==(e=Ir(e)).length?t:yn(t,jn(e,0,-1))))return!1;e=Yr(e),n=Mt.call(t,e)}return n||Sr(t.length)&&wr(e,t.length)&&(qi(t)||Yi(t))},Me.identity=No,Me.includes=yi,Me.indexOf=Hr,Me.inRange=function(t,e,n){return e=+e||0,n===o?(n=e,e=0):n=+n||0,t>=be(e,n)&&t<me(e,n)},Me.isArguments=Yi,Me.isArray=qi,Me.isBoolean=function(t){return!0===t||!1===t||Jt(t)&&Kt.call(t)==P},Me.isDate=function(t){return Jt(t)&&Kt.call(t)==A},Me.isElement=function(t){return!!t&&1===t.nodeType&&Jt(t)&&!Zi(t)},Me.isEmpty=function(t){return null==t||(br(t)&&(qi(t)||eo(t)||Yi(t)||Jt(t)&&Ki(t.splice))?!t.length:!go(t).length)},Me.isEqual=Wi,Me.isError=Ji,Me.isFinite=function(t){return"number"==typeof t&&_e(t)},Me.isFunction=Ki,Me.isMatch=function(t,e,n,r){return n="function"==typeof n?Bn(n,r,3):o,gn(t,_r(e),n)},Me.isNaN=function(t){return Xi(t)&&t!=+t},Me.isNative=$i,Me.isNull=function(t){return null===t},Me.isNumber=Xi,Me.isObject=Qi,Me.isPlainObject=Zi,Me.isRegExp=to,Me.isString=eo,Me.isTypedArray=no,Me.isUndefined=function(t){return t===o},Me.kebabCase=To,Me.last=Yr,Me.lastIndexOf=function(t,e,n){var r=t?t.length:0;if(!r)return-1;var i=r;if("number"==typeof n)i=(n<0?me(r+n,0):be(n||0,r-1))+1;else if(n){var o=t[i=Fn(t,e,!0)-1];return(e==e?e===o:o!=o)?i:-1}if(e!=e)return Wt(t,i,!0);for(;i--;)if(t[i]===e)return i;return-1},Me.lt=ro,Me.lte=function(t,e){return t<=e},Me.max=Jo,Me.min=Ko,Me.noConflict=function(){return Ft._=ee,this},Me.noop=Ho,Me.now=ji,Me.pad=function(t,e,n){e=+e;var r=(t=Ut(t)).length;if(r>=e||!_e(e))return t;var i=(e-r)/2,o=ve(i);return(n=sr("",pe(i),n)).slice(0,o)+t+n},Me.padLeft=Po,Me.padRight=Ao,Me.parseInt=function(t,e,n){return(n?kr(t,e,n):null==e)?e=0:e&&(e=+e),t=Fo(t),ke(t,e||(ht.test(t)?16:10))},Me.random=function(t,e,n){n&&kr(t,e,n)&&(e=n=o);var r=null==t,i=null==e;if(null==n&&(i&&"boolean"==typeof t?(n=t,t=1):"boolean"==typeof e&&(n=e,i=!0)),r&&i&&(e=1,i=!1),t=+t||0,i?(e=t,t=0):e=+e||0,n||t%1||e%1){var a=xe();return be(t+a*(e-t+oe("1e-"+((a+"").length-1))),e)}return En(t,e)},Me.reduce=wi,Me.reduceRight=ki,Me.repeat=Oo,Me.result=function(t,e,n){var r=null==t?o:t[e];return r===o&&(null==t||xr(e,t)||(r=null==(t=1==(e=Ir(e)).length?t:yn(t,jn(e,0,-1)))?o:t[Yr(e)]),r=r===o?n:r),Ki(r)?r.call(t):r},Me.round=Qo,Me.runInContext=t,Me.size=function(t){var e=t?yr(t):0;return Sr(e)?e:go(t).length},Me.snakeCase=Mo,Me.some=Ei,Me.sortedIndex=Jr,Me.sortedLastIndex=Kr,Me.startCase=Ro,Me.startsWith=function(t,e,n){return t=Ut(t),n=null==n?0:be(n<0?0:+n||0,t.length),t.lastIndexOf(e,n)==n},Me.sum=function(t,e,n){return n&&kr(t,e,n)&&(e=o),1==(e=hr(e,n,3)).length?function(t,e){for(var n=t.length,r=0;n--;)r+=+e(t[n])||0;return r}(qi(t)?t:Rr(t),e):function(t,e){var n=0;return rn(t,function(t,r,i){n+=+e(t,r,i)||0}),n}(t,e)},Me.template=function(t,e,n){var r=Me.templateSettings;n&&kr(t,e,n)&&(e=n=o),t=Ut(t);var i,u,s=Je(Ke({},(e=Je(Ke({},n||e),r,We)).imports),r.imports,We),l=go(s),c=On(s,l),f=0,h=e.interpolate||yt,p="__p += '",d=St((e.escape||yt).source+"|"+h.source+"|"+(h===nt?ct:yt).source+"|"+(e.evaluate||yt).source+"|$","g"),v="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++bt+"]")+"\n";t.replace(d,function(e,n,r,o,a,s){return r||(r=o),p+=t.slice(f,s).replace(_t,qt),n&&(i=!0,p+="' +\n__e("+n+") +\n'"),a&&(u=!0,p+="';\n"+a+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),f=s+e.length,e}),p+="';\n";var y=e.variable;y||(p="with (obj) {\n"+p+"\n}\n"),p=(u?p.replace(W,""):p).replace(J,"$1").replace(K,"$1;"),p="function("+(y||"obj")+") {\n"+(y?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var _=Bo(function(){return a(l,v+"return "+p).apply(o,c)});if(_.source=p,Ji(_))throw _;return _},Me.trim=Fo,Me.trimLeft=function(t,e,n){var r=t;return(t=Ut(t))?(n?kr(r,e,n):null==e)?t.slice($t(t)):t.slice(Dt(t,e+"")):t},Me.trimRight=function(t,e,n){var r=t;return(t=Ut(t))?(n?kr(r,e,n):null==e)?t.slice(0,Xt(t)+1):t.slice(0,Gt(t,e+"")+1):t},Me.trunc=function(t,e,n){n&&kr(t,e,n)&&(e=o);var r=g,i=m;if(null!=e)if(Qi(e)){var a="separator"in e?e.separator:a;r="length"in e?+e.length||0:r,i="omission"in e?Ut(e.omission):i}else r=+e||0;if(r>=(t=Ut(t)).length)return t;var u=r-i.length;if(u<1)return i;var s=t.slice(0,u);if(null==a)return s+i;if(to(a)){if(t.slice(u).search(a)){var l,c,f=t.slice(0,u);for(a.global||(a=St(a.source,(ft.exec(a)||"")+"g")),a.lastIndex=0;l=a.exec(f);)c=l.index;s=s.slice(0,null==c?u:c)}}else if(t.indexOf(a,u)!=u){var h=s.lastIndexOf(a);h>-1&&(s=s.slice(0,h))}return s+i},Me.unescape=function(t){return(t=Ut(t))&&X.test(t)?t.replace(Q,Zt):t},Me.uniqueId=function(t){var e=++Rt;return Ut(t)+e},Me.words=Io,Me.all=li,Me.any=Ei,Me.contains=yi,Me.eq=Wi,Me.detect=fi,Me.foldl=wi,Me.foldr=ki,Me.head=zr,Me.include=yi,Me.inject=wi,zo(Me,(Yo={},pn(Me,function(t,e){Me.prototype[e]||(Yo[e]=t)}),Yo),!1),Me.sample=xi,Me.prototype.sample=function(t){return this.__chain__||null!=t?this.thru(function(e){return xi(e,t)}):xi(this.value())},Me.VERSION=s,De(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){Me[t].placeholder=Me}),De(["drop","take"],function(t,e){Ie.prototype[t]=function(n){var r=this.__filtered__;if(r&&!e)return new Ie(this);n=null==n?1:me(ve(n)||0,0);var i=this.clone();return r?i.__takeCount__=be(i.__takeCount__,n):i.__views__.push({size:n,type:t+(i.__dir__<0?"Right":"")}),i},Ie.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),De(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n!=E;Ie.prototype[t]=function(t,e){var i=this.clone();return i.__iteratees__.push({iteratee:hr(t,e,1),type:n}),i.__filtered__=i.__filtered__||r,i}}),De(["first","last"],function(t,e){var n="take"+(e?"Right":"");Ie.prototype[t]=function(){return this[n](1).value()[0]}}),De(["initial","rest"],function(t,e){var n="drop"+(e?"":"Right");Ie.prototype[t]=function(){return this.__filtered__?new Ie(this):this[n](1)}}),De(["pluck","where"],function(t,e){var n=e?"filter":"map",r=e?bn:Vo;Ie.prototype[t]=function(t){return this[n](r(t))}}),Ie.prototype.compact=function(){return this.filter(No)},Ie.prototype.reject=function(t,e){return t=hr(t,e,1),this.filter(function(e){return!t(e)})},Ie.prototype.slice=function(t,e){t=null==t?0:+t||0;var n=this;return n.__filtered__&&(t>0||e<0)?new Ie(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==o&&(n=(e=+e||0)<0?n.dropRight(-e):n.take(e-t)),n)},Ie.prototype.takeRightWhile=function(t,e){return this.reverse().takeWhile(t,e).reverse()},Ie.prototype.toArray=function(){return this.take(Se)},pn(Ie.prototype,function(t,e){var n=/^(?:filter|map|reject)|While$/.test(e),r=/^(?:first|last)$/.test(e),i=Me[r?"take"+("last"==e?"Right":""):e];i&&(Me.prototype[e]=function(){var e=r?[1]:arguments,a=this.__chain__,u=this.__wrapped__,s=!!this.__actions__.length,l=u instanceof Ie,c=e[0],f=l||qi(u);f&&n&&"function"==typeof c&&1!=c.length&&(l=f=!1);var h=function(t){return r&&a?i(t,1)[0]:i.apply(o,Ve([t],e))},p={func:oi,args:[h],thisArg:o},d=l&&!s;if(r&&!a)return d?((u=u.clone()).__actions__.push(p),t.call(u)):i.call(o,this.value())[0];if(!r&&f){u=d?u:new Ie(this);var v=t.apply(u,e);return v.__actions__.push(p),new Fe(v,a)}return this.thru(h)})}),De(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(t){var e=(/^(?:replace|split)$/.test(t)?At:Tt)[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:join|pop|replace|shift)$/.test(t);Me.prototype[t]=function(){var t=arguments;return r&&!this.__chain__?e.apply(this.value(),t):this[n](function(n){return e.apply(n,t)})}}),pn(Ie.prototype,function(t,e){var n=Me[e];if(n){var r=n.name;(Oe[r]||(Oe[r]=[])).push({name:e,func:n})}}),Oe[ur(o,c).name]=[{name:"wrapper",func:o}],Ie.prototype.clone=function(){var t=new Ie(this.__wrapped__);return t.__actions__=Ue(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ue(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ue(this.__views__),t},Ie.prototype.reverse=function(){if(this.__filtered__){var t=new Ie(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Ie.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=qi(t),r=e<0,i=n?t.length:0,o=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=be(e,t+a);break;case"takeRight":t=me(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=o.start,u=o.end,s=u-a,l=r?u:a-1,c=this.__iteratees__,f=c.length,h=0,p=be(s,this.__takeCount__);if(!n||i<k||i==s&&p==s)return Rn(r&&n?t.reverse():t,this.__actions__);var d=[];t:for(;s--&&h<p;){for(var v=-1,y=t[l+=e];++v<f;){var _=c[v],g=_.iteratee,m=_.type,b=g(y);if(m==E)y=b;else if(!b){if(m==x)continue t;break t}}d[h++]=y}return d},Me.prototype.chain=function(){return ii(this)},Me.prototype.commit=function(){return new Fe(this.value(),this.__chain__)},Me.prototype.concat=ai,Me.prototype.plant=function(t){for(var e,n=this;n instanceof Re;){var r=Br(n);e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},Me.prototype.reverse=function(){var t=this.__wrapped__,e=function(t){return n&&n.__dir__<0?t:t.reverse()};if(t instanceof Ie){var n=t;return this.__actions__.length&&(n=new Ie(this)),(n=n.reverse()).__actions__.push({func:oi,args:[e],thisArg:o}),new Fe(n,this.__chain__)}return this.thru(e)},Me.prototype.toString=function(){return this.value()+""},Me.prototype.run=Me.prototype.toJSON=Me.prototype.valueOf=Me.prototype.value=function(){return Rn(this.__wrapped__,this.__actions__)},Me.prototype.collect=Me.prototype.map,Me.prototype.head=Me.prototype.first,Me.prototype.select=Me.prototype.filter,Me.prototype.tail=Me.prototype.rest,Me}();Ft._=te,(i=function(){return te}.call(e,n,e,t))===o||(t.exports=i)}).call(this)}).call(this,n(79)(t),n(46))},332:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GameNote=void 0;var r=o(n(240)),i=o(n(188));function o(t){return t&&t.__esModule?t:{default:t}}var a=e.GameNote=new r.default(i.default,{id:Number,end:r.default.maybe(i.default),column:String});e.default=a},333:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fromBMSChart=function(t,e){var n=r.default.Notes.fromBMSChart(t).all(),a=r.default.Timing.fromBMSChart(t),u=r.default.Keysounds.fromBMSChart(t),s=r.default.SongInfo.fromBMSChart(t),l=r.default.Positioning.fromBMSChart(t),c=r.default.Spacing.fromBMSChart(t),f={notes:n,timing:a,keysounds:u,songInfo:s,positioning:l,spacing:c,barLines:function(t,e){var n=i.default.max(t.map(function(t){return t.endBeat||t.beat})),r=[0],o=0,a=0;do{o+=e.timeSignatures.getBeats(a),a+=1,r.push(o)}while(o<=n);return r}(n,t),expertJudgmentWindow:function(t){var e=+t.headers.get("rank")||2;return 0===e?[8,24]:1===e?[15,30]:3===e?[21,60]:[18,40]}(t)};return new o.default(f,e)};var r=a(n(103)),i=a(n(43)),o=a(n(254));function a(t){return t&&t.__esModule?t:{default:t}}},334:function(t,e,n){var r=n(161);n(149);function i(t){t.length>0&&(this._speedcore=new r(t))}t.exports=i,i.prototype.factor=function(t){return this._speedcore?this._speedcore.x(t):1},i.fromBMSChart=function(t){var e=[];return t.objects.allSorted().forEach(function(n){if("SP"===n.channel){var r=t.measureToBeat(n.measure,n.fraction),i=+t.headers.get("speed"+n.value);if(isNaN(i))return;if(e.length>0){var o=e[e.length-1];o.dx=(i-o.x)/(r-o.t)}e.push({t:r,x:i,dx:0,inclusive:!0})}}),e.length>0&&e.unshift({t:0,x:e[0].x,dx:0,inclusive:!0}),new i(e)}},335:function(t,e,n){var r=n(161);n(149);function i(t){this._speedcore=new r(t)}t.exports=i,i.prototype.speed=function(t){return this._speedcore.dx(t)},i.prototype.position=function(t){return this._speedcore.x(t)},i.fromBMSChart=function(t){var e=[],n=0;return e.push({t:0,x:n,dx:1,inclusive:!0}),t.objects.allSorted().forEach(function(r){if("SC"===r.channel){var i=t.measureToBeat(r.measure,r.fraction),o=+t.headers.get("scroll"+r.value);if(isNaN(o))return;var a=e[e.length-1];n+=(i-a.t)*a.dx,0===i&&1===e.length?e[0].dx=o:e.push({t:i,x:n,dx:o,inclusive:!0})}}),new i(e)}},336:function(t,e,n){var r=n(149);function i(t){this._map=t}i.prototype.get=function(t){return this._map[t.toLowerCase()]},i.prototype.files=function(){return r.uniq(r.values(this._map))},i.prototype.all=function(){return this._map},i.fromBMSChart=function(t){var e={};return t.headers.each(function(t,n){var r=t.match(/^wav(\S\S)$/i);r&&(e[r[1].toLowerCase()]=n)}),new i(e)},t.exports=i},337:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},338:function(t,e){e.read=function(t,e,n,r,i){var o,a,u=8*i-r-1,s=(1<<u)-1,l=s>>1,c=-7,f=n?i-1:0,h=n?-1:1,p=t[e+f];for(f+=h,o=p&(1<<-c)-1,p>>=-c,c+=u;c>0;o=256*o+t[e+f],f+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+t[e+f],f+=h,c-=8);if(0===o)o=1-l;else{if(o===s)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=l}return(p?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,u,s,l=8*o-i-1,c=(1<<l)-1,f=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(s=Math.pow(2,-a))<1&&(a--,s*=2),(e+=a+f>=1?h/s:h*Math.pow(2,1-f))*s>=2&&(a++,s/=2),a+f>=c?(u=0,a=c):a+f>=1?(u=(e*s-1)*Math.pow(2,i),a+=f):(u=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&u,p+=d,u/=256,i-=8);for(a=a<<i|u,l+=i;l>0;t[n+p]=255&a,p+=d,a/=256,l-=8);t[n+p-d]|=128*v}},339:function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(t){return r.exec(t).slice(1)};function o(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var a=i>=0?arguments[i]:t.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(e=a+"/"+e,r="/"===a.charAt(0))}return(r?"/":"")+(e=n(o(e.split("/"),function(t){return!!t}),!r).join("/"))||"."},e.normalize=function(t){var r=e.isAbsolute(t),i="/"===a(t,-1);return(t=n(o(t.split("/"),function(t){return!!t}),!r).join("/"))||r||(t="."),t&&i&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(o(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),u=a,s=0;s<a;s++)if(i[s]!==o[s]){u=s;break}var l=[];for(s=u;s<i.length;s++)l.push("..");return(l=l.concat(o.slice(u))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=i(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},e.basename=function(t,e){var n=i(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){return i(t)[3]};var a="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(66))},340:function(t,e,n){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},479:function(t,e){e.convert=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return{offset:(n-e+(r-i))/2,delay:i-e-(r-n)}},e.offset=function(t){(t=t.slice()).sort(function(t,e){return t.offset-e.offset}),(t=t.slice(1,t.length-1)).sort(function(t,e){return t.delay-e.delay});for(var e=0,n=0,r=Math.ceil(t.length/8),i=0;i<t.length&&(t[i].delay>t[0].delay&&r--,0!==r);i++)e+=t[i].offset,n+=1;return e/n}},480:function(t,e,n){var r=n(479);t.exports=function(t,e,n){var i=new WebSocket(t),o=[];function a(){try{i.send(""+(new Date).getTime())}catch(t){}}i.onmessage=function(t){"k"==t.data&&a(),t.data.indexOf(",")>=0&&(!function(t){var e=t.split(","),i=+e[0],a=+e[1],u=(new Date).getTime();i<=u&&o.push(r.convert([i,a,a,u]));o.length>=8&&n&&n(r.offset(o))}(t.data),a())},i.onclose=function(){return o.length<1?e(new Error("no offset received")):e(null,r.offset(o))}}},496:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=e.WaveFactory=function(){function t(e,n,r){var i=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).volume;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._master=e,this._samples=n,this._map=r,this._exclusiveInstances=new Map,this._group=this._master.group({volume:i})}return r(t,[{key:"playAuto",value:function(t,e,n){return this._play({note:t,delay:e,exclusive:!0,slice:n})}},{key:"playNote",value:function(t,e,n){return this._play({note:t,delay:e,exclusive:!0,slice:n})}},{key:"playFree",value:function(t,e,n){return this._play({note:t,delay:0,exclusive:!1,slice:n})}},{key:"_play",value:function(t){var e=t.note,n=t.delay,r=t.exclusive,i=e.keysound;r&&this._stopOldExclusiveSound(i,n);var o=this._map[i.toLowerCase()];if(!o)return null;var a=this._samples[o];if(!a)return null;var u=a.play(n,{start:e.keysoundStart,end:e.keysoundEnd,group:this._group});return r&&this._exclusiveInstances.set(i,u),u}},{key:"_stopOldExclusiveSound",value:function(t,e){var n=this._exclusiveInstances.get(t);n&&(setTimeout(function(){return n.stop()},1e3*e),this._exclusiveInstances.delete(t))}}]),t}();e.default=i},497:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createKeysoundCache=a;var r,i=n(119),o=(r=i)&&r.__esModule?r:{default:r};function a(){var t=new Map,e=void 0;return{receiveSongId:function(n){e!==n&&(e=n,t.clear())},isEmpty:function(){return 0===t.size},isCached:function(e){return t.has(e)},cache:function(n,r){(0,o.default)(e,"Expected current song to be set."),t.set(n,r)},get:function(e){return t.get(e)}}}e.default=a},56:function(t,e,n){var r;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var o=typeof r;if("string"===o||"number"===o)t.push(r);else if(Array.isArray(r))t.push(i.apply(null,r));else if("object"===o)for(var a in r)n.call(r,a)&&r[a]&&t.push(a)}}return t.join(" ")}void 0!==t&&t.exports?t.exports=i:void 0===(r=function(){return i}.apply(e,[]))||(t.exports=r)}()},595:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SamplesLoader=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(126)),o=l(n(43)),a=l(n(329)),u=n(89),s=n(150);function l(t){return t&&t.__esModule?t:{default:t}}var c=e.SamplesLoader=function(){function t(e,n){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).keysoundCache,i=void 0===r?a.default:r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._assets=e,this._master=n,this._keysoundCache=i}return r(t,[{key:"loadFiles",value:function(t,e,n){var r=this,a=i.fixed(t.length,e),s=i.fixed(t.length,n);return n&&(n.formatter=u.EXTRA_FORMATTER),Promise.map(t,function(t){return new Promise(function(e){requestAnimationFrame(function(){e(r._loadSample(t,a,s))})})},{concurrency:64}).then(function(t){return(0,o.default)(t).filter().fromPairs().value()})}},{key:"_loadSample",value:function(t,e,n){var r=this;return(r._keysoundCache.isCached(t)?Promise.resolve(r._keysoundCache.get(t)).tap(function(){e(t),n(t)}):r._getFile(t).then(function(i){return i.read().tap(function(){e(t)}).then(function(t){return r._decode(t)}).tap(function(e){r._keysoundCache.cache(t,e),n(t)})})).then(function(t){return r._master.sample(t)}).then(function(e){return[t,e]}).catch(function(e){return console.error("Unable to load keysound: "+t,e),null})}},{key:"_decode",value:function(t){return this._master.decode(t)}},{key:"_getFile",value:function(t){var e=this;return Promise.try(function(){if(!(0,s.canPlay)('audio/ogg; codecs="vorbis"'))throw new Error("cannot play OGG");return e._assets.file(t.replace(/\.\w+$/,".ogg"))}).catch(function(){return e._assets.file(t.replace(/\.\w+$/,".m4a"))}).catch(function(){return e._assets.file(t.replace(/\.\w+$/,".mp3"))}).catch(function(){return e._assets.file(t)})}}]),t}();e.default=c},596:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAEEklEQVR4AdSaBY/zPAzHBw8cMzMzCo+ZmZmZmfvh7/1P8kt+kq65dLt00k9QZYbUSWynvkj/Pj8/40Et6AZz4ABcgQfwTjzQswMa003/ifd58QfDc8EwOAGWJickK9d0p3+DNnAKrAhxSjp+m+R4DOgBj8CKEo+kM+Y7HfeDZvAQxtgPcEBh3AqKQAqIA0Eijp4V0Zhh+s9HGNn3ZIM/2s4ng10bw97BMqgFMZrRVUuy3mX6yJbkaDlfCO4lhryCfhAXAb1xJPvVJhoKI+18C3iXhPkUSIrCC0giXR+SyGuJhNIArUtLwBrI/IY9KJN0WxyyNeCm8ysSRZ0GnEKdEttWXJkEyZt/AdUGHcXV4EUUCW6seYtxBbIMTMSyyDaL0aKz279z503Oz6nuuBJsjIVfOefvediL37yRkfAiOCKTFTI8YZJTrWlYLGgEM2AbnIMX4hLsgRkak+BQ5oB0TxAnS34nQps1d3surwZsOUhrRQZX2sgdonG/FE6HZiep5wM/5zX2kD1gaXIMSkTOE9LkS5An3Num5lRh8Qwv8wt5wwiwXGYQBJnzIbLDJEs88nrs6nle0k59oXjZsHHiCHSDEpAOfhF/V4LdYYqsW8Gz4jA2TQlK6d+igW2CwiZJ0fkzieGLIF1xJ59xGBnVDmoHXkC1iQbyTk6/YthvSJKmAs3K85LJVE50Qr7wzpKgh8eSB4WSVrLmtxVkKMlmtDkspXlSl2uX7y8rvSWx80F95/mGJ6TPoaxlaZ0g6N7WKhi5Jwj7uGg4T4w5lFfLu83/zZ/50RejkORYjIJoOU/MK2zS/EiMF83MvoKhW3y3d8H5AWApsK4g++CPSKezV7mGptyez2i6SwXNLzq+skExRVoLaAN9YAzMg3UwqdHb6A49nGMPWx0Ka+RJjgcqxVZm85woLIocCpvls+mBCShiNh/4BA2EFIfCttn/SjwwASn8xPIJqr84h8LO+fr3wATEMZsffDxDcprACLouvzwwAUGe8XpyAsiRjv/QpjMBnlsC0JXG17LGEvDeJghd5Uz3lsYm6L1jkMJe0LhRPwY9mQiFdHGbdRIhY1Jhh3ozBMVbnE4qXMvD4juKIQWdC+4WQwaUw5rNlzqdctjMhoh8yV0wXXvAr9EQMbolxhOYHZ1oE7fEvNEUjQObCq0whaao+W3xfMmd/wb7+kOvLW7gxUgG/ccScMo3ae2LEQOuxtJAMegBhzb/3xQtK42rMU9djsq//NK8HOVv8N6w6/G9cBegGtfjxn4g8UGnSLXLn881m/CJzKzgE5kLejZLY2L/at8OLACAgSAI1nolpH9IC8kJ4U0Xi50H21y1yJikbHJGSausWdouD0wgM9DUBZtbB1mbgs3lP5sDJ9FZeHo6n99ybdMJ2yzi/QAAAABJRU5ErkJggg=="},597:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACxUlEQVR4AdSYgWfrUBTG2xWNhLbQUbQAlUA7oEzKUNSGwqbA84INBs3oJPvj+75wUMe5Sd+yfM3KD+L2nvPdnNz7ndtp+nc6nQIQghjsQALeQQoyIZVniYyJ5T9BI0kRRE/ABryCr5q8ylyTtovugxV4k8Sb4E1i9Nsk3ANr8CFJMviQmN41hXfBAqQVyeYgkTK+AzMwAj7oCb48m8mYjfwnr5j7IDl02eKH4E9JYhl4lo3Mq1ldocyVueJJLkOW+Ck4OBL5BA/AbyCuL3N/llTDtGnxS5A5yvwJDAgvYCCxckflLZsIegM2jpXfg/EV9qCxxP7SSK43Pyn+xRHovgWn0L0jt5cfWQTHmz+CeYuO4jk4WpVQ+5s3Jn0Hty00YreSm853WWe3zwzxQYvdaKAXQTRMv3POH3TZ22++lZVwNI7I4eUOzzY581/UjM0dZql7yZ8X5m5fvmBbEBEFRhKz+5+nw6LSehrefl8h/vHMDEUk8bnEfKxYhL3xKXhlk68NhzcuGb81xkcM8WdsK8ySHr8u6+d1S/t0SUKERfh2rEKD0Ur3rYEro7EZNJIYQbzqHXQDtbIG6pucB0KClLkLLfpmSQ+YGObBJyRKmbPQYpi6SZnffyYkTF3QQpOzTzBub0PCW2NXU6hvm8/9sw7kUb5bgnjlcfS8gbUyf2k7N0G8mj/RlV48jK1vg7cIBPHuvS4uHu7UwzuWgWEbqkKbirGzymLGdHFkNzlTcZKOcYEwIvr4nCVechjpC56O0f35zGaG3Ez5Kl7aMRxSj9HOssVL7J52vP/at28CgIEYiqF4AssQzH/Jmt4z/QfhqptkAzwBn6AwmJ4ISYWH1bUIKobiy2ENES0xTVFtcYMRozHD0Vms7IDxOEACIgOSgskBJaGyYGm4PGGCMkOaeq/N9QVtrh5oc/W7NkecpM6Sp+P1+REepk4aEr9vwAAAAABJRU5ErkJggg=="},598:function(t,e,n){t.exports=n.p+"ea410328703171d8f693d3a404a11a8f.jpg"},599:function(t,e,n){var r=n(120);(t.exports=n(1)(!1)).push([t.i,".game-display {\n  display: block;\n  margin: 0 auto;\n  overflow: hidden;\n  position: relative;\n}\n\n.game-display--bg {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 10;\n  background: url("+r(n(598))+") center no-repeat;\n  background-size: cover;\n  -webkit-animation: 1.5s game-display--bg-default;\n          animation: 1.5s game-display--bg-default;\n  -webkit-animation-fill-mode: both;\n          animation-fill-mode: both;\n}\n\n.game-display[data-info-panel-position='top'] .game-display--bg {\n  -webkit-animation-name: game-display--bg-down;\n          animation-name: game-display--bg-down;\n}\n\n.game-display--video-bg {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: -48px;\n  left: 0px;\n  z-index: 11;\n  opacity: 0;\n  -webkit-transition: 0.5s opacity;\n  transition: 0.5s opacity;\n  will-change: opacity;\n}\n\n.game-display--video-bg.is-playing {\n  opacity: 1;\n}\n\n.game-display[data-panel-placement='left'] .game-display--video-bg {\n  -webkit-transform: translateX(13.67188%) scale(0.87);\n          transform: translateX(13.67188%) scale(0.87);\n}\n\n.game-display[data-panel-placement='right'] .game-display--video-bg {\n  -webkit-transform: translateX(13.67188%) scale(0.87);\n          transform: translateX(13.67188%) scale(0.87);\n}\n\n.game-display--bg img {\n  width: 100%;\n  height: 100%;\n  display: block;\n  -o-object-fit: cover;\n     object-fit: cover;\n  -webkit-animation: 1.2s game-display--bg-default;\n          animation: 1.2s game-display--bg-default;\n  -webkit-animation-fill-mode: both;\n          animation-fill-mode: both;\n}\n\n.game-display[data-info-panel-position='top'] .game-display--bg img {\n  -webkit-animation-name: game-display--bg-down;\n          animation-name: game-display--bg-down;\n}\n\n.game-display > canvas {\n  position: relative;\n  z-index: 100;\n}\n\n.game-display--touch-buttons {\n  position: fixed;\n  -webkit-transform: translateZ(0);\n          transform: translateZ(0);\n  top: 0;\n  left: 0;\n  opacity: 0;\n  z-index: 110;\n}\n\n.game-display--touch-buttons.is-visible {\n  opacity: 1;\n}\n\n.game-display--touch-escape-button, .game-display--touch-replay-button {\n  position: absolute;\n  top: 12px;\n  margin: 0;\n  padding: 0;\n  border: 0;\n  width: 32px;\n  height: 32px;\n  background: transparent center center no-repeat;\n  background-size: 32px 32px;\n}\n\n.game-display--touch-escape-button {\n  background-image: url("+r(n(597))+");\n  left: 12px;\n}\n\n.game-display--touch-replay-button {\n  background-image: url("+r(n(596))+");\n  left: 56px;\n}\n\n@-webkit-keyframes game-display--bg-default {\n  from {\n    -webkit-transform: translate(0, 0);\n            transform: translate(0, 0);\n    opacity: 0;\n  }\n  to {\n    -webkit-transform: translate(0, -35px);\n            transform: translate(0, -35px);\n    opacity: 1;\n  }\n}\n\n@keyframes game-display--bg-default {\n  from {\n    -webkit-transform: translate(0, 0);\n            transform: translate(0, 0);\n    opacity: 0;\n  }\n  to {\n    -webkit-transform: translate(0, -35px);\n            transform: translate(0, -35px);\n    opacity: 1;\n  }\n}\n\n@-webkit-keyframes game-display--bg-down {\n  from {\n    -webkit-transform: translate(0, 0);\n            transform: translate(0, 0);\n    opacity: 0;\n  }\n  to {\n    -webkit-transform: translate(0, 35px);\n            transform: translate(0, 35px);\n    opacity: 1;\n  }\n}\n\n@keyframes game-display--bg-down {\n  from {\n    -webkit-transform: translate(0, 0);\n            transform: translate(0, 0);\n    opacity: 0;\n  }\n  to {\n    -webkit-transform: translate(0, 35px);\n            transform: translate(0, 35px);\n    opacity: 1;\n  }\n}\n",""])},600:function(t,e,n){var r=n(599);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},601:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GameDisplay=void 0;var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(600);var o=s(n(76)),a=s(n(321)),u=s(n(265));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.GameDisplay=function(){function t(e){var n=e.game,r=e.context,i=e.backgroundImagePromise,o=e.video;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._game=n,this._context=r;var u=r.skinData;this._players=new Map(n.players.map(function(t){return[t,new a.default(t,u)]})),this._stateful={},this._wrapper=this._createWrapper({backgroundImagePromise:i,video:o,panelPlacement:n.players[0].options.placement,infoPanelPosition:u.infoPanelPosition}),this._createTouchEscapeButton({displayByDefault:"touch"===u.mainInputDevice})}return i(t,[{key:"setEscapeHandler",value:function(t){this._onEscape=t}},{key:"setReplayHandler",value:function(t){this._onReplay=t}},{key:"start",value:function(){this._started=(new Date).getTime();var t=this._game.players[0],e=t.notechart.songInfo;this._stateful.song_title=e.title,this._stateful.song_artist=e.artist,this._duration=t.notechart.duration}},{key:"destroy",value:function(){this._context.destroy()}},{key:"update",value:function(t,e){var n=((new Date).getTime()-this._started)/1e3,r=this._getData(n,t,e);this._updateStatefulData(n,t,e),this._context.render(Object.assign({},this._stateful,r)),this._video&&!this._videoStarted&&t>=this._videoOffset&&(this._video.volume=0,this._video.play(),this._video.classList.add("is-playing"),this._videoStarted=!0)}},{key:"_getData",value:function(t,e,n){var i={};i.tutorial=this._game.options.tutorial?"yes":"no",i.t=t,i.gameTime=e,i.ready=this._getReady(n),i.song_time=this._getSongTime(e);var o=!0,a=!1,u=void 0;try{for(var s,l=this._players[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value,f=r(c,2),h=f[0],p=f[1],d=n.player(h),v=p.update(t,e,d);for(var y in v)i["p"+h.number+"_"+y]=v[y]}}catch(t){a=!0,u=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw u}}return i}},{key:"_updateStatefulData",value:function(t,e,n){var r=this._stateful;void 0===r.started&&n.started&&(r.started=t),void 0===r.gettingStarted&&n.gettingStarted&&(r.gettingStarted=t)}},{key:"_getSongTime",value:function(t){return(0,u.default)(Math.min(this._duration,Math.max(0,t)))+" / "+(0,u.default)(this._duration)}},{key:"_getReady",value:function(t){var e=t.readyFraction;return e>.5?Math.pow(1-(e-.5)/.5,2):0}},{key:"_createWrapper",value:function(t){var e=t.backgroundImagePromise,n=t.video,r=t.panelPlacement,i=t.infoPanelPosition,a=(0,o.default)('<div class="game-display"></div>').attr("data-panel-placement",r).attr("data-info-panel-position",i).append('<div class="game-display--bg js-back-image"></div>').append(this.view);return e&&Promise.resolve(e).then(function(t){return a.find(".js-back-image").append(t)}),n&&(this._video=n.element,this._videoOffset=n.offset,(0,o.default)(n.element).addClass("game-display--video-bg").appendTo(a)),a[0]}},{key:"_createTouchEscapeButton",value:function(t){var e=this,n=t.displayByDefault,r=document.createElement("div");if(r.className="game-display--touch-buttons",this.wrapper.appendChild(r),n)r.classList.add("is-visible");else{var i=!1;this.wrapper.addEventListener("touchstart",function(){i||(i=!0,r.classList.add("is-visible"))},!0)}var o=function(t,e){var n=document.createElement("button");n.addEventListener("touchstart",function(t){t.stopPropagation()},!0),n.onclick=function(t){t.preventDefault(),e()},n.className=t,r.appendChild(n)};o("game-display--touch-escape-button",function(){return e._onEscape()}),o("game-display--touch-replay-button",function(){return e._onReplay()})}},{key:"context",get:function(){return this._context}},{key:"view",get:function(){return this._context.view}},{key:"wrapper",get:function(){return this._wrapper}}]),t}();e.default=l},602:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TouchPlugin=s;var r,i=n(171),o=(r=i)&&r.__esModule?r:{default:r},a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(170));var u=["p1_1","p1_2","p1_3","p1_4","p1_5","p1_6","p1_7","start"];function s(t){var e=null,n=null,r=o.default.wrap("input:touch:I",function(){return t.input}),i=o.default.wrap("input:touch:SC",function(r){var i=t.refs.p1_SC;if(!i)return 0;n=null;var o=!0,a=!1,u=void 0;try{for(var s,l=r[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value,f=!0,h=!1,d=void 0;try{for(var v,y=i[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var _=v.value;if(p(_.getBounds(),32).contains(c.x,c.y)){n=c.y;break}}}catch(t){h=!0,d=t}finally{try{!f&&y.return&&y.return()}finally{if(h)throw d}}if(null!==n)break}}catch(t){a=!0,u=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw u}}if(null===n)return e=null,0;null===e&&(e=n);n>e+24?e=n-24:n<e-24&&(e=n+24);return n>e+4?-1:n<e-4?1:0}),s=o.default.wrap("input:touch:B",function(e,n){var r=t.refs[n];if(r){var i=!0,o=!1,a=void 0;try{for(var u,s=r[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value,c=p(l.getBounds()),f=!0,h=!1,d=void 0;try{for(var v,y=e[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var _=v.value;if(c.contains(_.x,_.y))return 1}}catch(t){h=!0,d=t}finally{try{!f&&y.return&&y.return()}finally{if(h)throw d}}}}catch(t){o=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}}return 0}),l=o.default.wrap("input:touch:P",function(t){var e=null,n=null,r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value;if(s.y<h)if(null===e)e=s.y;else{if(null!==n)return 0;n=s.y}}}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return null!==e&&null!==n?Math.abs(e-n):0}),c=new function(){var t=[];return window.BEMUSE_TOUCH_STATS.push(t),{record:function(e){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value,s=u.x,l=u.y;t.push({x:Math.round(s),y:Math.round(l)})}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}},done:function(){t.length&&(localStorage._stats_touch=JSON.stringify(window.BEMUSE_TOUCH_STATS))}}},f="touch3d"===t.skinData.displayMode,h=f?a.getRow(.8).y:550;return{name:"TouchPlugin",get:function(){var t=r(),e={};o.default.enabled&&(o.default.stats["input:touch:n"]=""+t.length),c.record(t),e.p1_SC=i(t);var n=!0,h=!1,p=void 0;try{for(var d,v=u[Symbol.iterator]();!(n=(d=v.next()).done);n=!0){var y=d.value;e[y]=s(t,y)}}catch(t){h=!0,p=t}finally{try{!n&&v.return&&v.return()}finally{if(h)throw p}}if(f){var _=!0,g=!1,m=void 0;try{for(var b,w=t[Symbol.iterator]();!(_=(b=w.next()).done);_=!0){var k=b.value,x=a.getTouchedColumn(k.x,k.y);x&&(e["p1_"+x]=1)}}catch(t){g=!0,m=t}finally{try{!_&&w.return&&w.return()}finally{if(g)throw m}}}return e.p1_pinch=l(t),e},destroy:function(){c.done()}};function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=t.clone();return n.x-=e,n.y-=e,n.width+=2*e,n.height+=2*e,n}}window.BEMUSE_TOUCH_STATS=[],e.default=s},603:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GameState=void 0;var r,i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(324),u=(r=a)&&r.__esModule?r:{default:r};var s=e.GameState=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._game=e,this._players=new Map(e.players.map(function(t){return[t,new u.default(t)]}))}return o(t,[{key:"update",value:function(t,e,n){var r=!0,o=!0,a=!1,u=void 0;try{for(var s,l=this._players[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value,f=i(c,2),h=(f[0],f[1]);h.update(t,e),h.finished||(r=!1)}}catch(t){a=!0,u=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw u}}this.readyFraction=n.readyFraction,this.gettingStarted=n.gettingStarted,this.started=n.started,this.finished=r}},{key:"player",value:function(t){return this._players.get(t)}},{key:"game",get:function(){return this._game}}]),t}();e.default=s},604:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerAudio=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=u(n(43)),o=u(n(496)),a=n(77);function u(t){return t&&t.__esModule?t:{default:t}}function s(t){t=i.default.sortBy(t,"time");var e=0;return{next:function(n){for(var r=[];e<t.length&&n>=t[e].time;e++)r.push(t[e]);return r}}}var l=e.PlayerAudio=function(){function t(e){var n=e.player,r=e.samples,i=e.master,a=e.waveFactory,u=e.volume;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var l=n.notechart;this._waveFactory=a||new o.default(i,r,l.keysounds,{volume:u}),this._autos=s(l.autos),this._notes=s(l.notes),this._played=new Map,this._autosound=!!n.options.autosound}return r(t,[{key:"update",value:function(t,e){this._playAutokeysounds(t),this._playAutosounds(t,e),this._handleSoundNotifications(e&&e.notifications.sounds||[])}},{key:"_playAutokeysounds",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this._autos.next(t+1/30)[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this._waveFactory.playAuto(a,a.time-t)}}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_playAutosounds",value:function(t,e){var n=this._notes.next(t+1/30),r=e&&e.stats.poor;if(this._autosound&&!r){var i=!0,o=!1,a=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;this._hitNote(l,l.time-t)}}catch(t){o=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}}}},{key:"_handleSoundNotifications",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value,u=a.type,s=a.note;"hit"===u?this._hitNote(s,0,a.judgment):"break"===u?this._breakNote(s):"free"===u&&this._waveFactory.playFree(s,0)}}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_hitNote",value:function(t,e,n){var r=this._played.get(t);r||(r=this._waveFactory.playNote(t,e),this._played.set(t,r)),r&&(0,a.isBad)(n)&&r.bad()}},{key:"_breakNote",value:function(t){var e=this._played.get(t);e&&e.stop()}}]),t}();e.default=l},605:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(271),a=(r=o)&&r.__esModule?r:{default:r};var u=e.Game=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=n,this.players=n.players.map(function(t,r){return t=Object.assign({},t,{autosound:n.audioInputLatency>=.01,tutorial:n.tutorial}),new a.default(e[r],r+1,t)})}return i(t,[{key:"samples",get:function(){var t=new Set,e=!0,n=!1,r=void 0;try{for(var i,o=this.players[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value,u=!0,s=!1,l=void 0;try{for(var c,f=a.notechart.samples[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value;t.add(h)}}catch(t){s=!0,l=t}finally{try{!u&&f.return&&f.return()}finally{if(s)throw l}}}}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}return Array.from(t)}}]),t}();e.default=u},606:function(t,e,n){(function(e,n,r){t.exports=function(){var t,i,o;return function t(e,n,r){function i(a,u){if(!n[a]){if(!e[a]){var s="function"==typeof _dereq_&&_dereq_;if(!u&&s)return s(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n||t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof _dereq_&&_dereq_,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){"use strict";e.exports=function(t){var e=t._SomePromiseArray;function n(t){var n=new e(t),r=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),r}t.any=function(t){return n(t)},t.prototype.any=function(){return n(this)}}},{}],2:[function(t,n,r){"use strict";var i;try{throw new Error}catch(t){i=t}var o=t("./schedule"),a=t("./queue"),u=t("./util");function s(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new a(16),this._normalQueue=new a(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=o}function l(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function c(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function f(t){this._normalQueue._pushOne(t),this._queueTick()}s.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},s.prototype.hasCustomScheduler=function(){return this._customScheduler},s.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},s.prototype.disableTrampolineIfNecessary=function(){u.hasDevTools&&(this._trampolineEnabled=!1)},s.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},s.prototype.fatalError=function(t,n){n?(e.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),e.exit(2)):this.throwLater(t)},s.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},u.hasDevTools?(s.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?l.call(this,t,e,n):this._schedule(function(){setTimeout(function(){t.call(e,n)},100)})},s.prototype.invoke=function(t,e,n){this._trampolineEnabled?c.call(this,t,e,n):this._schedule(function(){t.call(e,n)})},s.prototype.settlePromises=function(t){this._trampolineEnabled?f.call(this,t):this._schedule(function(){t._settlePromises()})}):(s.prototype.invokeLater=l,s.prototype.invoke=c,s.prototype.settlePromises=f),s.prototype.invokeFirst=function(t,e,n){this._normalQueue.unshift(t,e,n),this._queueTick()},s.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var n=t.shift(),r=t.shift();e.call(n,r)}else e._settlePromises()}},s.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},s.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},s.prototype._reset=function(){this._isTickUsed=!1},n.exports=s,n.exports.firstLineError=i},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var i=!1,o=function(t,e){this._reject(e)},a=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(o,o,null,this,t)},u=function(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)},s=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(o){i||(i=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var l=n(o),c=new t(e);c._propagateFrom(this,1);var f=this._target();if(c._setBoundTo(l),l instanceof t){var h={promiseRejectionQueued:!1,promise:c,target:f,bindingPromise:l};f._then(e,a,void 0,c,h),l._then(u,s,void 0,c,h),c._setOnCancel(l)}else c._resolveCallback(f);return c},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";var r;"undefined"!=typeof Promise&&(r=Promise);var i=t("./promise")();i.noConflict=function(){try{Promise===i&&(Promise=r)}catch(t){}return i},e.exports=i},{"./promise":22}],5:[function(t,e,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}e.exports=function(e){var n=t("./util"),r=n.canEvaluate;function i(t){var r=this.pop(),i=function(t,r){var i;if(null!=t&&(i=t[r]),"function"!=typeof i){var o="Object "+n.classString(t)+" has no method '"+n.toString(r)+"'";throw new e.TypeError(o)}return i}(t,r);return i.apply(t,this)}function o(t){return t[this]}function a(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}n.isIdentifier,e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(i,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e,n="number"==typeof t;if(n)e=a;else if(r){var i=(void 0)(t);e=null!==i?i:o}else e=o;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),a=o.tryCatch,u=o.errorObj,s=e._async;e.prototype.break=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),s.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(o.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=a(t).call(this._boundValue());r===u&&(this._attachExtraTrace(r.e),s.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),s.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=t("./es5").keys,i=n.tryCatch,o=n.errorObj;return function(t,a,u){return function(s){var l=u._boundValue();t:for(var c=0;c<t.length;++c){var f=t[c];if(f===Error||null!=f&&f.prototype instanceof Error){if(s instanceof f)return i(a).call(l,s)}else if("function"==typeof f){var h=i(f).call(l,s);if(h===o)return h;if(h)return i(a).call(l,s)}else if(n.isObject(s)){for(var p=r(f),d=0;d<p.length;++d){var v=p[d];if(f[v]!=s[v])continue t}return i(a).call(l,s)}}return e}}}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){var e=!1,n=[];function r(){this._trace=new r.CapturedTrace(i())}function i(){var t=n.length-1;if(t>=0)return n[t]}return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},r.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},r.prototype._popContext=function(){if(void 0!==this._trace){var t=n.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},r.CapturedTrace=null,r.create=function(){if(e)return new r},r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,a=t._peekContext,u=t.prototype._peekContext,s=t.prototype._promiseCreated;r.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=a,t.prototype._peekContext=u,t.prototype._promiseCreated=s,e=!1},e=!0,t.prototype._pushContext=r.prototype._pushContext,t.prototype._popContext=r.prototype._popContext,t._peekContext=t.prototype._peekContext=i,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},r}},{}],9:[function(t,n,r){"use strict";n.exports=function(n,r){var i,o,a,u=n._getDomain,s=n._async,l=t("./errors").Warning,c=t("./util"),f=c.canAttachTrace,h=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,p=/\((?:timers\.js):\d+:\d+\)/,d=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,v=null,y=null,_=!1,g=!(0==c.env("BLUEBIRD_DEBUG")),m=!(0==c.env("BLUEBIRD_WARNINGS")||!g&&!c.env("BLUEBIRD_WARNINGS")),b=!(0==c.env("BLUEBIRD_LONG_STACK_TRACES")||!g&&!c.env("BLUEBIRD_LONG_STACK_TRACES")),w=0!=c.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(m||!!c.env("BLUEBIRD_W_FORGOTTEN_RETURN"));n.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},n.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),s.invokeLater(this._notifyUnhandledRejection,this,void 0))},n.prototype._notifyUnhandledRejectionIsHandled=function(){H("rejectionHandled",i,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},n.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),H("unhandledRejection",o,t,this)}},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},n.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},n.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},n.prototype._warn=function(t,e,n){return U(t,e,n||this)},n.onPossiblyUnhandledRejection=function(t){var e=u();o="function"==typeof t?null===e?t:c.domainBind(e,t):void 0},n.onUnhandledRejectionHandled=function(t){var e=u();i="function"==typeof t?null===e?t:c.domainBind(e,t):void 0};var k=function(){};n.longStackTraces=function(){if(s.haveItemsQueued()&&!$.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!$.longStackTraces&&Y()){var t=n.prototype._captureStackTrace,e=n.prototype._attachExtraTrace;$.longStackTraces=!0,k=function(){if(s.haveItemsQueued()&&!$.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");n.prototype._captureStackTrace=t,n.prototype._attachExtraTrace=e,r.deactivateLongStackTraces(),s.enableTrampoline(),$.longStackTraces=!1},n.prototype._captureStackTrace=L,n.prototype._attachExtraTrace=N,r.activateLongStackTraces(),s.disableTrampolineIfNecessary()}},n.hasLongStackTraces=function(){return $.longStackTraces&&Y()};var x=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return c.global.dispatchEvent(t),function(t,e){var n=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!c.global.dispatchEvent(n)}}if("function"==typeof Event){var t=new Event("CustomEvent");return c.global.dispatchEvent(t),function(t,e){var n=new Event(t.toLowerCase(),{cancelable:!0});return n.detail=e,!c.global.dispatchEvent(n)}}var t=document.createEvent("CustomEvent");return t.initCustomEvent("testingtheevent",!1,!0,{}),c.global.dispatchEvent(t),function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t.toLowerCase(),!1,!0,e),!c.global.dispatchEvent(n)}}catch(t){}return function(){return!1}}(),E=c.isNode?function(){return e.emit.apply(e,arguments)}:c.global?function(t){var e="on"+t.toLowerCase(),n=c.global[e];return!!n&&(n.apply(c.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function S(t,e){return{promise:e}}var j={promiseCreated:S,promiseFulfilled:S,promiseRejected:S,promiseResolved:S,promiseCancelled:S,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:S},C=function(t){var e=!1;try{e=E.apply(null,arguments)}catch(t){s.throwLater(t),e=!0}var n=!1;try{n=x(t,j[t].apply(null,arguments))}catch(t){s.throwLater(t),n=!0}return n||e};function T(){return!1}function P(t,e,n){var r=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+c.toString(t));r._attachCancellationCallback(t)})}catch(t){return t}}function A(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?c.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function O(){return this._onCancelField}function M(t){this._onCancelField=t}function R(){this._cancellationParent=void 0,this._onCancelField=void 0}function F(t,e){if(0!=(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}n.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?n.longStackTraces():!t.longStackTraces&&n.hasLongStackTraces()&&k()),"warnings"in t){var e=t.warnings;$.warnings=!!e,w=$.warnings,c.isObject(e)&&"wForgottenReturn"in e&&(w=!!e.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!$.cancellation){if(s.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=R,n.prototype._propagateFrom=F,n.prototype._onCancel=O,n.prototype._setOnCancel=M,n.prototype._attachCancellationCallback=A,n.prototype._execute=P,I=F,$.cancellation=!0}"monitoring"in t&&(t.monitoring&&!$.monitoring?($.monitoring=!0,n.prototype._fireEvent=C):!t.monitoring&&$.monitoring&&($.monitoring=!1,n.prototype._fireEvent=T))},n.prototype._fireEvent=T,n.prototype._execute=function(t,e,n){try{t(e,n)}catch(t){return t}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(t){},n.prototype._attachCancellationCallback=function(t){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(t,e){};var I=function(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)};function B(){var t=this._boundTo;return void 0!==t&&t instanceof n?t.isFulfilled()?t.value():void 0:t}function L(){this._trace=new K(this._peekContext())}function N(t,e){if(f(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=G(t);c.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),c.notEnumerableProp(t,"__stackCleaned__",!0)}}}function U(t,e,r){if($.warnings){var i,o=new l(t);if(e)r._attachExtraTrace(o);else if($.longStackTraces&&(i=n._peekContext()))i.attachExtraTrace(o);else{var a=G(o);o.stack=a.message+"\n"+a.stack.join("\n")}C("warning",o)||z(o,"",!0)}}function D(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],i="    (No stack trace)"===r||v.test(r),o=i&&q(r);i&&!o&&(_&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function G(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||v.test(r))break}return n>0&&(e=e.slice(n)),e}(t):["    (No stack trace)"],{message:n,stack:D(e)}}function z(t,e,n){if("undefined"!=typeof console){var r;if(c.isObject(t)){var i=t.stack;r=e+y(i,t)}else r=e+String(t);"function"==typeof a?a(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function H(t,e,n,r){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(t){s.throwLater(t)}"unhandledRejection"===t?C(t,n,r)||i||z(n,"Unhandled rejection "):C(t,r)}function V(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{if(e=t&&"function"==typeof t.toString?t.toString():c.toString(t),/\[object [a-zA-Z0-9$_]+\]/.test(e))try{var n=JSON.stringify(t);e=n}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){return t.length<41?t:t.substr(0,38)+"..."}(e)+">, no stack trace)"}function Y(){return"function"==typeof Q}var q=function(){return!1},W=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function J(t){var e=t.match(W);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function K(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);Q(this,K),e>32&&this.uncycle()}c.inherits(K,Error),r.CapturedTrace=K,K.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;for(var r=(t=this._length=r)-1;r>=0;--r){var o=e[r].stack;void 0===n[o]&&(n[o]=r)}for(var r=0;r<t;++r){var a=e[r].stack,u=n[a];if(void 0!==u&&u!==r){u>0&&(e[u-1]._parent=void 0,e[u-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var s=r>0?e[r-1]:this;u<t-1?(s._parent=e[u+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var l=s._length+1,c=r-2;c>=0;--c)e[c]._length=l,l++;return}}}},K.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=G(t),n=e.message,r=[e.stack],i=this;void 0!==i;)r.push(D(i.stack.split("\n"))),i=i._parent;!function(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,o=e[i],a=-1,u=r.length-1;u>=0;--u)if(r[u]===o){a=u;break}for(var u=a;u>=0;--u){var s=r[u];if(e[i]!==s)break;e.pop(),i--}e=r}}(r),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(r),c.notEnumerableProp(t,"stack",function(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}(n,r)),c.notEnumerableProp(t,"__stackCleaned__",!0)}};var Q=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():V(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,v=t,y=e;var n=Error.captureStackTrace;return q=function(t){return h.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r,i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return v=/@/,y=e,_=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){r="stack"in t}return"stack"in i||!r||"number"!=typeof Error.stackTraceLimit?(y=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?V(e):e.toString()},null):(v=t,y=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(a=function(t){console.warn(t)},c.isNode&&e.stderr.isTTY?a=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:c.isNode||"string"!=typeof(new Error).stack||(a=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var $={warnings:m,longStackTraces:!1,cancellation:!1,monitoring:!1};return b&&n.longStackTraces(),{longStackTraces:function(){return $.longStackTraces},warnings:function(){return $.warnings},cancellation:function(){return $.cancellation},monitoring:function(){return $.monitoring},propagateFromFunction:function(){return I},boundValueFunction:function(){return B},checkForgottenReturns:function(t,e,n,r,i){if(void 0===t&&null!==e&&w){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&r._bitField))return;n&&(n+=" ");var o="",a="";if(e._trace){for(var u=e._trace.stack.split("\n"),s=D(u),l=s.length-1;l>=0;--l){var c=s[l];if(!p.test(c)){var f=c.match(d);f&&(o="at "+f[1]+":"+f[2]+":"+f[3]+" ");break}}if(s.length>0)for(var h=s[0],l=0;l<u.length;++l)if(u[l]===h){l>0&&(a="\n"+u[l-1]);break}}var v="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+a;r._warn(v,!0,e)}},setBounds:function(t,e){if(Y()){for(var n,r,i=t.stack.split("\n"),o=e.stack.split("\n"),a=-1,u=-1,s=0;s<i.length;++s){var l=J(i[s]);if(l){n=l.fileName,a=l.line;break}}for(var s=0;s<o.length;++s){var l=J(o[s]);if(l){r=l.fileName,u=l.line;break}}a<0||u<0||!n||!r||n!==r||a>=u||(q=function(t){if(h.test(t))return!0;var e=J(t);return!!(e&&e.fileName===n&&a<=e.line&&e.line<=u)})}},warn:U,deprecated:function(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),U(n)},CapturedTrace:K,fireDomEvent:x,fireGlobalEvent:E}}},{"./errors":12,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1];return this.caught(t,function(){throw e})},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];return r instanceof t&&r.suppressUnhandledRejections(),this.caught(n,function(){return r})}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.reduce,r=t.all;function i(){return r(this)}t.prototype.each=function(t){return n(this,t,e,0)._then(i,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return n(this,t,e,e)},t.each=function(t,r){return n(t,r,e,0)._then(i,void 0,void 0,t,void 0)},t.mapSeries=function(t,r){return n(t,r,e,e)}}},{}],12:[function(t,e,n){"use strict";var r,i,o=t("./es5"),a=o.freeze,u=t("./util"),s=u.inherits,l=u.notEnumerableProp;function c(t,e){function n(r){if(!(this instanceof n))return new n(r);l(this,"message","string"==typeof r?r:e),l(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return s(n,Error),n}var f=c("Warning","warning"),h=c("CancellationError","cancellation error"),p=c("TimeoutError","timeout error"),d=c("AggregateError","aggregate error");try{r=TypeError,i=RangeError}catch(t){r=c("TypeError","type error"),i=c("RangeError","range error")}for(var v="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),y=0;y<v.length;++y)"function"==typeof Array.prototype[v[y]]&&(d.prototype[v[y]]=Array.prototype[v[y]]);o.defineProperty(d.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var _=0;function g(t){if(!(this instanceof g))return new g(t);l(this,"name","OperationalError"),l(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(l(this,"message",t.message),l(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}d.prototype.toString=function(){var t=Array(4*_+1).join(" "),e="\n"+t+"AggregateError of:\n";_++,t=Array(4*_+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];r=i.join("\n"),e+=r+"\n"}return _--,e},s(g,Error);var m=Error.__BluebirdErrorTypes__;m||(m=a({CancellationError:h,TimeoutError:p,OperationalError:g,RejectionError:g,AggregateError:d}),o.defineProperty(Error,"__BluebirdErrorTypes__",{value:m,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:r,RangeError:i,CancellationError:m.CancellationError,OperationalError:m.OperationalError,TimeoutError:m.TimeoutError,AggregateError:m.AggregateError,Warning:f}},{"./es5":13,"./util":36}],13:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,a={}.constructor.prototype,u=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e};e.exports={isArray:function(t){try{return"[object Array]"===o.call(t)}catch(t){return!1}},keys:u,names:u,defineProperty:function(t,e,n){return t[e]=n.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return a}},isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n){var r=t("./util"),i=e.CancellationError,o=r.errorObj;function a(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function u(t){this.finallyHandler=t}function s(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function l(){return f.call(this,this.promise._target()._settledValue())}function c(t){if(!s(this,t))return o.e=t,o}function f(t){var r=this.promise,a=this.handler;if(!this.called){this.called=!0;var f=this.isFinallyHandler()?a.call(r._boundValue()):a.call(r._boundValue(),t);if(void 0!==f){r._setReturnedNonUndefined();var h=n(f,r);if(h instanceof e){if(null!=this.cancelPromise){if(h._isCancelled()){var p=new i("late cancellation observer");return r._attachExtraTrace(p),o.e=p,o}h.isPending()&&h._attachCancellationCallback(new u(this))}return h._then(l,c,void 0,this,void 0)}}}return r.isRejected()?(s(this),o.e=t,o):(s(this),t)}return a.prototype.isFinallyHandler=function(){return 0===this.type},u.prototype._resultCancelled=function(){s(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new a(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,f,f)},e.prototype.tap=function(t){return this._passThrough(t,1,f)},a}},{"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,a){var u=t("./errors"),s=u.TypeError,l=t("./util"),c=l.errorObj,f=l.tryCatch,h=[];function p(t,n,i,o){if(a.cancellation()){var u=new e(r),s=this._finallyPromise=new e(r);this._promise=u.lastly(function(){return s}),u._captureStackTrace(),u._setOnCancel(this)}else{var l=this._promise=new e(r);l._captureStackTrace()}this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}l.inherits(p,o),p.prototype._isResolved=function(){return null===this._promise},p.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},p.prototype._promiseCancelled=function(){if(!this._isResolved()){var t,n=void 0!==this._generator.return;if(n)this._promise._pushContext(),t=f(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var r=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),t=f(this._generator.throw).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},p.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=f(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},p.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=f(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},p.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},p.prototype.promise=function(){return this._promise},p.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},p.prototype._continue=function(t){var n=this._promise;if(t===c)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var o=i(r,this._promise);if(o instanceof e||null!==(o=function(t,n,r){for(var o=0;o<n.length;++o){r._pushContext();var a=f(n[o])(t);if(r._popContext(),a===c){r._pushContext();var u=e.reject(c.e);return r._popContext(),u}var s=i(a,r);if(s instanceof e)return s}return null}(o,this._yieldHandlers,this._promise))){var a=(o=o._target())._bitField;0==(50397184&a)?(this._yieldedPromise=o,o._proxy(this,null)):0!=(33554432&a)?e._async.invoke(this._promiseFulfilled,this,o._value()):0!=(16777216&a)?e._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()}else this._promiseRejected(new s("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",r)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},e.coroutine=function(t,e){if("function"!=typeof t)throw new s("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=p,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new r(void 0,void 0,n,i),a=o.promise();return o._generator=e,o._promiseFulfilled(void 0),a}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new s("expecting a function but got "+l.classString(t));h.push(t)},e.spawn=function(t){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new p(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,a){var u=t("./util");u.canEvaluate,u.tryCatch,u.errorObj,e.join=function(){var t,e=arguments.length-1;e>0&&"function"==typeof arguments[e]&&(t=arguments[e]);var r=[].slice.call(arguments);t&&r.pop();var i=new n(r).promise();return void 0!==t?i.spread(t):i}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,a){var u=e._getDomain,s=t("./util"),l=s.tryCatch,c=s.errorObj,f=e._async;function h(t,e,n,r){this.constructor$(t),this._promise._captureStackTrace();var i=u();this._callback=null===i?e:s.domainBind(i,e),this._preservedValues=r===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],f.invoke(this._asyncInit,this,void 0)}function p(t,n,i,o){if("function"!=typeof n)return r("expecting a function but got "+s.classString(n));var a=0;if(void 0!==i){if("object"!=typeof i||null===i)return e.reject(new TypeError("options argument must be an object but it is "+s.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+s.classString(i.concurrency)));a=i.concurrency}return a="number"==typeof a&&isFinite(a)&&a>=1?a:0,new h(t,n,a,o).promise()}s.inherits(h,n),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(t,n){var r=this._values,o=this.length(),u=this._preservedValues,s=this._limit;if(n<0){if(r[n=-1*n-1]=t,s>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(s>=1&&this._inFlight>=s)return r[n]=t,this._queue.push(n),!1;null!==u&&(u[n]=t);var f=this._promise,h=this._callback,p=f._boundValue();f._pushContext();var d=l(h).call(p,t,n,o),v=f._popContext();if(a.checkForgottenReturns(d,v,null!==u?"Promise.filter":"Promise.map",f),d===c)return this._reject(d.e),!0;var y=i(d,this._promise);if(y instanceof e){var _=(y=y._target())._bitField;if(0==(50397184&_))return s>=1&&this._inFlight++,r[n]=y,y._proxy(this,-1*(n+1)),!1;if(0==(33554432&_))return 0!=(16777216&_)?(this._reject(y._reason()),!0):(this._cancel(),!0);d=y._value()}r[n]=d}var g=++this._totalResolved;return g>=o&&(null!==u?this._filter(r,u):this._resolve(r),!0)},h.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},h.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;o<n;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},h.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return p(this,t,e,null)},e.map=function(t,e,n,r){return p(t,e,n,r)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var a=t("./util"),u=a.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+a.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=u(t).apply(this,arguments),a=r._popContext();return o.checkForgottenReturns(i,a,"Promise.method",r),r._resolveFromSyncValue(i),r}},e.attempt=e.try=function(t){if("function"!=typeof t)return i("expecting a function but got "+a.classString(t));var r,s=new e(n);if(s._captureStackTrace(),s._pushContext(),arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],c=arguments[2];r=a.isArray(l)?u(t).apply(c,l):u(t).call(c,l)}else r=u(t)();var f=s._popContext();return o.checkForgottenReturns(r,f,"Promise.try",s),s._resolveFromSyncValue(r),s},e.prototype._resolveFromSyncValue=function(t){t===a.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";var r=t("./util"),i=r.maybeWrapAsError,o=t("./errors"),a=o.OperationalError,u=t("./es5"),s=/^(?:name|message|stack|cause)$/;function l(t){var e;if(function(t){return t instanceof Error&&u.getPrototypeOf(t)===Error.prototype}(t)){(e=new a(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var n=u.keys(t),i=0;i<n.length;++i){var o=n[i];s.test(o)||(e[o]=t[o])}return e}return r.markAsOriginatingFromRejection(t),t}e.exports=function(t,e){return function(n,r){if(null!==t){if(n){var o=l(i(n));t._attachExtraTrace(o),t._reject(o)}else if(e){var a=[].slice.call(arguments,1);t._fulfill(a)}else t._fulfill(r);t=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=e._async,i=n.tryCatch,o=n.errorObj;function a(t,e){if(!n.isArray(t))return u.call(this,t,e);var a=i(e).apply(this._boundValue(),[null].concat(t));a===o&&r.throwLater(a.e)}function u(t,e){var n=this._boundValue(),a=void 0===t?i(e).call(n,null):i(e).call(n,null,t);a===o&&r.throwLater(a.e)}function s(t,e){if(!t){var n=new Error(t+"");n.cause=t,t=n}var a=i(e).call(this._boundValue(),t);a===o&&r.throwLater(a.e)}e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var n=u;void 0!==e&&Object(e).spread&&(n=a),this._then(n,s,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,n,r){"use strict";n.exports=function(){var r=function(){return new d("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},i=function(){return new P.PromiseInspection(this._target())},o=function(t){return P.reject(new d(t))};function a(){}var u,s={},l=t("./util");u=l.isNode?function(){var t=e.domain;return void 0===t&&(t=null),t}:function(){return null},l.notEnumerableProp(P,"_getDomain",u);var c=t("./es5"),f=t("./async"),h=new f;c.defineProperty(P,"_async",{value:h});var p=t("./errors"),d=P.TypeError=p.TypeError;P.RangeError=p.RangeError;var v=P.CancellationError=p.CancellationError;P.TimeoutError=p.TimeoutError,P.OperationalError=p.OperationalError,P.RejectionError=p.OperationalError,P.AggregateError=p.AggregateError;var y=function(){},_={},g={},m=t("./thenables")(P,y),b=t("./promise_array")(P,y,m,o,a),w=t("./context")(P),k=w.create,x=t("./debuggability")(P,w),E=(x.CapturedTrace,t("./finally")(P,m)),S=t("./catch_filter")(g),j=t("./nodeback"),C=l.errorObj,T=l.tryCatch;function P(t){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,t!==y&&(function(t,e){if("function"!=typeof e)throw new d("expecting a function but got "+l.classString(e));if(t.constructor!==P)throw new d("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n")}(this,t),this._resolveFromExecutor(t)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function A(t){this.promise._resolveCallback(t)}function O(t){this.promise._rejectCallback(t,!1)}function M(t){var e=new P(y);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}return P.prototype.toString=function(){return"[object Promise]"},P.prototype.caught=P.prototype.catch=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;n<e-1;++n){var a=arguments[n];if(!l.isObject(a))return o("expecting an object but got A catch statement predicate "+l.classString(a));r[i++]=a}return r.length=i,t=arguments[n],this.then(void 0,S(r,t,this))}return this.then(void 0,t)},P.prototype.reflect=function(){return this._then(i,i,void 0,this,void 0)},P.prototype.then=function(t,e){if(x.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+l.classString(t);arguments.length>1&&(n+=", "+l.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},P.prototype.done=function(t,e){var n=this._then(t,e,void 0,void 0,void 0);n._setIsFinal()},P.prototype.spread=function(t){return"function"!=typeof t?o("expecting a function but got "+l.classString(t)):this.all()._then(t,void 0,void 0,_,void 0)},P.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},P.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new b(this).promise()},P.prototype.error=function(t){return this.caught(l.originatesFromRejection,t)},P.getNewLibraryCopy=n.exports,P.is=function(t){return t instanceof P},P.fromNode=P.fromCallback=function(t){var e=new P(y);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=T(t)(j(e,n));return r===C&&e._rejectCallback(r.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},P.all=function(t){return new b(t).promise()},P.cast=function(t){var e=m(t);return e instanceof P||((e=new P(y))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},P.resolve=P.fulfilled=P.cast,P.reject=P.rejected=function(t){var e=new P(y);return e._captureStackTrace(),e._rejectCallback(t,!0),e},P.setScheduler=function(t){if("function"!=typeof t)throw new d("expecting a function but got "+l.classString(t));return h.setScheduler(t)},P.prototype._then=function(t,e,n,r,i){var o=void 0!==i,a=o?i:new P(y),s=this._target(),c=s._bitField;o||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&c)?this._boundValue():s===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var f=u();if(0!=(50397184&c)){var p,d,_=s._settlePromiseCtx;0!=(33554432&c)?(d=s._rejectionHandler0,p=t):0!=(16777216&c)?(d=s._fulfillmentHandler0,p=e,s._unsetRejectionIsUnhandled()):(_=s._settlePromiseLateCancellationObserver,d=new v("late cancellation observer"),s._attachExtraTrace(d),p=e),h.invoke(_,s,{handler:null===f?p:"function"==typeof p&&l.domainBind(f,p),promise:a,receiver:r,value:d})}else s._addCallbacks(t,e,a,r,f);return a},P.prototype._length=function(){return 65535&this._bitField},P.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},P.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},P.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},P.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},P.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},P.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},P.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},P.prototype._isFinal=function(){return(4194304&this._bitField)>0},P.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},P.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},P.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},P.prototype._setAsyncGuaranteed=function(){h.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},P.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==s)return void 0===e&&this._isBound()?this._boundValue():e},P.prototype._promiseAt=function(t){return this[4*t-4+2]},P.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},P.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},P.prototype._boundValue=function(){},P.prototype._migrateCallback0=function(t){t._bitField;var e=t._fulfillmentHandler0,n=t._rejectionHandler0,r=t._promise0,i=t._receiverAt(0);void 0===i&&(i=s),this._addCallbacks(e,n,r,i,null)},P.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),i=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=s),this._addCallbacks(n,r,i,o,null)},P.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=null===i?t:l.domainBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:l.domainBind(i,e));else{var a=4*o-4;this[a+2]=n,this[a+3]=r,"function"==typeof t&&(this[a+0]=null===i?t:l.domainBind(i,t)),"function"==typeof e&&(this[a+1]=null===i?e:l.domainBind(i,e))}return this._setLength(o+1),o},P.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},P.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(r(),!1);var n=m(t,this);if(!(n instanceof P))return this._fulfill(t);e&&this._propagateFrom(n,2);var i=n._target();if(i!==this){var o=i._bitField;if(0==(50397184&o)){var a=this._length();a>0&&i._migrateCallback0(this);for(var u=1;u<a;++u)i._migrateCallbackAt(this,u);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else if(0!=(33554432&o))this._fulfill(i._value());else if(0!=(16777216&o))this._reject(i._reason());else{var s=new v("late cancellation observer");i._attachExtraTrace(s),this._reject(s)}}else this._reject(r())}},P.prototype._rejectCallback=function(t,e,n){var r=l.ensureErrorObject(t),i=r===t;if(!i&&!n&&x.warnings()){var o="a promise was rejected with a non-error: "+l.classString(t);this._warn(o,!0)}this._attachExtraTrace(r,!!e&&i),this._reject(t)},P.prototype._resolveFromExecutor=function(t){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)},P.prototype._settlePromiseFromHandler=function(t,e,n,r){var i=r._bitField;if(0==(65536&i)){var o;r._pushContext(),e===_?n&&"number"==typeof n.length?o=T(t).apply(this._boundValue(),n):(o=C).e=new d("cannot .spread() a non-array: "+l.classString(n)):o=T(t).call(e,n);var a=r._popContext();0==(65536&(i=r._bitField))&&(o===g?r._reject(n):o===C?r._rejectCallback(o.e,!1):(x.checkForgottenReturns(o,a,"",r,this),r._resolveCallback(o)))}},P.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},P.prototype._followee=function(){return this._rejectionHandler0},P.prototype._setFollowee=function(t){this._rejectionHandler0=t},P.prototype._settlePromise=function(t,e,n,r){var o=t instanceof P,u=this._bitField,s=0!=(134217728&u);0!=(65536&u)?(o&&t._invokeInternalOnCancel(),n instanceof E&&n.isFinallyHandler()?(n.cancelPromise=t,T(e).call(n,r)===C&&t._reject(C.e)):e===i?t._fulfill(i.call(n)):n instanceof a?n._promiseCancelled(t):o||t instanceof b?t._cancel():n.cancel()):"function"==typeof e?o?(s&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,n,r,t)):e.call(n,r,t):n instanceof a?n._isResolved()||(0!=(33554432&u)?n._promiseFulfilled(r,t):n._promiseRejected(r,t)):o&&(s&&t._setAsyncGuaranteed(),0!=(33554432&u)?t._fulfill(r):t._reject(r))},P.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,r=t.receiver,i=t.value;"function"==typeof e?n instanceof P?this._settlePromiseFromHandler(e,r,i,n):e.call(r,i,n):n instanceof P&&n._reject(i)},P.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},P.prototype._settlePromise0=function(t,e,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,i,e)},P.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},P.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=r();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!=(134217728&e)?this._settlePromises():h.settlePromises(this))}},P.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=t,this._isFinal())return h.fatalError(t,l.isNode);(65535&e)>0?h.settlePromises(this):this._ensurePossibleRejectionHandled()}},P.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},P.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},P.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!=(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},P.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},P.defer=P.pending=function(){x.deprecated("Promise.defer","new Promise");var t=new P(y);return{promise:t,resolve:A,reject:O}},l.notEnumerableProp(P,"_makeSelfResolutionError",r),t("./method")(P,y,m,o,x),t("./bind")(P,y,m,x),t("./cancel")(P,b,o,x),t("./direct_resolve")(P),t("./synchronous_inspection")(P),t("./join")(P,b,m,y,h,u),P.Promise=P,P.version="3.4.6",t("./map.js")(P,b,o,m,y,x),t("./call_get.js")(P),t("./using.js")(P,o,m,k,y,x),t("./timers.js")(P,y,x),t("./generators.js")(P,o,y,m,a,x),t("./nodeify.js")(P),t("./promisify.js")(P,y),t("./props.js")(P,b,m,o),t("./race.js")(P,y,m,o),t("./reduce.js")(P,b,o,m,y,x),t("./settle.js")(P,b,x),t("./some.js")(P,b,o),t("./filter.js")(P,y),t("./each.js")(P,y),t("./any.js")(P),l.toFastProperties(P),l.toFastProperties(P.prototype),M({a:1}),M({b:2}),M({c:3}),M(1),M(function(){}),M(void 0),M(!1),M(new P(y)),x.setBounds(f.firstLineError,l.lastLineError),P}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var a=t("./util");function u(t){var r=this._promise=new e(n);t instanceof e&&r._propagateFrom(t,3),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return a.isArray,a.inherits(u,o),u.prototype.length=function(){return this._length},u.prototype.promise=function(){return this._promise},u.prototype._init=function t(n,o){var u=r(this._values,this._promise);if(u instanceof e){var s=(u=u._target())._bitField;if(this._values=u,0==(50397184&s))return this._promise._setAsyncGuaranteed(),u._then(t,this._reject,void 0,this,o);if(0==(33554432&s))return 0!=(16777216&s)?this._reject(u._reason()):this._cancel();u=u._value()}if(null!==(u=a.asArray(u)))0!==u.length?this._iterate(u):-5===o?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{}}}(o));else{var l=i("expecting an array or an iterable object but got "+a.classString(u)).reason();this._promise._rejectCallback(l,!1)}},u.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,a=null,u=0;u<n;++u){var s=r(t[u],i);s instanceof e?(s=s._target(),a=s._bitField):a=null,o?null!==a&&s.suppressUnhandledRejections():null!==a?0==(50397184&a)?(s._proxy(this,u),this._values[u]=s):o=0!=(33554432&a)?this._promiseFulfilled(s._value(),u):0!=(16777216&a)?this._promiseRejected(s._reason(),u):this._promiseCancelled(u):o=this._promiseFulfilled(s,u)}o||i._setAsyncGuaranteed()},u.prototype._isResolved=function(){return null===this._values},u.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},u.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},u.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},u.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},u.prototype._promiseCancelled=function(){return this._cancel(),!0},u.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},u.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},u.prototype.shouldCopyValues=function(){return!0},u.prototype.getActualLength=function(t){return t},u}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){var r={},i=t("./util"),o=t("./nodeback"),a=i.withAppended,u=i.maybeWrapAsError,s=i.canEvaluate,l=t("./errors").TypeError,c={__isPromisified__:!0},f=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),h=function(t){return i.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function p(t){return!f.test(t)}function d(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function v(t,e,n){var r=i.getDataPropertyOrDefault(t,e+n,c);return!!r&&d(r)}function y(t,e,n,r){for(var o=i.inheritedDataKeys(t),a=[],u=0;u<o.length;++u){var s=o[u],c=t[s],f=r===h||h(s,c,t);"function"!=typeof c||d(c)||v(t,s,e)||!r(s,c,t,f)||a.push(s,c)}return function(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),a=0;a<t.length;a+=2)if(t[a]===o)throw new l("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}(a,e,n),a}var _=function(t){return t.replace(/([$])/,"\\$")},g=s?void 0:function(t,s,l,c,f,h){var p=function(){return this}(),d=t;function v(){var i=s;s===r&&(i=this);var l=new e(n);l._captureStackTrace();var c="string"==typeof d&&this!==p?this[d]:t,f=o(l,h);try{c.apply(i,a(arguments,f))}catch(t){l._rejectCallback(u(t),!0,!0)}return l._isFateSealed()||l._setAsyncGuaranteed(),l}return"string"==typeof d&&(t=c),i.notEnumerableProp(v,"__isPromisified__",!0),v};function m(t,e,n,o,a){for(var u=new RegExp(_(e)+"$"),s=y(t,e,u,n),l=0,c=s.length;l<c;l+=2){var f=s[l],h=s[l+1],p=f+e;if(o===g)t[p]=g(f,r,f,h,e,a);else{var d=o(h,function(){return g(f,r,f,h,e,a)});i.notEnumerableProp(d,"__isPromisified__",!0),t[p]=d}}return i.toFastProperties(t),t}e.promisify=function(t,e){if("function"!=typeof t)throw new l("expecting a function but got "+i.classString(t));if(d(t))return t;var n=void 0===(e=Object(e)).context?r:e.context,o=!!e.multiArgs,a=function(t,e,n){return g(t,e,void 0,t,null,n)}(t,n,o);return i.copyDescriptors(t,a,p),a},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new l("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(e=Object(e)).multiArgs,r=e.suffix;"string"!=typeof r&&(r="Async");var o=e.filter;"function"!=typeof o&&(o=h);var a=e.promisifier;if("function"!=typeof a&&(a=g),!i.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var u=i.inheritedDataKeys(t),s=0;s<u.length;++s){var c=t[u[s]];"constructor"!==u[s]&&i.isClass(c)&&(m(c.prototype,r,o,a,n),m(c,r,o,a,n))}return m(t,r,o,a,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o,a=t("./util"),u=a.isObject,s=t("./es5");"function"==typeof Map&&(o=Map);var l=function(){var t=0,e=0;function n(n,r){this[t]=n,this[t+e]=r,t++}return function(r){e=r.size,t=0;var i=new Array(2*r.size);return r.forEach(n,i),i}}();function c(t){var e,n=!1;if(void 0!==o&&t instanceof o)e=l(t),n=!0;else{var r=s.keys(t),i=r.length;e=new Array(2*i);for(var a=0;a<i;++a){var u=r[a];e[a]=t[u],e[a+i]=u}}this.constructor$(e),this._isMap=n,this._init$(void 0,-3)}function f(t){var n,o=r(t);return u(o)?(n=o instanceof e?o._then(e.props,void 0,void 0,void 0,void 0):new c(o).promise(),o instanceof e&&n._propagateFrom(o,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}a.inherits(c,n),c.prototype._init=function(){},c.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){var r;if(this._isMap)r=function(t){for(var e=new o,n=t.length/2|0,r=0;r<n;++r){var i=t[n+r],a=t[r];e.set(i,a)}return e}(this._values);else{r={};for(var i=this.length(),a=0,u=this.length();a<u;++a)r[this._values[a+i]]=this._values[a]}return this._resolve(r),!0}return!1},c.prototype.shouldCopyValues=function(){return!1},c.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return f(this)},e.props=function(t){return f(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function r(t){this._capacity=t,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},r.prototype._unshiftOne=function(t){var e=this._capacity;this._checkCapacity(this.length()+1);var n=this._front,r=(n-1&e-1^e)-e;this[r]=t,this._front=r,this._length=this.length()+1},r.prototype.unshift=function(t,e,n){this._unshiftOne(n),this._unshiftOne(e),this._unshiftOne(t)},r.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var n=this._front,r=this._length,i=n+r&e-1;!function(t,e,n,r,i){for(var o=0;o<i;++o)n[o+r]=t[o+e],t[o+e]=void 0}(this,0,this,e,i)},e.exports=r},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),a=function(t){return t.then(function(e){return u(e,t)})};function u(t,u){var s=r(t);if(s instanceof e)return a(s);if(null===(t=o.asArray(t)))return i("expecting an array or an iterable object but got "+o.classString(t));var l=new e(n);void 0!==u&&l._propagateFrom(u,3);for(var c=l._fulfill,f=l._reject,h=0,p=t.length;h<p;++h){var d=t[h];(void 0!==d||h in t)&&e.cast(d)._then(c,f,void 0,l,null)}return l}e.race=function(t){return u(t,void 0)},e.prototype.race=function(){return u(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,a){var u=e._getDomain,s=t("./util"),l=s.tryCatch;function c(t,n,r,i){this.constructor$(t);var a=u();this._fn=null===a?n:s.domainBind(a,n),void 0!==r&&(r=e.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=i===o?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function f(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function h(t,e,n,i){if("function"!=typeof e)return r("expecting a function but got "+s.classString(e));var o=new c(t,e,n,i);return o.promise()}function p(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(d,void 0,void 0,this,void 0)):d.call(this,n)}function d(t){var n,r=this.array,i=r._promise,o=l(r._fn);i._pushContext(),(n=void 0!==r._eachValues?o.call(i._boundValue(),t,this.index,this.length):o.call(i._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(r._currentCancellable=n);var u=i._popContext();return a.checkForgottenReturns(n,u,void 0!==r._eachValues?"Promise.each":"Promise.reduce",i),n}s.inherits(c,n),c.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==o&&this._eachValues.push(t)},c.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},c.prototype._init=function(){},c.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},c.prototype.shouldCopyValues=function(){return!1},c.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},c.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},c.prototype._iterate=function(t){var n,r;this._values=t;var i=t.length;if(void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n,!n.isRejected())for(;r<i;++r){var o={accum:null,value:t[r],index:r,length:i,array:this};n=n._then(p,void 0,void 0,o,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(f,f,void 0,n,this)},e.prototype.reduce=function(t,e){return h(this,t,e,null)},e.reduce=function(t,e,n,r){return h(t,e,n,r)}}},{"./util":36}],29:[function(t,i,o){"use strict";var a,u,s,l,c,f=t("./util"),h=f.getNativePromise();if(f.isNode&&"undefined"==typeof MutationObserver){var p=n.setImmediate,d=e.nextTick;a=f.isRecentNode?function(t){p.call(n,t)}:function(t){d.call(e,t)}}else if("function"==typeof h&&"function"==typeof h.resolve){var v=h.resolve();a=function(t){v.then(t)}}else a="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?void 0!==r?function(t){r(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:(u=document.createElement("div"),s={attributes:!0},l=!1,c=document.createElement("div"),new MutationObserver(function(){u.classList.toggle("foo"),l=!1}).observe(c,s),function(t){var e=new MutationObserver(function(){e.disconnect(),t()});e.observe(u,s),l||(l=!0,c.classList.toggle("foo"))});i.exports=a},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=e.PromiseInspection,o=t("./util");function a(t){this.constructor$(t)}o.inherits(a,n),a.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseFulfilled=function(t,e){var n=new i;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},a.prototype._promiseRejected=function(t,e){var n=new i;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new a(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=t("./errors").RangeError,a=t("./errors").AggregateError,u=i.isArray,s={};function l(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function c(t,e){if((0|e)!==e||e<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new l(t),i=n.promise();return n.setHowMany(e),n.init(),i}i.inherits(l,n),l.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=u(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},l.prototype.init=function(){this._initialized=!0,this._init()},l.prototype.setUnwrap=function(){this._unwrap=!0},l.prototype.howMany=function(){return this._howMany},l.prototype.setHowMany=function(t){this._howMany=t},l.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},l.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},l.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(s),this._checkOutcome())},l.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new a,e=this.length();e<this._values.length;++e)this._values[e]!==s&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},l.prototype._fulfilled=function(){return this._totalResolved},l.prototype._rejected=function(){return this._values.length-this.length()},l.prototype._addRejected=function(t){this._values.push(t)},l.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},l.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},l.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new o(e)},l.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return c(t,e)},e.prototype.some=function(t){return c(this,t)},e._SomePromiseArray=l}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},a=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},u=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return a.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return u.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){var r=t("./util"),i=r.errorObj,o=r.isObject,a={}.hasOwnProperty;return function(t,u){if(o(t)){if(t instanceof e)return t;var s=function(t){try{return function(t){return t.then}(t)}catch(t){return i.e=t,i}}(t);if(s===i){u&&u._pushContext();var l=e.reject(s.e);return u&&u._popContext(),l}if("function"==typeof s){if(function(t){try{return a.call(t,"_promise0")}catch(t){return!1}}(t)){var l=new e(n);return t._then(l._fulfill,l._reject,void 0,l,null),l}return function(t,o,a){var u=new e(n),s=u;a&&a._pushContext(),u._captureStackTrace(),a&&a._popContext();var l=!0,c=r.tryCatch(o).call(t,function(t){u&&(u._resolveCallback(t),u=null)},function(t){u&&(u._rejectCallback(t,l,!0),u=null)});return l=!1,u&&c===i&&(u._rejectCallback(c.e,!0,!0),u=null),s}(t,s,u)}}return t}}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=e.TimeoutError;function a(t){this.handle=t}a.prototype._resultCancelled=function(){clearTimeout(this.handle)};var u=function(t){return s(+this).thenReturn(t)},s=e.delay=function(t,i){var o,s;return void 0!==i?(o=e.resolve(i)._then(u,null,null,t,void 0),r.cancellation()&&i instanceof e&&o._setOnCancel(i)):(o=new e(n),s=setTimeout(function(){o._fulfill()},+t),r.cancellation()&&o._setOnCancel(new a(s)),o._captureStackTrace()),o._setAsyncGuaranteed(),o};function l(t){return clearTimeout(this.handle),t}function c(t){throw clearTimeout(this.handle),t}e.prototype.delay=function(t){return s(t,this)},e.prototype.timeout=function(t,e){var n,u;t=+t;var s=new a(setTimeout(function(){n.isPending()&&function(t,e,n){var r;r="string"!=typeof e?e instanceof Error?e:new o("operation timed out"):new o(e),i.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=n&&n.cancel()}(n,e,u)},t));return r.cancellation()?(u=this.then(),(n=u._then(l,c,void 0,s,void 0))._setOnCancel(s)):n=this._then(l,c,void 0,s,void 0),n}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,a){var u=t("./util"),s=t("./errors").TypeError,l=t("./util").inherits,c=u.errorObj,f=u.tryCatch,h={};function p(t){setTimeout(function(){throw t},0)}function d(t,n){var i=0,a=t.length,u=new e(o);return function o(){if(i>=a)return u._fulfill();var s=function(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(t[i++]);if(s instanceof e&&s._isDisposable()){try{s=r(s._getDisposer().tryDispose(n),t.promise)}catch(t){return p(t)}if(s instanceof e)return s._then(o,p,null,null,null)}o()}(),u}function v(t,e,n){this._data=t,this._promise=e,this._context=n}function y(t,e,n){this.constructor$(t,e,n)}function _(t){return v.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function g(t){this.length=t,this.promise=null,this[t-1]=null}v.prototype.data=function(){return this._data},v.prototype.promise=function(){return this._promise},v.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():h},v.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=e!==h?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},v.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},l(y,v),y.prototype.doDispose=function(t,e){var n=this.data();return n.call(t,t,e)},g.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(t<2)return n("you must pass at least 2 arguments to Promise.using");var i,o=arguments[t-1];if("function"!=typeof o)return n("expecting a function but got "+u.classString(o));var s=!0;2===t&&Array.isArray(arguments[0])?(i=arguments[0],t=i.length,s=!1):(i=arguments,t--);for(var l=new g(t),h=0;h<t;++h){var p=i[h];if(v.isDisposer(p)){var y=p;(p=p.promise())._setDisposable(y)}else{var m=r(p);m instanceof e&&(p=m._then(_,null,null,{resources:l,index:h},void 0))}l[h]=p}for(var b=new Array(l.length),h=0;h<b.length;++h)b[h]=e.resolve(l[h]).reflect();var w=e.all(b).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return c.e=n.error(),c;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}k._pushContext(),o=f(o);var r=s?o.apply(void 0,t):o(t),i=k._popContext();return a.checkForgottenReturns(r,i,"Promise.using",k),r}),k=w.lastly(function(){var t=new e.PromiseInspection(w);return d(l,t)});return l.promise=k,k._setOnCancel(l),k},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new y(t,this,i());throw new s}}},{"./errors":12,"./util":36}],36:[function(t,r,i){"use strict";var o=t("./es5"),a="undefined"==typeof navigator,u={e:{}},s,l="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:void 0!==this?this:null;function c(){try{var t=s;return s=null,t.apply(this,arguments)}catch(t){return u.e=t,u}}function f(t){return s=t,c}var h=function(t,e){var n={}.hasOwnProperty;function r(){for(var r in this.constructor=t,this.constructor$=e,e.prototype)n.call(e.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=e.prototype[r])}return r.prototype=e.prototype,t.prototype=new r,t.prototype};function p(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function d(t){return"function"==typeof t||"object"==typeof t&&null!==t}function v(t){return p(t)?new Error(C(t)):t}function y(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;n<r;++n)i[n]=t[n];return i[n]=e,i}function _(t,e,n){if(!o.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function g(t,e,n){if(p(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return o.defineProperty(t,e,r),t}function m(t){throw t}var b=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(o.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],i=Object.create(null);null!=t&&!e(t);){var a;try{a=n(t)}catch(t){return r}for(var u=0;u<a.length;++u){var s=a[u];if(!i[s]){i[s]=!0;var l=Object.getOwnPropertyDescriptor(t,s);null!=l&&null==l.get&&null==l.set&&r.push(s)}}t=o.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var i=[];t:for(var o in n)if(r.call(n,o))i.push(o);else{for(var a=0;a<t.length;++a)if(r.call(t[a],o))continue t;i.push(o)}return i}}(),w=/this\s*\.\s*\S+\s*=/;function k(t){try{if("function"==typeof t){var e=o.names(t.prototype),n=o.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=w.test(t+"")&&o.names(t).length>0;if(n||r||i)return!0}return!1}catch(t){return!1}}function x(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t}var E=/^[a-z$_][a-z$_0-9]*$/i;function S(t){return E.test(t)}function j(t,e,n){for(var r=new Array(t),i=0;i<t;++i)r[i]=e+i+n;return r}function C(t){try{return t+""}catch(t){return"[no string representation]"}}function T(t){return null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function P(t){try{g(t,"isOperational",!0)}catch(t){}}function A(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function O(t){return T(t)&&o.propertyIsWritable(t,"stack")}var M="stack"in new Error?function(t){return O(t)?t:new Error(C(t))}:function(t){if(O(t))return t;try{throw new Error(C(t))}catch(t){return t}};function R(t){return{}.toString.call(t)}function F(t,e,n){for(var r=o.names(t),i=0;i<r.length;++i){var a=r[i];if(n(a))try{o.defineProperty(e,a,o.getDescriptor(t,a))}catch(t){}}}var I=function(t){return o.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var B="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};I=function(t){return o.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?B(t):null}}var L=void 0!==e&&"[object process]"===R(e).toLowerCase();function N(t,n){return L?e.env[t]:n}function U(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}}function D(t,e){return t.bind(e)}var G={isClass:k,isIdentifier:S,inheritedDataKeys:b,getDataPropertyOrDefault:_,thrower:m,isArray:o.isArray,asArray:I,notEnumerableProp:g,isPrimitive:p,isObject:d,isError:T,canEvaluate:a,errorObj:u,tryCatch:f,inherits:h,withAppended:y,maybeWrapAsError:v,toFastProperties:x,filledRange:j,toString:C,canAttachTrace:O,ensureErrorObject:M,originatesFromRejection:A,markAsOriginatingFromRejection:P,classString:R,copyDescriptors:F,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:L,env:N,global:l,getNativePromise:U,domainBind:D},z;G.isRecentNode=G.isNode&&(z=e.versions.node.split(".").map(Number),0===z[0]&&z[1]>10||z[0]>0),G.isNode&&G.toFastProperties(e);try{throw new Error}catch(t){G.lastLineError=t}r.exports=G},{"./es5":13}]},{},[4])(4)}(),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,n(66),n(46),n(239).setImmediate)},607:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.slicesForNotesAndTiming=function(t,e,n){var r=n.beatForPulse,i=new Set,a=new Set,u=new Set,s=!0,l=!1,c=void 0;try{for(var f,h=t[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value,d=p.x,v=p.y,y=p.c;i.add(v),d&&a.add(v),y||u.add(v)}}catch(t){l=!0,c=t}finally{try{!s&&h.return&&h.return()}finally{if(l)throw c}}var _=new Map,g=null,m=!0,b=void 0,w=void 0,k=!0,x=!1,E=void 0;try{for(var S,j=o.default.sortBy([].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(i)))[Symbol.iterator]();!(k=(S=j.next()).done);k=!0){var v=S.value,C=e.beatToSeconds(r(v));null===g||u.has(v)?g=0:g+=C-b;var T=m||a.has(v)||u.has(v);if(T){w&&!u.has(v)&&(w.keysoundEnd=g);var P={keysoundStart:g,keysoundEnd:void 0};_.set(v,P),w=P}m=a.has(v),b=C}}catch(t){x=!0,E=t}finally{try{!k&&j.return&&j.return()}finally{if(x)throw E}}return _};var r,i=n(331),o=(r=i)&&r.__esModule?r:{default:r}},619:function(t,e,n){"use strict";t.exports=function(t,e,n,r){Object.defineProperty(t,e,{get:function(){var t=n.call(this);return Object.defineProperty(this,e,{value:t,enumerable:!!r,writable:!0}),t},set:function(t){return Object.defineProperty(this,e,{value:t,enumerable:!!r,writable:!0}),t},enumerable:!!r,configurable:!0})}},620:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BemusePackageResources=void 0;var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(126)),a=p(n(619)),u=p(n(162)),s=p(n(113)),l=p(n(274)),c=p(n(4)),f=n(190),h=n(189);function p(t){return t&&t.__esModule?t:{default:t}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var v=e.BemusePackageResources=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d(this,t);var i=a.default.bind(null,this);this._url=e,this._fallback=r.fallback,this._fallbackPattern=r.fallbackPattern,i("metadata",function(){return(0,u.default)((0,f.resolve)(n._url,"metadata.json")).as("text").then(function(t){return JSON.parse(t)})}),i("refs",function(){return n.metadata.then(function(t){return t.refs.map(function(t){return new _(n,t)})})}),i("_fileMap",function(){return n.metadata.then(function(t){var e=new Map,n=!0,r=!1,i=void 0;try{for(var o,a=t.files[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;e.set(u.name.toLowerCase(),u)}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e})}),this.progress={all:new c.default,current:new c.default};var s=o.simultaneous(this.progress.current);this._loadPayload=o.wrapPromise(this.progress.all,(0,l.default)(2,function(t){return(0,u.default)(t).as("blob",(e=new c.default,s.add(e),e)).then(g);var e}))}return i(t,[{key:"file",value:function(t){var e=this;return this._fileMap.then(function(n){var r=n.get(t.toLowerCase());if(r)return new y(e,r.ref,r.name);if(e._fallback&&e._fallbackPattern.test(t))return new h.URLResource((0,f.resolve)(e._fallback,t));throw new Error("Unable to find: "+t)})}},{key:"getBlob",value:function(t){var e=r(t,3),n=e[0],i=e[1],o=e[2];return this.refs.then(function(t){return t[n]}).then(function(t){return t.load()}).then(function(t){return t.slice(i,o)})}},{key:"url",get:function(){return this._url}}]),t}(),y=function(){function t(e,n,r){d(this,t),this._resources=e,this._ref=n,this._name=r}return i(t,[{key:"read",value:function(t){return o.atomic(t,this._resources.getBlob(this._ref).then(function(t){return(0,s.default)(t).as("arraybuffer")}))}},{key:"resolveUrl",value:function(){return this._resources.getBlob(this._ref).then(function(t){return URL.createObjectURL(t)})}},{key:"name",get:function(){return this._name}}]),t}(),_=function(){function t(e,n){d(this,t),this._resources=e,this._url=(0,f.resolve)(e.url,n.path)}return i(t,[{key:"load",value:function(){return this._promise||(this._promise=this._resources._loadPayload(this._url))}}]),t}();function g(t){return(0,s.default)(t.slice(0,10)).as("text").then(function(e){if("BEMUSEPACK"!==e)throw new Error("Invalid magic number");return(0,s.default)(t.slice(10,14)).as("arraybuffer")}).then(function(t){var e=new Uint8Array(t);return e[0]+(e[1]<<8)+(e[2]<<16)+(e[3]<<24)}).then(function(e){return t.slice(14+e)})}e.default=v},683:function(t,e,n){(t.exports=n(1)(!1)).push([t.i,'.Scene {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  overflow: hidden;\n  font-family: "Source Sans Pro", "Segoe UI", "Helvetica Neue", sans-serif;\n}\n\n.Scene > .SceneHeading {\n  position: absolute;\n  top: 20px;\n  right: 0;\n  left: 0;\n}\n\n@media (min-width: 720px) {\n  .Scene > .SceneHeading {\n    top: 2rem;\n  }\n}\n\n.Scene > .SceneToolbar {\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n',""])},684:function(t,e,n){var r=n(683);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(0)(r,i);r.locals&&(t.exports=r.locals)},734:function(t,e,n){t.exports=n.p+"7d6d69a86d70e4e52079c5ce873435c6.jpg"},77:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.judgeEndTime=e.judgeTime=e.MISSED=e.UNJUDGED=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.getJudgeForNotechart=function(t,e){var n=e.tutorial,r=void 0!==n&&n,i=t.songInfo,o=i.difficulty>=5;if(r)return new y;if(o)return _;if(1===i.level||2===i.level)return new v(d);if(3===i.level)return new v(p);if(4===i.level)return new v(h);if(5===i.level)return new v(f);return _},e.judgeTimeWith=g,e.timegate=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;return a.default.find(e.getTimegates(null,null),{value:t}).timegate},e.isBad=m,e.breaksCombo=function(t){return t===l||m(t)},e.weight=function(t){return 1===t?100:2===t?80:3===t?50:0};var i,o=n(43),a=(i=o)&&i.__esModule?i:{default:i};function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=e.UNJUDGED=0,l=e.MISSED=-1,c=[{value:1,timegate:.02,endTimegate:.04},{value:2,timegate:.05,endTimegate:.1},{value:3,timegate:.1,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}],f=[{value:1,timegate:.021,endTimegate:.042},{value:2,timegate:.06,endTimegate:.12},{value:3,timegate:.12,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}],h=[{value:1,timegate:.022,endTimegate:.044},{value:2,timegate:.07,endTimegate:.14},{value:3,timegate:.14,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}],p=[{value:1,timegate:.023,endTimegate:.046},{value:2,timegate:.08,endTimegate:.16},{value:3,timegate:.16,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}],d=[{value:1,timegate:.024,endTimegate:.048},{value:2,timegate:.1,endTimegate:.18},{value:3,timegate:.18,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}],v=function(){function t(e){u(this,t),this._timegates=e}return r(t,[{key:"getTimegates",value:function(t,e){return this._timegates}}]),t}(),y=function(){function t(){u(this,t)}return r(t,[{key:"getTimegates",value:function(t,e){return e<100?d:c}}]),t}(),_=new v(c);function g(t){return function(e,n){for(var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:_).getTimegates(e,n),i=Math.abs(e-n),o=0;o<r.length;o++)if(i<t(r[o]))return r[o].value;return e<n?s:l}}e.judgeTime=g(a.default.property("timegate")),e.judgeEndTime=g(a.default.property("endTimegate"));function m(t){return t>=4}},89:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EXTRA_FORMATTER=e.PERCENTAGE_FORMATTER=e.BYTES_FORMATTER=void 0;var r,i=n(341),o=(r=i)&&r.__esModule?r:{default:r};var a=function(t){return function(e){return null!==e.progress?t(e):""}};e.BYTES_FORMATTER=a(function(t){return(0,o.default)(t.current)+" / "+(0,o.default)(t.total)}),e.PERCENTAGE_FORMATTER=a(function(t){return(t.current/t.total*100).toFixed(1)+"%"}),e.EXTRA_FORMATTER=a(function(t){return t.extra+""})}}]);
//# sourceMappingURL=game-757e50ffaf9f89e02583.js.map