{"version":3,"sources":["file:///home/runner/work/bemuse/bemuse/common/temp/node_modules/.pnpm/delay@5.0.0/node_modules/delay/index.js","file:///home/runner/work/bemuse/bemuse/common/temp/node_modules/.pnpm/bytes@3.1.2/node_modules/bytes/index.js","file:///home/runner/work/bemuse/bemuse/common/temp/node_modules/.pnpm/webpack@4.46.0/node_modules/webpack/buildin/amd-define.js","file:///home/runner/work/bemuse/bemuse/common/temp/node_modules/.pnpm/webpack@4.46.0/node_modules/webpack/buildin/amd-options.js","file:///home/runner/work/bemuse/bemuse/common/temp/node_modules/.pnpm/classnames@2.3.2/node_modules/classnames/index.js","file:///home/runner/work/bemuse/bemuse/common/temp/node_modules/.pnpm/baconjs@0.7.95/node_modules/baconjs/dist/Bacon.js"],"names":["createAbortError","error","Error","name","createDelay","clearTimeout","defaultClear","setTimeout","set","willResolve","ms","value","signal","aborted","Promise","reject","timeoutId","settle","rejectFn","clear","signalListener","delayPromise","resolve","removeEventListener","addEventListener","once","createWithTimers","clearAndSet","delay","range","minimum","maximum","options","Math","floor","random","randomInteger","module","exports","default","parse","format","formatThousandsRegExp","formatDecimalsRegExp","map","b","kb","mb","gb","tb","pow","pb","parseRegExp","Number","isFinite","mag","abs","thousandsSeparator","unitSeparator","decimalPlaces","undefined","fixedDecimals","Boolean","unit","toLowerCase","str","toFixed","replace","split","s","i","join","val","isNaN","floatValue","results","exec","parseFloat","parseInt","__webpack_amd_options__","hasOwn","hasOwnProperty","classNames","classes","arguments","length","arg","argType","push","Array","isArray","inner","apply","toString","Object","prototype","includes","key","call","_slice","slice","Bacon","Exception","global","this","nop","former","x","_","assert","message","condition","assertObservableIsProperty","_isObservable","_isProperty","assertFunction","f","isFunction","xs","isObservable","assertNoArguments","args","extend","target","prop","inherit","child","parent","hasProp","ctor","symbol","Symbol","indexOf","indexWhere","head","always","negate","empty","tail","filter","filtered","result","each","toArray","contains","id","last","all","any","without","y","remove","splice","fold","seed","flatMap","ys","concat","cached","None","_isNone","bind","fn","me","obj","recursionDepth","UpdateBarrier","rootEvent","waiterObs","waiters","aftersStack","aftersStackHeight","flushed","ensureStackHeight","h","afterTransaction","obs","stackIndexForThisObs","containsObs","processAfters","aftersList","stackSizeAtStart","topOfStack","topAfters","index","_topAfters$index","after","callSuccess","flushWaiters","deps","obsId","obsWaiters","flushDepsOf","dep","internalDeps","whenDoneWith","hasWaiters","inTransaction","event","context","flush","currentEventId","wrappedSubscribe","sink","unsubd","shouldUnsub","doUnsub","unsub","dispatcher","subscribe","noMore","Source","sync","lazy","queue","ConsumingSource","BufferingSource","Desc","method","_isSource","markEnded","ended","consume","mayHave","hasAtLeast","flatten","shift","c","values","isTrigger","_isEventStream","fromObservable","_isDesc","findDeps","describe","ref","_len","_key","withDesc","desc","withMethodCallSupport","wrapped","_len2","_key2","methodName","makeFunctionArgs","makeFunction_","partiallyApplied","applied","_len3","_key3","toFieldExtractor","parts","partFuncs","fieldValue","toSimpleExtractor","isFieldKey","charAt","_len4","_key4","makeFunction","convertArgsToFunction","sampled","sampledBy","p","_ref","_ref2","toCombinator","toFieldKey","left","right","Some","_isSome","getOrElse","get","forEach","isDefined","inspect","toOption","v","more","eventIdCounter","Event","Next","valueF","eager","_isNext","valueInternal","Initial","End","_isEvent","isEvent","isEnd","isInitial","isNext","isError","hasValue","log","fmap","_isInitial","toNext","initialEvent","nextEvent","endEvent","toEvent","idCounter","registerObs","Observable","initialDesc","CompositeUnsubscribe","ss","unsubscribe","unsubscribed","subscriptions","starting","add","Dispatcher","_subscribe","_handleEvent","handleEvent","pushing","prevError","unsubSrc","EventStream","handler","subscribeInternal","onValue","onValues","onError","onEnd","_name","withDescription","assign","subscription","_this2","iterable","count","hasSubscribers","removeSub","pushIt","pushToSubscriptions","tmp","len","sub","unsubscribeFromSource","_this","toProperty","initValue_","initValue","disp","Property","initSent","subbed","reply","sendInit","toEventStream","withHandler","never","when","usage","sources","pats","patterns","patSources","constantToFunction","pat","ixs","triggerFound","j","ix","k","needsBarrier","containsDuplicateDeps","resultStream","triggers","ends","match","i1","cannotSync","source","cannotMatch","nonFlattened","trigger","part","unsubAll","flushLater","flushWhileTriggers","pop","events","i2","e","_p","observables","state","checkObservable","PropertyDispatcher","property","current","currentValueRootId","propertyEnded","groupSimultaneous","_len5","streams","_key5","_len6","_key6","maybeSubSource","_this3","dispatchingId","valId","changes","_this4","_this5","constant","fromBinder","binder","eventTransformer","unbound","shouldUnbind","unbind","unbinder","_len7","_key7","_len8","_key8","argumentsToObservables","argumentsToObservablesAndFunction","combineAsArray","stream","_len9","_key9","combineWith","_argumentsToObservablesAndFunction","combine","other","combinator","withStateMachine","initState","fromF","newState","outputs","output","equals","a","isNone","object","skipDuplicates","isEqual","prev","awaiting","not","and","or","scheduler","d","setInterval","clearInterval","now","Date","getTime","bufferWithTime","bufferWithTimeOrCount","MAX_VALUE","bufferWithCount","flushOrSchedule","buffer","schedule","onInput","onFlush","scheduled","end","valuesToPush","_this6","delayMs","_this7","_len10","_key10","unsubRight","unsubLeft","addPropertyInitValueToStream","concatAll","justInitValue","flatMap_","makeSpawner","flatMapFirst","makeObservable","root","firstOnly","limit","rootDep","childDeps","composite","spawn","unsubMe","checkQueue","checkEnd","__","unsubRoot","Bus","subscribeAll","guardedSink","flatMapWithConcurrencyLimit","_len11","_key11","flatMapConcat","later","bufferingThrottle","minimumInterval","newSink","subscribeInput","input","_this8","unsubscribeInput","plug","_this9","assertObservable","rootPush","pushQueue","liftCallback","callback","_len12","_key12","fromCallback","_len13","_key13","fromNodeCallback","_len14","_key14","combineTemplate","template","setValue","ctxStack","mkContext","containsObservables","constructor","compile","funcs","applyStreamValue","newContext","pushContext","compileTemplate","constantValue","resultProperty","rootContext","mapEnd","skipErrors","takeUntil","stopper","endMarker","_event$value","data","flatMapLatest","delayChanges","debounce","debounceImmediate","decode","cases","scan","_this10","acc","initHandled","next","diff","start","prevTuple","tuple","doAction","doEnd","doError","doLog","_len15","_key15","console","endOnError","_len16","_key16","errors","take","first","mapError","flatMapError","err","flatScan","updated","sampler","thisSource","samplerSource","sample","interval","_len17","_key17","reduce","eventMethods","valueAndEnd","fromEventTarget","eventName","_findHandlerMethods","pair","methodPair","addListener","findHandlerMethods","fromEvent","fromPoll","poll","fromPromise","promise","abort","bound","then","done","groupBy","keyF","limitF","src","similar","limited","fromArray","assertArray","pushNeeded","holdWhen","valve","onHold","bufferedValues","srcIsEnded","subscribed","endIfBothEnded","toSend","$","asEventStream","selector","_this11","on","off","jQuery","Zepto","lastEvent","_len18","_key18","merge","assertEventStream","mergeAll","sinks","unsubBoth","repeatedly","repeat","generator","flag","subscribeNext","retry","retries","retriesDone","isRetryable","finished","valueStream","pause","sequentially","skip","skipUntil","starter","started","skipWhile","ok","_len19","_key19","slidingWindow","n","minValues","window","spies","running","spy","ESObservable","observable","startWith","takeWhile","_len20","_key20","throttle","firstToPromise","PromiseCtr","_this12","toPromise","update","initial","lateBindFirst","_len22","_key22","_len21","_key21","Function","zipAsArray","_len23","_key23","zipWith","_len24","_key24","_len25","_key25","observablesAndFunction","zip","observerOrOnNext","onComplete","observer","complete","closed","cancel","toESObservable","fromESObservable","_observable"],"mappings":"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","file":"build/vendors~sync-3998e99e783f4b51412b.js","sourcesContent":["'use strict';\n\n// From https://github.com/sindresorhus/random-int/blob/c37741b56f76b9160b0b63dae4e9c64875128146/index.js#L13-L15\nconst randomInteger = (minimum, maximum) => Math.floor((Math.random() * (maximum - minimum + 1)) + minimum);\n\nconst createAbortError = () => {\n\tconst error = new Error('Delay aborted');\n\terror.name = 'AbortError';\n\treturn error;\n};\n\nconst createDelay = ({clearTimeout: defaultClear, setTimeout: set, willResolve}) => (ms, {value, signal} = {}) => {\n\tif (signal && signal.aborted) {\n\t\treturn Promise.reject(createAbortError());\n\t}\n\n\tlet timeoutId;\n\tlet settle;\n\tlet rejectFn;\n\tconst clear = defaultClear || clearTimeout;\n\n\tconst signalListener = () => {\n\t\tclear(timeoutId);\n\t\trejectFn(createAbortError());\n\t};\n\n\tconst cleanup = () => {\n\t\tif (signal) {\n\t\t\tsignal.removeEventListener('abort', signalListener);\n\t\t}\n\t};\n\n\tconst delayPromise = new Promise((resolve, reject) => {\n\t\tsettle = () => {\n\t\t\tcleanup();\n\t\t\tif (willResolve) {\n\t\t\t\tresolve(value);\n\t\t\t} else {\n\t\t\t\treject(value);\n\t\t\t}\n\t\t};\n\n\t\trejectFn = reject;\n\t\ttimeoutId = (set || setTimeout)(settle, ms);\n\t});\n\n\tif (signal) {\n\t\tsignal.addEventListener('abort', signalListener, {once: true});\n\t}\n\n\tdelayPromise.clear = () => {\n\t\tclear(timeoutId);\n\t\ttimeoutId = null;\n\t\tsettle();\n\t};\n\n\treturn delayPromise;\n};\n\nconst createWithTimers = clearAndSet => {\n\tconst delay = createDelay({...clearAndSet, willResolve: true});\n\tdelay.reject = createDelay({...clearAndSet, willResolve: false});\n\tdelay.range = (minimum, maximum, options) => delay(randomInteger(minimum, maximum), options);\n\treturn delay;\n};\n\nconst delay = createWithTimers();\ndelay.createWithTimers = createWithTimers;\n\nmodule.exports = delay;\n// TODO: Remove this for the next major release\nmodule.exports.default = delay;\n","/*!\n * bytes\n * Copyright(c) 2012-2014 TJ Holowaychuk\n * Copyright(c) 2015 Jed Watson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = bytes;\nmodule.exports.format = format;\nmodule.exports.parse = parse;\n\n/**\n * Module variables.\n * @private\n */\n\nvar formatThousandsRegExp = /\\B(?=(\\d{3})+(?!\\d))/g;\n\nvar formatDecimalsRegExp = /(?:\\.0*|(\\.[^0]+)0+)$/;\n\nvar map = {\n  b:  1,\n  kb: 1 << 10,\n  mb: 1 << 20,\n  gb: 1 << 30,\n  tb: Math.pow(1024, 4),\n  pb: Math.pow(1024, 5),\n};\n\nvar parseRegExp = /^((-|\\+)?(\\d+(?:\\.\\d+)?)) *(kb|mb|gb|tb|pb)$/i;\n\n/**\n * Convert the given value in bytes into a string or parse to string to an integer in bytes.\n *\n * @param {string|number} value\n * @param {{\n *  case: [string],\n *  decimalPlaces: [number]\n *  fixedDecimals: [boolean]\n *  thousandsSeparator: [string]\n *  unitSeparator: [string]\n *  }} [options] bytes options.\n *\n * @returns {string|number|null}\n */\n\nfunction bytes(value, options) {\n  if (typeof value === 'string') {\n    return parse(value);\n  }\n\n  if (typeof value === 'number') {\n    return format(value, options);\n  }\n\n  return null;\n}\n\n/**\n * Format the given value in bytes into a string.\n *\n * If the value is negative, it is kept as such. If it is a float,\n * it is rounded.\n *\n * @param {number} value\n * @param {object} [options]\n * @param {number} [options.decimalPlaces=2]\n * @param {number} [options.fixedDecimals=false]\n * @param {string} [options.thousandsSeparator=]\n * @param {string} [options.unit=]\n * @param {string} [options.unitSeparator=]\n *\n * @returns {string|null}\n * @public\n */\n\nfunction format(value, options) {\n  if (!Number.isFinite(value)) {\n    return null;\n  }\n\n  var mag = Math.abs(value);\n  var thousandsSeparator = (options && options.thousandsSeparator) || '';\n  var unitSeparator = (options && options.unitSeparator) || '';\n  var decimalPlaces = (options && options.decimalPlaces !== undefined) ? options.decimalPlaces : 2;\n  var fixedDecimals = Boolean(options && options.fixedDecimals);\n  var unit = (options && options.unit) || '';\n\n  if (!unit || !map[unit.toLowerCase()]) {\n    if (mag >= map.pb) {\n      unit = 'PB';\n    } else if (mag >= map.tb) {\n      unit = 'TB';\n    } else if (mag >= map.gb) {\n      unit = 'GB';\n    } else if (mag >= map.mb) {\n      unit = 'MB';\n    } else if (mag >= map.kb) {\n      unit = 'KB';\n    } else {\n      unit = 'B';\n    }\n  }\n\n  var val = value / map[unit.toLowerCase()];\n  var str = val.toFixed(decimalPlaces);\n\n  if (!fixedDecimals) {\n    str = str.replace(formatDecimalsRegExp, '$1');\n  }\n\n  if (thousandsSeparator) {\n    str = str.split('.').map(function (s, i) {\n      return i === 0\n        ? s.replace(formatThousandsRegExp, thousandsSeparator)\n        : s\n    }).join('.');\n  }\n\n  return str + unitSeparator + unit;\n}\n\n/**\n * Parse the string value into an integer in bytes.\n *\n * If no unit is given, it is assumed the value is in bytes.\n *\n * @param {number|string} val\n *\n * @returns {number|null}\n * @public\n */\n\nfunction parse(val) {\n  if (typeof val === 'number' && !isNaN(val)) {\n    return val;\n  }\n\n  if (typeof val !== 'string') {\n    return null;\n  }\n\n  // Test if the string passed is valid\n  var results = parseRegExp.exec(val);\n  var floatValue;\n  var unit = 'b';\n\n  if (!results) {\n    // Nothing could be extracted from the given string\n    floatValue = parseInt(val, 10);\n    unit = 'b'\n  } else {\n    // Retrieve the value and the unit\n    floatValue = parseFloat(results[1]);\n    unit = results[4].toLowerCase();\n  }\n\n  if (isNaN(floatValue)) {\n    return null;\n  }\n\n  return Math.floor(map[unit] * floatValue);\n}\n","module.exports = function() {\n\tthrow new Error(\"define cannot be used indirect\");\n};\n","/* globals __webpack_amd_options__ */\nmodule.exports = __webpack_amd_options__;\n","/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\tvar nativeCodeString = '[native code]';\n\n\tfunction classNames() {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tif (arg.length) {\n\t\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\t\tif (inner) {\n\t\t\t\t\t\tclasses.push(inner);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\t\t\tclasses.push(arg.toString());\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","(function() {\nvar _slice = Array.prototype.slice;\nvar Bacon = {\n  toString: function () {\n    return \"Bacon\";\n  }\n};\n\nBacon.version = '0.7.95';\n\nvar Exception = (typeof global !== \"undefined\" && global !== null ? global : this).Error;\nvar nop = function () {};\nvar latter = function (_, x) {\n  return x;\n};\nvar former = function (x, _) {\n  return x;\n};\nvar cloneArray = function (xs) {\n  return xs.slice(0);\n};\nvar assert = function (message, condition) {\n  if (!condition) {\n    throw new Exception(message);\n  }\n};\nvar assertObservableIsProperty = function (x) {\n  if ((x != null ? x._isObservable : void 0) && !(x != null ? x._isProperty : void 0)) {\n    throw new Exception(\"Observable is not a Property : \" + x);\n  }\n};\nvar assertEventStream = function (event) {\n  if (!(event != null ? event._isEventStream : void 0)) {\n    throw new Exception(\"not an EventStream : \" + event);\n  }\n};\n\nvar assertObservable = function (event) {\n  if (!(event != null ? event._isObservable : void 0)) {\n    throw new Exception(\"not an Observable : \" + event);\n  }\n};\nvar assertFunction = function (f) {\n  return assert(\"not a function : \" + f, _.isFunction(f));\n};\nvar isArray = Array.isArray || function (xs) {\n  return xs instanceof Array;\n};\nvar isObservable = function (x) {\n  return x && x._isObservable;\n};\nvar assertArray = function (xs) {\n  if (!isArray(xs)) {\n    throw new Exception(\"not an array : \" + xs);\n  }\n};\nvar assertNoArguments = function (args) {\n  return assert(\"no arguments supported\", args.length === 0);\n};\nvar assertString = function (x) {\n  if (typeof x === \"string\") {\n    throw new Exception(\"not a string : \" + x);\n  }\n};\n\nvar extend = function (target) {\n  var length = arguments.length;\n  for (var i = 1; 1 < length ? i < length : i > length; 1 < length ? i++ : i--) {\n    for (var prop in arguments[i]) {\n      target[prop] = arguments[i][prop];\n    }\n  }\n  return target;\n};\n\nvar inherit = function (child, parent) {\n  var hasProp = ({}).hasOwnProperty;\n  var ctor = function () {};\n  ctor.prototype = parent.prototype;\n  child.prototype = new ctor();\n  for (var key in parent) {\n    if (hasProp.call(parent, key)) {\n      child[key] = parent[key];\n    }\n  }\n  return child;\n};\n\nvar symbol = function (key) {\n  if (typeof Symbol !== \"undefined\" && Symbol[key]) {\n    return Symbol[key];\n  } else if (typeof Symbol !== \"undefined\" && typeof Symbol[\"for\"] === \"function\") {\n    return Symbol[key] = Symbol[\"for\"](key);\n  } else {\n    return \"@@\" + key;\n  }\n};\n\nvar _ = {\n  indexOf: (function () {\n    if (Array.prototype.indexOf) {\n      return function (xs, x) {\n        return xs.indexOf(x);\n      };\n    } else {\n      return function (xs, x) {\n        for (var i = 0, y; i < xs.length; i++) {\n          y = xs[i];\n          if (x === y) {\n            return i;\n          }\n        }\n        return -1;\n      };\n    }\n  })(),\n  indexWhere: function (xs, f) {\n    for (var i = 0, y; i < xs.length; i++) {\n      y = xs[i];\n      if (f(y)) {\n        return i;\n      }\n    }\n    return -1;\n  },\n  head: function (xs) {\n    return xs[0];\n  },\n  always: function (x) {\n    return function () {\n      return x;\n    };\n  },\n  negate: function (f) {\n    return function (x) {\n      return !f(x);\n    };\n  },\n  empty: function (xs) {\n    return xs.length === 0;\n  },\n  tail: function (xs) {\n    return xs.slice(1, xs.length);\n  },\n  filter: function (f, xs) {\n    var filtered = [];\n    for (var i = 0, x; i < xs.length; i++) {\n      x = xs[i];\n      if (f(x)) {\n        filtered.push(x);\n      }\n    }\n    return filtered;\n  },\n  map: function (f, xs) {\n    return (function () {\n      var result = [];\n      for (var i = 0, x; i < xs.length; i++) {\n        x = xs[i];\n        result.push(f(x));\n      }\n      return result;\n    })();\n  },\n  each: function (xs, f) {\n    for (var key in xs) {\n      if (Object.prototype.hasOwnProperty.call(xs, key)) {\n        var value = xs[key];\n        f(key, value);\n      }\n    }\n  },\n  toArray: function (xs) {\n    return isArray(xs) ? xs : [xs];\n  },\n  contains: function (xs, x) {\n    return _.indexOf(xs, x) !== -1;\n  },\n  id: function (x) {\n    return x;\n  },\n  last: function (xs) {\n    return xs[xs.length - 1];\n  },\n  all: function (xs) {\n    var f = arguments.length <= 1 || arguments[1] === undefined ? _.id : arguments[1];\n\n    for (var i = 0, x; i < xs.length; i++) {\n      x = xs[i];\n      if (!f(x)) {\n        return false;\n      }\n    }\n    return true;\n  },\n  any: function (xs) {\n    var f = arguments.length <= 1 || arguments[1] === undefined ? _.id : arguments[1];\n\n    for (var i = 0, x; i < xs.length; i++) {\n      x = xs[i];\n      if (f(x)) {\n        return true;\n      }\n    }\n    return false;\n  },\n  without: function (x, xs) {\n    return _.filter(function (y) {\n      return y !== x;\n    }, xs);\n  },\n  remove: function (x, xs) {\n    var i = _.indexOf(xs, x);\n    if (i >= 0) {\n      return xs.splice(i, 1);\n    }\n  },\n  fold: function (xs, seed, f) {\n    for (var i = 0, x; i < xs.length; i++) {\n      x = xs[i];\n      seed = f(seed, x);\n    }\n    return seed;\n  },\n  flatMap: function (f, xs) {\n    return _.fold(xs, [], function (ys, x) {\n      return ys.concat(f(x));\n    });\n  },\n  cached: function (f) {\n    var value = None;\n    return function () {\n      if (typeof value !== \"undefined\" && value !== null ? value._isNone : undefined) {\n        value = f();\n        f = undefined;\n      }\n      return value;\n    };\n  },\n  bind: function (fn, me) {\n    return function () {\n      return fn.apply(me, arguments);\n    };\n  },\n  isFunction: function (f) {\n    return typeof f === \"function\";\n  },\n  toString: function (obj) {\n    var internals, key, value;\n    var hasProp = ({}).hasOwnProperty;\n    try {\n      recursionDepth++;\n      if (obj == null) {\n        return \"undefined\";\n      } else if (_.isFunction(obj)) {\n        return \"function\";\n      } else if (isArray(obj)) {\n        if (recursionDepth > 5) {\n          return \"[..]\";\n        }\n        return \"[\" + _.map(_.toString, obj).toString() + \"]\";\n      } else if ((obj != null ? obj.toString : void 0) != null && obj.toString !== Object.prototype.toString) {\n        return obj.toString();\n      } else if (typeof obj === \"object\") {\n        if (recursionDepth > 5) {\n          return \"{..}\";\n        }\n        internals = (function () {\n          var results = [];\n          for (key in obj) {\n            if (!hasProp.call(obj, key)) continue;\n            value = (function () {\n              var error;\n              try {\n                return obj[key];\n              } catch (error) {\n                return error;\n              }\n            })();\n            results.push(_.toString(key) + \":\" + _.toString(value));\n          }\n          return results;\n        })();\n        return \"{\" + internals + \"}\";\n      } else {\n        return obj;\n      }\n    } finally {\n      recursionDepth--;\n    }\n  }\n};\n\nvar recursionDepth = 0;\n\nBacon._ = _;\n\nvar UpdateBarrier = Bacon.UpdateBarrier = (function () {\n  var rootEvent;\n  var waiterObs = [];\n  var waiters = {};\n  var aftersStack = [];\n  var aftersStackHeight = 0;\n  var flushed = {};\n\n  function ensureStackHeight(h) {\n    if (h <= aftersStackHeight) return;\n    if (!aftersStack[h - 1]) {\n      aftersStack[h - 1] = [[], 0];\n    }\n    aftersStackHeight = h;\n  }\n\n  var afterTransaction = function (obs, f) {\n    if (rootEvent || aftersStack.length) {\n      ensureStackHeight(1);\n      var stackIndexForThisObs = 0;\n      while (stackIndexForThisObs < aftersStackHeight - 1) {\n        if (containsObs(obs, aftersStack[stackIndexForThisObs][0])) {\n          break;\n        }\n        stackIndexForThisObs++;\n      }\n      var listFromStack = aftersStack[stackIndexForThisObs][0];\n      listFromStack.push([obs, f]);\n      if (!rootEvent) {\n        processAfters();\n      }\n    } else {\n        return f();\n      }\n  };\n\n  function containsObs(obs, aftersList) {\n    for (var i = 0; i < aftersList.length; i++) {\n      if (aftersList[i][0].id == obs.id) return true;\n    }\n    return false;\n  }\n\n  function processAfters() {\n    var stackSizeAtStart = aftersStackHeight;\n    if (!stackSizeAtStart) return;\n    while (aftersStackHeight >= stackSizeAtStart) {\n      var topOfStack = aftersStack[aftersStackHeight - 1];\n      if (!topOfStack) throw new Error(\"Unexpected stack top: \" + topOfStack);\n      var topAfters = topOfStack[0];\n      var index = topOfStack[1];\n\n      if (index < topAfters.length) {\n        var _topAfters$index = topAfters[index];\n        var obs = _topAfters$index[0];\n        var after = _topAfters$index[1];\n\n        topOfStack[1]++;\n        ensureStackHeight(aftersStackHeight + 1);\n        var callSuccess = false;\n        try {\n          after();\n          callSuccess = true;\n          while (aftersStackHeight > stackSizeAtStart && aftersStack[aftersStackHeight - 1][0].length == 0) {\n            aftersStackHeight--;\n          }\n        } finally {\n          if (!callSuccess) {\n            aftersStack = [];\n            aftersStackHeight = 0;\n          }\n        }\n      } else {\n          topOfStack[0] = [];\n          topOfStack[1] = 0;\n          break;\n        }\n    }\n  }\n\n  var whenDoneWith = function (obs, f) {\n    if (rootEvent) {\n      var obsWaiters = waiters[obs.id];\n      if (!(typeof obsWaiters !== \"undefined\" && obsWaiters !== null)) {\n        obsWaiters = waiters[obs.id] = [f];\n        return waiterObs.push(obs);\n      } else {\n        return obsWaiters.push(f);\n      }\n    } else {\n      return f();\n    }\n  };\n\n  var flush = function () {\n    while (waiterObs.length > 0) {\n      flushWaiters(0, true);\n    }\n    flushed = {};\n  };\n\n  var flushWaiters = function (index, deps) {\n    var obs = waiterObs[index];\n    var obsId = obs.id;\n    var obsWaiters = waiters[obsId];\n    waiterObs.splice(index, 1);\n    delete waiters[obsId];\n    if (deps && waiterObs.length > 0) {\n      flushDepsOf(obs);\n    }\n    for (var i = 0, f; i < obsWaiters.length; i++) {\n      f = obsWaiters[i];\n      f();\n    }\n  };\n\n  var flushDepsOf = function (obs) {\n    if (flushed[obs.id]) return;\n    var deps = obs.internalDeps();\n    for (var i = 0, dep; i < deps.length; i++) {\n      dep = deps[i];\n      flushDepsOf(dep);\n      if (waiters[dep.id]) {\n        var index = _.indexOf(waiterObs, dep);\n        flushWaiters(index, false);\n      }\n    }\n    flushed[obs.id] = true;\n  };\n\n  var inTransaction = function (event, context, f, args) {\n    if (rootEvent) {\n      return f.apply(context, args);\n    } else {\n      rootEvent = event;\n      try {\n        var result = f.apply(context, args);\n\n        flush();\n      } finally {\n        rootEvent = undefined;\n        processAfters();\n      }\n      return result;\n    }\n  };\n\n  var currentEventId = function () {\n    return rootEvent ? rootEvent.id : undefined;\n  };\n\n  var wrappedSubscribe = function (obs, sink) {\n    var unsubd = false;\n    var shouldUnsub = false;\n    var doUnsub = function () {\n      shouldUnsub = true;\n      return shouldUnsub;\n    };\n    var unsub = function () {\n      unsubd = true;\n      return doUnsub();\n    };\n    doUnsub = obs.dispatcher.subscribe(function (event) {\n      return afterTransaction(obs, function () {\n        if (!unsubd) {\n          var reply = sink(event);\n          if (reply === Bacon.noMore) {\n            return unsub();\n          }\n        }\n      });\n    });\n    if (shouldUnsub) {\n      doUnsub();\n    }\n    return unsub;\n  };\n\n  var hasWaiters = function () {\n    return waiterObs.length > 0;\n  };\n\n  return { whenDoneWith: whenDoneWith, hasWaiters: hasWaiters, inTransaction: inTransaction, currentEventId: currentEventId, wrappedSubscribe: wrappedSubscribe, afterTransaction: afterTransaction };\n})();\n\nfunction Source(obs, sync) {\n  var lazy = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\n  this.obs = obs;\n  this.sync = sync;\n  this.lazy = lazy;\n  this.queue = [];\n}\n\nextend(Source.prototype, {\n  _isSource: true,\n\n  subscribe: function (sink) {\n    return this.obs.dispatcher.subscribe(sink);\n  },\n  toString: function () {\n    return this.obs.toString();\n  },\n  markEnded: function () {\n    this.ended = true;\n    return true;\n  },\n  consume: function () {\n    if (this.lazy) {\n      return { value: _.always(this.queue[0]) };\n    } else {\n      return this.queue[0];\n    }\n  },\n  push: function (x) {\n    this.queue = [x];\n    return [x];\n  },\n  mayHave: function () {\n    return true;\n  },\n  hasAtLeast: function () {\n    return this.queue.length;\n  },\n  flatten: true\n});\n\nfunction ConsumingSource() {\n  Source.apply(this, arguments);\n}\n\ninherit(ConsumingSource, Source);\nextend(ConsumingSource.prototype, {\n  consume: function () {\n    return this.queue.shift();\n  },\n  push: function (x) {\n    return this.queue.push(x);\n  },\n  mayHave: function (c) {\n    return !this.ended || this.queue.length >= c;\n  },\n  hasAtLeast: function (c) {\n    return this.queue.length >= c;\n  },\n  flatten: false\n});\n\nfunction BufferingSource(obs) {\n  Source.call(this, obs, true);\n}\n\ninherit(BufferingSource, Source);\nextend(BufferingSource.prototype, {\n  consume: function () {\n    var values = this.queue;\n    this.queue = [];\n    return {\n      value: function () {\n        return values;\n      }\n    };\n  },\n  push: function (x) {\n    return this.queue.push(x.value());\n  },\n  hasAtLeast: function () {\n    return true;\n  }\n});\n\nSource.isTrigger = function (s) {\n  if (s != null ? s._isSource : void 0) {\n    return s.sync;\n  } else {\n    return s != null ? s._isEventStream : void 0;\n  }\n};\n\nSource.fromObservable = function (s) {\n  if (s != null ? s._isSource : void 0) {\n    return s;\n  } else if (s != null ? s._isProperty : void 0) {\n    return new Source(s, false);\n  } else {\n    return new ConsumingSource(s, true);\n  }\n};\n\nfunction Desc(context, method, args) {\n  this.context = context;\n  this.method = method;\n  this.args = args;\n}\n\nextend(Desc.prototype, {\n  _isDesc: true,\n  deps: function () {\n    if (!this.cached) {\n      this.cached = findDeps([this.context].concat(this.args));\n    }\n    return this.cached;\n  },\n  toString: function () {\n    return _.toString(this.context) + \".\" + _.toString(this.method) + \"(\" + _.map(_.toString, this.args) + \")\";\n  }\n});\n\nvar describe = function (context, method) {\n  var ref = context || method;\n  if (ref && ref._isDesc) {\n    return context || method;\n  } else {\n    for (var _len = arguments.length, args = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      args[_key - 2] = arguments[_key];\n    }\n\n    return new Desc(context, method, args);\n  }\n};\n\nvar withDesc = function (desc, obs) {\n  obs.desc = desc;\n  return obs;\n};\n\nvar findDeps = function (x) {\n  if (isArray(x)) {\n    return _.flatMap(findDeps, x);\n  } else if (isObservable(x)) {\n    return [x];\n  } else if (typeof x !== \"undefined\" && x !== null ? x._isSource : undefined) {\n    return [x.obs];\n  } else {\n    return [];\n  }\n};\n\nBacon.Desc = Desc;\nBacon.Desc.empty = new Bacon.Desc(\"\", \"\", []);\n\nvar withMethodCallSupport = function (wrapped) {\n  return function (f) {\n    for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    if (typeof f === \"object\" && args.length) {\n      var context = f;\n      var methodName = args[0];\n      f = function () {\n        return context[methodName].apply(context, arguments);\n      };\n      args = args.slice(1);\n    }\n    return wrapped.apply(undefined, [f].concat(args));\n  };\n};\n\nvar makeFunctionArgs = function (args) {\n  args = Array.prototype.slice.call(args);\n  return makeFunction_.apply(undefined, args);\n};\n\nvar partiallyApplied = function (f, applied) {\n  return function () {\n    for (var _len3 = arguments.length, args = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    return f.apply(undefined, applied.concat(args));\n  };\n};\n\nvar toSimpleExtractor = function (args) {\n  return function (key) {\n    return function (value) {\n      if (!(typeof value !== \"undefined\" && value !== null)) {\n        return;\n      } else {\n        var fieldValue = value[key];\n        if (_.isFunction(fieldValue)) {\n          return fieldValue.apply(value, args);\n        } else {\n          return fieldValue;\n        }\n      }\n    };\n  };\n};\n\nvar toFieldExtractor = function (f, args) {\n  var parts = f.slice(1).split(\".\");\n  var partFuncs = _.map(toSimpleExtractor(args), parts);\n  return function (value) {\n    for (var i = 0, f; i < partFuncs.length; i++) {\n      f = partFuncs[i];\n      value = f(value);\n    }\n    return value;\n  };\n};\n\nvar isFieldKey = function (f) {\n  return typeof f === \"string\" && f.length > 1 && f.charAt(0) === \".\";\n};\n\nvar makeFunction_ = withMethodCallSupport(function (f) {\n  for (var _len4 = arguments.length, args = Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n    args[_key4 - 1] = arguments[_key4];\n  }\n\n  if (_.isFunction(f)) {\n    if (args.length) {\n      return partiallyApplied(f, args);\n    } else {\n      return f;\n    }\n  } else if (isFieldKey(f)) {\n    return toFieldExtractor(f, args);\n  } else {\n    return _.always(f);\n  }\n});\n\nvar makeFunction = function (f, args) {\n  return makeFunction_.apply(undefined, [f].concat(args));\n};\n\nvar convertArgsToFunction = function (obs, f, args, method) {\n  if (typeof f !== \"undefined\" && f !== null ? f._isProperty : undefined) {\n    var sampled = f.sampledBy(obs, function (p, s) {\n      return [p, s];\n    });\n    return method.call(sampled, function (_ref) {\n      var p = _ref[0];\n      var s = _ref[1];\n      return p;\n    }).map(function (_ref2) {\n      var p = _ref2[0];\n      var s = _ref2[1];\n      return s;\n    });\n  } else {\n    f = makeFunction(f, args);\n    return method.call(obs, f);\n  }\n};\n\nvar toCombinator = function (f) {\n  if (_.isFunction(f)) {\n    return f;\n  } else if (isFieldKey(f)) {\n    var key = toFieldKey(f);\n    return function (left, right) {\n      return left[key](right);\n    };\n  } else {\n    throw new Exception(\"not a function or a field key: \" + f);\n  }\n};\n\nvar toFieldKey = function (f) {\n  return f.slice(1);\n};\n\nfunction Some(value) {\n  this.value = value;\n}\n\nextend(Some.prototype, {\n  _isSome: true,\n  getOrElse: function () {\n    return this.value;\n  },\n  get: function () {\n    return this.value;\n  },\n  filter: function (f) {\n    if (f(this.value)) {\n      return new Some(this.value);\n    } else {\n      return None;\n    }\n  },\n  map: function (f) {\n    return new Some(f(this.value));\n  },\n  forEach: function (f) {\n    return f(this.value);\n  },\n  isDefined: true,\n  toArray: function () {\n    return [this.value];\n  },\n  inspect: function () {\n    return \"Some(\" + this.value + \")\";\n  },\n  toString: function () {\n    return this.inspect();\n  }\n});\n\nvar None = {\n  _isNone: true,\n  getOrElse: function (value) {\n    return value;\n  },\n  filter: function () {\n    return None;\n  },\n  map: function () {\n    return None;\n  },\n  forEach: function () {},\n  isDefined: false,\n  toArray: function () {\n    return [];\n  },\n  inspect: function () {\n    return \"None\";\n  },\n  toString: function () {\n    return this.inspect();\n  }\n};\n\nvar toOption = function (v) {\n  if ((typeof v !== \"undefined\" && v !== null ? v._isSome : undefined) || (typeof v !== \"undefined\" && v !== null ? v._isNone : undefined)) {\n    return v;\n  } else {\n    return new Some(v);\n  }\n};\n\nBacon.noMore = \"<no-more>\";\nBacon.more = \"<more>\";\n\nvar eventIdCounter = 0;\n\nfunction Event() {\n  this.id = ++eventIdCounter;\n}\n\nEvent.prototype._isEvent = true;\nEvent.prototype.isEvent = function () {\n  return true;\n};\nEvent.prototype.isEnd = function () {\n  return false;\n};\nEvent.prototype.isInitial = function () {\n  return false;\n};\nEvent.prototype.isNext = function () {\n  return false;\n};\nEvent.prototype.isError = function () {\n  return false;\n};\nEvent.prototype.hasValue = function () {\n  return false;\n};\nEvent.prototype.filter = function () {\n  return true;\n};\nEvent.prototype.inspect = function () {\n  return this.toString();\n};\nEvent.prototype.log = function () {\n  return this.toString();\n};\n\nfunction Next(valueF, eager) {\n  if (!(this instanceof Next)) {\n    return new Next(valueF, eager);\n  }\n\n  Event.call(this);\n\n  if (!eager && _.isFunction(valueF) || (valueF != null ? valueF._isNext : void 0)) {\n    this.valueF = valueF;\n    this.valueInternal = void 0;\n  } else {\n    this.valueF = void 0;\n    this.valueInternal = valueF;\n  }\n}\n\ninherit(Next, Event);\n\nNext.prototype.isNext = function () {\n  return true;\n};\nNext.prototype.hasValue = function () {\n  return true;\n};\nNext.prototype.value = function () {\n  var ref;\n  if ((ref = this.valueF) != null ? ref._isNext : void 0) {\n    this.valueInternal = this.valueF.value();\n    this.valueF = void 0;\n  } else if (this.valueF) {\n    this.valueInternal = this.valueF();\n    this.valueF = void 0;\n  }\n  return this.valueInternal;\n};\n\nNext.prototype.fmap = function (f) {\n  var event, value;\n  if (this.valueInternal) {\n    value = this.valueInternal;\n    return this.apply(function () {\n      return f(value);\n    });\n  } else {\n    event = this;\n    return this.apply(function () {\n      return f(event.value());\n    });\n  }\n};\n\nNext.prototype.apply = function (value) {\n  return new Next(value);\n};\nNext.prototype.filter = function (f) {\n  return f(this.value());\n};\nNext.prototype.toString = function () {\n  return _.toString(this.value());\n};\nNext.prototype.log = function () {\n  return this.value();\n};\nNext.prototype._isNext = true;\n\nfunction Initial(valueF, eager) {\n  if (!(this instanceof Initial)) {\n    return new Initial(valueF, eager);\n  }\n  Next.call(this, valueF, eager);\n}\n\ninherit(Initial, Next);\nInitial.prototype._isInitial = true;\nInitial.prototype.isInitial = function () {\n  return true;\n};\nInitial.prototype.isNext = function () {\n  return false;\n};\nInitial.prototype.apply = function (value) {\n  return new Initial(value);\n};\nInitial.prototype.toNext = function () {\n  return new Next(this);\n};\n\nfunction End() {\n  if (!(this instanceof End)) {\n    return new End();\n  }\n  Event.call(this);\n}\n\ninherit(End, Event);\nEnd.prototype.isEnd = function () {\n  return true;\n};\nEnd.prototype.fmap = function () {\n  return this;\n};\nEnd.prototype.apply = function () {\n  return this;\n};\nEnd.prototype.toString = function () {\n  return \"<end>\";\n};\n\nfunction Error(error) {\n  if (!(this instanceof Error)) {\n    return new Error(error);\n  }\n  this.error = error;\n  Event.call(this);\n}\n\ninherit(Error, Event);\nError.prototype.isError = function () {\n  return true;\n};\nError.prototype.fmap = function () {\n  return this;\n};\nError.prototype.apply = function () {\n  return this;\n};\nError.prototype.toString = function () {\n  return \"<error> \" + _.toString(this.error);\n};\n\nBacon.Event = Event;\nBacon.Initial = Initial;\nBacon.Next = Next;\nBacon.End = End;\nBacon.Error = Error;\n\nvar initialEvent = function (value) {\n  return new Initial(value, true);\n};\nvar nextEvent = function (value) {\n  return new Next(value, true);\n};\nvar endEvent = function () {\n  return new End();\n};\nvar toEvent = function (x) {\n  if (x && x._isEvent) {\n    return x;\n  } else {\n    return nextEvent(x);\n  }\n};\n\nvar idCounter = 0;\nvar registerObs = function () {};\n\nfunction Observable(desc) {\n  this.desc = desc;\n  this.id = ++idCounter;\n  this.initialDesc = this.desc;\n}\n\nextend(Observable.prototype, {\n  _isObservable: true,\n\n  subscribe: function (sink) {\n    return UpdateBarrier.wrappedSubscribe(this, sink);\n  },\n\n  subscribeInternal: function (sink) {\n    return this.dispatcher.subscribe(sink);\n  },\n\n  onValue: function () {\n    var f = makeFunctionArgs(arguments);\n    return this.subscribe(function (event) {\n      if (event.hasValue()) {\n        return f(event.value());\n      }\n    });\n  },\n\n  onValues: function (f) {\n    return this.onValue(function (args) {\n      return f.apply(undefined, args);\n    });\n  },\n\n  onError: function () {\n    var f = makeFunctionArgs(arguments);\n    return this.subscribe(function (event) {\n      if (event.isError()) {\n        return f(event.error);\n      }\n    });\n  },\n\n  onEnd: function () {\n    var f = makeFunctionArgs(arguments);\n    return this.subscribe(function (event) {\n      if (event.isEnd()) {\n        return f();\n      }\n    });\n  },\n\n  name: function (name) {\n    this._name = name;\n    return this;\n  },\n\n  withDescription: function () {\n    this.desc = describe.apply(undefined, arguments);\n    return this;\n  },\n\n  toString: function () {\n    if (this._name) {\n      return this._name;\n    } else {\n      return this.desc.toString();\n    }\n  },\n\n  deps: function () {\n    return this.desc.deps();\n  },\n\n  internalDeps: function () {\n    return this.initialDesc.deps();\n  }\n});\n\nObservable.prototype.assign = Observable.prototype.onValue;\nObservable.prototype.forEach = Observable.prototype.onValue;\nObservable.prototype.inspect = Observable.prototype.toString;\n\nBacon.Observable = Observable;\n\nfunction CompositeUnsubscribe() {\n  var ss = arguments.length <= 0 || arguments[0] === undefined ? [] : arguments[0];\n\n  this.unsubscribe = _.bind(this.unsubscribe, this);\n  this.unsubscribed = false;\n  this.subscriptions = [];\n  this.starting = [];\n  for (var i = 0, s; i < ss.length; i++) {\n    s = ss[i];\n    this.add(s);\n  }\n}\n\nextend(CompositeUnsubscribe.prototype, {\n  add: function (subscription) {\n    var _this2 = this;\n\n    if (this.unsubscribed) {\n      return;\n    }\n    var ended = false;\n    var unsub = nop;\n    this.starting.push(subscription);\n    var unsubMe = function () {\n      if (_this2.unsubscribed) {\n        return;\n      }\n      ended = true;\n      _this2.remove(unsub);\n      return _.remove(subscription, _this2.starting);\n    };\n    unsub = subscription(this.unsubscribe, unsubMe);\n    if (!(this.unsubscribed || ended)) {\n      this.subscriptions.push(unsub);\n    } else {\n      unsub();\n    }\n    _.remove(subscription, this.starting);\n    return unsub;\n  },\n\n  remove: function (unsub) {\n    if (this.unsubscribed) {\n      return;\n    }\n    if (_.remove(unsub, this.subscriptions) !== undefined) {\n      return unsub();\n    }\n  },\n\n  unsubscribe: function () {\n    if (this.unsubscribed) {\n      return;\n    }\n    this.unsubscribed = true;\n    var iterable = this.subscriptions;\n    for (var i = 0; i < iterable.length; i++) {\n      iterable[i]();\n    }\n    this.subscriptions = [];\n    this.starting = [];\n    return [];\n  },\n\n  count: function () {\n    if (this.unsubscribed) {\n      return 0;\n    }\n    return this.subscriptions.length + this.starting.length;\n  },\n\n  empty: function () {\n    return this.count() === 0;\n  }\n});\n\nBacon.CompositeUnsubscribe = CompositeUnsubscribe;\n\nfunction Dispatcher(_subscribe, _handleEvent) {\n  this._subscribe = _subscribe;\n  this._handleEvent = _handleEvent;\n  this.subscribe = _.bind(this.subscribe, this);\n  this.handleEvent = _.bind(this.handleEvent, this);\n  this.pushing = false;\n  this.ended = false;\n  this.prevError = undefined;\n  this.unsubSrc = undefined;\n  this.subscriptions = [];\n  this.queue = [];\n}\n\nDispatcher.prototype.hasSubscribers = function () {\n  return this.subscriptions.length > 0;\n};\n\nDispatcher.prototype.removeSub = function (subscription) {\n  this.subscriptions = _.without(subscription, this.subscriptions);\n  return this.subscriptions;\n};\n\nDispatcher.prototype.push = function (event) {\n  if (event.isEnd()) {\n    this.ended = true;\n  }\n  return UpdateBarrier.inTransaction(event, this, this.pushIt, [event]);\n};\n\nDispatcher.prototype.pushToSubscriptions = function (event) {\n  try {\n    var tmp = this.subscriptions;\n    var len = tmp.length;\n    for (var i = 0; i < len; i++) {\n      var sub = tmp[i];\n      var reply = sub.sink(event);\n      if (reply === Bacon.noMore || event.isEnd()) {\n        this.removeSub(sub);\n      }\n    }\n    return true;\n  } catch (error) {\n    this.pushing = false;\n    this.queue = [];\n    throw error;\n  }\n};\n\nDispatcher.prototype.pushIt = function (event) {\n  if (!this.pushing) {\n    if (event === this.prevError) {\n      return;\n    }\n    if (event.isError()) {\n      this.prevError = event;\n    }\n    this.pushing = true;\n    this.pushToSubscriptions(event);\n    this.pushing = false;\n    while (this.queue.length) {\n      event = this.queue.shift();\n      this.push(event);\n    }\n    if (this.hasSubscribers()) {\n      return Bacon.more;\n    } else {\n      this.unsubscribeFromSource();\n      return Bacon.noMore;\n    }\n  } else {\n    this.queue.push(event);\n    return Bacon.more;\n  }\n};\n\nDispatcher.prototype.handleEvent = function (event) {\n  if (this._handleEvent) {\n    return this._handleEvent(event);\n  } else {\n    return this.push(event);\n  }\n};\n\nDispatcher.prototype.unsubscribeFromSource = function () {\n  if (this.unsubSrc) {\n    this.unsubSrc();\n  }\n  this.unsubSrc = undefined;\n};\n\nDispatcher.prototype.subscribe = function (sink) {\n  var subscription;\n  if (this.ended) {\n    sink(endEvent());\n    return nop;\n  } else {\n    assertFunction(sink);\n    subscription = {\n      sink: sink\n    };\n    this.subscriptions.push(subscription);\n    if (this.subscriptions.length === 1) {\n      this.unsubSrc = this._subscribe(this.handleEvent);\n      assertFunction(this.unsubSrc);\n    }\n    return (function (_this) {\n      return function () {\n        _this.removeSub(subscription);\n        if (!_this.hasSubscribers()) {\n          return _this.unsubscribeFromSource();\n        }\n      };\n    })(this);\n  }\n};\n\nBacon.Dispatcher = Dispatcher;\n\nfunction EventStream(desc, subscribe, handler) {\n  if (!(this instanceof EventStream)) {\n    return new EventStream(desc, subscribe, handler);\n  }\n  if (_.isFunction(desc)) {\n    handler = subscribe;\n    subscribe = desc;\n    desc = Desc.empty;\n  }\n  Observable.call(this, desc);\n  assertFunction(subscribe);\n  this.dispatcher = new Dispatcher(subscribe, handler);\n  registerObs(this);\n}\n\ninherit(EventStream, Observable);\nextend(EventStream.prototype, {\n  _isEventStream: true,\n\n  toProperty: function (initValue_) {\n    var initValue = arguments.length === 0 ? None : toOption(function () {\n      return initValue_;\n    });\n    var disp = this.dispatcher;\n    var desc = new Bacon.Desc(this, \"toProperty\", [initValue_]);\n    return new Property(desc, function (sink) {\n      var initSent = false;\n      var subbed = false;\n      var unsub = nop;\n      var reply = Bacon.more;\n      var sendInit = function () {\n        if (!initSent) {\n          return initValue.forEach(function (value) {\n            initSent = true;\n            reply = sink(new Initial(value));\n            if (reply === Bacon.noMore) {\n              unsub();\n              unsub = nop;\n              return nop;\n            }\n          });\n        }\n      };\n\n      unsub = disp.subscribe(function (event) {\n        if (event.hasValue()) {\n          if (event.isInitial() && !subbed) {\n            initValue = new Some(function () {\n              return event.value();\n            });\n            return Bacon.more;\n          } else {\n            if (!event.isInitial()) {\n              sendInit();\n            }\n            initSent = true;\n            initValue = new Some(event);\n            return sink(event);\n          }\n        } else {\n          if (event.isEnd()) {\n            reply = sendInit();\n          }\n          if (reply !== Bacon.noMore) {\n            return sink(event);\n          }\n        }\n      });\n      subbed = true;\n      sendInit();\n      return unsub;\n    });\n  },\n\n  toEventStream: function () {\n    return this;\n  },\n\n  withHandler: function (handler) {\n    return new EventStream(new Bacon.Desc(this, \"withHandler\", [handler]), this.dispatcher.subscribe, handler);\n  }\n});\n\nBacon.EventStream = EventStream;\n\nBacon.never = function () {\n  return new EventStream(describe(Bacon, \"never\"), function (sink) {\n    sink(endEvent());\n    return nop;\n  });\n};\n\nBacon.when = function () {\n  if (arguments.length === 0) {\n    return Bacon.never();\n  }\n  var len = arguments.length;\n  var usage = \"when: expecting arguments in the form (Observable+,function)+\";\n\n  assert(usage, len % 2 === 0);\n  var sources = [];\n  var pats = [];\n  var i = 0;\n  var patterns = [];\n  while (i < len) {\n    patterns[i] = arguments[i];\n    patterns[i + 1] = arguments[i + 1];\n    var patSources = _.toArray(arguments[i]);\n    var f = constantToFunction(arguments[i + 1]);\n    var pat = { f: f, ixs: [] };\n    var triggerFound = false;\n    for (var j = 0, s; j < patSources.length; j++) {\n      s = patSources[j];\n      var index = _.indexOf(sources, s);\n      if (!triggerFound) {\n        triggerFound = Source.isTrigger(s);\n      }\n      if (index < 0) {\n        sources.push(s);\n        index = sources.length - 1;\n      }\n      for (var k = 0, ix; k < pat.ixs.length; k++) {\n        ix = pat.ixs[k];\n        if (ix.index === index) {\n          ix.count++;\n        }\n      }\n      pat.ixs.push({ index: index, count: 1 });\n    }\n\n    assert(\"At least one EventStream required\", triggerFound || !patSources.length);\n\n    if (patSources.length > 0) {\n      pats.push(pat);\n    }\n    i = i + 2;\n  }\n\n  if (!sources.length) {\n    return Bacon.never();\n  }\n\n  sources = _.map(Source.fromObservable, sources);\n  var needsBarrier = _.any(sources, function (s) {\n    return s.flatten;\n  }) && containsDuplicateDeps(_.map(function (s) {\n    return s.obs;\n  }, sources));\n\n  var desc = new Bacon.Desc(Bacon, \"when\", patterns);\n  var resultStream = new EventStream(desc, function (sink) {\n    var triggers = [];\n    var ends = false;\n    var match = function (p) {\n      for (var i1 = 0, i; i1 < p.ixs.length; i1++) {\n        i = p.ixs[i1];\n        if (!sources[i.index].hasAtLeast(i.count)) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var cannotSync = function (source) {\n      return !source.sync || source.ended;\n    };\n    var cannotMatch = function (p) {\n      for (var i1 = 0, i; i1 < p.ixs.length; i1++) {\n        i = p.ixs[i1];\n        if (!sources[i.index].mayHave(i.count)) {\n          return true;\n        }\n      }\n    };\n    var nonFlattened = function (trigger) {\n      return !trigger.source.flatten;\n    };\n    var part = function (source) {\n      return function (unsubAll) {\n        var flushLater = function () {\n          return UpdateBarrier.whenDoneWith(resultStream, flush);\n        };\n        var flushWhileTriggers = function () {\n          if (triggers.length > 0) {\n            var reply = Bacon.more;\n            var trigger = triggers.pop();\n            for (var i1 = 0, p; i1 < pats.length; i1++) {\n              p = pats[i1];\n              if (match(p)) {\n                var events = (function () {\n                  var result = [];\n                  for (var i2 = 0, i; i2 < p.ixs.length; i2++) {\n                    i = p.ixs[i2];\n                    result.push(sources[i.index].consume());\n                  }\n                  return result;\n                })();\n                reply = sink(trigger.e.apply(function () {\n                  var _p;\n\n                  var values = (function () {\n                    var result = [];\n                    for (var i2 = 0, event; i2 < events.length; i2++) {\n                      event = events[i2];\n                      result.push(event.value());\n                    }\n                    return result;\n                  })();\n\n                  return (_p = p).f.apply(_p, values);\n                }));\n                if (triggers.length) {\n                  triggers = _.filter(nonFlattened, triggers);\n                }\n                if (reply === Bacon.noMore) {\n                  return reply;\n                } else {\n                  return flushWhileTriggers();\n                }\n              }\n            }\n          } else {\n            return Bacon.more;\n          }\n        };\n        var flush = function () {\n          var reply = flushWhileTriggers();\n          if (ends) {\n            if (_.all(sources, cannotSync) || _.all(pats, cannotMatch)) {\n              reply = Bacon.noMore;\n              sink(endEvent());\n            }\n          }\n          if (reply === Bacon.noMore) {\n            unsubAll();\n          }\n\n          return reply;\n        };\n        return source.subscribe(function (e) {\n          if (e.isEnd()) {\n            ends = true;\n            source.markEnded();\n            flushLater();\n          } else if (e.isError()) {\n            var reply = sink(e);\n          } else {\n            source.push(e);\n            if (source.sync) {\n              triggers.push({ source: source, e: e });\n              if (needsBarrier || UpdateBarrier.hasWaiters()) {\n                flushLater();\n              } else {\n                flush();\n              }\n            }\n          }\n          if (reply === Bacon.noMore) {\n            unsubAll();\n          }\n          return reply || Bacon.more;\n        });\n      };\n    };\n\n    return new Bacon.CompositeUnsubscribe((function () {\n      var result = [];\n      for (var i1 = 0, s; i1 < sources.length; i1++) {\n        s = sources[i1];\n        result.push(part(s));\n      }\n      return result;\n    })()).unsubscribe;\n  });\n  return resultStream;\n};\n\nvar containsDuplicateDeps = function (observables) {\n  var state = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];\n\n  var checkObservable = function (obs) {\n    if (_.contains(state, obs)) {\n      return true;\n    } else {\n      var deps = obs.internalDeps();\n      if (deps.length) {\n        state.push(obs);\n        return _.any(deps, checkObservable);\n      } else {\n        state.push(obs);\n        return false;\n      }\n    }\n  };\n\n  return _.any(observables, checkObservable);\n};\n\nvar constantToFunction = function (f) {\n  if (_.isFunction(f)) {\n    return f;\n  } else {\n    return _.always(f);\n  }\n};\n\nBacon.groupSimultaneous = function () {\n  for (var _len5 = arguments.length, streams = Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n    streams[_key5] = arguments[_key5];\n  }\n\n  if (streams.length === 1 && isArray(streams[0])) {\n    streams = streams[0];\n  }\n  var sources = (function () {\n    var result = [];\n    for (var i = 0, s; i < streams.length; i++) {\n      s = streams[i];\n      result.push(new BufferingSource(s));\n    }\n    return result;\n  })();\n  return withDesc(new Bacon.Desc(Bacon, \"groupSimultaneous\", streams), Bacon.when(sources, function () {\n    for (var _len6 = arguments.length, xs = Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n      xs[_key6] = arguments[_key6];\n    }\n\n    return xs;\n  }));\n};\n\nfunction PropertyDispatcher(property, subscribe, handleEvent) {\n  Dispatcher.call(this, subscribe, handleEvent);\n  this.property = property;\n  this.subscribe = _.bind(this.subscribe, this);\n  this.current = None;\n  this.currentValueRootId = undefined;\n  this.propertyEnded = false;\n}\n\ninherit(PropertyDispatcher, Dispatcher);\nextend(PropertyDispatcher.prototype, {\n  push: function (event) {\n    if (event.isEnd()) {\n      this.propertyEnded = true;\n    }\n    if (event.hasValue()) {\n      this.current = new Some(event);\n      this.currentValueRootId = UpdateBarrier.currentEventId();\n    }\n    return Dispatcher.prototype.push.call(this, event);\n  },\n\n  maybeSubSource: function (sink, reply) {\n    if (reply === Bacon.noMore) {\n      return nop;\n    } else if (this.propertyEnded) {\n      sink(endEvent());\n      return nop;\n    } else {\n      return Dispatcher.prototype.subscribe.call(this, sink);\n    }\n  },\n\n  subscribe: function (sink) {\n    var _this3 = this;\n\n    var initSent = false;\n\n    var reply = Bacon.more;\n\n    if (this.current.isDefined && (this.hasSubscribers() || this.propertyEnded)) {\n      var dispatchingId = UpdateBarrier.currentEventId();\n      var valId = this.currentValueRootId;\n      if (!this.propertyEnded && valId && dispatchingId && dispatchingId !== valId) {\n        UpdateBarrier.whenDoneWith(this.property, function () {\n          if (_this3.currentValueRootId === valId) {\n            return sink(initialEvent(_this3.current.get().value()));\n          }\n        });\n\n        return this.maybeSubSource(sink, reply);\n      } else {\n        UpdateBarrier.inTransaction(undefined, this, function () {\n          reply = sink(initialEvent(this.current.get().value()));\n          return reply;\n        }, []);\n        return this.maybeSubSource(sink, reply);\n      }\n    } else {\n      return this.maybeSubSource(sink, reply);\n    }\n  }\n});\n\nfunction Property(desc, subscribe, handler) {\n  Observable.call(this, desc);\n  assertFunction(subscribe);\n  this.dispatcher = new PropertyDispatcher(this, subscribe, handler);\n  registerObs(this);\n}\n\ninherit(Property, Observable);\nextend(Property.prototype, {\n  _isProperty: true,\n\n  changes: function () {\n    var _this4 = this;\n\n    return new EventStream(new Bacon.Desc(this, \"changes\", []), function (sink) {\n      return _this4.dispatcher.subscribe(function (event) {\n        if (!event.isInitial()) {\n          return sink(event);\n        }\n      });\n    });\n  },\n\n  withHandler: function (handler) {\n    return new Property(new Bacon.Desc(this, \"withHandler\", [handler]), this.dispatcher.subscribe, handler);\n  },\n\n  toProperty: function () {\n    assertNoArguments(arguments);\n    return this;\n  },\n\n  toEventStream: function () {\n    var _this5 = this;\n\n    return new EventStream(new Bacon.Desc(this, \"toEventStream\", []), function (sink) {\n      return _this5.dispatcher.subscribe(function (event) {\n        if (event.isInitial()) {\n          event = event.toNext();\n        }\n        return sink(event);\n      });\n    });\n  }\n});\n\nBacon.Property = Property;\n\nBacon.constant = function (value) {\n  return new Property(new Bacon.Desc(Bacon, \"constant\", [value]), function (sink) {\n    sink(initialEvent(value));\n    sink(endEvent());\n    return nop;\n  });\n};\n\nBacon.fromBinder = function (binder) {\n  var eventTransformer = arguments.length <= 1 || arguments[1] === undefined ? _.id : arguments[1];\n\n  var desc = new Bacon.Desc(Bacon, \"fromBinder\", [binder, eventTransformer]);\n  return new EventStream(desc, function (sink) {\n    var unbound = false;\n    var shouldUnbind = false;\n    var unbind = function () {\n      if (!unbound) {\n        if (typeof unbinder !== \"undefined\" && unbinder !== null) {\n          unbinder();\n          return unbound = true;\n        } else {\n          return shouldUnbind = true;\n        }\n      }\n    };\n    var unbinder = binder(function () {\n      var ref;\n\n      for (var _len7 = arguments.length, args = Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {\n        args[_key7] = arguments[_key7];\n      }\n\n      var value = eventTransformer.apply(this, args);\n      if (!(isArray(value) && ((ref = _.last(value)) != null ? ref._isEvent : undefined))) {\n        value = [value];\n      }\n      var reply = Bacon.more;\n      for (var i = 0, event; i < value.length; i++) {\n        event = value[i];\n        reply = sink(event = toEvent(event));\n        if (reply === Bacon.noMore || event.isEnd()) {\n          unbind();\n          return reply;\n        }\n      }\n      return reply;\n    });\n    if (shouldUnbind) {\n      unbind();\n    }\n    return unbind;\n  });\n};\n\nBacon.Observable.prototype.map = function (p) {\n  for (var _len8 = arguments.length, args = Array(_len8 > 1 ? _len8 - 1 : 0), _key8 = 1; _key8 < _len8; _key8++) {\n    args[_key8 - 1] = arguments[_key8];\n  }\n\n  return convertArgsToFunction(this, p, args, function (f) {\n    return withDesc(new Bacon.Desc(this, \"map\", [f]), this.withHandler(function (event) {\n      return this.push(event.fmap(f));\n    }));\n  });\n};\n\nvar argumentsToObservables = function (args) {\n  if (isArray(args[0])) {\n    return args[0];\n  } else {\n    return Array.prototype.slice.call(args);\n  }\n};\n\nvar argumentsToObservablesAndFunction = function (args) {\n  if (_.isFunction(args[0])) {\n    return [argumentsToObservables(Array.prototype.slice.call(args, 1)), args[0]];\n  } else {\n    return [argumentsToObservables(Array.prototype.slice.call(args, 0, args.length - 1)), _.last(args)];\n  }\n};\n\nBacon.combineAsArray = function () {\n  var streams = argumentsToObservables(arguments);\n  if (streams.length) {\n    var sources = [];\n    for (var i = 0; i < streams.length; i++) {\n      var stream = isObservable(streams[i]) ? streams[i] : Bacon.constant(streams[i]);\n      sources.push(new Source(stream, true));\n    }\n    return withDesc(new Bacon.Desc(Bacon, \"combineAsArray\", streams), Bacon.when(sources, function () {\n      for (var _len9 = arguments.length, xs = Array(_len9), _key9 = 0; _key9 < _len9; _key9++) {\n        xs[_key9] = arguments[_key9];\n      }\n\n      return xs;\n    }).toProperty());\n  } else {\n    return Bacon.constant([]);\n  }\n};\n\nBacon.onValues = function () {\n  return Bacon.combineAsArray(Array.prototype.slice.call(arguments, 0, arguments.length - 1)).onValues(arguments[arguments.length - 1]);\n};\n\nBacon.combineWith = function () {\n  var _argumentsToObservablesAndFunction = argumentsToObservablesAndFunction(arguments);\n\n  var streams = _argumentsToObservablesAndFunction[0];\n  var f = _argumentsToObservablesAndFunction[1];\n\n  var desc = new Bacon.Desc(Bacon, \"combineWith\", [f].concat(streams));\n  return withDesc(desc, Bacon.combineAsArray(streams).map(function (values) {\n    return f.apply(undefined, values);\n  }));\n};\n\nBacon.Observable.prototype.combine = function (other, f) {\n  var combinator = toCombinator(f);\n  var desc = new Bacon.Desc(this, \"combine\", [other, f]);\n  return withDesc(desc, Bacon.combineAsArray(this, other).map(function (values) {\n    return combinator(values[0], values[1]);\n  }));\n};\n\nBacon.Observable.prototype.withStateMachine = function (initState, f) {\n  var state = initState;\n  var desc = new Bacon.Desc(this, \"withStateMachine\", [initState, f]);\n  return withDesc(desc, this.withHandler(function (event) {\n    var fromF = f(state, event);\n    var newState = fromF[0];\n    var outputs = fromF[1];\n\n    state = newState;\n    var reply = Bacon.more;\n    for (var i = 0, output; i < outputs.length; i++) {\n      output = outputs[i];\n      reply = this.push(output);\n      if (reply === Bacon.noMore) {\n        return reply;\n      }\n    }\n    return reply;\n  }));\n};\n\nvar equals = function (a, b) {\n  return a === b;\n};\n\nvar isNone = function (object) {\n  return typeof object !== \"undefined\" && object !== null ? object._isNone : false;\n};\n\nBacon.Observable.prototype.skipDuplicates = function () {\n  var isEqual = arguments.length <= 0 || arguments[0] === undefined ? equals : arguments[0];\n\n  var desc = new Bacon.Desc(this, \"skipDuplicates\", []);\n  return withDesc(desc, this.withStateMachine(None, function (prev, event) {\n    if (!event.hasValue()) {\n      return [prev, [event]];\n    } else if (event.isInitial() || isNone(prev) || !isEqual(prev.get(), event.value())) {\n      return [new Some(event.value()), [event]];\n    } else {\n      return [prev, []];\n    }\n  }));\n};\n\nBacon.Observable.prototype.awaiting = function (other) {\n  var desc = new Bacon.Desc(this, \"awaiting\", [other]);\n  return withDesc(desc, Bacon.groupSimultaneous(this, other).map(function (values) {\n    return values[1].length === 0;\n  }).toProperty(false).skipDuplicates());\n};\n\nBacon.Observable.prototype.not = function () {\n  return withDesc(new Bacon.Desc(this, \"not\", []), this.map(function (x) {\n    return !x;\n  }));\n};\n\nBacon.Property.prototype.and = function (other) {\n  return withDesc(new Bacon.Desc(this, \"and\", [other]), this.combine(other, function (x, y) {\n    return x && y;\n  }));\n};\n\nBacon.Property.prototype.or = function (other) {\n  return withDesc(new Bacon.Desc(this, \"or\", [other]), this.combine(other, function (x, y) {\n    return x || y;\n  }));\n};\n\nBacon.scheduler = {\n  setTimeout: function (f, d) {\n    return setTimeout(f, d);\n  },\n  setInterval: function (f, i) {\n    return setInterval(f, i);\n  },\n  clearInterval: function (id) {\n    return clearInterval(id);\n  },\n  clearTimeout: function (id) {\n    return clearTimeout(id);\n  },\n  now: function () {\n    return new Date().getTime();\n  }\n};\n\nBacon.EventStream.prototype.bufferWithTime = function (delay) {\n  return withDesc(new Bacon.Desc(this, \"bufferWithTime\", [delay]), this.bufferWithTimeOrCount(delay, Number.MAX_VALUE));\n};\n\nBacon.EventStream.prototype.bufferWithCount = function (count) {\n  return withDesc(new Bacon.Desc(this, \"bufferWithCount\", [count]), this.bufferWithTimeOrCount(undefined, count));\n};\n\nBacon.EventStream.prototype.bufferWithTimeOrCount = function (delay, count) {\n  var flushOrSchedule = function (buffer) {\n    if (buffer.values.length === count) {\n      return buffer.flush();\n    } else if (delay !== undefined) {\n      return buffer.schedule();\n    }\n  };\n  var desc = new Bacon.Desc(this, \"bufferWithTimeOrCount\", [delay, count]);\n  return withDesc(desc, this.buffer(delay, flushOrSchedule, flushOrSchedule));\n};\n\nBacon.EventStream.prototype.buffer = function (delay) {\n  var onInput = arguments.length <= 1 || arguments[1] === undefined ? nop : arguments[1];\n  var onFlush = arguments.length <= 2 || arguments[2] === undefined ? nop : arguments[2];\n\n  var buffer = {\n    scheduled: null,\n    end: undefined,\n    values: [],\n    flush: function () {\n      if (this.scheduled) {\n        Bacon.scheduler.clearTimeout(this.scheduled);\n        this.scheduled = null;\n      }\n      if (this.values.length > 0) {\n        var valuesToPush = this.values;\n        this.values = [];\n        var reply = this.push(nextEvent(valuesToPush));\n        if (this.end != null) {\n          return this.push(this.end);\n        } else if (reply !== Bacon.noMore) {\n          return onFlush(this);\n        }\n      } else {\n        if (this.end != null) {\n          return this.push(this.end);\n        }\n      }\n    },\n    schedule: function () {\n      var _this6 = this;\n\n      if (!this.scheduled) {\n        return this.scheduled = delay(function () {\n          return _this6.flush();\n        });\n      }\n    }\n  };\n  var reply = Bacon.more;\n  if (!_.isFunction(delay)) {\n    var delayMs = delay;\n    delay = function (f) {\n      return Bacon.scheduler.setTimeout(f, delayMs);\n    };\n  }\n  return withDesc(new Bacon.Desc(this, \"buffer\", []), this.withHandler(function (event) {\n    var _this7 = this;\n\n    buffer.push = function (event) {\n      return _this7.push(event);\n    };\n    if (event.isError()) {\n      reply = this.push(event);\n    } else if (event.isEnd()) {\n      buffer.end = event;\n      if (!buffer.scheduled) {\n        buffer.flush();\n      }\n    } else {\n      buffer.values.push(event.value());\n\n      onInput(buffer);\n    }\n    return reply;\n  }));\n};\n\nBacon.Observable.prototype.filter = function (f) {\n  assertObservableIsProperty(f);\n\n  for (var _len10 = arguments.length, args = Array(_len10 > 1 ? _len10 - 1 : 0), _key10 = 1; _key10 < _len10; _key10++) {\n    args[_key10 - 1] = arguments[_key10];\n  }\n\n  return convertArgsToFunction(this, f, args, function (f) {\n    return withDesc(new Bacon.Desc(this, \"filter\", [f]), this.withHandler(function (event) {\n      if (event.filter(f)) {\n        return this.push(event);\n      } else {\n        return Bacon.more;\n      }\n    }));\n  });\n};\n\nBacon.once = function (value) {\n  return new EventStream(new Desc(Bacon, \"once\", [value]), function (sink) {\n    sink(toEvent(value));\n    sink(endEvent());\n    return nop;\n  });\n};\n\nBacon.EventStream.prototype.concat = function (right) {\n  var left = this;\n  return new EventStream(new Bacon.Desc(left, \"concat\", [right]), function (sink) {\n    var unsubRight = nop;\n    var unsubLeft = left.dispatcher.subscribe(function (e) {\n      if (e.isEnd()) {\n        unsubRight = right.toEventStream().dispatcher.subscribe(sink);\n        return unsubRight;\n      } else {\n        return sink(e);\n      }\n    });\n    return function () {\n      return unsubLeft(), unsubRight();\n    };\n  });\n};\n\nBacon.Property.prototype.concat = function (right) {\n  return addPropertyInitValueToStream(this, this.changes().concat(right));\n};\n\nBacon.concatAll = function () {\n  var streams = argumentsToObservables(arguments);\n  if (streams.length) {\n    return withDesc(new Bacon.Desc(Bacon, \"concatAll\", streams), _.fold(_.tail(streams), _.head(streams).toEventStream(), function (a, b) {\n      return a.concat(b);\n    }));\n  } else {\n    return Bacon.never();\n  }\n};\n\nvar addPropertyInitValueToStream = function (property, stream) {\n  var justInitValue = new EventStream(describe(property, \"justInitValue\"), function (sink) {\n    var value = undefined;\n    var unsub = property.dispatcher.subscribe(function (event) {\n      if (!event.isEnd()) {\n        value = event;\n      }\n      return Bacon.noMore;\n    });\n    UpdateBarrier.whenDoneWith(justInitValue, function () {\n      if (typeof value !== \"undefined\" && value !== null) {\n        sink(value);\n      }\n      return sink(endEvent());\n    });\n    return unsub;\n  });\n  return justInitValue.concat(stream).toProperty();\n};\n\nBacon.Observable.prototype.flatMap = function () {\n  return flatMap_(this, makeSpawner(arguments));\n};\n\nBacon.Observable.prototype.flatMapFirst = function () {\n  return flatMap_(this, makeSpawner(arguments), true);\n};\n\nvar makeSpawner = function (args) {\n  if (args.length === 1 && isObservable(args[0])) {\n    return _.always(args[0]);\n  } else {\n    return makeFunctionArgs(args);\n  }\n};\n\nvar makeObservable = function (x) {\n  if (isObservable(x)) {\n    return x;\n  } else {\n    return Bacon.once(x);\n  }\n};\n\nvar flatMap_ = function (root, f, firstOnly, limit) {\n  var rootDep = [root];\n  var childDeps = [];\n  var desc = new Bacon.Desc(root, \"flatMap\" + (firstOnly ? \"First\" : \"\"), [f]);\n  var result = new EventStream(desc, function (sink) {\n    var composite = new CompositeUnsubscribe();\n    var queue = [];\n    var spawn = function (event) {\n      var child = makeObservable(f(event.value()));\n      childDeps.push(child);\n      return composite.add(function (unsubAll, unsubMe) {\n        return child.dispatcher.subscribe(function (event) {\n          if (event.isEnd()) {\n            _.remove(child, childDeps);\n            checkQueue();\n            checkEnd(unsubMe);\n            return Bacon.noMore;\n          } else {\n            if (typeof event !== \"undefined\" && event !== null ? event._isInitial : undefined) {\n              event = event.toNext();\n            }\n            var reply = sink(event);\n            if (reply === Bacon.noMore) {\n              unsubAll();\n            }\n            return reply;\n          }\n        });\n      });\n    };\n    var checkQueue = function () {\n      var event = queue.shift();\n      if (event) {\n        return spawn(event);\n      }\n    };\n    var checkEnd = function (unsub) {\n      unsub();\n      if (composite.empty()) {\n        return sink(endEvent());\n      }\n    };\n    composite.add(function (__, unsubRoot) {\n      return root.dispatcher.subscribe(function (event) {\n        if (event.isEnd()) {\n          return checkEnd(unsubRoot);\n        } else if (event.isError()) {\n          return sink(event);\n        } else if (firstOnly && composite.count() > 1) {\n          return Bacon.more;\n        } else {\n          if (composite.unsubscribed) {\n            return Bacon.noMore;\n          }\n          if (limit && composite.count() > limit) {\n            return queue.push(event);\n          } else {\n            return spawn(event);\n          }\n        }\n      });\n    });\n    return composite.unsubscribe;\n  });\n  result.internalDeps = function () {\n    if (childDeps.length) {\n      return rootDep.concat(childDeps);\n    } else {\n      return rootDep;\n    }\n  };\n  return result;\n};\n\nBacon.Observable.prototype.flatMapWithConcurrencyLimit = function (limit) {\n  for (var _len11 = arguments.length, args = Array(_len11 > 1 ? _len11 - 1 : 0), _key11 = 1; _key11 < _len11; _key11++) {\n    args[_key11 - 1] = arguments[_key11];\n  }\n\n  var desc = new Bacon.Desc(this, \"flatMapWithConcurrencyLimit\", [limit].concat(args));\n  return withDesc(desc, flatMap_(this, makeSpawner(args), false, limit));\n};\n\nBacon.Observable.prototype.flatMapConcat = function () {\n  var desc = new Bacon.Desc(this, \"flatMapConcat\", Array.prototype.slice.call(arguments, 0));\n  return withDesc(desc, this.flatMapWithConcurrencyLimit.apply(this, [1].concat(_slice.call(arguments))));\n};\n\nBacon.later = function (delay, value) {\n  return withDesc(new Bacon.Desc(Bacon, \"later\", [delay, value]), Bacon.fromBinder(function (sink) {\n    var sender = function () {\n      return sink([value, endEvent()]);\n    };\n    var id = Bacon.scheduler.setTimeout(sender, delay);\n    return function () {\n      return Bacon.scheduler.clearTimeout(id);\n    };\n  }));\n};\n\nBacon.Observable.prototype.bufferingThrottle = function (minimumInterval) {\n  var desc = new Bacon.Desc(this, \"bufferingThrottle\", [minimumInterval]);\n  return withDesc(desc, this.flatMapConcat(function (x) {\n    return Bacon.once(x).concat(Bacon.later(minimumInterval).filter(false));\n  }));\n};\n\nBacon.Property.prototype.bufferingThrottle = function () {\n  return Bacon.Observable.prototype.bufferingThrottle.apply(this, arguments).toProperty();\n};\n\nfunction Bus() {\n  if (!(this instanceof Bus)) {\n    return new Bus();\n  }\n\n  this.unsubAll = _.bind(this.unsubAll, this);\n  this.subscribeAll = _.bind(this.subscribeAll, this);\n  this.guardedSink = _.bind(this.guardedSink, this);\n\n  this.sink = undefined;\n  this.subscriptions = [];\n  this.ended = false;\n  EventStream.call(this, new Bacon.Desc(Bacon, \"Bus\", []), this.subscribeAll);\n}\n\ninherit(Bus, EventStream);\nextend(Bus.prototype, {\n  unsubAll: function () {\n    var iterable = this.subscriptions;\n    for (var i = 0, sub; i < iterable.length; i++) {\n      sub = iterable[i];\n      if (typeof sub.unsub === \"function\") {\n        sub.unsub();\n      }\n    }\n  },\n\n  subscribeAll: function (newSink) {\n    if (this.ended) {\n      newSink(endEvent());\n    } else {\n      this.sink = newSink;\n      var iterable = cloneArray(this.subscriptions);\n      for (var i = 0, subscription; i < iterable.length; i++) {\n        subscription = iterable[i];\n        this.subscribeInput(subscription);\n      }\n    }\n    return this.unsubAll;\n  },\n\n  guardedSink: function (input) {\n    var _this8 = this;\n\n    return function (event) {\n      if (event.isEnd()) {\n        _this8.unsubscribeInput(input);\n        return Bacon.noMore;\n      } else {\n        return _this8.sink(event);\n      }\n    };\n  },\n\n  subscribeInput: function (subscription) {\n    subscription.unsub = subscription.input.dispatcher.subscribe(this.guardedSink(subscription.input));\n    return subscription.unsub;\n  },\n\n  unsubscribeInput: function (input) {\n    var iterable = this.subscriptions;\n    for (var i = 0, sub; i < iterable.length; i++) {\n      sub = iterable[i];\n      if (sub.input === input) {\n        if (typeof sub.unsub === \"function\") {\n          sub.unsub();\n        }\n        this.subscriptions.splice(i, 1);\n        return;\n      }\n    }\n  },\n\n  plug: function (input) {\n    var _this9 = this;\n\n    assertObservable(input);\n    if (this.ended) {\n      return;\n    }\n    var sub = { input: input };\n    this.subscriptions.push(sub);\n    if (typeof this.sink !== \"undefined\") {\n      this.subscribeInput(sub);\n    }\n    return function () {\n      return _this9.unsubscribeInput(input);\n    };\n  },\n\n  end: function () {\n    this.ended = true;\n    this.unsubAll();\n    if (typeof this.sink === \"function\") {\n      return this.sink(endEvent());\n    }\n  },\n\n  push: function (value) {\n    if (!this.ended && typeof this.sink === \"function\") {\n      var rootPush = !this.pushing;\n      if (!rootPush) {\n        if (!this.pushQueue) this.pushQueue = [];\n        this.pushQueue.push(value);\n\n        return;\n      }\n      this.pushing = true;\n      try {\n        return this.sink(nextEvent(value));\n      } finally {\n        if (rootPush && this.pushQueue) {\n          var i = 0;\n          while (i < this.pushQueue.length) {\n            var value = this.pushQueue[i];\n            this.sink(nextEvent(value));\n            i++;\n          }\n          this.pushQueue = null;\n        }\n        this.pushing = false;\n      }\n    }\n  },\n\n  error: function (error) {\n    if (typeof this.sink === \"function\") {\n      return this.sink(new Error(error));\n    }\n  }\n});\n\nBacon.Bus = Bus;\n\nvar liftCallback = function (desc, wrapped) {\n  return withMethodCallSupport(function (f) {\n    var stream = partiallyApplied(wrapped, [function (values, callback) {\n      return f.apply(undefined, values.concat([callback]));\n    }]);\n\n    for (var _len12 = arguments.length, args = Array(_len12 > 1 ? _len12 - 1 : 0), _key12 = 1; _key12 < _len12; _key12++) {\n      args[_key12 - 1] = arguments[_key12];\n    }\n\n    return withDesc(new Bacon.Desc(Bacon, desc, [f].concat(args)), Bacon.combineAsArray(args).flatMap(stream));\n  });\n};\n\nBacon.fromCallback = liftCallback(\"fromCallback\", function (f) {\n  for (var _len13 = arguments.length, args = Array(_len13 > 1 ? _len13 - 1 : 0), _key13 = 1; _key13 < _len13; _key13++) {\n    args[_key13 - 1] = arguments[_key13];\n  }\n\n  return Bacon.fromBinder(function (handler) {\n    makeFunction(f, args)(handler);\n    return nop;\n  }, function (value) {\n    return [value, endEvent()];\n  });\n});\n\nBacon.fromNodeCallback = liftCallback(\"fromNodeCallback\", function (f) {\n  for (var _len14 = arguments.length, args = Array(_len14 > 1 ? _len14 - 1 : 0), _key14 = 1; _key14 < _len14; _key14++) {\n    args[_key14 - 1] = arguments[_key14];\n  }\n\n  return Bacon.fromBinder(function (handler) {\n    makeFunction(f, args)(handler);\n    return nop;\n  }, function (error, value) {\n    if (error) {\n      return [new Error(error), endEvent()];\n    }\n    return [value, endEvent()];\n  });\n});\n\nBacon.combineTemplate = function (template) {\n  function current(ctxStack) {\n    return ctxStack[ctxStack.length - 1];\n  }\n  function setValue(ctxStack, key, value) {\n    current(ctxStack)[key] = value;\n    return value;\n  }\n  function applyStreamValue(key, index) {\n    return function (ctxStack, values) {\n      setValue(ctxStack, key, values[index]);\n    };\n  }\n  function constantValue(key, value) {\n    return function (ctxStack) {\n      setValue(ctxStack, key, value);\n    };\n  }\n\n  function mkContext(template) {\n    return isArray(template) ? [] : {};\n  }\n\n  function pushContext(key, value) {\n    return function (ctxStack) {\n      var newContext = mkContext(value);\n      setValue(ctxStack, key, newContext);\n      ctxStack.push(newContext);\n    };\n  }\n\n  function containsObservables(value) {\n    if (isObservable(value)) {\n      return true;\n    } else if (value && (value.constructor == Object || value.constructor == Array)) {\n      for (var key in value) {\n        if (Object.prototype.hasOwnProperty.call(value, key)) {\n          var child = value[key];\n          if (containsObservables(child)) return true;\n        }\n      }\n    }\n  }\n\n  function compile(key, value) {\n    if (isObservable(value)) {\n      streams.push(value);\n      funcs.push(applyStreamValue(key, streams.length - 1));\n    } else if (containsObservables(value)) {\n      var popContext = function (ctxStack) {\n        ctxStack.pop();\n      };\n      funcs.push(pushContext(key, value));\n      compileTemplate(value);\n      funcs.push(popContext);\n    } else {\n      funcs.push(constantValue(key, value));\n    }\n  }\n\n  function combinator(values) {\n    var rootContext = mkContext(template);\n    var ctxStack = [rootContext];\n    for (var i = 0, f; i < funcs.length; i++) {\n      f = funcs[i];\n      f(ctxStack, values);\n    }\n    return rootContext;\n  }\n\n  function compileTemplate(template) {\n    _.each(template, compile);\n  }\n\n  var funcs = [];\n  var streams = [];\n\n  var resultProperty = containsObservables(template) ? (compileTemplate(template), Bacon.combineAsArray(streams).map(combinator)) : Bacon.constant(template);\n\n  return withDesc(new Bacon.Desc(Bacon, \"combineTemplate\", [template]), resultProperty);\n};\n\nBacon.Observable.prototype.mapEnd = function () {\n  var f = makeFunctionArgs(arguments);\n  return withDesc(new Bacon.Desc(this, \"mapEnd\", [f]), this.withHandler(function (event) {\n    if (event.isEnd()) {\n      this.push(nextEvent(f(event)));\n      this.push(endEvent());\n      return Bacon.noMore;\n    } else {\n      return this.push(event);\n    }\n  }));\n};\n\nBacon.Observable.prototype.skipErrors = function () {\n  return withDesc(new Bacon.Desc(this, \"skipErrors\", []), this.withHandler(function (event) {\n    if (event.isError()) {\n      return Bacon.more;\n    } else {\n      return this.push(event);\n    }\n  }));\n};\n\nBacon.EventStream.prototype.takeUntil = function (stopper) {\n  var endMarker = {};\n  return withDesc(new Bacon.Desc(this, \"takeUntil\", [stopper]), Bacon.groupSimultaneous(this.mapEnd(endMarker), stopper.skipErrors()).withHandler(function (event) {\n    if (!event.hasValue()) {\n      return this.push(event);\n    } else {\n      var _event$value = event.value();\n\n      var data = _event$value[0];\n      var stopper = _event$value[1];\n\n      if (stopper.length) {\n        return this.push(endEvent());\n      } else {\n        var reply = Bacon.more;\n        for (var i = 0, value; i < data.length; i++) {\n          value = data[i];\n          if (value === endMarker) {\n            reply = this.push(endEvent());\n          } else {\n            reply = this.push(nextEvent(value));\n          }\n        }\n        return reply;\n      }\n    }\n  }));\n};\n\nBacon.Property.prototype.takeUntil = function (stopper) {\n  var changes = this.changes().takeUntil(stopper);\n  return withDesc(new Bacon.Desc(this, \"takeUntil\", [stopper]), addPropertyInitValueToStream(this, changes));\n};\n\nBacon.Observable.prototype.flatMapLatest = function () {\n  var f = makeSpawner(arguments);\n  var stream = this.toEventStream();\n  return withDesc(new Bacon.Desc(this, \"flatMapLatest\", [f]), stream.flatMap(function (value) {\n    return makeObservable(f(value)).takeUntil(stream);\n  }));\n};\n\nBacon.Property.prototype.delayChanges = function (desc, f) {\n  return withDesc(desc, addPropertyInitValueToStream(this, f(this.changes())));\n};\n\nBacon.EventStream.prototype.delayChanges = function (desc, f) {\n  return withDesc(desc, f(this));\n};\n\nBacon.Observable.prototype.delay = function (delay) {\n  return this.delayChanges(new Bacon.Desc(this, \"delay\", [delay]), function (changes) {\n    return changes.flatMap(function (value) {\n      return Bacon.later(delay, value);\n    });\n  });\n};\n\nBacon.Observable.prototype.debounce = function (delay) {\n  return this.delayChanges(new Bacon.Desc(this, \"debounce\", [delay]), function (changes) {\n    return changes.flatMapLatest(function (value) {\n      return Bacon.later(delay, value);\n    });\n  });\n};\n\nBacon.Observable.prototype.debounceImmediate = function (delay) {\n  return this.delayChanges(new Bacon.Desc(this, \"debounceImmediate\", [delay]), function (changes) {\n    return changes.flatMapFirst(function (value) {\n      return Bacon.once(value).concat(Bacon.later(delay).filter(false));\n    });\n  });\n};\n\nBacon.Observable.prototype.decode = function (cases) {\n  return withDesc(new Bacon.Desc(this, \"decode\", [cases]), this.combine(Bacon.combineTemplate(cases), function (key, values) {\n    return values[key];\n  }));\n};\n\nBacon.Observable.prototype.scan = function (seed, f) {\n  var _this10 = this;\n\n  var resultProperty;\n  f = toCombinator(f);\n  var acc = toOption(seed);\n  var initHandled = false;\n  var subscribe = function (sink) {\n    var initSent = false;\n    var unsub = nop;\n    var reply = Bacon.more;\n    var sendInit = function () {\n      if (!initSent) {\n        return acc.forEach(function (value) {\n          initSent = initHandled = true;\n          reply = sink(new Initial(function () {\n            return value;\n          }));\n          if (reply === Bacon.noMore) {\n            unsub();\n            unsub = nop;\n            return unsub;\n          }\n        });\n      }\n    };\n    unsub = _this10.dispatcher.subscribe(function (event) {\n      if (event.hasValue()) {\n        if (initHandled && event.isInitial()) {\n          return Bacon.more;\n        } else {\n            if (!event.isInitial()) {\n              sendInit();\n            }\n            initSent = initHandled = true;\n            var prev = acc.getOrElse(undefined);\n            var next = f(prev, event.value());\n\n            acc = new Some(next);\n            return sink(event.apply(function () {\n              return next;\n            }));\n          }\n      } else {\n        if (event.isEnd()) {\n          reply = sendInit();\n        }\n        if (reply !== Bacon.noMore) {\n          return sink(event);\n        }\n      }\n    });\n    UpdateBarrier.whenDoneWith(resultProperty, sendInit);\n    return unsub;\n  };\n  resultProperty = new Property(new Bacon.Desc(this, \"scan\", [seed, f]), subscribe);\n  return resultProperty;\n};\n\nBacon.Observable.prototype.diff = function (start, f) {\n  f = toCombinator(f);\n  return withDesc(new Bacon.Desc(this, \"diff\", [start, f]), this.scan([start], function (prevTuple, next) {\n    return [next, f(prevTuple[0], next)];\n  }).filter(function (tuple) {\n    return tuple.length === 2;\n  }).map(function (tuple) {\n    return tuple[1];\n  }));\n};\n\nBacon.Observable.prototype.doAction = function () {\n  var f = makeFunctionArgs(arguments);\n  return withDesc(new Bacon.Desc(this, \"doAction\", [f]), this.withHandler(function (event) {\n    if (event.hasValue()) {\n      f(event.value());\n    }\n    return this.push(event);\n  }));\n};\n\nBacon.Observable.prototype.doEnd = function () {\n  var f = makeFunctionArgs(arguments);\n  return withDesc(new Bacon.Desc(this, \"doEnd\", [f]), this.withHandler(function (event) {\n    if (event.isEnd()) {\n      f();\n    }\n    return this.push(event);\n  }));\n};\n\nBacon.Observable.prototype.doError = function () {\n  var f = makeFunctionArgs(arguments);\n  return withDesc(new Bacon.Desc(this, \"doError\", [f]), this.withHandler(function (event) {\n    if (event.isError()) {\n      f(event.error);\n    }\n    return this.push(event);\n  }));\n};\n\nBacon.Observable.prototype.doLog = function () {\n  for (var _len15 = arguments.length, args = Array(_len15), _key15 = 0; _key15 < _len15; _key15++) {\n    args[_key15] = arguments[_key15];\n  }\n\n  return withDesc(new Bacon.Desc(this, \"doLog\", args), this.withHandler(function (event) {\n    if (typeof console !== \"undefined\" && console !== null && typeof console.log === \"function\") {\n      console.log.apply(console, args.concat([event.log()]));\n    }\n    return this.push(event);\n  }));\n};\n\nBacon.Observable.prototype.endOnError = function (f) {\n  if (!(typeof f !== \"undefined\" && f !== null)) {\n    f = true;\n  }\n\n  for (var _len16 = arguments.length, args = Array(_len16 > 1 ? _len16 - 1 : 0), _key16 = 1; _key16 < _len16; _key16++) {\n    args[_key16 - 1] = arguments[_key16];\n  }\n\n  return convertArgsToFunction(this, f, args, function (f) {\n    return withDesc(new Bacon.Desc(this, \"endOnError\", []), this.withHandler(function (event) {\n      if (event.isError() && f(event.error)) {\n        this.push(event);\n        return this.push(endEvent());\n      } else {\n        return this.push(event);\n      }\n    }));\n  });\n};\n\nObservable.prototype.errors = function () {\n  return withDesc(new Bacon.Desc(this, \"errors\", []), this.filter(function () {\n    return false;\n  }));\n};\n\nBacon.Observable.prototype.take = function (count) {\n  if (count <= 0) {\n    return Bacon.never();\n  }\n  return withDesc(new Bacon.Desc(this, \"take\", [count]), this.withHandler(function (event) {\n    if (!event.hasValue()) {\n      return this.push(event);\n    } else {\n      count--;\n      if (count > 0) {\n        return this.push(event);\n      } else {\n        if (count === 0) {\n          this.push(event);\n        }\n        this.push(endEvent());\n        return Bacon.noMore;\n      }\n    }\n  }));\n};\n\nBacon.Observable.prototype.first = function () {\n  return withDesc(new Bacon.Desc(this, \"first\", []), this.take(1));\n};\n\nBacon.Observable.prototype.mapError = function () {\n  var f = makeFunctionArgs(arguments);\n  return withDesc(new Bacon.Desc(this, \"mapError\", [f]), this.withHandler(function (event) {\n    if (event.isError()) {\n      return this.push(nextEvent(f(event.error)));\n    } else {\n      return this.push(event);\n    }\n  }));\n};\n\nBacon.Observable.prototype.flatMapError = function (fn) {\n  var desc = new Bacon.Desc(this, \"flatMapError\", [fn]);\n  return withDesc(desc, this.mapError(function (err) {\n    return new Error(err);\n  }).flatMap(function (x) {\n    if (x instanceof Error) {\n      return fn(x.error);\n    } else {\n      return Bacon.once(x);\n    }\n  }));\n};\n\nBacon.EventStream.prototype.flatScan = function (seed, f) {\n  var current = seed;\n  return this.flatMapConcat(function (next) {\n    return makeObservable(f(current, next)).doAction(function (updated) {\n      return current = updated;\n    });\n  }).toProperty(seed);\n};\n\nBacon.EventStream.prototype.sampledBy = function (sampler, combinator) {\n  return withDesc(new Bacon.Desc(this, \"sampledBy\", [sampler, combinator]), this.toProperty().sampledBy(sampler, combinator));\n};\n\nBacon.Property.prototype.sampledBy = function (sampler, combinator) {\n  var lazy = false;\n  if (typeof combinator !== \"undefined\" && combinator !== null) {\n    combinator = toCombinator(combinator);\n  } else {\n    lazy = true;\n    combinator = function (f) {\n      return f.value();\n    };\n  }\n  var thisSource = new Source(this, false, lazy);\n  var samplerSource = new Source(sampler, true, lazy);\n  var stream = Bacon.when([thisSource, samplerSource], combinator);\n  var result = sampler._isProperty ? stream.toProperty() : stream;\n  return withDesc(new Bacon.Desc(this, \"sampledBy\", [sampler, combinator]), result);\n};\n\nBacon.Property.prototype.sample = function (interval) {\n  return withDesc(new Bacon.Desc(this, \"sample\", [interval]), this.sampledBy(Bacon.interval(interval, {})));\n};\n\nBacon.Observable.prototype.map = function (p) {\n  if (p && p._isProperty) {\n    return p.sampledBy(this, former);\n  } else {\n    for (var _len17 = arguments.length, args = Array(_len17 > 1 ? _len17 - 1 : 0), _key17 = 1; _key17 < _len17; _key17++) {\n      args[_key17 - 1] = arguments[_key17];\n    }\n\n    return convertArgsToFunction(this, p, args, function (f) {\n      return withDesc(new Bacon.Desc(this, \"map\", [f]), this.withHandler(function (event) {\n        return this.push(event.fmap(f));\n      }));\n    });\n  }\n};\n\nBacon.Observable.prototype.fold = function (seed, f) {\n  return withDesc(new Bacon.Desc(this, \"fold\", [seed, f]), this.scan(seed, f).sampledBy(this.filter(false).mapEnd().toProperty()));\n};\n\nObservable.prototype.reduce = Observable.prototype.fold;\n\nvar eventMethods = [[\"addEventListener\", \"removeEventListener\"], [\"addListener\", \"removeListener\"], [\"on\", \"off\"], [\"bind\", \"unbind\"]];\n\nvar findHandlerMethods = function (target) {\n  var pair;\n  for (var i = 0; i < eventMethods.length; i++) {\n    pair = eventMethods[i];\n    var methodPair = [target[pair[0]], target[pair[1]]];\n    if (methodPair[0] && methodPair[1]) {\n      return methodPair;\n    }\n  }\n  for (var j = 0; j < eventMethods.length; j++) {\n    pair = eventMethods[j];\n    var addListener = target[pair[0]];\n    if (addListener) {\n      return [addListener, function () {}];\n    }\n  }\n  throw new Error(\"No suitable event methods in \" + target);\n};\n\nBacon.fromEventTarget = function (target, eventName, eventTransformer) {\n  var _findHandlerMethods = findHandlerMethods(target);\n\n  var sub = _findHandlerMethods[0];\n  var unsub = _findHandlerMethods[1];\n\n  var desc = new Bacon.Desc(Bacon, \"fromEvent\", [target, eventName]);\n  return withDesc(desc, Bacon.fromBinder(function (handler) {\n    sub.call(target, eventName, handler);\n    return function () {\n      return unsub.call(target, eventName, handler);\n    };\n  }, eventTransformer));\n};\n\nBacon.fromEvent = Bacon.fromEventTarget;\n\nBacon.fromPoll = function (delay, poll) {\n  var desc = new Bacon.Desc(Bacon, \"fromPoll\", [delay, poll]);\n  return withDesc(desc, Bacon.fromBinder(function (handler) {\n    var id = Bacon.scheduler.setInterval(handler, delay);\n    return function () {\n      return Bacon.scheduler.clearInterval(id);\n    };\n  }, poll));\n};\n\nfunction valueAndEnd(value) {\n  return [value, endEvent()];\n}\n\nBacon.fromPromise = function (promise, abort) {\n  var eventTransformer = arguments.length <= 2 || arguments[2] === undefined ? valueAndEnd : arguments[2];\n\n  return withDesc(new Bacon.Desc(Bacon, \"fromPromise\", [promise]), Bacon.fromBinder(function (handler) {\n    var bound = promise.then(handler, function (e) {\n      return handler(new Error(e));\n    });\n    if (bound && typeof bound.done === \"function\") {\n      bound.done();\n    }\n\n    if (abort) {\n      return function () {\n        if (typeof promise.abort === \"function\") {\n          return promise.abort();\n        }\n      };\n    } else {\n      return function () {};\n    }\n  }, eventTransformer));\n};\n\nBacon.Observable.prototype.groupBy = function (keyF) {\n  var limitF = arguments.length <= 1 || arguments[1] === undefined ? Bacon._.id : arguments[1];\n\n  var streams = {};\n  var src = this;\n  return src.filter(function (x) {\n    return !streams[keyF(x)];\n  }).map(function (x) {\n    var key = keyF(x);\n    var similar = src.filter(function (x) {\n      return keyF(x) === key;\n    });\n    var data = Bacon.once(x).concat(similar);\n    var limited = limitF(data, x).withHandler(function (event) {\n      this.push(event);\n      if (event.isEnd()) {\n        return delete streams[key];\n      }\n    });\n    streams[key] = limited;\n    return limited;\n  });\n};\n\nBacon.fromArray = function (values) {\n  assertArray(values);\n  if (!values.length) {\n    return withDesc(new Bacon.Desc(Bacon, \"fromArray\", values), Bacon.never());\n  } else {\n    var i = 0;\n    var stream = new EventStream(new Bacon.Desc(Bacon, \"fromArray\", [values]), function (sink) {\n      var unsubd = false;\n      var reply = Bacon.more;\n      var pushing = false;\n      var pushNeeded = false;\n      function push() {\n        pushNeeded = true;\n        if (pushing) {\n          return;\n        }\n        pushing = true;\n        while (pushNeeded) {\n          pushNeeded = false;\n          if (reply !== Bacon.noMore && !unsubd) {\n            var value = values[i++];\n            reply = sink(toEvent(value));\n            if (reply !== Bacon.noMore) {\n              if (i === values.length) {\n                sink(endEvent());\n              } else {\n                UpdateBarrier.afterTransaction(stream, push);\n              }\n            }\n          }\n        }\n        pushing = false;\n        return pushing;\n      };\n\n      push();\n      return function () {\n        unsubd = true;\n        return unsubd;\n      };\n    });\n    return stream;\n  }\n};\n\nBacon.EventStream.prototype.holdWhen = function (valve) {\n  var onHold = false;\n  var bufferedValues = [];\n  var src = this;\n  var srcIsEnded = false;\n  return new EventStream(new Bacon.Desc(this, \"holdWhen\", [valve]), function (sink) {\n    var composite = new CompositeUnsubscribe();\n    var subscribed = false;\n    var endIfBothEnded = function (unsub) {\n      if (typeof unsub === \"function\") {\n        unsub();\n      }\n      if (composite.empty() && subscribed) {\n        return sink(endEvent());\n      }\n    };\n    composite.add(function (unsubAll, unsubMe) {\n      return valve.subscribeInternal(function (event) {\n        if (event.hasValue()) {\n          onHold = event.value();\n          if (!onHold) {\n            var toSend = bufferedValues;\n            bufferedValues = [];\n            return (function () {\n              var result = [];\n              for (var i = 0, value; i < toSend.length; i++) {\n                value = toSend[i];\n                result.push(sink(nextEvent(value)));\n              }\n              if (srcIsEnded) {\n                result.push(sink(endEvent()));\n                unsubMe();\n              }\n              return result;\n            })();\n          }\n        } else if (event.isEnd()) {\n          return endIfBothEnded(unsubMe);\n        } else {\n          return sink(event);\n        }\n      });\n    });\n    composite.add(function (unsubAll, unsubMe) {\n      return src.subscribeInternal(function (event) {\n        if (onHold && event.hasValue()) {\n          return bufferedValues.push(event.value());\n        } else if (event.isEnd() && bufferedValues.length) {\n          srcIsEnded = true;\n          return endIfBothEnded(unsubMe);\n        } else {\n          return sink(event);\n        }\n      });\n    });\n    subscribed = true;\n    endIfBothEnded();\n    return composite.unsubscribe;\n  });\n};\n\nBacon.interval = function (delay) {\n  var value = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n  return withDesc(new Bacon.Desc(Bacon, \"interval\", [delay, value]), Bacon.fromPoll(delay, function () {\n    return nextEvent(value);\n  }));\n};\n\nBacon.$ = {};\nBacon.$.asEventStream = function (eventName, selector, eventTransformer) {\n  var _this11 = this;\n\n  if (_.isFunction(selector)) {\n    eventTransformer = selector;\n    selector = undefined;\n  }\n\n  return withDesc(new Bacon.Desc(this.selector || this, \"asEventStream\", [eventName]), Bacon.fromBinder(function (handler) {\n    _this11.on(eventName, selector, handler);\n    return function () {\n      return _this11.off(eventName, selector, handler);\n    };\n  }, eventTransformer));\n};\n\nif (typeof jQuery !== \"undefined\" && jQuery) {\n  jQuery.fn.asEventStream = Bacon.$.asEventStream;\n}\n\nif (typeof Zepto !== \"undefined\" && Zepto) {\n  Zepto.fn.asEventStream = Bacon.$.asEventStream;\n}\n\nBacon.Observable.prototype.last = function () {\n  var lastEvent;\n\n  return withDesc(new Bacon.Desc(this, \"last\", []), this.withHandler(function (event) {\n    if (event.isEnd()) {\n      if (lastEvent) {\n        this.push(lastEvent);\n      }\n      this.push(endEvent());\n      return Bacon.noMore;\n    } else {\n      lastEvent = event;\n    }\n  }));\n};\n\nBacon.Observable.prototype.log = function () {\n  for (var _len18 = arguments.length, args = Array(_len18), _key18 = 0; _key18 < _len18; _key18++) {\n    args[_key18] = arguments[_key18];\n  }\n\n  this.subscribe(function (event) {\n    if (typeof console !== \"undefined\" && typeof console.log === \"function\") {\n      console.log.apply(console, args.concat([event.log()]));\n    }\n  });\n  return this;\n};\n\nBacon.EventStream.prototype.merge = function (right) {\n  assertEventStream(right);\n  var left = this;\n  return withDesc(new Bacon.Desc(left, \"merge\", [right]), Bacon.mergeAll(this, right));\n};\n\nBacon.mergeAll = function () {\n  var streams = argumentsToObservables(arguments);\n  if (streams.length) {\n    return new EventStream(new Bacon.Desc(Bacon, \"mergeAll\", streams), function (sink) {\n      var ends = 0;\n      var smartSink = function (obs) {\n        return function (unsubBoth) {\n          return obs.dispatcher.subscribe(function (event) {\n            if (event.isEnd()) {\n              ends++;\n              if (ends === streams.length) {\n                return sink(endEvent());\n              } else {\n                return Bacon.more;\n              }\n            } else {\n              var reply = sink(event);\n              if (reply === Bacon.noMore) {\n                unsubBoth();\n              }\n              return reply;\n            }\n          });\n        };\n      };\n      var sinks = _.map(smartSink, streams);\n      return new Bacon.CompositeUnsubscribe(sinks).unsubscribe;\n    });\n  } else {\n    return Bacon.never();\n  }\n};\n\nBacon.repeatedly = function (delay, values) {\n  var index = 0;\n  return withDesc(new Bacon.Desc(Bacon, \"repeatedly\", [delay, values]), Bacon.fromPoll(delay, function () {\n    return values[index++ % values.length];\n  }));\n};\n\nBacon.repeat = function (generator) {\n  var index = 0;\n  return Bacon.fromBinder(function (sink) {\n    var flag = false;\n    var reply = Bacon.more;\n    var unsub = function () {};\n    function handleEvent(event) {\n      if (event.isEnd()) {\n        if (!flag) {\n          return flag = true;\n        } else {\n          return subscribeNext();\n        }\n      } else {\n        return reply = sink(event);\n      }\n    };\n    function subscribeNext() {\n      var next;\n      flag = true;\n      while (flag && reply !== Bacon.noMore) {\n        next = generator(index++);\n        flag = false;\n        if (next) {\n          unsub = next.subscribeInternal(handleEvent);\n        } else {\n          sink(endEvent());\n        }\n      }\n      return flag = true;\n    };\n    subscribeNext();\n    return function () {\n      return unsub();\n    };\n  });\n};\n\nBacon.retry = function (options) {\n  if (!_.isFunction(options.source)) {\n    throw new Exception(\"'source' option has to be a function\");\n  }\n  var source = options.source;\n  var retries = options.retries || 0;\n  var retriesDone = 0;\n  var delay = options.delay || function () {\n    return 0;\n  };\n  var isRetryable = options.isRetryable || function () {\n    return true;\n  };\n  var finished = false;\n  var error = null;\n\n  return withDesc(new Bacon.Desc(Bacon, \"retry\", [options]), Bacon.repeat(function (count) {\n    function valueStream() {\n      return source(count).endOnError().withHandler(function (event) {\n        if (event.isError()) {\n          error = event;\n          if (!(isRetryable(error.error) && (retries === 0 || retriesDone < retries))) {\n            finished = true;\n            return this.push(event);\n          }\n        } else {\n          if (event.hasValue()) {\n            error = null;\n            finished = true;\n          }\n          return this.push(event);\n        }\n      });\n    }\n\n    if (finished) {\n      return null;\n    } else if (error) {\n      var context = {\n        error: error.error,\n        retriesDone: retriesDone\n      };\n      var pause = Bacon.later(delay(context)).filter(false);\n      retriesDone++;\n      return pause.concat(Bacon.once().flatMap(valueStream));\n    } else {\n      return valueStream();\n    }\n  }));\n};\n\nBacon.sequentially = function (delay, values) {\n  var index = 0;\n  return withDesc(new Bacon.Desc(Bacon, \"sequentially\", [delay, values]), Bacon.fromPoll(delay, function () {\n    var value = values[index++];\n    if (index < values.length) {\n      return value;\n    } else if (index === values.length) {\n      return [value, endEvent()];\n    } else {\n      return endEvent();\n    }\n  }));\n};\n\nBacon.Observable.prototype.skip = function (count) {\n  return withDesc(new Bacon.Desc(this, \"skip\", [count]), this.withHandler(function (event) {\n    if (!event.hasValue()) {\n      return this.push(event);\n    } else if (count > 0) {\n      count--;\n      return Bacon.more;\n    } else {\n      return this.push(event);\n    }\n  }));\n};\n\nBacon.EventStream.prototype.skipUntil = function (starter) {\n  var started = starter.take(1).map(true).toProperty(false);\n  return withDesc(new Bacon.Desc(this, \"skipUntil\", [starter]), this.filter(started));\n};\n\nBacon.EventStream.prototype.skipWhile = function (f) {\n  assertObservableIsProperty(f);\n  var ok = false;\n\n  for (var _len19 = arguments.length, args = Array(_len19 > 1 ? _len19 - 1 : 0), _key19 = 1; _key19 < _len19; _key19++) {\n    args[_key19 - 1] = arguments[_key19];\n  }\n\n  return convertArgsToFunction(this, f, args, function (f) {\n    return withDesc(new Bacon.Desc(this, \"skipWhile\", [f]), this.withHandler(function (event) {\n      if (ok || !event.hasValue() || !f(event.value())) {\n        if (event.hasValue()) {\n          ok = true;\n        }\n        return this.push(event);\n      } else {\n        return Bacon.more;\n      }\n    }));\n  });\n};\n\nBacon.Observable.prototype.slidingWindow = function (n) {\n  var minValues = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n\n  return withDesc(new Bacon.Desc(this, \"slidingWindow\", [n, minValues]), this.scan([], function (window, value) {\n    return window.concat([value]).slice(-n);\n  }).filter(function (values) {\n    return values.length >= minValues;\n  }));\n};\n\nvar spies = [];\nvar registerObs = function (obs) {\n  if (spies.length) {\n    if (!registerObs.running) {\n      try {\n        registerObs.running = true;\n        spies.forEach(function (spy) {\n          spy(obs);\n        });\n      } finally {\n        delete registerObs.running;\n      }\n    }\n  }\n};\n\nBacon.spy = function (spy) {\n  return spies.push(spy);\n};\n\nBacon.Property.prototype.startWith = function (seed) {\n  return withDesc(new Bacon.Desc(this, \"startWith\", [seed]), this.scan(seed, function (prev, next) {\n    return next;\n  }));\n};\n\nBacon.EventStream.prototype.startWith = function (seed) {\n  return withDesc(new Bacon.Desc(this, \"startWith\", [seed]), Bacon.once(seed).concat(this));\n};\n\nBacon.Observable.prototype.takeWhile = function (f) {\n  assertObservableIsProperty(f);\n\n  for (var _len20 = arguments.length, args = Array(_len20 > 1 ? _len20 - 1 : 0), _key20 = 1; _key20 < _len20; _key20++) {\n    args[_key20 - 1] = arguments[_key20];\n  }\n\n  return convertArgsToFunction(this, f, args, function (f) {\n    return withDesc(new Bacon.Desc(this, \"takeWhile\", [f]), this.withHandler(function (event) {\n      if (event.filter(f)) {\n        return this.push(event);\n      } else {\n        this.push(endEvent());\n        return Bacon.noMore;\n      }\n    }));\n  });\n};\n\nBacon.Observable.prototype.throttle = function (delay) {\n  return this.delayChanges(new Bacon.Desc(this, \"throttle\", [delay]), function (changes) {\n    return changes.bufferWithTime(delay).map(function (values) {\n      return values[values.length - 1];\n    });\n  });\n};\n\nObservable.prototype.firstToPromise = function (PromiseCtr) {\n  var _this12 = this;\n\n  if (typeof PromiseCtr !== \"function\") {\n    if (typeof Promise === \"function\") {\n      PromiseCtr = Promise;\n    } else {\n      throw new Exception(\"There isn't default Promise, use shim or parameter\");\n    }\n  }\n\n  return new PromiseCtr(function (resolve, reject) {\n    return _this12.subscribe(function (event) {\n      if (event.hasValue()) {\n        resolve(event.value());\n      }\n      if (event.isError()) {\n        reject(event.error);\n      }\n\n      return Bacon.noMore;\n    });\n  });\n};\n\nObservable.prototype.toPromise = function (PromiseCtr) {\n  return this.last().firstToPromise(PromiseCtr);\n};\n\nBacon[\"try\"] = function (f) {\n  return function (value) {\n    try {\n      return Bacon.once(f(value));\n    } catch (e) {\n      return new Bacon.Error(e);\n    }\n  };\n};\n\nBacon.update = function (initial) {\n  function lateBindFirst(f) {\n    return function () {\n      for (var _len22 = arguments.length, args = Array(_len22), _key22 = 0; _key22 < _len22; _key22++) {\n        args[_key22] = arguments[_key22];\n      }\n\n      return function (i) {\n        return f.apply(undefined, [i].concat(args));\n      };\n    };\n  }\n\n  for (var _len21 = arguments.length, patterns = Array(_len21 > 1 ? _len21 - 1 : 0), _key21 = 1; _key21 < _len21; _key21++) {\n    patterns[_key21 - 1] = arguments[_key21];\n  }\n\n  var i = patterns.length - 1;\n  while (i > 0) {\n    if (!(patterns[i] instanceof Function)) {\n      patterns[i] = _.always(patterns[i]);\n    }\n    patterns[i] = lateBindFirst(patterns[i]);\n    i = i - 2;\n  }\n  return withDesc(new Bacon.Desc(Bacon, \"update\", [initial].concat(patterns)), Bacon.when.apply(Bacon, patterns).scan(initial, function (x, f) {\n    return f(x);\n  }));\n};\n\nBacon.zipAsArray = function () {\n  for (var _len23 = arguments.length, args = Array(_len23), _key23 = 0; _key23 < _len23; _key23++) {\n    args[_key23] = arguments[_key23];\n  }\n\n  var streams = argumentsToObservables(args);\n  return withDesc(new Bacon.Desc(Bacon, \"zipAsArray\", streams), Bacon.zipWith(streams, function () {\n    for (var _len24 = arguments.length, xs = Array(_len24), _key24 = 0; _key24 < _len24; _key24++) {\n      xs[_key24] = arguments[_key24];\n    }\n\n    return xs;\n  }));\n};\n\nBacon.zipWith = function () {\n  for (var _len25 = arguments.length, args = Array(_len25), _key25 = 0; _key25 < _len25; _key25++) {\n    args[_key25] = arguments[_key25];\n  }\n\n  var observablesAndFunction = argumentsToObservablesAndFunction(args);\n  var streams = observablesAndFunction[0];\n  var f = observablesAndFunction[1];\n\n  streams = _.map(function (s) {\n    return s.toEventStream();\n  }, streams);\n  return withDesc(new Bacon.Desc(Bacon, \"zipWith\", [f].concat(streams)), Bacon.when(streams, f));\n};\n\nBacon.Observable.prototype.zip = function (other, f) {\n  return withDesc(new Bacon.Desc(this, \"zip\", [other]), Bacon.zipWith([this, other], f || Array));\n};\n\nfunction ESObservable(observable) {\n  this.observable = observable;\n}\n\nESObservable.prototype.subscribe = function (observerOrOnNext, onError, onComplete) {\n  var observer = typeof observerOrOnNext === 'function' ? { next: observerOrOnNext, error: onError, complete: onComplete } : observerOrOnNext;\n  var subscription = {\n    closed: false,\n    unsubscribe: function () {\n      subscription.closed = true;\n      cancel();\n    }\n  };\n\n  var cancel = this.observable.subscribe(function (event) {\n    if (event.isError()) {\n      if (observer.error) observer.error(event.error);\n      subscription.unsubscribe();\n    } else if (event.isEnd()) {\n      subscription.closed = true;\n      if (observer.complete) observer.complete();\n    } else if (observer.next) {\n      observer.next(event.value());\n    }\n  });\n  return subscription;\n};\n\nESObservable.prototype[symbol('observable')] = function () {\n  return this;\n};\n\nBacon.Observable.prototype.toESObservable = function () {\n  return new ESObservable(this);\n};\n\nBacon.Observable.prototype[symbol('observable')] = Bacon.Observable.prototype.toESObservable;\n\nBacon.fromESObservable = function (_observable) {\n  var observable;\n  if (_observable[symbol(\"observable\")]) {\n    observable = _observable[symbol(\"observable\")]();\n  } else {\n    observable = _observable;\n  }\n\n  var desc = new Bacon.Desc(Bacon, \"fromESObservable\", [observable]);\n  return new Bacon.EventStream(desc, function (sink) {\n    var cancel = observable.subscribe({\n      error: function () {\n        sink(new Bacon.Error());\n        sink(new Bacon.End());\n      },\n      next: function (value) {\n        sink(new Bacon.Next(value, true));\n      },\n      complete: function () {\n        sink(new Bacon.End());\n      }\n    });\n\n    if (cancel.unsubscribe) {\n      return function () {\n        cancel.unsubscribe();\n      };\n    } else {\n      return cancel;\n    }\n  });\n};\n\nif (typeof define !== \"undefined\" && define !== null && define.amd != null) {\n  define([], function () {\n    return Bacon;\n  });\n  if (typeof this !== \"undefined\" && this !== null) {\n    this.Bacon = Bacon;\n  }\n} else if (typeof module !== \"undefined\" && module !== null && module.exports != null) {\n  module.exports = Bacon;\n  Bacon.Bacon = Bacon;\n} else {\n    this.Bacon = Bacon;\n  }\n}).call(this);\n"],"sourceRoot":""}