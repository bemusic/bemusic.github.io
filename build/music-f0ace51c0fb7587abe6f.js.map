{"version":3,"sources":["file:///home/circleci/bemuse/src/utils/main-element.js","file:///home/circleci/bemuse/src/music-collection-viewer/MusicTable.js","file:///home/circleci/bemuse/src/music-collection-viewer/CollectionViewer.jsx","file:///home/circleci/bemuse/src/music-collection-viewer/index.js","file:///home/circleci/bemuse/src/music-collection/isChartPlayable.js","file:///home/circleci/bemuse/src/music-collection/getPlayableCharts.js","file:///home/circleci/bemuse/src/music-collection/index.js","file:///home/circleci/bemuse/src/music-collection/groupSongsIntoCategories.js","file:///home/circleci/bemuse/src/music-collection/preprocessCollection.js","file:///home/circleci/bemuse/src/music-collection/sortSongs.js","file:///home/circleci/bemuse/src/music-previewer/index.js","file:///home/circleci/bemuse/src/music-previewer/default.ogg","file:///home/circleci/bemuse/src/music-previewer/go.ogg","file:///home/circleci/bemuse/src/music-previewer/MusicSelectPreviewer.jsx","file:///home/circleci/bemuse/src/music-collection/getPreviewUrl.js"],"names":["__webpack_exports__","document","querySelector","sorters","ingame","songs","Object","groupSongsIntoCategories","sortSongs","added","title","lodash_default","a","reverse","sortBy","getAdded","song","initial","renderSongWarnings","problems","report","message","keys","push","unreleased","readme","replaygain","artist_url","song_url","youtube_url","long_url","bms_url","exclusive","bmssearch_id","charts","filter","chart","length","getPlayableCharts","info","subtitles","file","validateSong","react_default","createElement","map","problem","index","key","style","fontFamily","marginRight","padding","fontSize","background","MusicTable_MusicTable","Component","[object Object]","props","super","this","state","sort","initialSort","previewUrl","previewEnabled","borderSpacing","colSpan","renderSorter","renderPreview","renderRows","out","onClick","setState","button","s","MusicSelectPreviewer","url","categories","data","category","id","prompt","color","textAlign","getPreviewUrl","genre","console","log","alert","__webpack_require__","inspect","artist","text","renderMessage","renderTable","e","propTypes","prop_types_default","object","string","music_collection_viewer_MusicTable","music_collection_viewer_CollectionViewer","query","server","music_collection","status","then","result","catch","preprocessCollection","main","music_previewer","react_dom","main_element","d","lodash__WEBPACK_IMPORTED_MODULE_0__","lodash__WEBPACK_IMPORTED_MODULE_0___default","n","_isChartPlayable__WEBPACK_IMPORTED_MODULE_1__","orderBy","difficulty","level","value","global","OFFICIAL_SERVER_URL","load","fetch","response","json","grouping","criteria","custom","tutorial","Date","now","parse","groups","group","input","output","updeep__WEBPACK_IMPORTED_MODULE_0__","updeep__WEBPACK_IMPORTED_MODULE_0___default","chart_names","name","min","bpm","toLowerCase","preload","enable","disable","go","preview","instance","getInstance","enabled","currentUrl","backgroundLoaded","backgroundPlayed","instances","Audio","loop","oncanplaythrough","update","goSound","src","volume","backgroundFader","createFader","target","pause","fadeTo","destroy","playing","loaded","play","stop","warn","currentTime","songUrl","audio","played","fader","onended","createInstance","createMusicPreviewer","initialVolume","onTargetReached","volumeChanged","targetVolume","currentSpeed","requested","elapsed","getCurrentVolume","Math","max","currentVolume","requestAnimationFrame","speed","module","exports","p","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","___WEBPACK_IMPORTED_MODULE_2__","addEventListener","handleMessage","removeEventListener","nextProps","type","serverUrl","path"],"mappings":"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","file":"build/music-f0ace51c0fb7587abe6f.js","sourcesContent":["export default document.querySelector('#scene-root')\n","import _ from 'lodash'\nimport MusicSelectPreviewer from 'bemuse/music-previewer/MusicSelectPreviewer'\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport getPlayableCharts from 'bemuse/music-collection/getPlayableCharts'\nimport getPreviewUrl from 'bemuse/music-collection/getPreviewUrl'\nimport groupSongsIntoCategories from 'bemuse/music-collection/groupSongsIntoCategories'\nimport sortSongs from 'bemuse/music-collection/sortSongs'\n\nconst sorters = {\n  ingame: songs => groupSongsIntoCategories(sortSongs(songs)),\n  added: songs => [\n    {\n      title: 'Sorted by added date',\n      songs: _.reverse(_.sortBy(songs, getAdded)),\n    },\n  ],\n}\n\nconst getAdded = song =>\n  song.added || (song.initial ? '0000-00-00' : '9999-99-99')\n\nfunction validateSong(song) {\n  const problems = []\n  const report = (message, ...keys) => problems.push({ keys, message })\n  if (song.unreleased) {\n    report('Not released', 'unreleased')\n  }\n  if (!song.readme) {\n    report('No README file found', 'README.md')\n  }\n  if (!song.replaygain) {\n    report('No replay gain', 'replaygain')\n  }\n  if (!song.artist_url) {\n    report('No artist URL', 'artist_url')\n  }\n  if (!song.added && !song.initial) {\n    report('No added date', 'added')\n  }\n  if (!song.song_url && !song.youtube_url && !song.long_url) {\n    report('No song/YouTube/long URL', 'song_url', 'long_url', 'youtube_url')\n  }\n  if (!song.bms_url && !song.exclusive) {\n    report('No download URL', 'bms_url')\n  }\n  if (!song.bmssearch_id && !song.exclusive) {\n    report('No BMS search ID', 'bmssearch_id')\n  }\n  if (!song.charts.filter(chart => chart.keys === '5K').length) {\n    report('No 5-key charts', '5key')\n  }\n  for (const chart of getPlayableCharts(song.charts)) {\n    if (!chart.info.subtitles.length) {\n      report('Missing subtitle', 'chart_names ' + chart.file)\n    }\n  }\n  return problems\n}\n\nfunction renderSongWarnings(song) {\n  const problems = validateSong(song)\n  if (!problems.length) return null\n  return (\n    <div>\n      {problems.map((problem, index) => (\n        <div key={index}>\n          {problem.keys.map(key => (\n            <code\n              key={key}\n              style={{\n                fontFamily: 'Ubuntu Mono',\n                marginRight: '2',\n                padding: 3,\n                fontSize: '0.8em',\n                background: '#755',\n              }}\n            >\n              {key}\n            </code>\n          ))}\n          {problem.message}\n        </div>\n      ))}\n    </div>\n  )\n}\n\nexport class MusicTable extends React.Component {\n  static propTypes = {\n    data: PropTypes.object,\n    url: PropTypes.string,\n    initialSort: PropTypes.string,\n  }\n  constructor(props) {\n    super(props)\n    this.state = {\n      sort: this.props.initialSort || Object.keys(sorters)[0],\n      previewUrl: null,\n      previewEnabled: false,\n    }\n  }\n  renderTable() {\n    return (\n      <table style={{ borderSpacing: 4 }}>\n        <thead>\n          <tr>\n            <th colSpan={4}>\n              {this.renderSorter()}\n              {' · '}\n              {this.renderPreview()}\n            </th>\n          </tr>\n          <tr>\n            <th>id</th>\n            <th>song</th>\n            <th>warnings</th>\n          </tr>\n        </thead>\n        <tbody>{this.renderRows()}</tbody>\n      </table>\n    )\n  }\n  renderSorter() {\n    const out = []\n    for (const key of Object.keys(sorters)) {\n      out.push(\n        <button\n          key={key}\n          onClick={() => {\n            this.setState({ sort: key })\n          }}\n        >\n          {key}\n        </button>\n      )\n    }\n    return (\n      <span>\n        <strong>Sort by:</strong> {out}\n      </span>\n    )\n  }\n  renderPreview() {\n    const button = (\n      <button\n        onClick={() => {\n          this.setState(s => ({ previewEnabled: !s.previewEnabled }))\n        }}\n      >\n        {this.state.previewEnabled ? 'disable' : 'enable'}\n      </button>\n    )\n    return (\n      <span>\n        <strong>Music preview:</strong> {button}\n        {this.state.previewEnabled && (\n          <MusicSelectPreviewer url={this.state.previewUrl} />\n        )}\n      </span>\n    )\n  }\n  renderRows() {\n    const categories = sorters[this.state.sort](this.props.data.songs)\n    const out = []\n    for (const category of categories) {\n      out.push(\n        <tr key={category.title}>\n          <th colSpan={4}>{category.title}</th>\n        </tr>\n      )\n      for (const song of category.songs) {\n        out.push(\n          <tr key={song.id}>\n            <td>\n              <strong\n                onClick={() => {\n                  prompt('', `vim '${song.id}/README.md'`)\n                }}\n              >\n                <code style={{ fontFamily: 'Ubuntu Mono' }}>{song.id}</code>\n              </strong>\n              <br />\n              <span style={{ color: '#8b8685' }}>{song.added}</span>\n            </td>\n            <td style={{ textAlign: 'center', background: '#353433' }}>\n              <span\n                style={{ color: '#8b8685' }}\n                onClick={() => {\n                  const previewUrl = getPreviewUrl(this.props.url, song)\n                  this.setState({ previewUrl })\n                }}\n              >\n                {song.genre}\n              </span>\n              <br />\n              <strong\n                onClick={() => {\n                  console.log(song)\n                  alert(require('util').inspect(song))\n                }}\n              >\n                {song.title}\n              </strong>\n              <br />\n              {song.artist}\n            </td>\n            <td>{renderSongWarnings(song)}</td>\n          </tr>\n        )\n      }\n    }\n    return out\n  }\n  renderMessage(text) {\n    return <div style={{ textAlign: 'center' }}>{text}</div>\n  }\n  render() {\n    if (!this.props.data) return this.renderMessage('No data')\n    try {\n      return this.renderTable()\n    } catch (e) {\n      return this.renderMessage(`Error: ${e}`)\n    }\n  }\n}\n\nexport default MusicTable\n","import React from 'react'\nimport preprocessCollection from 'bemuse/music-collection/preprocessCollection'\nimport query from 'bemuse/utils/query'\nimport { OFFICIAL_SERVER_URL, load } from 'bemuse/music-collection'\n\nimport MusicTable from './MusicTable'\n\nexport class CollectionViewer extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      url: query.server || OFFICIAL_SERVER_URL,\n      status: 'Loading',\n    }\n  }\n  componentDidMount() {\n    load(this.state.url)\n      .then(result => {\n        this.setState({ status: 'Load completed', data: result })\n      })\n      .catch(e => {\n        this.setState({ status: 'Load error: ' + e })\n      })\n  }\n  render() {\n    return (\n      <div>\n        <header style={{ textAlign: 'center' }}>\n          <h1>Bemuse collection viewer</h1>\n          <div>\n            {this.state.url}\n            <br />\n            {this.state.status}\n          </div>\n        </header>\n        <div style={{ padding: 20 }}>\n          <MusicTable\n            data={this.state.data && preprocessCollection(this.state.data)}\n            url={this.state.url}\n            initialSort={query.sort}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default CollectionViewer\n","import * as MusicPreviewer from 'bemuse/music-previewer'\nimport MAIN from 'bemuse/utils/main-element'\nimport React from 'react'\nimport { render } from 'react-dom'\n\nimport CollectionViewer from './CollectionViewer'\n\nexport function main() {\n  MusicPreviewer.preload()\n  render(<CollectionViewer />, MAIN)\n}\n","export function isChartPlayable(chart) {\n  return chart.keys === '7K' || chart.keys === '5K'\n}\n\nexport default isChartPlayable\n","import _ from 'lodash'\n\nimport isChartPlayable from './isChartPlayable'\n\nexport function getPlayableCharts(charts) {\n  return _(charts)\n    .filter(isChartPlayable)\n    .orderBy([\n      chart => (chart.info.difficulty >= 5 ? 1 : 0),\n      chart => chart.keys,\n      chart => chart.info.level,\n    ])\n    .value()\n}\n\nexport default getPlayableCharts\n","export const OFFICIAL_SERVER_URL = 'https://music.bemuse.ninja/live'\n\nexport function load(url, { fetch = global.fetch } = {}) {\n  return fetch(url + '/index.json').then(response => response.json())\n}\n","import _ from 'lodash'\n\nconst grouping = [\n  { title: 'Custom Song', criteria: song => song.custom },\n  { title: 'Tutorial', criteria: song => song.tutorial },\n  { title: 'Unreleased', criteria: song => song.unreleased },\n  {\n    title: 'Recently Added Songs',\n    criteria: song =>\n      song.added && Date.now() - Date.parse(song.added) < 60 * 86400000,\n    sort: song => song.added,\n    reverse: true,\n  },\n  { title: '☆', criteria: () => true },\n]\n\nexport function groupSongsIntoCategories(songs) {\n  let groups = grouping.map(group => ({\n    input: group,\n    output: { title: group.title, songs: [] },\n  }))\n  for (let song of songs) {\n    for (let { input, output } of groups) {\n      if (input.criteria(song)) {\n        output.songs.push(song)\n        break\n      }\n    }\n  }\n  for (let { input, output } of groups) {\n    if (input.sort) output.songs = _.sortBy(output.songs, input.sort)\n    if (input.reverse) output.songs.reverse()\n  }\n  return _(groups)\n    .map('output')\n    .filter(group => group.songs.length > 0)\n    .value()\n}\n\nexport default groupSongsIntoCategories\n","import u from 'updeep'\n\nexport const preprocessCollection = u({\n  songs: u.map(preprocessSong),\n})\n\nfunction preprocessSong(song) {\n  if (song.chart_names) {\n    song = u(\n      {\n        charts: u.map(chart => {\n          const name = song.chart_names[chart.file]\n          if (!name) return chart\n          return u(\n            {\n              info: {\n                subtitles: subtitles => [...subtitles, name],\n              },\n            },\n            chart\n          )\n        }),\n      },\n      song\n    )\n  }\n  return song\n}\n\nexport default preprocessCollection\n","import _ from 'lodash'\nimport isChartPlayable from './isChartPlayable'\n\nexport function sortSongs(songs) {\n  return _.orderBy(songs, [\n    song => {\n      return _(song.charts)\n        .filter(isChartPlayable)\n        .filter(chart => chart.info.difficulty < 5)\n        .filter(chart => chart.info.level > 0)\n        .map(chart => chart.info.level)\n        .min()\n    },\n    song => song.bpm,\n    song => song.title.toLowerCase(),\n  ])\n}\n\nexport default sortSongs\n","let instance = null\n\nfunction getInstance() {\n  return instance || (instance = createMusicPreviewer())\n}\n\nexport function preload() {\n  getInstance()\n}\n\nexport function enable() {\n  return getInstance().enable()\n}\n\nexport function disable() {\n  return getInstance().disable()\n}\n\nexport function go() {\n  return getInstance().go()\n}\n\nexport function preview(url) {\n  return getInstance().preview(url)\n}\n\nfunction createFader(audio, initialVolume, onTargetReached) {\n  let targetVolume = 0\n  let currentSpeed = 0\n  let requested = false\n  let volumeChanged\n  audio.volume = initialVolume\n\n  function elapsed() {\n    return (Date.now() - volumeChanged) / 1000\n  }\n\n  function getCurrentVolume() {\n    if (targetVolume > initialVolume) {\n      return Math.min(targetVolume, initialVolume + elapsed() * currentSpeed)\n    }\n    if (targetVolume < initialVolume) {\n      return Math.max(targetVolume, initialVolume - elapsed() * currentSpeed)\n    }\n    return targetVolume\n  }\n\n  function update() {\n    requested = false\n    const currentVolume = getCurrentVolume()\n    audio.volume = currentVolume\n    if (currentVolume === targetVolume) {\n      if (onTargetReached) onTargetReached(targetVolume)\n    } else {\n      if (!requested) {\n        requested = true\n        requestAnimationFrame(update)\n      }\n    }\n  }\n\n  return {\n    fadeTo(target, speed) {\n      if (targetVolume !== target || speed !== currentSpeed) {\n        initialVolume = getCurrentVolume()\n        targetVolume = target\n        currentSpeed = speed\n        volumeChanged = Date.now()\n        update()\n      }\n    },\n  }\n}\n\nfunction createMusicPreviewer() {\n  let enabled = false\n  let currentUrl = null\n  let backgroundLoaded = false\n  let backgroundPlayed = false\n  const instances = {}\n\n  const background = new Audio(require('./default.ogg'))\n  background.preload = 'auto'\n  background.loop = true\n  background.oncanplaythrough = () => {\n    backgroundLoaded = true\n    update()\n  }\n  background.load()\n\n  const goSound = document.createElement('audio')\n  goSound.src = require('./go.ogg')\n  goSound.volume = 0.5\n  goSound.load()\n\n  const backgroundFader = createFader(background, 0.5, target => {\n    if (target === 0 && backgroundPlayed) {\n      backgroundPlayed = false\n      background.pause()\n    }\n  })\n\n  function update() {\n    if (!enabled) {\n      if (backgroundPlayed) {\n        backgroundFader.fadeTo(0, 100)\n        backgroundPlayed = false\n        background.pause()\n      }\n      for (const key of Object.keys(instances)) {\n        const instance = instances[key]\n        instance.destroy()\n      }\n      return\n    }\n    let playing = null\n    for (const key of Object.keys(instances)) {\n      const instance = instances[key]\n      if (key === currentUrl) {\n        if (instance.loaded) {\n          instance.play()\n          playing = instance\n        }\n      } else {\n        instance.stop()\n      }\n    }\n    if (playing) {\n      backgroundFader.fadeTo(0, 1)\n    } else {\n      backgroundFader.fadeTo(0.4, 0.5)\n      if (backgroundLoaded && !backgroundPlayed) {\n        backgroundPlayed = true\n        try {\n          background.play()\n        } catch (e) {\n          console.warn('Cannot play background music')\n        }\n      }\n    }\n  }\n\n  const musicPreviewer = {\n    enable() {\n      if (enabled) return\n      enabled = true\n      update()\n    },\n    disable() {\n      if (!enabled) return\n      enabled = false\n      update()\n    },\n    go() {\n      if (!enabled) return\n      goSound.currentTime = 0\n      try {\n        goSound.play()\n      } catch (e) {\n        console.warn('Cannot play go sound.')\n      }\n    },\n    preview(songUrl) {\n      if (currentUrl === songUrl) return\n      currentUrl = songUrl\n      if (songUrl && !instances[songUrl]) {\n        instances[songUrl] = createInstance(songUrl)\n      }\n      update()\n    },\n  }\n\n  function createInstance(songUrl) {\n    const audio = document.createElement('audio')\n    audio.src = songUrl\n    let played = false\n\n    const fader = createFader(audio, 1, target => {\n      if (target === 0) {\n        audio.pause()\n        delete instances[songUrl]\n        update()\n      }\n    })\n\n    const instance = {\n      loaded: false,\n      play() {\n        if (!played) {\n          try {\n            audio.play()\n            played = true\n          } catch (e) {\n            console.warn('Cannot play', audio.src)\n          }\n        }\n        fader.fadeTo(1, 2)\n      },\n      stop() {\n        fader.fadeTo(0, 4)\n      },\n      destroy() {\n        audio.pause()\n        delete instances[songUrl]\n        update()\n      },\n    }\n\n    audio.oncanplaythrough = () => {\n      instance.loaded = true\n      update()\n    }\n    audio.onended = () => {\n      delete instances[songUrl]\n      update()\n    }\n    audio.load()\n\n    return instance\n  }\n\n  return musicPreviewer\n}\n","module.exports = __webpack_public_path__ + \"build/354b30433269481d2f132496a0d13f64.ogg\";","module.exports = __webpack_public_path__ + \"build/38fbcad5f2b14ca6ffc359446f7ec455.ogg\";","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport * as MusicPreviewer from './'\n\nMusicPreviewer.preload()\n\nexport default class MusicSelectPreviewer extends React.Component {\n  static propTypes = {\n    url: PropTypes.string,\n  }\n  componentDidMount() {\n    MusicPreviewer.enable()\n    MusicPreviewer.preview(this.props.url)\n    addEventListener('message', this.handleMessage)\n  }\n  componentWillUnmount() {\n    MusicPreviewer.disable()\n    removeEventListener('message', this.handleMessage)\n  }\n  componentWillReceiveProps(nextProps) {\n    MusicPreviewer.preview(nextProps.url)\n  }\n  render() {\n    return null\n  }\n  handleMessage({ data }) {\n    if (data.type === 'calibration-started') {\n      MusicPreviewer.disable()\n    } else if (data.type === 'calibration-closed') {\n      MusicPreviewer.enable()\n    }\n  }\n}\n","export function getPreviewUrl(serverUrl, song) {\n  if (!song) return null\n  if (song.tutorial) return null\n  return serverUrl + '/' + song.path + '/_bemuse_preview.mp3'\n}\n\nexport default getPreviewUrl\n"],"sourceRoot":""}