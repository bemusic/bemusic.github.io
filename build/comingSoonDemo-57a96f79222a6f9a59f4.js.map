{"version":3,"sources":["file:///home/circleci/bemuse/src/sampling-master/index.js","file:///home/circleci/bemuse/src/coming-soon/demo/template.jade","file:///home/circleci/bemuse/src/coming-soon/demo/style.scss","file:///home/circleci/bemuse/src/coming-soon/demo/style.scss?d4ff","file:///home/circleci/bemuse/src/coming-soon/demo/index.js","file:///home/circleci/bemuse/src/audio-context/index.js","file:///home/circleci/bemuse/src/resources/dnd-resources.js","file:///home/circleci/bemuse/node_modules/webpack/buildin/module.js"],"names":["FADE_LENGTH","dummyAudioTag","document","createElement","canPlay","type","canPlayType","SamplingMaster","audioContext","_classCallCheck","this","_audioContext","bemuse_audio_context__WEBPACK_IMPORTED_MODULE_0__","_samples","_groups","_instances","Set","_destination","destination","_createClass","key","value","unmuteAudio","_destroyed","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","destroy","err","return","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","blobOrArrayBuffer","_this","_coerceToArrayBuffer","then","arrayBuffer","_decodeAudio","blobOrArrayBufferOrAudioBuffer","_this2","numberOfChannels","Promise","resolve","decode","audioBuffer","Error","sample","Sample","push","options","group","SoundGroup","ArrayBuffer","Object","bemuse_utils_read_blob__WEBPACK_IMPORTED_MODULE_1__","as","_this3","reject","decodeAudioData","e","instance","add","delete","get","samplingMaster","volume","arguments","length","_master","_gain","createGain","gain","connect","disconnect","_buffer","delay","PlayInstance","buffer","_this4","context","source","createBufferSource","onended","stop","node","_source","TEST_node","startTime","Math","max","currentTime","startOffset","start","fadeIn","fadeOutAt","setValueAtTime","end","duration","linearRampToValueAtTime","_startPlaying","_stoppedPlaying","onstop","playbackRate","random","pow","ctx","osc","createOscillator","frequency","resume","console","error","__webpack_exports__","__webpack_require__","module","exports","locals","buf","join","i","content","hmr","transform","insertInto","main","element","jquery__WEBPACK_IMPORTED_MODULE_1___default","text","on","handler","el","_template_jade__WEBPACK_IMPORTED_MODULE_7___default","appendTo","find","hide","preventDefault","dndLoader","bemuse_resources_dnd_resources__WEBPACK_IMPORTED_MODULE_3__","originalEvent","loader","master","bemuse_sampling_master__WEBPACK_IMPORTED_MODULE_4__","bemuse_audio_context__WEBPACK_IMPORTED_MODULE_6__","$log","$play","$sampler","log","t","loadSamples","notes","chart","samples","promises","completed","_loop2","note","name","keysound","headers","file","catch","replace","read","blob","tap","all","co__WEBPACK_IMPORTED_MODULE_5___default","co","_callee","list","bmsFile","arraybuffer","timing","info","regeneratorRuntime","wrap","_context","prev","fileList","sent","filter","f","match","Buffer","from","Uint8Array","promisify","bms__WEBPACK_IMPORTED_MODULE_2__","readAsync","compile","fromBMSChart","JSON","stringify","show","unmute","_loop","setTimeout","span","play","scrollTop","scrollHeight","addClass","beatToSeconds","beat","go","off","audio_context__WEBPACK_IMPORTED_MODULE_0___default","latencyHint","DndResources","event","_files","out","co__WEBPACK_IMPORTED_MODULE_1___default","item","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_iterator3","_step3","dataTransfer","items","Array","readItem","t0","finish","files","addFile","t1","abrupt","_callee2","entry","_context2","webkitGetAsEntry","readEntry","getAsFile","isFile","readFile","isDirectory","dir","_callee3","entries","reader","readMore","results","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_iterator4","_step4","_context3","createReader","readEntries","apply","_toConsumableArray","getFilesFromEvent","toLowerCase","FileResource","map","_file","progress","bemuse_progress_utils__WEBPACK_IMPORTED_MODULE_0__","bemuse_utils_read_blob__WEBPACK_IMPORTED_MODULE_2__","URL","createObjectURL","webpackPolyfill","deprecate","paths","children","defineProperty","enumerable","l"],"mappings":"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","file":"comingSoonDemo-57a96f79222a6f9a59f4.js","sourcesContent":["import defaultAudioContext from 'bemuse/audio-context'\nimport readBlob from 'bemuse/utils/read-blob'\n\nexport const FADE_LENGTH = 0.001\n\nlet dummyAudioTag = document.createElement('audio')\n\n// Checks whether an audio format is supported.\nexport function canPlay (type) {\n  return dummyAudioTag.canPlayType(type) === 'probably'\n}\n\n// The sampling master is a wrapper class around Web Audio API\n// that takes care of:\n//\n// - Decoding audio from an ArrayBuffer or Blob (resulting in a \"Sample\").\n// - Playing the `Sample` and managing its lifecycle.\nexport class SamplingMaster {\n  constructor (audioContext) {\n    this._audioContext = audioContext || defaultAudioContext\n    this._samples = []\n    this._groups = []\n    this._instances = new Set()\n    this._destination = this._audioContext.destination\n  }\n\n  // Connects a dummy node to the audio, thereby unmuting the audio system on\n  // iOS devices (which keeps the audio muted until a user interacts with the\n  // page).\n  unmute () {\n    unmuteAudio(this._audioContext)\n  }\n\n  // The underlying AudioContext.\n  get audioContext () {\n    return this._audioContext\n  }\n\n  // The audio destination.\n  get destination () {\n    return this._destination\n  }\n\n  // Destroys this SamplingMaster, make it unusable.\n  destroy () {\n    if (this._destroyed) return\n    this._destroyed = true\n    for (let sample of this._samples) sample.destroy()\n    for (let instance of this._instances) instance.destroy()\n    this._samples = null\n    this._instances = null\n  }\n\n  // Decodes the audio data from a Blob or an ArrayBuffer.\n  // Returns an AudioBuffer which can be re-used in other sampling masters.\n  decode (blobOrArrayBuffer) {\n    return this._coerceToArrayBuffer(blobOrArrayBuffer).then(arrayBuffer =>\n      this._decodeAudio(arrayBuffer)\n    )\n  }\n\n  // Creates a `Sample` from a Blob or an ArrayBuffer or an AudioBuffer.\n  sample (blobOrArrayBufferOrAudioBuffer) {\n    const audioBufferPromise = (() => {\n      if (blobOrArrayBufferOrAudioBuffer.numberOfChannels) {\n        return Promise.resolve(blobOrArrayBufferOrAudioBuffer)\n      } else {\n        return this.decode(blobOrArrayBufferOrAudioBuffer)\n      }\n    })()\n    return audioBufferPromise.then(audioBuffer => {\n      if (this._destroyed) throw new Error('SamplingMaster already destroyed!')\n      var sample = new Sample(this, audioBuffer)\n      this._samples.push(sample)\n      return sample\n    })\n  }\n\n  group (options) {\n    const group = new SoundGroup(this, options)\n    this._groups.push(group)\n    return group\n  }\n\n  _coerceToArrayBuffer (blobOrArrayBuffer) {\n    if (blobOrArrayBuffer instanceof ArrayBuffer) {\n      return Promise.resolve(blobOrArrayBuffer)\n    } else {\n      return readBlob(blobOrArrayBuffer).as('arraybuffer')\n    }\n  }\n\n  _decodeAudio (arrayBuffer) {\n    return new Promise((resolve, reject) => {\n      this.audioContext.decodeAudioData(\n        arrayBuffer,\n        function decodeAudioDataSuccess (audioBuffer) {\n          resolve(audioBuffer)\n        },\n        function decodeAudioDataFailure (e) {\n          reject(new Error('Unable to decode audio: ' + e))\n        }\n      )\n    })\n  }\n\n  _startPlaying (instance) {\n    this._instances.add(instance)\n  }\n\n  _stoppedPlaying (instance) {\n    this._instances.delete(instance)\n  }\n}\n\n// Sound group\nclass SoundGroup {\n  constructor (samplingMaster, { volume } = {}) {\n    this._master = samplingMaster\n    this._gain = this._master.audioContext.createGain()\n    if (volume != null) this._gain.gain.value = volume\n    this._gain.connect(this._master.destination)\n  }\n\n  get destination () {\n    return this._gain\n  }\n\n  destroy () {\n    this._gain.disconnect()\n    this._gain = null\n  }\n}\n\n// The Sample is created by and belongs to the `SamplingMaster`.\n//\n// You don't invoke this constructor directly; it is invoked by\n// `SamplingMaster#create`.\nclass Sample {\n  constructor (samplingMaster, audioBuffer) {\n    this._master = samplingMaster\n    this._buffer = audioBuffer\n  }\n\n  // Plays the sample and returns the new PlayInstance.\n  play (delay, options) {\n    return new PlayInstance(this._master, this._buffer, delay, options)\n  }\n\n  // Destroys this sample, thereby making it unusable.\n  destroy () {\n    this._master = null\n    this._buffer = null\n  }\n}\n\n// When a `Sample` is played, a PlayInstance is created.\n// A PlayInstance may not be reused; after the sound finishes playing,\n// you have to invoke `Sample#play` again.\n//\n// You don't invoke this constructor directly; it is invoked by `Sample#play`.\nclass PlayInstance {\n  constructor (samplingMaster, buffer, delay, options = {}) {\n    delay = delay || 0\n    this._master = samplingMaster\n\n    // Connect all the stuff...\n    let context = samplingMaster.audioContext\n    let source = context.createBufferSource()\n    source.buffer = buffer\n    source.onended = () => this.stop()\n    let gain = context.createGain()\n    source.connect(gain)\n    let destination =\n      options.node ||\n      (options.group && options.group.destination) ||\n      samplingMaster.destination\n    gain.connect(destination)\n    this._source = source\n    this._gain = this.TEST_node = gain\n\n    // Start the sound.\n    let startTime = !delay ? 0 : Math.max(0, context.currentTime + delay)\n    let startOffset = options.start || 0\n    let fadeIn = startOffset > 0\n    let fadeOutAt = false\n    if (fadeIn) {\n      gain.gain.setValueAtTime(0, 0)\n    }\n    if (options.end !== undefined) {\n      let duration = Math.max(options.end - startOffset, 0)\n      source.start(startTime, startOffset, duration + FADE_LENGTH)\n      fadeOutAt = context.currentTime + delay + duration\n    } else {\n      source.start(startTime, startOffset)\n    }\n    if (fadeIn) {\n      gain.gain.setValueAtTime(0, context.currentTime + delay)\n      gain.gain.linearRampToValueAtTime(\n        1,\n        context.currentTime + delay + FADE_LENGTH\n      )\n    }\n    if (fadeOutAt !== false) {\n      gain.gain.setValueAtTime(1, fadeOutAt)\n      gain.gain.linearRampToValueAtTime(0, fadeOutAt + FADE_LENGTH)\n    }\n    this._master._startPlaying(this)\n  }\n\n  // Stops the sample and disconnects the underlying Web Audio nodes.\n  stop () {\n    if (!this._source) return\n    this._source.stop(0)\n    this._source.disconnect()\n    this._gain.disconnect()\n    this._source = null\n    this._gain = null\n    this._master._stoppedPlaying(this)\n    if (this.onstop) this.onstop()\n  }\n\n  // Makes this PlayInstance sound off-pitch, as a result of badly hitting\n  // a note.\n  bad () {\n    if (!this._source) return\n    this._source.playbackRate.value =\n      Math.random() < 0.5 ? Math.pow(2, 1 / 24) : Math.pow(2, -1 / 24)\n  }\n\n  // Destroys this PlayInstance.\n  destroy () {\n    this.stop()\n  }\n}\n\nexport default SamplingMaster\n\n/**\n * Enables Web Audio on iOS. By default, on iOS, audio is disabled.\n * This function must be called before audio will start working. It must be\n * called as a response to some user interaction (e.g. touchstart).\n *\n * Also, there’s now Chrome autoplay policy taking effect.\n * https://developers.google.com/web/updates/2017/09/autoplay-policy-changes\n *\n * @param {AudioContext} ctx The AudioContext to be unmuted.\n */\nexport function unmuteAudio (ctx = defaultAudioContext) {\n  // Perform some strange magic to unmute the audio on iOS devices.\n  // This code doesn’t make sense at all, you know.\n  let gain = ctx.createGain()\n  let osc = ctx.createOscillator()\n  osc.frequency.value = 440\n  osc.start(ctx.currentTime + 0.1)\n  osc.stop(ctx.currentTime + 0.1)\n  gain.connect(ctx.destination)\n  gain.disconnect()\n\n  try {\n    ctx.resume()\n  } catch (e) {\n    console.error('[sampling-master] Cannot resume AudioContext', e)\n  }\n}\n","var jade = require(\"/home/circleci/bemuse/node_modules/jade/lib/runtime.js\");\n\nmodule.exports = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div class=\\\"jukebox\\\"><div class=\\\"jukebox--overlay\\\"></div><div class=\\\"jukebox--inner\\\"><h1>BMS Jukebox</h1><p class=\\\"jukebox--status js-log\\\">Waiting for BMS file...</p><p>Google Chrome: Drag a BMS folder into this box.</p><p>Firefox, Safari: Select all files (BMS+sounds) and drag into this box.</p><button class=\\\"js-play\\\">Click Here to Play</button><div class=\\\"js-sampler jukebox--sampler\\\"></div></div></div>\");;return buf.join(\"\");\n}","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".jukebox--overlay {\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  background: rgba(139, 134, 133, 0.5);\\n}\\n\\n.jukebox--inner {\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  -webkit-transform: translate(-50%, -50%);\\n          transform: translate(-50%, -50%);\\n  border: 2px solid #8b8685;\\n  background: #252423;\\n  padding: 12px;\\n}\\n\\n.jukebox--sampler {\\n  background: #090807;\\n  padding: 9px;\\n  border: 1px solid #8b8685;\\n  margin-top: 10px;\\n  height: 192px;\\n  width: 40em;\\n  overflow: auto;\\n}\\n\\n.jukebox--sampler span {\\n  font-size: 12px;\\n  opacity: 1;\\n  transition: 0.5s opacity;\\n}\\n\\n.jukebox--sampler span.is-off {\\n  color: #8b8685;\\n  opacity: 0;\\n}\\n\\n.jukebox h1 {\\n  margin: 0 0 20px;\\n  font: 30px Helvetica Neue, Helvetica, sans-serif;\\n}\\n\\n.jukebox p {\\n  margin: 10px 0 0;\\n}\\n\\n.jukebox .jukebox--status {\\n  color: #8b8685;\\n  font-style: italic;\\n  margin-bottom: 20px;\\n}\\n\\n.jukebox button {\\n  display: block;\\n  box-sizing: border-box;\\n  width: 100%;\\n  background: #090807;\\n  color: #7f3;\\n  cursor: pointer;\\n  border: 1px solid #8b8685;\\n  padding: 8px;\\n  font: bold 15px verdana, sans-serif;\\n  margin-top: 18px;\\n}\\n\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../node_modules/css-loader/index.js??ref--9-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/sass-loader/lib/loader.js??ref--9-3!./style.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js??ref--9-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/sass-loader/lib/loader.js??ref--9-3!./style.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js??ref--9-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/sass-loader/lib/loader.js??ref--9-3!./style.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import './style.scss'\n\nimport $ from 'jquery'\nimport { Compiler, Notes, Reader, SongInfo, Timing } from 'bms'\nimport DndResources from 'bemuse/resources/dnd-resources'\nimport SamplingMaster from 'bemuse/sampling-master'\nimport co from 'co'\nimport ctx from 'bemuse/audio-context'\n\nimport template from './template.jade'\n\nexport function main (element) {\n  $(element)\n    .text('Technical Demo!')\n    .on('click', handler)\n\n  function handler () {\n    ui()\n    $(element).off('click', handler)\n    $(element).hide()\n    return false\n  }\n\n  function ui () {\n    var el = $(template()).appendTo('body')\n    el.find('.js-play').hide()\n    el.on('dragover', () => false).on('drop', e => {\n      e.preventDefault()\n      let dndLoader = new DndResources(e.originalEvent)\n      go(dndLoader, el)\n      return false\n    })\n  }\n}\n\nfunction go (loader, element) {\n  let master = new SamplingMaster(ctx)\n  let $log = element.find('.js-log')\n  let $play = element.find('.js-play').hide()\n  let $sampler = element.find('.js-sampler')\n\n  co(function * () {\n    log('Loading file list')\n    let list = yield loader.fileList\n    let bmsFile = list.filter(f => f.match(/\\.(?:bms|bme|bml|pms)$/i))[0]\n    log('Loading ' + bmsFile)\n\n    let arraybuffer = yield (yield loader.file(bmsFile)).read()\n    let buffer = Buffer.from(new Uint8Array(arraybuffer))\n    let text = yield Promise.promisify(Reader.readAsync)(buffer)\n    let chart = Compiler.compile(text).chart\n    var timing = Timing.fromBMSChart(chart)\n    var notes = Notes.fromBMSChart(chart)\n    var info = SongInfo.fromBMSChart(chart)\n    $('<pre wrap></pre>')\n      .text(JSON.stringify(info, null, 2))\n      .appendTo($sampler)\n    log('Loading samples')\n    var samples = yield loadSamples(notes, chart)\n    log('Click the button to play!')\n    yield waitForPlay()\n    void (function () {\n      master.unmute()\n      for (let note of notes.all()) {\n        setTimeout(() => {\n          let sample = samples[note.keysound]\n          if (!sample) {\n            console.log('warn: unknown sample ' + note.keysound)\n            return\n          }\n          let span = $('<span></span>')\n            .text('[' + note.keysound + '] ')\n            .appendTo($sampler)\n          let instance = sample.play()\n          $sampler[0].scrollTop = $sampler[0].scrollHeight\n          instance.onstop = function () {\n            span.addClass('is-off')\n          }\n        }, timing.beatToSeconds(note.beat) * 1000)\n      }\n      return false\n    })()\n  }).done()\n\n  function waitForPlay () {\n    return new Promise(function (resolve) {\n      $play.show()\n      $play.on('click', () => {\n        resolve()\n        $play.hide()\n      })\n    })\n  }\n\n  function log (t) {\n    $log.text(t)\n  }\n\n  function loadSamples (notes, chart) {\n    var samples = {}\n    var promises = []\n    let completed = 0\n\n    for (let note of notes.all()) {\n      let keysound = note.keysound\n      if (!(keysound in samples)) {\n        samples[keysound] = null\n        promises.push(\n          loadKeysound(chart.headers.get('wav' + keysound))\n            .then(blob => master.sample(blob))\n            .then(sample => (samples[keysound] = sample))\n            .catch(e => console.error('Unable to load ' + keysound + ': ' + e))\n            .tap(() =>\n              log(\n                '[loaded ' + ++completed + '/' + promises.length + ' samples]'\n              )\n            )\n        )\n      }\n    }\n\n    return Promise.all(promises).then(() => samples)\n  }\n\n  function loadKeysound (name) {\n    if (typeof name !== 'string') return Promise.reject(new Error('Empty name'))\n    return loader\n      .file(name)\n      .catch(() => loader.file(name.replace(/\\.\\w+$/, '.ogg')))\n      .catch(() => loader.file(name.replace(/\\.\\w+$/, '.mp3')))\n      .catch(() => loader.file(name.replace(/\\.\\w+$/, '.wav')))\n      .then(file => file.read())\n  }\n}\n","import createAudioContext from 'audio-context'\n\nexport default createAudioContext({\n  latencyHint: 'interaction'\n})\n","import * as ProgressUtils from 'bemuse/progress/utils'\n\nimport co from 'co'\nimport readBlob from 'bemuse/utils/read-blob'\n\nexport class DndResources {\n  constructor (event) {\n    this._files = getFilesFromEvent(event)\n  }\n  file (name) {\n    return this._files.then(function (files) {\n      for (let file of files) {\n        if (file.name.toLowerCase() === name.toLowerCase()) {\n          return new FileResource(file.file)\n        }\n      }\n      throw new Error('unable to find ' + name)\n    })\n  }\n  get fileList () {\n    return Promise.resolve(this._files.map(f => f.name))\n  }\n}\n\nexport class FileResource {\n  constructor (file) {\n    this._file = file\n  }\n  read (progress) {\n    return ProgressUtils.atomic(\n      progress,\n      readBlob(this._file).as('arraybuffer')\n    )\n  }\n  resolveUrl () {\n    return Promise.resolve(URL.createObjectURL(this._file))\n  }\n  get name () {\n    return this._file.name\n  }\n}\n\nexport default DndResources\n\nfunction getFilesFromEvent (event) {\n  let out = []\n\n  return co(function * () {\n    if (event.dataTransfer.items) {\n      for (let item of Array.from(event.dataTransfer.items)) {\n        yield readItem(item)\n      }\n    } else if (event.dataTransfer.files) {\n      for (let file of Array.from(event.dataTransfer.files)) {\n        addFile(file)\n      }\n    }\n    return out\n  })\n\n  function readItem (item) {\n    return co(function * () {\n      let entry = item.webkitGetAsEntry && item.webkitGetAsEntry()\n      if (entry) {\n        yield readEntry(entry, '')\n      } else {\n        let file = item.getAsFile && item.getAsFile()\n        addFile(file)\n      }\n    })\n  }\n\n  function readEntry (entry) {\n    if (entry.isFile) {\n      return readFile(entry)\n    } else if (entry.isDirectory) {\n      return readDirectory(entry)\n    }\n  }\n\n  function readFile (entry) {\n    return new Promise((resolve, reject) => {\n      entry.file(resolve, reject)\n    }).tap(file => {\n      addFile(file)\n    })\n  }\n\n  function readDirectory (dir) {\n    return co(function * () {\n      let entries = []\n      let reader = dir.createReader()\n      let readMore = () =>\n        new Promise((resolve, reject) => {\n          reader.readEntries(resolve, reject)\n        })\n      for (;;) {\n        let results = yield readMore()\n        if (!results || results.length === 0) break\n        entries.push(...Array.from(results))\n      }\n      for (let entry of entries) {\n        yield readEntry(entry)\n      }\n    })\n  }\n\n  function addFile (file) {\n    if (file) {\n      out.push({ name: file.name, file })\n    }\n  }\n}\n","module.exports = function(module) {\r\n\tif (!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif (!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n"],"sourceRoot":""}