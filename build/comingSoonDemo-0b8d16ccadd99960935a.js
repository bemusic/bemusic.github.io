(this.webpackJsonp=this.webpackJsonp||[]).push([[16],{101:function(e,t,n){"use strict";t.a=function(e){return{as:t=>new Promise(function(n,r){let o=new FileReader;switch(o.onload=function(){n(o.result)},o.onerror=function(){r(new Error("Unable to read from Blob"))},t){case"arraybuffer":o.readAsArrayBuffer(e);break;case"text":o.readAsText(e)}})}}},104:function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(247));t.Reader=i;var s=o(n(249));t.Compiler=s,r(n(40)),r(n(149)),r(n(150)),r(n(68)),r(n(151)),r(n(251)),r(n(254)),r(n(255)),r(n(256)),r(n(257)),r(n(258))},148:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.match=function(e){var t=!1;return{when:function(n,r){if(t)return this;var o=e.match(n);return o&&(t=!0,r(o)),this},else:function(e){if(t)return this;e()}}}},149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._data={},this._dataAll={}}return e.prototype.each=function(e){for(var t in this._data)e(t,this._data[t])},e.prototype.get=function(e){return this._data[e.toLowerCase()]},e.prototype.getAll=function(e){return this._dataAll[e.toLowerCase()]},e.prototype.set=function(e,t){var n=e.toLowerCase();this._data[n]=t,(this._dataAll[n]||(this._dataAll[n]=[])).push(t)},e}();t.BMSHeaders=r},150:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._objects=[]}return e.prototype.add=function(e){if("01"!==e.channel)for(var t=0;t<this._objects.length;t++){var n=this._objects[t];if(n.channel===e.channel&&n.measure===e.measure&&n.fraction===e.fraction)return void(this._objects[t]=e)}this._objects.push(e)},e.prototype.all=function(){return this._objects.slice()},e.prototype.allSorted=function(){var e=this.all();return e.sort(function(e,t){return e.measure+e.fraction-(t.measure+t.fraction)}),e},e}();t.BMSObjects=r},151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._values={}}return e.prototype.set=function(e,t){this._values[e]=t},e.prototype.get=function(e){return this._values[e]||1},e.prototype.getBeats=function(e){return 4*this.get(e)},e.prototype.measureToBeat=function(e,t){for(var n=0,r=0;r<e;r++)n+=this.getBeats(r);return n+this.getBeats(e)*t},e}();t.TimeSignatures=r},165:function(e,t,n){"use strict";var r=n(246),o=n.n(r);t.a=o()({latencyHint:"interaction"})},1731:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"main",function(){return d});n(1732);var r=n(66),o=n.n(r),i=n(104),s=n(525),a=n(203),u=n(85),c=n.n(u),l=n(165),f=n(1734),h=n.n(f);function d(t){o()(t).text("Technical Demo!").on("click",function n(){!function(){var t=o()(h()()).appendTo("body");t.find(".js-play").hide(),t.on("dragover",()=>!1).on("drop",n=>{n.preventDefault();let r=new s.a(n.originalEvent);return function(t,n){let r=new a.b(l.a),s=n.find(".js-log"),u=n.find(".js-play").hide(),f=n.find(".js-sampler");function h(e){s.text(e)}function d(e){return"string"!=typeof e?Promise.reject(new Error("Empty name")):t.file(e).catch(()=>t.file(e.replace(/\.\w+$/,".ogg"))).catch(()=>t.file(e.replace(/\.\w+$/,".mp3"))).catch(()=>t.file(e.replace(/\.\w+$/,".wav"))).then(e=>e.read())}c()(function*(){h("Loading file list");let n=yield t.fileList,s=n.filter(e=>e.match(/\.(?:bms|bme|bml|pms)$/i))[0];h("Loading "+s);let a=yield(yield t.file(s)).read(),c=e.from(new Uint8Array(a)),l=yield Promise.promisify(i.Reader.readAsync)(c),p=i.Compiler.compile(l).chart;var m=i.Timing.fromBMSChart(p),_=i.Notes.fromBMSChart(p),v=i.SongInfo.fromBMSChart(p);o()("<pre wrap></pre>").text(JSON.stringify(v,null,2)).appendTo(f),h("Loading samples");var b=yield function(e,t){var n={},o=[];let i=0;for(let s of e.all()){let e=s.keysound;e in n||(n[e]=null,o.push(d(t.headers.get("wav"+e)).then(e=>r.sample(e)).then(t=>n[e]=t).catch(t=>console.error("Unable to load "+e+": "+t)).tap(()=>h("[loaded "+ ++i+"/"+o.length+" samples]"))))}return Promise.all(o).then(()=>n)}(_,p);h("Click the button to play!"),yield new Promise(function(e){u.show(),u.on("click",()=>{e(),u.hide()})}),function(){r.unmute();for(let e of _.all())setTimeout(()=>{let t=b[e.keysound];if(!t)return void console.log("warn: unknown sample "+e.keysound);let n=o()("<span></span>").text("["+e.keysound+"] ").appendTo(f),r=t.play();f[0].scrollTop=f[0].scrollHeight,r.onstop=function(){n.addClass("is-off")}},1e3*m.beatToSeconds(e.beat))}()}).done()}(r,t),!1})}();o()(t).off("click",n);o()(t).hide();return!1})}}.call(this,n(287).Buffer)},1732:function(e,t,n){var r=n(1733);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(0)(r,o);r.locals&&(e.exports=r.locals)},1733:function(e,t,n){(e.exports=n(1)(!1)).push([e.i,".jukebox--overlay {\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background: rgba(139, 134, 133, 0.5);\n}\n\n.jukebox--inner {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  border: 2px solid #8b8685;\n  background: #252423;\n  padding: 12px;\n}\n\n.jukebox--sampler {\n  background: #090807;\n  padding: 9px;\n  border: 1px solid #8b8685;\n  margin-top: 10px;\n  height: 192px;\n  width: 40em;\n  overflow: auto;\n}\n\n.jukebox--sampler span {\n  font-size: 12px;\n  opacity: 1;\n  transition: 0.5s opacity;\n}\n\n.jukebox--sampler span.is-off {\n  color: #8b8685;\n  opacity: 0;\n}\n\n.jukebox h1 {\n  margin: 0 0 20px;\n  font: 30px Helvetica Neue, Helvetica, sans-serif;\n}\n\n.jukebox p {\n  margin: 10px 0 0;\n}\n\n.jukebox .jukebox--status {\n  color: #8b8685;\n  font-style: italic;\n  margin-bottom: 20px;\n}\n\n.jukebox button {\n  display: block;\n  box-sizing: border-box;\n  width: 100%;\n  background: #090807;\n  color: #7f3;\n  cursor: pointer;\n  border: 1px solid #8b8685;\n  padding: 8px;\n  font: bold 15px verdana, sans-serif;\n  margin-top: 18px;\n}\n",""])},1734:function(e,t,n){n(4);e.exports=function(e){var t=[];return t.push('<div class="jukebox"><div class="jukebox--overlay"></div><div class="jukebox--inner"><h1>BMS Jukebox</h1><p class="jukebox--status js-log">Waiting for BMS file...</p><p>Google Chrome: Drag a BMS folder into this box.</p><p>Firefox, Safari: Select all files (BMS+sounds) and drag into this box.</p><button class="js-play">Click Here to Play</button><div class="js-sampler jukebox--sampler"></div></div></div>'),t.join("")}},203:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return h});var r=n(165),o=n(101),i=n(235);const s=.001;let a=document.createElement("audio");const u=!a.canPlayType('audio/ogg; codecs="vorbis"');class c{constructor(e,{volume:t}={}){this._master=e,this._gain=this._master.audioContext.createGain(),null!=t&&(this._gain.gain.value=t),this._gain.connect(this._master.destination)}get destination(){return this._gain}destroy(){this._gain.disconnect(),this._gain=null}}class l{constructor(e,t){this._master=e,this._buffer=t}play(e,t){return new f(this._master,this._buffer,e,t)}destroy(){this._master=null,this._buffer=null}}class f{constructor(e,t,n,r={}){n=n||0,this._master=e;let o=e.audioContext,i=o.createBufferSource();i.buffer=t,i.onended=(()=>this.stop());let a=o.createGain();i.connect(a);let u=r.node||r.group&&r.group.destination||e.destination;a.connect(u),this._source=i,this._gain=this.TEST_node=a;let c=n?Math.max(0,o.currentTime+n):0,l=r.start||0,f=l>0,h=!1;if(f&&a.gain.setValueAtTime(0,0),void 0!==r.end){let e=Math.max(r.end-l,0);i.start(c,l,e+s),h=o.currentTime+n+e}else i.start(c,l);f&&(a.gain.setValueAtTime(0,o.currentTime+n),a.gain.linearRampToValueAtTime(1,o.currentTime+n+s)),!1!==h&&(a.gain.setValueAtTime(1,h),a.gain.linearRampToValueAtTime(0,h+s)),this._master._startPlaying(this)}stop(){this._source&&(this._source.stop(0),this._source.disconnect(),this._gain.disconnect(),this._source=null,this._gain=null,this._master._stoppedPlaying(this),this.onstop&&this.onstop())}bad(){this._source&&(this._source.playbackRate.value=Math.random()<.5?Math.pow(2,1/24):Math.pow(2,-1/24))}destroy(){this.stop()}}function h(e=r.a){let t=e.createGain(),n=e.createOscillator();n.frequency.value=440,n.start(e.currentTime+.1),n.stop(e.currentTime+.1),t.connect(e.destination),t.disconnect();try{e.resume()}catch(e){console.error("[sampling-master] Cannot resume AudioContext",e)}}t.b=class{constructor(e){this._audioContext=e||r.a,this._samples=[],this._groups=[],this._instances=new Set,this._destination=this._audioContext.destination}unmute(){h(this._audioContext)}get audioContext(){return this._audioContext}get destination(){return this._destination}destroy(){if(!this._destroyed){this._destroyed=!0;for(let e of this._samples)e.destroy();for(let e of this._instances)e.destroy();this._samples=null,this._instances=null}}decode(e){return this._coerceToArrayBuffer(e).then(e=>this._decodeAudio(e))}sample(e){return(()=>e.numberOfChannels?Promise.resolve(e):this.decode(e))().then(e=>{if(this._destroyed)throw new Error("SamplingMaster already destroyed!");var t=new l(this,e);return this._samples.push(t),t})}group(e){const t=new c(this,e);return this._groups.push(t),t}_coerceToArrayBuffer(e){return e instanceof ArrayBuffer?Promise.resolve(e):Object(o.a)(e).as("arraybuffer")}_decodeAudio(e){return new Promise((t,n)=>{if(u&&e.byteLength>4){const n=new Uint8Array(e,0,4);if(79===n[0]&&103===n[1]&&103===n[2]&&83===n[3])return t(Object(i.a)(this.audioContext,e))}this.audioContext.decodeAudioData(e,function(e){t(e)},function(e){n(new Error("Unable to decode audio: "+e))})})}_startPlaying(e){this._instances.add(e)}_stoppedPlaying(e){this._instances.delete(e)}}},235:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(201),o=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})};let i;const s=n.n(r)()(1);function a(e,t){return o(this,void 0,void 0,function*(){const r=yield(i||(i=n.e(13).then(n.t.bind(null,849,7)).then(e=>e.default).then(e=>(0,eval)(e+";stbvorbis"))),i);return s(()=>(function(e,t,n){return new Promise((r,i)=>{const s=[];let a,c=0;e.decode(n,function(e){if(e.data&&(a=e.sampleRate,s.push(e.data),c+=e.data[0].length),e.error){const t=e.error instanceof Error?e.error:`stbvorbis.js Error: ${e.error}`;i(t)}e.eof&&r(function(e,t,n,r){return o(this,void 0,void 0,function*(){if(!n)throw new Error("stbvorbis.js Error: No length");if(!r)throw new Error("stbvorbis.js Error: No sample rate");const o=t[0].length,i=e.createBuffer(o,n,r),s=Array(i.numberOfChannels).fill(null).map((e,t)=>new u(i.getChannelData(t)));for(const e of t)e.forEach((e,t)=>{s[t].write(e)});return i})}(t,s,c,a))})})})(r,e,t))})}class u{constructor(e){this.data=e,this.offset=0}write(e){const{offset:t,data:n}=this;for(var r=0;r<e.length;r++)n[r+t]=e[r];this.offset+=e.length}}},247:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(587);t.read=function(e){throw new Error("Synchronous read unsupported in browser!")},t.readAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],o=e[1],i=e[2];i?(o=e[1],i=e[2]):(o=null,i=e[1]);var s=o&&o.forceEncoding||r.detect(n),a=new FileReader;a.onload=function(){i(null,a.result)},a.onerror=function(){i(new Error("cannot read it"))},a.readAsText(new Blob([n]),s)};var o=n(248);t.getReaderOptionsFromFilename=o.getReaderOptionsFromFilename},248:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReaderOptionsFromFilename=function(e){var t;return e.match(/\.sjis\.\w+$/i)&&(t="Shift-JIS"),e.match(/\.euc_kr\.\w+$/i)&&(t="EUC-KR"),e.match(/\.utf8\.\w+$/i)&&(t="UTF-8"),{forceEncoding:t}}},249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(148),o=n(40),i={bms:{random:/^#RANDOM\s+(\d+)$/i,if:/^#IF\s+(\d+)$/i,endif:/^#ENDIF$/i,timeSignature:/^#(\d\d\d)02:(\S*)$/,channel:/^#(?:EXT\s+#)?(\d\d\d)(\S\S):(\S*)$/,header:/^#(\w+)(?:\s+(\S.*))?$/},dtx:{random:/^#RANDOM\s+(\d+)$/i,if:/^#IF\s+(\d+)$/i,endif:/^#ENDIF$/i,timeSignature:/^#(\d\d\d)02:\s*(\S*)$/,channel:/^#(?:EXT\s+#)?(\d\d\d)(\S\S):\s*(\S*)$/,header:/^#(\w+):(?:\s+(\S.*))?$/}};t.compile=function(e,t){t=t||{};var n=new o.BMSChart,s=t.rng||function(e){return 1+Math.floor(Math.random()*e)},a=t.format&&i[t.format]||i.bms,u=[],c=[!1],l={headerSentences:0,channelSentences:0,controlSentences:0,skippedSentences:0,malformedSentences:0,chart:n,warnings:[]};return function(e,t){e.split(/\r\n|\r|\n/).map(function(e){return e.trim()}).forEach(function(e,n){t(e,n+1)})}(e,function(e,t){var o=!0;if("#"===e.charAt(0)&&(r.match(e).when(a.random,function(e){l.controlSentences+=1,u.push(s(+e[1]))}).when(a.if,function(e){l.controlSentences+=1,c.push(u[u.length-1]!==+e[1])}).when(a.endif,function(e){l.controlSentences+=1,c.pop()}).else(function(){o=!1}),!o)){var i=c[c.length-1];r.match(e).when(a.timeSignature,function(e){l.channelSentences+=1,i||n.timeSignatures.set(+e[1],+e[2])}).when(a.channel,function(e){l.channelSentences+=1,i||function(e,t,r,o){var i=Math.floor(r.length/2);if(0!==i)for(var s=0;s<i;s++){var a=r.substr(2*s,2),u=s/i;"00"!==a&&n.objects.add({measure:e,fraction:u,value:a,channel:t,lineNumber:o})}}(+e[1],e[2],e[3],t)}).when(a.header,function(e){l.headerSentences+=1,i||n.headers.set(e[1],e[2])}).else(function(){!function(e,t){l.warnings.push({lineNumber:e,message:t})}(t,"Invalid command")})}}),l}},250:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(236));t.Segment=o.default({t:"number",x:"number",dx:"number"})},251:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=n(252),s=r(n(73)),a=o(n(253)),u=n(40),c=function(){function e(e){e.forEach(i.Note),this._notes=e}return e.prototype.count=function(){return this._notes.length},e.prototype.all=function(){return this._notes.slice()},e.fromBMSChart=function(t,n){u.BMSChart;var r=(n=n||{}).mapping||e.CHANNEL_MAPPING.IIDX_P1;return new l(t,{mapping:r}).build()},e.CHANNEL_MAPPING=a,e}();t.Notes=c;var l=function(){function e(e,t){this._chart=e,s.default(t.mapping,"Expected options.mapping"),s.default("object"==typeof t.mapping,"options.mapping must be object"),this._mapping=t.mapping,this._notes=[],this._activeLN={},this._lastNote={},this._lnObj=(this._chart.headers.get("lnobj")||"").toLowerCase(),this._channelMapping=this._mapping,this._objects=this._chart.objects.allSorted()}return e.prototype.build=function(){var e=this;return this._objects.forEach(function(t){e._handle(t)}),new c(this._notes)},e.prototype._handle=function(e){if("01"===e.channel)this._handleNormalNote(e);else switch(e.channel.charAt(0)){case"1":case"2":this._handleNormalNote(e);break;case"5":case"6":this._handleLongNote(e)}},e.prototype._handleNormalNote=function(e){var t=this._normalizeChannel(e.channel),n=this._getBeat(e);if(e.value.toLowerCase()===this._lnObj)this._lastNote[t]&&(this._lastNote[t].endBeat=n);else{var r={beat:n,endBeat:void 0,keysound:e.value,column:this._getColumn(t)};this._lastNote[t]=r,this._notes.push(r)}},e.prototype._handleLongNote=function(e){var t=this._normalizeChannel(e.channel),n=this._getBeat(e);if(this._activeLN[t]){var r=this._activeLN[t];r.endBeat=n,this._notes.push(r),delete this._activeLN[t]}else this._activeLN[t]={beat:n,keysound:e.value,column:this._getColumn(t)}},e.prototype._getBeat=function(e){return this._chart.measureToBeat(e.measure,e.fraction)},e.prototype._getColumn=function(e){return this._channelMapping[e]},e.prototype._normalizeChannel=function(e){return e.replace(/^5/,"1").replace(/^6/,"2")},e}()},252:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(236));t.Note=o.default({beat:"number",endBeat:o.default.maybe("number"),column:o.default.maybe("string"),keysound:"string"})},253:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IIDX_P1={11:"1",12:"2",13:"3",14:"4",15:"5",18:"6",19:"7",16:"SC"}},254:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(68),o=n(96),i=n(40),s={bpm:1,stop:2},a=function(){function e(e,t){var n={bpm:e,beat:0,seconds:0},i=[];i.push({t:0,x:0,dx:n.bpm/60,bpm:n.bpm,inclusive:!0}),(t=t.slice()).sort(function(e,t){return e.beat-t.beat||s[e.type]-s[t.type]}),t.forEach(function(e){var t=e.beat,r=n.seconds+60*(t-n.beat)/n.bpm;switch(e.type){case"bpm":n.bpm=e.bpm,i.push({t:r,x:t,dx:n.bpm/60,bpm:n.bpm,inclusive:!0});break;case"stop":i.push({t:r,x:t,dx:0,bpm:n.bpm,inclusive:!0}),r+=60*(e.stopBeats||0)/n.bpm,i.push({t:r,x:t,dx:n.bpm/60,bpm:n.bpm,inclusive:!1});break;default:throw new Error("Unrecognized segment object!")}n.beat=t,n.seconds=r}),this._speedcore=new r.Speedcore(i),this._eventBeats=o.uniq(o.map(t,function(e){return e.beat}))}return e.prototype.beatToSeconds=function(e){return this._speedcore.t(e)},e.prototype.secondsToBeat=function(e){return this._speedcore.x(e)},e.prototype.bpmAtBeat=function(e){return this._speedcore.segmentAtX(e).bpm},e.prototype.getEventBeats=function(){return this._eventBeats},e.fromBMSChart=function(t){i.BMSChart;var n=[];return t.objects.all().forEach(function(e){var r,o=t.measureToBeat(e.measure,e.fraction);if("03"===e.channel)r=parseInt(e.value,16),n.push({type:"bpm",beat:o,bpm:r});else if("08"===e.channel)r=+t.headers.get("bpm"+e.value),isNaN(r)||n.push({type:"bpm",beat:o,bpm:r});else if("09"===e.channel){var i=+t.headers.get("stop"+e.value)/48;n.push({type:"stop",beat:o,stopBeats:i})}}),new e(+t.headers.get("bpm")||60,n)},e}();t.Timing=a},255:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(148),o=n(96),i=n(40),s=function(){function e(e){this.title="NO TITLE",this.artist="NO ARTIST",this.genre="NO GENRE",this.subtitles=[],this.subartists=[],this.difficulty=0,this.level=0,e&&o.assign(this,e)}return e.fromBMSChart=function(t){i.BMSChart;var n={},o=t.headers.get("title"),s=t.headers.get("artist"),a=t.headers.get("genre"),u=+t.headers.get("difficulty")||0,c=+t.headers.get("playlevel")||0,l=t.headers.getAll("subtitle"),f=t.headers.getAll("subartist");if("string"==typeof o&&!l){var h=function(e){o=e[1],l=[e[2]]};r.match(o).when(/^(.*\S)\s*-(.+?)-$/,h).when(/^(.*\S)\s*～(.+?)～$/,h).when(/^(.*\S)\s*\((.+?)\)$/,h).when(/^(.*\S)\s*\[(.+?)\]$/,h).when(/^(.*\S)\s*<(.+?)>$/,h)}return o&&(n.title=o),s&&(n.artist=s),a&&(n.genre=a),l&&(n.subtitles=l),f&&(n.subartists=f),u&&(n.difficulty=u),c&&(n.level=c),new e(n)},e}();t.SongInfo=s},256:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96),o=n(40),i=function(){function e(e){this._map=e}return e.prototype.get=function(e){return this._map[e.toLowerCase()]},e.prototype.files=function(){return r.uniq(r.values(this._map))},e.prototype.all=function(){return this._map},e.fromBMSChart=function(t){o.BMSChart;var n={};return t.headers.each(function(e,t){var r=e.match(/^wav(\S\S)$/i);r&&(n[r[1].toLowerCase()]=t)}),new e(n)},e}();t.Keysounds=i},257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(68),o=n(40),i=function(){function e(e){this._speedcore=new r.Speedcore(e)}return e.prototype.speed=function(e){return this._speedcore.dx(e)},e.prototype.position=function(e){return this._speedcore.x(e)},e.fromBMSChart=function(t){o.BMSChart;var n=[],r=0;return n.push({t:0,x:r,dx:1,inclusive:!0}),t.objects.allSorted().forEach(function(e){if("SC"===e.channel){var o=t.measureToBeat(e.measure,e.fraction),i=+t.headers.get("scroll"+e.value);if(isNaN(i))return;var s=n[n.length-1];r+=(o-s.t)*s.dx,0===o&&1===n.length?n[0].dx=i:n.push({t:o,x:r,dx:i,inclusive:!0})}}),new e(n)},e}();t.Positioning=i},258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(68),o=n(40),i=function(){function e(e){e.length>0&&(this._speedcore=new r.Speedcore(e))}return e.prototype.factor=function(e){return this._speedcore?this._speedcore.x(e):1},e.fromBMSChart=function(t){o.BMSChart;var n=[];return t.objects.allSorted().forEach(function(e){if("SP"===e.channel){var r=t.measureToBeat(e.measure,e.fraction),o=+t.headers.get("speed"+e.value);if(isNaN(o))return;if(n.length>0){var i=n[n.length-1];i.dx=(o-i.x)/(r-i.t)}n.push({t:r,x:o,dx:0,inclusive:!0})}}),n.length>0&&n.unshift({t:0,x:n[0].x,dx:0,inclusive:!0}),new e(n)},e}();t.Spacing=i},40:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(149),o=n(150),i=n(151),s=function(){function e(){this.headers=new r.BMSHeaders,this.objects=new o.BMSObjects,this.timeSignatures=new i.TimeSignatures}return e.prototype.measureToBeat=function(e,t){return this.timeSignatures.measureToBeat(e,t)},e}();t.BMSChart=s},525:function(e,t,n){"use strict";var r=n(95),o=n(101),i=n(523),s=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})};i.a.init({workerUrl:"/vendor/libarchive.js-1.3.0/dist/worker-bundle.js"});var a=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})};class u{constructor(e){this._file=e}read(e){return r.a(e,Object(o.a)(this._file).as("arraybuffer"))}resolveUrl(){return Promise.resolve(URL.createObjectURL(this._file))}get name(){return this._file.name}}t.a=class{constructor(e){this._files=function(e){return a(this,void 0,void 0,function*(){let t=[];const n=e.dataTransfer;if(!n)throw new Error("Expect event.dataTransfer to be present");if(n.items)for(let e of Array.from(n.items))yield r(e);else if(n.files)for(let e of Array.from(n.files))i(e);return t;function r(e){return a(this,void 0,void 0,function*(){let t=e.webkitGetAsEntry&&e.webkitGetAsEntry();if(t)yield o(t);else{let t=e.getAsFile&&e.getAsFile();t&&i(t)}})}function o(e){return e.isFile?function(e){return new Promise((t,n)=>{e.file(t,n)}).tap(e=>{i(e)})}(e):e.isDirectory?function(e){return a(this,void 0,void 0,function*(){let t=[],n=e.createReader();for(;;){let e=yield new Promise((e,t)=>{n.readEntries(e,t)});if(!e||0===e.length)break;t.push(...Array.from(e))}for(let e of t)yield o(e)})}(e):void 0}function i(e){e&&t.push({name:e.name,file:e})}})}(e).then(c)}file(e){return this._files.then(function(t){for(let n of t)if(n.name.toLowerCase()===e.toLowerCase())return new u(n.file);throw new Error("unable to find "+e)})}get fileList(){return Promise.resolve(this._files.map(e=>e.name))}};function c(e){return a(this,void 0,void 0,function*(){if(1!==e.length)return e;const t=e[0];return t.name.match(/\.(?:zip|rar|7z|tar(?:\.(?:gz|bz2))?)/i)?function(e){return s(this,void 0,void 0,function*(){const t=[],n=yield(yield i.a.open(e)).extractFiles(),r=e=>{for(const n of Object.keys(e))e[n]instanceof File?t.push({name:n,file:e[n]}):e[n]&&"object"==typeof e[n]&&r(e[n])};return r(n),t})}(t.file):e})}},68:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(250),o=function(){function e(e){e.forEach(r.Segment),this._segments=e}return e.prototype._reached=function(e,t,n){if(e>=this._segments.length)return!1;var r=this._segments[e],o=t(r);return r.inclusive?n>=o:n>o},e.prototype._segmentAt=function(e,t){for(var n=0;n<this._segments.length;n++)if(!this._reached(n+1,e,t))return this._segments[n];throw new Error("Unable to find a segment matching a criteria (this should never happen)!")},e.prototype.segmentAtX=function(e){return this._segmentAt(s,e)},e.prototype.segmentAtT=function(e){return this._segmentAt(i,e)},e.prototype.t=function(e){var t=this.segmentAtX(e);return t.t+(e-t.x)/(t.dx||1)},e.prototype.x=function(e){var t=this.segmentAtT(e);return t.x+(e-t.t)*t.dx},e.prototype.dx=function(e){return this.segmentAtT(e).dx},e}();t.Speedcore=o;var i=function(e){return e.t},s=function(e){return e.x}},77:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return u});var r=n(490),o=n.n(r);let i=e=>t=>null!==t.progress?e(t):"",s=i(e=>o()(e.current)+" / "+o()(e.total)),a=i(e=>(e.current/e.total*100).toFixed(1)+"%"),u=i(e=>e.extra+"")},95:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"e",function(){return s}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return u});var r=n(77);function o(e,t){if(!t)return()=>{};let n=0;return t.report(0,e),r=>t.report(++n,e,r)}function i(e,t){return e?Promise.resolve(t).tap(t=>{!function(e){return e&&e.byteLength}(t)?e.report(1,1):(e.formatter=r.a,e.report(t.byteLength,t.byteLength))}):t}function s(e,t){let n=0,r=0;return function(...o){return e.report(n,++r),Promise.resolve(t.apply(this,o)).tap(()=>e.report(++n,r))}}function a(e,t){return e.watch(()=>t.report(e.current,e.total,e.extra))}function u(e){let t,n=[],r=null;function o(){t&&e.report(t.current,t.total,t.extra),n.length>0&&(!t||t.progress>=1)&&function(e){if(t===e)return;r&&(r(),r=null);(t=e)&&(r=t.watch(o))}(n.shift())}return{add(e){n.push(e),o()}}}},96:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(589));t.uniq=o.default;var i=r(n(590));t.map=i.default;var s=r(n(591));t.values=s.default;var a=r(n(592));t.assign=a.default}}]);
//# sourceMappingURL=comingSoonDemo-0b8d16ccadd99960935a.js.map