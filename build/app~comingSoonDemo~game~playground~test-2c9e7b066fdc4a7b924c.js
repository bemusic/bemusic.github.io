(this.webpackJsonp=this.webpackJsonp||[]).push([[15],{105:function(e,t,n){"use strict";t.a=function(e){return{as:function(t){return new Promise(function(n,r){var o=new FileReader;switch(o.onload=function(){n(o.result)},o.onerror=function(){r(new Error("Unable to read from Blob"))},t){case"arraybuffer":o.readAsArrayBuffer(e);break;case"text":o.readAsText(e)}})}}}},110:function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(258));t.Reader=o;var i=r(n(256));t.Compiler=i;var s=n(37);t.BMSChart=s.BMSChart;var a=n(144);t.BMSHeaders=a.BMSHeaders;var u=n(143);t.BMSObjects=u.BMSObjects;var c=n(73);t.Speedcore=c.Speedcore;var f=n(142);t.TimeSignatures=f.TimeSignatures;var h=n(254);t.Notes=h.Notes;var l=n(251);t.Timing=l.Timing;var p=n(250);t.SongInfo=p.SongInfo;var d=n(249);t.Keysounds=d.Keysounds;var m=n(248);t.Positioning=m.Positioning;var _=n(247);t.Spacing=_.Spacing},118:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"e",function(){return s}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return u});var r=n(79);function o(e,t){if(!t)return function(){};var n=0;return t.report(0,e),function(r){return t.report(++n,e,r)}}function i(e,t){return e?Promise.resolve(t).tap(function(t){t&&t.byteLength?(e.formatter=r.a,e.report(t.byteLength,t.byteLength)):e.report(1,1)}):t}function s(e,t){var n=0,r=0;return function(){return e.report(n,++r),Promise.resolve(t.apply(this,arguments)).tap(function(){return e.report(++n,r)})}}function a(e,t){return e.watch(function(){return t.report(e.current,e.total,e.extra)})}function u(e){var t=[],n=void 0,r=void 0;function o(){n&&e.report(n.current,n.total,n.extra),t.length>0&&(!n||n.progress>=1)&&function(e){if(n===e)return;r&&(r(),r=null);(n=e)&&(r=n.watch(o))}(t.shift())}return{add:function(e){t.push(e),o()}}}},142:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._values={}}return e.prototype.set=function(e,t){this._values[e]=t},e.prototype.get=function(e){return this._values[e]||1},e.prototype.getBeats=function(e){return 4*this.get(e)},e.prototype.measureToBeat=function(e,t){for(var n=0,r=0;r<e;r++)n+=this.getBeats(r);return n+this.getBeats(e)*t},e}();t.TimeSignatures=r},143:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._objects=[]}return e.prototype.add=function(e){if("01"!==e.channel)for(var t=0;t<this._objects.length;t++){var n=this._objects[t];if(n.channel===e.channel&&n.measure===e.measure&&n.fraction===e.fraction)return void(this._objects[t]=e)}this._objects.push(e)},e.prototype.all=function(){return this._objects.slice()},e.prototype.allSorted=function(){var e=this.all();return e.sort(function(e,t){return e.measure+e.fraction-(t.measure+t.fraction)}),e},e}();t.BMSObjects=r},144:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._data={},this._dataAll={}}return e.prototype.each=function(e){for(var t in this._data)e(t,this._data[t])},e.prototype.get=function(e){return this._data[e.toLowerCase()]},e.prototype.getAll=function(e){return this._dataAll[e.toLowerCase()]},e.prototype.set=function(e,t){var n=e.toLowerCase();this._data[n]=t,(this._dataAll[n]||(this._dataAll[n]=[])).push(t)},e}();t.BMSHeaders=r},145:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.match=function(e){var t=!1;return{when:function(n,r){if(t)return this;var o=e.match(n);return o&&(t=!0,r(o)),this},else:function(e){if(t)return this;e()}}}},247:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(73),o=n(37),i=function(){function e(e){e.length>0&&(this._speedcore=new r.Speedcore(e))}return e.prototype.factor=function(e){return this._speedcore?this._speedcore.x(e):1},e.fromBMSChart=function(t){o.BMSChart;var n=[];return t.objects.allSorted().forEach(function(e){if("SP"===e.channel){var r=t.measureToBeat(e.measure,e.fraction),o=+t.headers.get("speed"+e.value);if(isNaN(o))return;if(n.length>0){var i=n[n.length-1];i.dx=(o-i.x)/(r-i.t)}n.push({t:r,x:o,dx:0,inclusive:!0})}}),n.length>0&&n.unshift({t:0,x:n[0].x,dx:0,inclusive:!0}),new e(n)},e}();t.Spacing=i},248:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(73),o=n(37),i=function(){function e(e){this._speedcore=new r.Speedcore(e)}return e.prototype.speed=function(e){return this._speedcore.dx(e)},e.prototype.position=function(e){return this._speedcore.x(e)},e.fromBMSChart=function(t){o.BMSChart;var n=[],r=0;return n.push({t:0,x:r,dx:1,inclusive:!0}),t.objects.allSorted().forEach(function(e){if("SC"===e.channel){var o=t.measureToBeat(e.measure,e.fraction),i=+t.headers.get("scroll"+e.value);if(isNaN(i))return;var s=n[n.length-1];r+=(o-s.t)*s.dx,0===o&&1===n.length?n[0].dx=i:n.push({t:o,x:r,dx:i,inclusive:!0})}}),new e(n)},e}();t.Positioning=i},249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(94),o=n(37),i=function(){function e(e){this._map=e}return e.prototype.get=function(e){return this._map[e.toLowerCase()]},e.prototype.files=function(){return r.uniq(r.values(this._map))},e.prototype.all=function(){return this._map},e.fromBMSChart=function(t){o.BMSChart;var n={};return t.headers.each(function(e,t){var r=e.match(/^wav(\S\S)$/i);r&&(n[r[1].toLowerCase()]=t)}),new e(n)},e}();t.Keysounds=i},250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(145),o=n(94),i=n(37),s=function(){function e(e){this.title="NO TITLE",this.artist="NO ARTIST",this.genre="NO GENRE",this.subtitles=[],this.subartists=[],this.difficulty=0,this.level=0,e&&o.assign(this,e)}return e.fromBMSChart=function(t){i.BMSChart;var n={},o=t.headers.get("title"),s=t.headers.get("artist"),a=t.headers.get("genre"),u=+t.headers.get("difficulty"),c=+t.headers.get("playlevel"),f=t.headers.getAll("subtitle"),h=t.headers.getAll("subartist");if("string"==typeof o&&!f){var l=function(e){o=e[1],f=[e[2]]};r.match(o).when(/^(.*\S)\s*-(.+?)-$/,l).when(/^(.*\S)\s*～(.+?)～$/,l).when(/^(.*\S)\s*\((.+?)\)$/,l).when(/^(.*\S)\s*\[(.+?)\]$/,l).when(/^(.*\S)\s*<(.+?)>$/,l)}return o&&(n.title=o),s&&(n.artist=s),a&&(n.genre=a),f&&(n.subtitles=f),h&&(n.subartists=h),u&&(n.difficulty=u),c&&(n.level=c),new e(n)},e}();t.SongInfo=s},251:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(73),o=n(94),i=n(37),s={bpm:1,stop:2},a=function(){function e(e,t){var n={bpm:e,beat:0,seconds:0},i=[];i.push({t:0,x:0,dx:n.bpm/60,bpm:n.bpm,inclusive:!0}),(t=t.slice()).sort(function(e,t){return e.beat-t.beat||s[e.type]-s[t.type]}),t.forEach(function(e){var t=e.beat,r=n.seconds+60*(t-n.beat)/n.bpm;switch(e.type){case"bpm":n.bpm=e.bpm,i.push({t:r,x:t,dx:n.bpm/60,bpm:n.bpm,inclusive:!0});break;case"stop":i.push({t:r,x:t,dx:0,bpm:n.bpm,inclusive:!0}),r+=60*(e.stopBeats||0)/n.bpm,i.push({t:r,x:t,dx:n.bpm/60,bpm:n.bpm,inclusive:!1});break;default:throw new Error("Unrecognized segment object!")}n.beat=t,n.seconds=r}),this._speedcore=new r.Speedcore(i),this._eventBeats=o.uniq(o.map(t,"beat"),!0)}return e.prototype.beatToSeconds=function(e){return this._speedcore.t(e)},e.prototype.secondsToBeat=function(e){return this._speedcore.x(e)},e.prototype.bpmAtBeat=function(e){return this._speedcore.segmentAtX(e).bpm},e.prototype.getEventBeats=function(){return this._eventBeats},e.fromBMSChart=function(t){i.BMSChart;var n=[];return t.objects.all().forEach(function(e){var r,o=t.measureToBeat(e.measure,e.fraction);if("03"===e.channel)r=parseInt(e.value,16),n.push({type:"bpm",beat:o,bpm:r});else if("08"===e.channel)r=+t.headers.get("bpm"+e.value),isNaN(r)||n.push({type:"bpm",beat:o,bpm:r});else if("09"===e.channel){var i=t.headers.get("stop"+e.value)/48;n.push({type:"stop",beat:o,stopBeats:i})}}),new e(+t.headers.get("bpm")||60,n)},e}();t.Timing=a},252:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IIDX_P1={11:"1",12:"2",13:"3",14:"4",15:"5",18:"6",19:"7",16:"SC"}},253:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(104));t.Note=new o.default({beat:"number",endBeat:o.default.maybe("number"),column:o.default.maybe("string"),keysound:"string"})},254:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=n(253),s=r(n(85)),a=o(n(252)),u=n(37),c=function(){function e(e){e.forEach(i.Note),this._notes=e}return e.prototype.count=function(){return this._notes.length},e.prototype.all=function(){return this._notes.slice()},e.fromBMSChart=function(t,n){u.BMSChart;var r=(n=n||{}).mapping||e.CHANNEL_MAPPING.IIDX_P1;return new f(t,{mapping:r}).build()},e}();t.Notes=c,c.CHANNEL_MAPPING=a;var f=function(){function e(e,t){this._chart=e,s.default(t.mapping,"Expected options.mapping"),s.default("object"==typeof t.mapping,"options.mapping must be object"),this._mapping=t.mapping}return e.prototype.build=function(){return this._notes=[],this._activeLN={},this._lastNote={},this._lnObj=(this._chart.headers.get("lnobj")||"").toLowerCase(),this._channelMapping=this._mapping,this._objects=this._chart.objects.allSorted(),this._objects.forEach(function(e){this._handle(e)}.bind(this)),new c(this._notes)},e.prototype._handle=function(e){if("01"===e.channel)this._handleNormalNote(e);else switch(e.channel.charAt(0)){case"1":case"2":this._handleNormalNote(e);break;case"5":case"6":this._handleLongNote(e)}},e.prototype._handleNormalNote=function(e){var t=this._normalizeChannel(e.channel),n=this._getBeat(e);if(e.value.toLowerCase()===this._lnObj)this._lastNote[t]&&(this._lastNote[t].endBeat=n);else{var r={beat:n,endBeat:void 0,keysound:e.value,column:this._getColumn(t)};this._lastNote[t]=r,this._notes.push(r)}},e.prototype._handleLongNote=function(e){var t=this._normalizeChannel(e.channel),n=this._getBeat(e);if(this._activeLN[t]){var r=this._activeLN[t];r.endBeat=n,this._notes.push(r),delete this._activeLN[t]}else this._activeLN[t]={beat:n,keysound:e.value,column:this._getColumn(t)}},e.prototype._getBeat=function(e){return this._chart.measureToBeat(e.measure,e.fraction)},e.prototype._getColumn=function(e){return this._channelMapping[e]},e.prototype._normalizeChannel=function(e){return e.replace(/^5/,"1").replace(/^6/,"2")},e}()},255:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(104));t.Segment=new o.default({t:"number",x:"number",dx:"number"})},256:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(145),o=n(37),i={bms:{random:/^#RANDOM\s+(\d+)$/i,if:/^#IF\s+(\d+)$/i,endif:/^#ENDIF$/i,timeSignature:/^#(\d\d\d)02:(\S*)$/,channel:/^#(?:EXT\s+#)?(\d\d\d)(\S\S):(\S*)$/,header:/^#(\w+)(?:\s+(\S.*))?$/},dtx:{random:/^#RANDOM\s+(\d+)$/i,if:/^#IF\s+(\d+)$/i,endif:/^#ENDIF$/i,timeSignature:/^#(\d\d\d)02:\s*(\S*)$/,channel:/^#(?:EXT\s+#)?(\d\d\d)(\S\S):\s*(\S*)$/,header:/^#(\w+):(?:\s+(\S.*))?$/}};t.compile=function(e,t){t=t||{};var n=new o.BMSChart,s=t.rng||function(e){return 1+Math.floor(Math.random()*e)},a=i[t.format]||i.bms,u=[],c=[!1],f={headerSentences:0,channelSentences:0,controlSentences:0,skippedSentences:0,malformedSentences:0,chart:n,warnings:[]};return function(e,t){e.split(/\r\n|\r|\n/).map(function(e){return e.trim()}).forEach(function(e,n){t(e,n+1)})}(e,function(e,t){var o=!0;if("#"===e.charAt(0)&&(r.match(e).when(a.random,function(e){f.controlSentences+=1,u.push(s(+e[1]))}).when(a.if,function(e){f.controlSentences+=1,c.push(u[u.length-1]!==+e[1])}).when(a.endif,function(e){f.controlSentences+=1,c.pop()}).else(function(){o=!1}),!o)){var i=c[c.length-1];r.match(e).when(a.timeSignature,function(e){f.channelSentences+=1,i||n.timeSignatures.set(+e[1],+e[2])}).when(a.channel,function(e){f.channelSentences+=1,i||function(e,t,r,o){var i=Math.floor(r.length/2);if(0!==i)for(var s=0;s<i;s++){var a=r.substr(2*s,2),u=s/i;"00"!==a&&n.objects.add({measure:e,fraction:u,value:a,channel:t,lineNumber:o})}}(+e[1],e[2],e[3],t)}).when(a.header,function(e){f.headerSentences+=1,i||n.headers.set(e[1],e[2])}).else(function(){!function(e,t){f.warnings.push({lineNumber:e,message:t})}(t,"Invalid command")})}}),f}},257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReaderOptionsFromFilename=function(e){var t;return e.match(/\.sjis\.\w+$/i)&&(t="Shift-JIS"),e.match(/\.euc_kr\.\w+$/i)&&(t="EUC-KR"),e.match(/\.utf8\.\w+$/i)&&(t="UTF-8"),{forceEncoding:t}}},258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(605);t.read=function(e){throw new Error("Synchronous read unsupported in browser!")},t.readAsync=function(e,t,n){n||(n=t,t=null);var o=t&&t.forceEncoding||r.detect(e),i=new FileReader;i.onload=function(){n(null,i.result)},i.onerror=function(){n(new Error("cannot read it"))},i.readAsText(new Blob([e]),o)};var o=n(257);t.getReaderOptionsFromFilename=o.getReaderOptionsFromFilename},37:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(144),o=n(143),i=n(142),s=function(){function e(){this.headers=new r.BMSHeaders,this.objects=new o.BMSObjects,this.timeSignatures=new i.TimeSignatures}return e.prototype.measureToBeat=function(e,t){return this.timeSignatures.measureToBeat(e,t)},e}();t.BMSChart=s},73:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(255),o=function(){function e(e){this._segments=e.map(r.Segment)}return e.prototype._reached=function(e,t,n){if(e>=this._segments.length)return!1;var r=this._segments[e],o=t(r);return r.inclusive?n>=o:n>o},e.prototype._segmentAt=function(e,t){for(var n=0;n<this._segments.length;n++)if(!this._reached(n+1,e,t))return this._segments[n]},e.prototype.segmentAtX=function(e){return this._segmentAt(s,e)},e.prototype.segmentAtT=function(e){return this._segmentAt(i,e)},e.prototype.t=function(e){var t=this.segmentAtX(e);return t.t+(e-t.x)/(t.dx||1)},e.prototype.x=function(e){var t=this.segmentAtT(e);return t.x+(e-t.t)*t.dx},e.prototype.dx=function(e){return this.segmentAtT(e).dx},e}();t.Speedcore=o;var i=function(e){return e.t},s=function(e){return e.x}},79:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return u});var r=n(345),o=n.n(r),i=function(e){return function(t){return null!==t.progress?e(t):""}},s=i(function(e){return o()(e.current)+" / "+o()(e.total)}),a=i(function(e){return(e.current/e.total*100).toFixed(1)+"%"}),u=i(function(e){return e.extra+""})},94:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(603));t.uniq=o.default;var i=r(n(602));t.map=i.default;var s=r(n(601));t.values=s.default;var a=r(n(600));t.assign=a.default}}]);
//# sourceMappingURL=app~comingSoonDemo~game~playground~test-2c9e7b066fdc4a7b924c.js.map